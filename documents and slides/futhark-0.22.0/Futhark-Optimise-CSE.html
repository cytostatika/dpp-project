<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Futhark.Optimise.CSE</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">futhark-0.22.0: An optimising compiler for a functional, array-oriented language.</span><ul class="links" id="page-menu"><li><a href="src/Futhark.Optimise.CSE.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Futhark.Optimise.CSE</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module implements common-subexpression elimination.  This
 module does not actually remove the duplicate, but only replaces
 one with a diference to the other.  E.g:</p><pre>  let a = x + y
  let b = x + y
</pre><p>becomes:</p><pre>  let a = x + y
  let b = a
</pre><p>After which copy propagation in the simplifier will actually remove
 the definition of <code>b</code>.</p><p>Our CSE is still rather stupid.  No normalisation is performed, so
 the expressions <code>x+y</code> and <code>y+x</code> will be considered distinct.
 Furthermore, no expression with its own binding will be considered
 equal to any other, since the variable names will be distinct.
 This affects SOACs in particular.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:performCSE">performCSE</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-Pass.html#t:Pass" title="Futhark.Pass">Pass</a> rep rep</li><li class="src short"><a href="#v:performCSEOnFunDef">performCSEOnFunDef</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-IR-Syntax.html#t:FunDef" title="Futhark.IR.Syntax">FunDef</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:FunDef" title="Futhark.IR.Syntax">FunDef</a> rep</li><li class="src short"><a href="#v:performCSEOnStms">performCSEOnStms</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-IR-Syntax.html#t:Stms" title="Futhark.IR.Syntax">Stms</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Stms" title="Futhark.IR.Syntax">Stms</a> rep</li><li class="src short"><span class="keyword">class</span> <a href="#t:CSEInOp">CSEInOp</a> op</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:performCSE" class="def">performCSE</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-Pass.html#t:Pass" title="Futhark.Pass">Pass</a> rep rep <a href="src/Futhark.Optimise.CSE.html#performCSE" class="link">Source</a> <a href="#v:performCSE" class="selflink">#</a></p><div class="doc"><p>Perform CSE on every function in a program.</p><p>If the boolean argument is false, the pass will not perform CSE on
 expressions producing arrays. This should be disabled when the rep has
 memory information, since at that point arrays have identity beyond their
 value.</p></div></div><div class="top"><p class="src"><a id="v:performCSEOnFunDef" class="def">performCSEOnFunDef</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-IR-Syntax.html#t:FunDef" title="Futhark.IR.Syntax">FunDef</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:FunDef" title="Futhark.IR.Syntax">FunDef</a> rep <a href="src/Futhark.Optimise.CSE.html#performCSEOnFunDef" class="link">Source</a> <a href="#v:performCSEOnFunDef" class="selflink">#</a></p><div class="doc"><p>Perform CSE on a single function.</p><p>If the boolean argument is false, the pass will not perform CSE on
 expressions producing arrays. This should be disabled when the rep has
 memory information, since at that point arrays have identity beyond their
 value.</p></div></div><div class="top"><p class="src"><a id="v:performCSEOnStms" class="def">performCSEOnStms</a> :: (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; Bool -&gt; <a href="Futhark-IR-Syntax.html#t:Stms" title="Futhark.IR.Syntax">Stms</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Stms" title="Futhark.IR.Syntax">Stms</a> rep <a href="src/Futhark.Optimise.CSE.html#performCSEOnStms" class="link">Source</a> <a href="#v:performCSEOnStms" class="selflink">#</a></p><div class="doc"><p>Perform CSE on some statements.</p><p>If the boolean argument is false, the pass will not perform CSE on
 expressions producing arrays. This should be disabled when the rep has
 memory information, since at that point arrays have identity beyond their
 value.</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:CSEInOp" class="def">CSEInOp</a> op <a href="src/Futhark.Optimise.CSE.html#CSEInOp" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></p><div class="doc"><p>The operations that permit CSE.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src">cseInOp</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:CSEInOp">Instances</h4><details id="i:CSEInOp" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:1"></span> <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> ()</span> <a href="src/Futhark.Optimise.CSE.html#line-290" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: () -&gt; CSEM rep ()</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:2"></span> (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:CanBeAliased" title="Futhark.IR.Prop.Aliases">CanBeAliased</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Prop-Aliases.html#t:OpWithAliases" title="Futhark.IR.Prop.Aliases">OpWithAliases</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep))) =&gt; <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-SOACS-SOAC.html#t:SOAC" title="Futhark.IR.SOACS.SOAC">SOAC</a> (<a href="Futhark-IR-Aliases.html#t:Aliases" title="Futhark.IR.Aliases">Aliases</a> rep))</span> <a href="src/Futhark.Optimise.CSE.html#line-345" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: <a href="Futhark-IR-SOACS-SOAC.html#t:SOAC" title="Futhark.IR.SOACS.SOAC">SOAC</a> (<a href="Futhark-IR-Aliases.html#t:Aliases" title="Futhark.IR.Aliases">Aliases</a> rep) -&gt; CSEM rep0 (<a href="Futhark-IR-SOACS-SOAC.html#t:SOAC" title="Futhark.IR.SOACS.SOAC">SOAC</a> (<a href="Futhark-IR-Aliases.html#t:Aliases" title="Futhark.IR.Aliases">Aliases</a> rep))</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:3"></span> <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> op =&gt; <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Mem.html#t:MemOp" title="Futhark.IR.Mem">MemOp</a> op)</span> <a href="src/Futhark.Optimise.CSE.html#line-340" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: <a href="Futhark-IR-Mem.html#t:MemOp" title="Futhark.IR.Mem">MemOp</a> op -&gt; CSEM rep (<a href="Futhark-IR-Mem.html#t:MemOp" title="Futhark.IR.Mem">MemOp</a> op)</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:4"></span> (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:Aliased" title="Futhark.IR.Prop.Aliases">Aliased</a> rep, <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep)) =&gt; <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-SegOp.html#t:SegOp" title="Futhark.IR.SegOp">SegOp</a> lvl rep)</span> <a href="src/Futhark.Optimise.CSE.html#line-324" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: <a href="Futhark-IR-SegOp.html#t:SegOp" title="Futhark.IR.SegOp">SegOp</a> lvl rep -&gt; CSEM rep0 (<a href="Futhark-IR-SegOp.html#t:SegOp" title="Futhark.IR.SegOp">SegOp</a> lvl rep)</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:5"></span> (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:Aliased" title="Futhark.IR.Prop.Aliases">Aliased</a> rep, <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> op) =&gt; <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-MC-Op.html#t:MCOp" title="Futhark.IR.MC.Op">MCOp</a> rep op)</span> <a href="src/Futhark.Optimise.CSE.html#line-311" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: <a href="Futhark-IR-MC-Op.html#t:MCOp" title="Futhark.IR.MC.Op">MCOp</a> rep op -&gt; CSEM rep0 (<a href="Futhark-IR-MC-Op.html#t:MCOp" title="Futhark.IR.MC.Op">MCOp</a> rep op)</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CSEInOp:CSEInOp:6"></span> (<a href="Futhark-IR-Prop.html#t:ASTRep" title="Futhark.IR.Prop">ASTRep</a> rep, <a href="Futhark-IR-Prop-Aliases.html#t:Aliased" title="Futhark.IR.Prop.Aliases">Aliased</a> rep, <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-Rep.html#t:Op" title="Futhark.IR.Rep">Op</a> rep), <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> op) =&gt; <a href="Futhark-Optimise-CSE.html#t:CSEInOp" title="Futhark.Optimise.CSE">CSEInOp</a> (<a href="Futhark-IR-GPU-Op.html#t:HostOp" title="Futhark.IR.GPU.Op">HostOp</a> rep op)</span> <a href="src/Futhark.Optimise.CSE.html#line-299" class="link">Source</a> <a href="#t:CSEInOp" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CSEInOp:CSEInOp:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Futhark-Optimise-CSE.html">Futhark.Optimise.CSE</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cseInOp">cseInOp</a> :: <a href="Futhark-IR-GPU-Op.html#t:HostOp" title="Futhark.IR.GPU.Op">HostOp</a> rep op -&gt; CSEM rep0 (<a href="Futhark-IR-GPU-Op.html#t:HostOp" title="Futhark.IR.GPU.Op">HostOp</a> rep op)</p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>