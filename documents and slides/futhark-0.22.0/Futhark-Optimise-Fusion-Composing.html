<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Futhark.Optimise.Fusion.Composing</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">futhark-0.22.0: An optimising compiler for a functional, array-oriented language.</span><ul class="links" id="page-menu"><li><a href="src/Futhark.Optimise.Fusion.Composing.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Futhark.Optimise.Fusion.Composing</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Facilities for composing SOAC functions.  Mostly intended for use
 by the fusion module, but factored into a separate module for ease
 of testing, debugging and development.  Of course, there is nothing
 preventing you from using the exported functions whereever you
 want.</p><p>Important: this module is &quot;dumb&quot; in the sense that it does not
 check the validity of its inputs, and does not have any
 functionality for massaging SOACs to be fusible.  It is assumed
 that the given SOACs are immediately compatible.</p><p>The module will, however, remove duplicate inputs after fusion.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:fuseMaps">fuseMaps</a> :: <a href="Futhark-Builder-Class.html#t:Buildable" title="Futhark.Builder.Class">Buildable</a> rep =&gt; <a href="Futhark-IR-Prop-Names.html#t:Names" title="Futhark.IR.Prop.Names">Names</a> -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; [(<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>, <a href="Futhark-IR-Syntax-Core.html#t:Ident" title="Futhark.IR.Syntax.Core">Ident</a>)] -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; (<a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep, [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>])</li><li class="src short"><a href="#v:fuseRedomap">fuseRedomap</a> :: <a href="Futhark-Builder-Class.html#t:Buildable" title="Futhark.Builder.Class">Buildable</a> rep =&gt; <a href="Futhark-IR-Prop-Names.html#t:Names" title="Futhark.IR.Prop.Names">Names</a> -&gt; [<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>] -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; [(<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>, <a href="Futhark-IR-Syntax-Core.html#t:Ident" title="Futhark.IR.Syntax.Core">Ident</a>)] -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; (<a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep, [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>])</li><li class="src short"><a href="#v:mergeReduceOps">mergeReduceOps</a> :: <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:fuseMaps" class="def">fuseMaps</a> <a href="src/Futhark.Optimise.Fusion.Composing.html#fuseMaps" class="link">Source</a> <a href="#v:fuseMaps" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Futhark-Builder-Class.html#t:Buildable" title="Futhark.Builder.Class">Buildable</a> rep</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Futhark-IR-Prop-Names.html#t:Names" title="Futhark.IR.Prop.Names">Names</a></td><td class="doc"><p>The producer var names that still need to be returned</p></td></tr><tr><td class="src">-&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep</td><td class="doc"><p>Function of SOAC to be fused.</p></td></tr><tr><td class="src">-&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>]</td><td class="doc"><p>Input of SOAC to be fused.</p></td></tr><tr><td class="src">-&gt; [(<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>, <a href="Futhark-IR-Syntax-Core.html#t:Ident" title="Futhark.IR.Syntax.Core">Ident</a>)]</td><td class="doc"><p>Output of SOAC to be fused.  The
 first identifier is the name of the
 actual output, where the second output
 is an identifier that can be used to
 bind a single element of that output.</p></td></tr><tr><td class="src">-&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep</td><td class="doc"><p>Function to be fused with.</p></td></tr><tr><td class="src">-&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>]</td><td class="doc"><p>Input of SOAC to be fused with.</p></td></tr><tr><td class="src">-&gt; (<a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep, [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>])</td><td class="doc"><p>The fused lambda and the inputs of
 the resulting SOAC.</p></td></tr></table></div><div class="doc"><p><code>fuseMaps lam1 inp1 out1 lam2 inp2</code> fuses the function <code>lam1</code> into
 <code>lam2</code>.  Both functions must be mapping functions, although <code>lam2</code>
 may have leading reduction parameters.  <code>inp1</code> and <code>inp2</code> are the
 array inputs to the SOACs containing <code>lam1</code> and <code>lam2</code>
 respectively.  <code>out1</code> are the identifiers to which the output of
 the SOAC containing <code>lam1</code> is bound.  It is nonsensical to call
 this function unless the intersection of <code>out1</code> and <code>inp2</code> is
 non-empty.</p><p>If <code>lam2</code> accepts more parameters than there are elements in
 <code>inp2</code>, it is assumed that the surplus (which are positioned at the
 beginning of the parameter list) are reduction (accumulator)
 parameters, that do not correspond to array elements, and they are
 thus not modified.</p><p>The result is the fused function, and a list of the array inputs
 expected by the SOAC containing the fused function.</p></div></div><div class="top"><p class="src"><a id="v:fuseRedomap" class="def">fuseRedomap</a> :: <a href="Futhark-Builder-Class.html#t:Buildable" title="Futhark.Builder.Class">Buildable</a> rep =&gt; <a href="Futhark-IR-Prop-Names.html#t:Names" title="Futhark.IR.Prop.Names">Names</a> -&gt; [<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>] -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; [(<a href="Language-Futhark-Core.html#t:VName" title="Language.Futhark.Core">VName</a>, <a href="Futhark-IR-Syntax-Core.html#t:Ident" title="Futhark.IR.Syntax.Core">Ident</a>)] -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-IR-Syntax-Core.html#t:SubExp" title="Futhark.IR.Syntax.Core">SubExp</a>] -&gt; [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>] -&gt; (<a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep, [<a href="Futhark-Analysis-HORep-SOAC.html#t:Input" title="Futhark.Analysis.HORep.SOAC">Input</a>]) <a href="src/Futhark.Optimise.Fusion.Composing.html#fuseRedomap" class="link">Source</a> <a href="#v:fuseRedomap" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:mergeReduceOps" class="def">mergeReduceOps</a> :: <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep -&gt; <a href="Futhark-IR-Syntax.html#t:Lambda" title="Futhark.IR.Syntax">Lambda</a> rep <a href="src/Futhark.Optimise.Fusion.Composing.html#mergeReduceOps" class="link">Source</a> <a href="#v:mergeReduceOps" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>