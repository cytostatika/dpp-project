<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621684469843"><span id="local-6989586621684469844"></span></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE Strict #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | Imperative intermediate language used as a stepping stone in code generation.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- This is a generic representation parametrised on an extensible</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- arbitrary operation.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Originally inspired by the paper &quot;Defunctionalizing Push Arrays&quot;</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- (FHPC '14).</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.CodeGen.ImpCode</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier">Definitions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier">FunctionT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier">Constants</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier">ValueDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Signedness"><span class="hs-identifier">Signedness</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier">ExternalValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier">Param</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier">paramName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier">SubExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemSize"><span class="hs-identifier">MemSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DimSize"><span class="hs-identifier">DimSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier">Space</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SpaceId"><span class="hs-identifier">SpaceId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier">Code</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimValue"><span class="hs-identifier">PrimValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier">Exp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier">TExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatility"><span class="hs-identifier">Volatility</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Arg"><span class="hs-identifier">Arg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#var"><span class="hs-identifier">var</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsg"><span class="hs-identifier">ErrorMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsgPart"><span class="hs-identifier">ErrorMsgPart</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#errorMsgArgTypes"><span class="hs-identifier">errorMsgArgTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayContents"><span class="hs-identifier">ArrayContents</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier">declaredIn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#lexicalMemoryUsage"><span class="hs-identifier">lexicalMemoryUsage</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier">calledFuncs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Typed enumerations</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier">Bytes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier">Elements</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#elements"><span class="hs-identifier">elements</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#bytes"><span class="hs-identifier">bytes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#withElemType"><span class="hs-identifier">withElemType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports from other modules.</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Futhark.Util.Pretty.html#pretty"><span class="hs-identifier">pretty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html"><span class="hs-identifier">Language.Futhark.Core</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html"><span class="hs-identifier">Futhark.IR.Primitive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html"><span class="hs-identifier">Futhark.Analysis.PrimExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.Convert.html"><span class="hs-identifier">Futhark.Analysis.PrimExp.Convert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html"><span class="hs-identifier">Futhark.IR.GPU.Sizes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html"><span class="hs-identifier">Futhark.Analysis.PrimExp</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.Convert.html"><span class="hs-identifier">Futhark.Analysis.PrimExp.Convert</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html"><span class="hs-identifier">Futhark.IR.GPU.Sizes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier">Count</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html"><span class="hs-identifier">Futhark.IR.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html"><span class="hs-identifier">Futhark.IR.Primitive</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html"><span class="hs-identifier">Futhark.IR.Syntax.Core</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsg"><span class="hs-identifier">ErrorMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsgPart"><span class="hs-identifier">ErrorMsgPart</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier">Space</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SpaceId"><span class="hs-identifier">SpaceId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier">SubExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#errorMsgArgTypes"><span class="hs-identifier">errorMsgArgTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">space</span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html"><span class="hs-identifier">Language.Futhark.Core</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | The size of a memory block.</span><span>
</span><span id="line-83"></span><span class="hs-keyword">type</span><span> </span><span id="MemSize"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemSize"><span class="hs-identifier hs-var">MemSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | The size of an array.</span><span>
</span><span id="line-86"></span><span class="hs-keyword">type</span><span> </span><span id="DimSize"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DimSize"><span class="hs-identifier hs-var">DimSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | An ImpCode function parameter.</span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span> </span><span id="Param"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-var">Param</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MemParam"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemParam"><span class="hs-identifier hs-var">MemParam</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScalarParam"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarParam"><span class="hs-identifier hs-var">ScalarParam</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469800"><span id="local-6989586621684469802"><span id="local-6989586621684469814"><span class="annot"><span class="annottext">Int -&gt; Param -&gt; ShowS
[Param] -&gt; ShowS
Param -&gt; String
(Int -&gt; Param -&gt; ShowS)
-&gt; (Param -&gt; String) -&gt; ([Param] -&gt; ShowS) -&gt; Show Param
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Param] -&gt; ShowS
$cshowList :: [Param] -&gt; ShowS
show :: Param -&gt; String
$cshow :: Param -&gt; String
showsPrec :: Int -&gt; Param -&gt; ShowS
$cshowsPrec :: Int -&gt; Param -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | The name of a parameter.</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier hs-type">paramName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-96"></span><span id="paramName"><span class="annot"><span class="annottext">paramName :: Param -&gt; VName
</span><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemParam"><span class="hs-identifier hs-type">MemParam</span></a></span><span> </span><span id="local-6989586621684469798"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469798"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469798"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier hs-var">paramName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarParam"><span class="hs-identifier hs-type">ScalarParam</span></a></span><span> </span><span id="local-6989586621684469797"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469797"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469797"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | A collection of imperative functions and constants.</span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="Definitions"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-var">Definitions</span></a></span></span><span> </span><span id="local-6989586621684470280"><span class="annot"><a href="#local-6989586621684470280"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Definitions"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-var">Definitions</span></a></span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="defConsts"><span class="annot"><span class="annottext">forall a. Definitions a -&gt; Constants a
</span><a href="Futhark.CodeGen.ImpCode.html#defConsts"><span class="hs-identifier hs-var hs-var">defConsts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-type">Constants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470280"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>    </span><span id="defFuns"><span class="annot"><span class="annottext">forall a. Definitions a -&gt; Functions a
</span><a href="Futhark.CodeGen.ImpCode.html#defFuns"><span class="hs-identifier hs-var hs-var">defFuns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470280"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469785"><span id="local-6989586621684469787"><span id="local-6989586621684469792"><span class="annot"><span class="annottext">Int -&gt; Definitions a -&gt; ShowS
[Definitions a] -&gt; ShowS
Definitions a -&gt; String
(Int -&gt; Definitions a -&gt; ShowS)
-&gt; (Definitions a -&gt; String)
-&gt; ([Definitions a] -&gt; ShowS)
-&gt; Show (Definitions a)
forall a. Show a =&gt; Int -&gt; Definitions a -&gt; ShowS
forall a. Show a =&gt; [Definitions a] -&gt; ShowS
forall a. Show a =&gt; Definitions a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Definitions a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Definitions a] -&gt; ShowS
show :: Definitions a -&gt; String
$cshow :: forall a. Show a =&gt; Definitions a -&gt; String
showsPrec :: Int -&gt; Definitions a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Definitions a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469782"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621684469778"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Definitions a -&gt; Definitions b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621684469777"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621684469777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span id="local-6989586621684469776"><span class="annot"><span class="annottext">Constants a
</span><a href="#local-6989586621684469776"><span class="hs-identifier hs-var">consts</span></a></span></span><span> </span><span id="local-6989586621684469775"><span class="annot"><span class="annottext">Functions a
</span><a href="#local-6989586621684469775"><span class="hs-identifier hs-var">funs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constants b -&gt; Functions b -&gt; Definitions b
forall a. Constants a -&gt; Functions a -&gt; Definitions a
</span><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-var">Definitions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Constants a -&gt; Constants b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621684469777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Constants a
</span><a href="#local-6989586621684469776"><span class="hs-identifier hs-var">consts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Functions a -&gt; Functions b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621684469777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Functions a
</span><a href="#local-6989586621684469775"><span class="hs-identifier hs-var">funs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | A collection of imperative functions.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">newtype</span><span> </span><span id="Functions"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span></span><span> </span><span id="local-6989586621684470276"><span class="annot"><a href="#local-6989586621684470276"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Functions"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469764"><span id="local-6989586621684469766"><span id="local-6989586621684469772"><span class="annot"><span class="annottext">Int -&gt; Functions a -&gt; ShowS
[Functions a] -&gt; ShowS
Functions a -&gt; String
(Int -&gt; Functions a -&gt; ShowS)
-&gt; (Functions a -&gt; String)
-&gt; ([Functions a] -&gt; ShowS)
-&gt; Show (Functions a)
forall a. Show a =&gt; Int -&gt; Functions a -&gt; ShowS
forall a. Show a =&gt; [Functions a] -&gt; ShowS
forall a. Show a =&gt; Functions a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Functions a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Functions a] -&gt; ShowS
show :: Functions a -&gt; String
$cshow :: forall a. Show a =&gt; Functions a -&gt; String
showsPrec :: Int -&gt; Functions a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Functions a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621684470259"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469755"><span id="local-6989586621684469757"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470259"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span id="local-6989586621684469753"><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684469753"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684469752"><span class="annot"><span class="annottext">&lt;&gt; :: Functions a -&gt; Functions a -&gt; Functions a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span id="local-6989586621684469751"><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684469751"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)] -&gt; Functions a
forall a. [(Name, Function a)] -&gt; Functions a
</span><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, Function a)] -&gt; Functions a)
-&gt; [(Name, Function a)] -&gt; Functions a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684469753"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)]
-&gt; [(Name, Function a)] -&gt; [(Name, Function a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684469751"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621684470253"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469744"><span id="local-6989586621684469746"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470253"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621684469742"><span class="annot"><span class="annottext">mempty :: Functions a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)] -&gt; Functions a
forall a. [(Name, Function a)] -&gt; Functions a
</span><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | A collection of imperative constants.</span><span>
</span><span id="line-120"></span><span class="hs-keyword">data</span><span> </span><span id="Constants"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span></span><span> </span><span id="local-6989586621684470277"><span class="annot"><a href="#local-6989586621684470277"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Constants"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | The constants that are made available to the functions.</span><span>
</span><span id="line-122"></span><span>    </span><span id="constsDecl"><span class="annot"><span class="annottext">forall a. Constants a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#constsDecl"><span class="hs-identifier hs-var hs-var">constsDecl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- | Setting the value of the constants.  Note that this must not</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- contain declarations of the names defined in 'constsDecl'.</span><span>
</span><span id="line-125"></span><span>    </span><span id="constsInit"><span class="annot"><span class="annottext">forall a. Constants a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#constsInit"><span class="hs-identifier hs-var hs-var">constsInit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470277"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469729"><span id="local-6989586621684469731"><span id="local-6989586621684469737"><span class="annot"><span class="annottext">Int -&gt; Constants a -&gt; ShowS
[Constants a] -&gt; ShowS
Constants a -&gt; String
(Int -&gt; Constants a -&gt; ShowS)
-&gt; (Constants a -&gt; String)
-&gt; ([Constants a] -&gt; ShowS)
-&gt; Show (Constants a)
forall a. Show a =&gt; Int -&gt; Constants a -&gt; ShowS
forall a. Show a =&gt; [Constants a] -&gt; ShowS
forall a. Show a =&gt; Constants a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Constants a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Constants a] -&gt; ShowS
show :: Constants a -&gt; String
$cshow :: forall a. Show a =&gt; Constants a -&gt; String
showsPrec :: Int -&gt; Constants a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Constants a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469726"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-type">Constants</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621684469724"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Constants a -&gt; Constants b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621684469723"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621684469723"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-type">Constants</span></a></span><span> </span><span id="local-6989586621684469722"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469722"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621684469721"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469721"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Code b -&gt; Constants b
forall a. [Param] -&gt; Code a -&gt; Constants a
</span><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-var">Constants</span></a></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469722"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Code a -&gt; Code b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621684469723"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469721"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | Since the core language does not care for signedness, but the</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- source language does, entry point input/output information has</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- metadata for integer types (and arrays containing these) that</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- indicate whether they are really unsigned integers.</span><span>
</span><span id="line-136"></span><span class="hs-keyword">data</span><span> </span><span id="Signedness"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Signedness"><span class="hs-identifier hs-var">Signedness</span></a></span></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TypeUnsigned"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TypeUnsigned"><span class="hs-identifier hs-var">TypeUnsigned</span></a></span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TypeDirect"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TypeDirect"><span class="hs-identifier hs-var">TypeDirect</span></a></span></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469715"><span id="local-6989586621684469717"><span class="annot"><span class="annottext">Signedness -&gt; Signedness -&gt; Bool
(Signedness -&gt; Signedness -&gt; Bool)
-&gt; (Signedness -&gt; Signedness -&gt; Bool) -&gt; Eq Signedness
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Signedness -&gt; Signedness -&gt; Bool
$c/= :: Signedness -&gt; Signedness -&gt; Bool
== :: Signedness -&gt; Signedness -&gt; Bool
$c== :: Signedness -&gt; Signedness -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469695"><span id="local-6989586621684469697"><span id="local-6989586621684469700"><span id="local-6989586621684469703"><span id="local-6989586621684469706"><span id="local-6989586621684469708"><span id="local-6989586621684469710"><span class="annot"><span class="annottext">Eq Signedness
Eq Signedness
-&gt; (Signedness -&gt; Signedness -&gt; Ordering)
-&gt; (Signedness -&gt; Signedness -&gt; Bool)
-&gt; (Signedness -&gt; Signedness -&gt; Bool)
-&gt; (Signedness -&gt; Signedness -&gt; Bool)
-&gt; (Signedness -&gt; Signedness -&gt; Bool)
-&gt; (Signedness -&gt; Signedness -&gt; Signedness)
-&gt; (Signedness -&gt; Signedness -&gt; Signedness)
-&gt; Ord Signedness
Signedness -&gt; Signedness -&gt; Bool
Signedness -&gt; Signedness -&gt; Ordering
Signedness -&gt; Signedness -&gt; Signedness
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Signedness -&gt; Signedness -&gt; Signedness
$cmin :: Signedness -&gt; Signedness -&gt; Signedness
max :: Signedness -&gt; Signedness -&gt; Signedness
$cmax :: Signedness -&gt; Signedness -&gt; Signedness
&gt;= :: Signedness -&gt; Signedness -&gt; Bool
$c&gt;= :: Signedness -&gt; Signedness -&gt; Bool
&gt; :: Signedness -&gt; Signedness -&gt; Bool
$c&gt; :: Signedness -&gt; Signedness -&gt; Bool
&lt;= :: Signedness -&gt; Signedness -&gt; Bool
$c&lt;= :: Signedness -&gt; Signedness -&gt; Bool
&lt; :: Signedness -&gt; Signedness -&gt; Bool
$c&lt; :: Signedness -&gt; Signedness -&gt; Bool
compare :: Signedness -&gt; Signedness -&gt; Ordering
$ccompare :: Signedness -&gt; Signedness -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469688"><span id="local-6989586621684469690"><span id="local-6989586621684469692"><span class="annot"><span class="annottext">Int -&gt; Signedness -&gt; ShowS
[Signedness] -&gt; ShowS
Signedness -&gt; String
(Int -&gt; Signedness -&gt; ShowS)
-&gt; (Signedness -&gt; String)
-&gt; ([Signedness] -&gt; ShowS)
-&gt; Show Signedness
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Signedness] -&gt; ShowS
$cshowList :: [Signedness] -&gt; ShowS
show :: Signedness -&gt; String
$cshow :: Signedness -&gt; String
showsPrec :: Int -&gt; Signedness -&gt; ShowS
$cshowsPrec :: Int -&gt; Signedness -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | A description of an externally meaningful value.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="ValueDesc"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier hs-var">ValueDesc</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | An array with memory block memory space, element type,</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-comment">-- signedness of element type (if applicable), and shape.</span><span>
</span><span id="line-145"></span><span>    </span><span id="ArrayValue"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayValue"><span class="hs-identifier hs-var">ArrayValue</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Signedness"><span class="hs-identifier hs-type">Signedness</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DimSize"><span class="hs-identifier hs-type">DimSize</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A scalar value with signedness if applicable.</span><span>
</span><span id="line-147"></span><span>    </span><span id="ScalarValue"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarValue"><span class="hs-identifier hs-var">ScalarValue</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Signedness"><span class="hs-identifier hs-type">Signedness</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469669"><span id="local-6989586621684469684"><span class="annot"><span class="annottext">ValueDesc -&gt; ValueDesc -&gt; Bool
(ValueDesc -&gt; ValueDesc -&gt; Bool)
-&gt; (ValueDesc -&gt; ValueDesc -&gt; Bool) -&gt; Eq ValueDesc
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ValueDesc -&gt; ValueDesc -&gt; Bool
$c/= :: ValueDesc -&gt; ValueDesc -&gt; Bool
== :: ValueDesc -&gt; ValueDesc -&gt; Bool
$c== :: ValueDesc -&gt; ValueDesc -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469651"><span id="local-6989586621684469653"><span id="local-6989586621684469666"><span class="annot"><span class="annottext">Int -&gt; ValueDesc -&gt; ShowS
[ValueDesc] -&gt; ShowS
ValueDesc -&gt; String
(Int -&gt; ValueDesc -&gt; ShowS)
-&gt; (ValueDesc -&gt; String)
-&gt; ([ValueDesc] -&gt; ShowS)
-&gt; Show ValueDesc
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ValueDesc] -&gt; ShowS
$cshowList :: [ValueDesc] -&gt; ShowS
show :: ValueDesc -&gt; String
$cshow :: ValueDesc -&gt; String
showsPrec :: Int -&gt; ValueDesc -&gt; ShowS
$cshowsPrec :: Int -&gt; ValueDesc -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | ^ An externally visible value.  This can be an opaque value</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- (covering several physical internal values), or a single value that</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- can be used externally.  We record the uniqueness because it is</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- important to the external interface as well.</span><span>
</span><span id="line-154"></span><span class="hs-keyword">data</span><span> </span><span id="ExternalValue"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier hs-var">ExternalValue</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | The string is a human-readable description with no other</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- semantics.</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- not matter.</span><span>
</span><span id="line-158"></span><span>    </span><span id="OpaqueValue"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#OpaqueValue"><span class="hs-identifier hs-var">OpaqueValue</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Uniqueness"><span class="hs-identifier hs-type">Uniqueness</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier hs-type">ValueDesc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TransparentValue"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TransparentValue"><span class="hs-identifier hs-var">TransparentValue</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Uniqueness"><span class="hs-identifier hs-type">Uniqueness</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier hs-type">ValueDesc</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469632"><span id="local-6989586621684469634"><span id="local-6989586621684469646"><span class="annot"><span class="annottext">Int -&gt; ExternalValue -&gt; ShowS
[ExternalValue] -&gt; ShowS
ExternalValue -&gt; String
(Int -&gt; ExternalValue -&gt; ShowS)
-&gt; (ExternalValue -&gt; String)
-&gt; ([ExternalValue] -&gt; ShowS)
-&gt; Show ExternalValue
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExternalValue] -&gt; ShowS
$cshowList :: [ExternalValue] -&gt; ShowS
show :: ExternalValue -&gt; String
$cshow :: ExternalValue -&gt; String
showsPrec :: Int -&gt; ExternalValue -&gt; ShowS
$cshowsPrec :: Int -&gt; ExternalValue -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | A imperative function, containing the body as well as its</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- low-level inputs and outputs, as well as its high-level arguments</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- and results.  The latter are only used if the function is an entry</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- point.</span><span>
</span><span id="line-166"></span><span class="hs-keyword">data</span><span> </span><span id="FunctionT"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-var">FunctionT</span></a></span></span><span> </span><span id="local-6989586621684470263"><span class="annot"><a href="#local-6989586621684470263"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Function"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-var">Function</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="functionEntry"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; Maybe Name
</span><a href="Futhark.CodeGen.ImpCode.html#functionEntry"><span class="hs-identifier hs-var hs-var">functionEntry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>    </span><span id="functionOutput"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#functionOutput"><span class="hs-identifier hs-var hs-var">functionOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>    </span><span id="functionInput"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#functionInput"><span class="hs-identifier hs-var hs-var">functionInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span id="functionBody"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#functionBody"><span class="hs-identifier hs-var hs-var">functionBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470263"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span id="functionResult"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; [ExternalValue]
</span><a href="Futhark.CodeGen.ImpCode.html#functionResult"><span class="hs-identifier hs-var hs-var">functionResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier hs-type">ExternalValue</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>    </span><span id="functionArgs"><span class="annot"><span class="annottext">forall a. FunctionT a -&gt; [(Name, ExternalValue)]
</span><a href="Futhark.CodeGen.ImpCode.html#functionArgs"><span class="hs-identifier hs-var hs-var">functionArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier hs-type">ExternalValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469606"><span id="local-6989586621684469608"><span id="local-6989586621684469622"><span class="annot"><span class="annottext">Int -&gt; FunctionT a -&gt; ShowS
[FunctionT a] -&gt; ShowS
FunctionT a -&gt; String
(Int -&gt; FunctionT a -&gt; ShowS)
-&gt; (FunctionT a -&gt; String)
-&gt; ([FunctionT a] -&gt; ShowS)
-&gt; Show (FunctionT a)
forall a. Show a =&gt; Int -&gt; FunctionT a -&gt; ShowS
forall a. Show a =&gt; [FunctionT a] -&gt; ShowS
forall a. Show a =&gt; FunctionT a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FunctionT a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [FunctionT a] -&gt; ShowS
show :: FunctionT a -&gt; String
$cshow :: forall a. Show a =&gt; FunctionT a -&gt; String
showsPrec :: Int -&gt; FunctionT a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; FunctionT a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Type alias for namespace control.</span><span>
</span><span id="line-177"></span><span class="hs-keyword">type</span><span> </span><span id="Function"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-var">Function</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-type">FunctionT</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | The contents of a statically declared constant array.  Such</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- arrays are always unidimensional, and reshaped if necessary in the</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- code that uses them.</span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="ArrayContents"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayContents"><span class="hs-identifier hs-var">ArrayContents</span></a></span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Precisely these values.</span><span>
</span><span id="line-184"></span><span>    </span><span id="ArrayValues"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayValues"><span class="hs-identifier hs-var">ArrayValues</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimValue"><span class="hs-identifier hs-type">PrimValue</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | This many zeroes.</span><span>
</span><span id="line-186"></span><span>    </span><span id="ArrayZeros"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayZeros"><span class="hs-identifier hs-var">ArrayZeros</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469592"><span id="local-6989586621684469594"><span id="local-6989586621684469602"><span class="annot"><span class="annottext">Int -&gt; ArrayContents -&gt; ShowS
[ArrayContents] -&gt; ShowS
ArrayContents -&gt; String
(Int -&gt; ArrayContents -&gt; ShowS)
-&gt; (ArrayContents -&gt; String)
-&gt; ([ArrayContents] -&gt; ShowS)
-&gt; Show ArrayContents
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ArrayContents] -&gt; ShowS
$cshowList :: [ArrayContents] -&gt; ShowS
show :: ArrayContents -&gt; String
$cshow :: ArrayContents -&gt; String
showsPrec :: Int -&gt; ArrayContents -&gt; ShowS
$cshowsPrec :: Int -&gt; ArrayContents -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | A block of imperative code.  Parameterised by an 'Op', which</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- allows extensibility.  Concrete uses of this type will instantiate</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- the type parameter with e.g. a construct for launching GPU kernels.</span><span>
</span><span id="line-192"></span><span class="hs-keyword">data</span><span> </span><span id="Code"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-var">Code</span></a></span></span><span> </span><span id="local-6989586621684470249"><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | No-op.  Crucial for the 'Monoid' instance.</span><span>
</span><span id="line-194"></span><span>    </span><span id="Skip"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Statement composition.  Crucial for the 'Semigroup' instance.</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span id="%3A%3E%3E%3A"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-var">:&gt;&gt;:</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A for-loop iterating the given number of times.</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- The loop parameter starts counting from zero and will</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- have the same (integer) type as the bound.  The bound</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- is evaluated just once, before the loop is entered.</span><span>
</span><span id="line-201"></span><span>    </span><span id="For"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-var">For</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | While loop.  The conditional is (of course)</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- re-evaluated before every iteration of the loop.</span><span>
</span><span id="line-204"></span><span>    </span><span id="While"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-var">While</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Declare a memory block variable that will point to</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- memory in the given memory space.  Note that this is</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- distinct from allocation.  The memory block must be the</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- target of either an 'Allocate' or a 'SetMem' before it</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- can be used for reading or writing.</span><span>
</span><span id="line-210"></span><span>    </span><span id="DeclareMem"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-var">DeclareMem</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Declare a scalar variable with an initially undefined value.</span><span>
</span><span id="line-212"></span><span>    </span><span id="DeclareScalar"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-var">DeclareScalar</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatility"><span class="hs-identifier hs-type">Volatility</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Create an array containing the given values.  The</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-comment">-- lifetime of the array will be the entire application.</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-comment">-- This is mostly used for constant arrays, but also for</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- some bookkeeping data, like the synchronisation</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- counts used to implement reduction.</span><span>
</span><span id="line-218"></span><span>    </span><span id="DeclareArray"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-var">DeclareArray</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayContents"><span class="hs-identifier hs-type">ArrayContents</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Memory space must match the corresponding</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-comment">-- 'DeclareMem'.</span><span>
</span><span id="line-221"></span><span>    </span><span id="Allocate"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Allocate"><span class="hs-identifier hs-var">Allocate</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Indicate that some memory block will never again be</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-comment">-- referenced via the indicated variable.  However, it</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-comment">-- may still be accessed through aliases.  It is only</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-comment">-- safe to actually deallocate the memory block if this</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">-- is the last reference.  There is no guarantee that</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-comment">-- all memory blocks will be freed with this statement.</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- Backends are free to ignore it entirely.</span><span>
</span><span id="line-229"></span><span>    </span><span id="Free"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Free"><span class="hs-identifier hs-var">Free</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Destination, offset in destination, destination</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- space, source, offset in source, offset space, number</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- of bytes.</span><span>
</span><span id="line-233"></span><span>    </span><span id="Copy"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Copy"><span class="hs-identifier hs-var">Copy</span></a></span></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | @Write mem i t space vol v@ writes the value @v@ to</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-comment">-- @mem@ offset by @i@ elements of type @t@.  The</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-comment">-- 'Space' argument is the memory space of @mem@</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-comment">-- (technically redundant, but convenient).  Note that</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- /reading/ is done with an 'Exp' ('Read').</span><span>
</span><span id="line-246"></span><span>    </span><span id="Write"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Write"><span class="hs-identifier hs-var">Write</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatility"><span class="hs-identifier hs-type">Volatility</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Set a scalar variable.</span><span>
</span><span id="line-248"></span><span>    </span><span id="SetScalar"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetScalar"><span class="hs-identifier hs-var">SetScalar</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Read a scalar from memory from memory.  The first 'VName' is</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">-- the target scalar variable, and the remaining arguments have</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- the same meaning as with 'Write'.</span><span>
</span><span id="line-252"></span><span>    </span><span id="Read"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Read"><span class="hs-identifier hs-var">Read</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatility"><span class="hs-identifier hs-type">Volatility</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Must be in same space.</span><span>
</span><span id="line-254"></span><span>    </span><span id="SetMem"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-var">SetMem</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Function call.  The results are written to the</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">-- provided 'VName' variables.</span><span>
</span><span id="line-257"></span><span>    </span><span id="Call"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-var">Call</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Conditional execution.</span><span>
</span><span id="line-259"></span><span>    </span><span id="If"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-var">If</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Assert that something must be true.  Should it turn</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- out not to be true, then report a failure along with</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- the given error message.</span><span>
</span><span id="line-263"></span><span>    </span><span id="Assert"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SrcLoc</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SrcLoc</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Has the same semantics as the contained code, but</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-comment">-- the comment should show up in generated code for ease</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-comment">-- of inspection.</span><span>
</span><span id="line-267"></span><span>    </span><span id="Comment"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-var">Comment</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Print the given value to the screen, somehow</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- annotated with the given string as a description.  If</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- no type/value pair, just print the string.  This has</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- no semantic meaning, but is used entirely for</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- debugging.  Code generators are free to ignore this</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">-- statement.</span><span>
</span><span id="line-274"></span><span>    </span><span id="DebugPrint"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-var">DebugPrint</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Log the given message, *without* a trailing linebreak (unless</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- part of the mssage).</span><span>
</span><span id="line-277"></span><span>    </span><span id="TracePrint"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TracePrint"><span class="hs-identifier hs-var">TracePrint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Perform an extensible operation.</span><span>
</span><span id="line-279"></span><span>    </span><span id="Op"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621684470249"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469475"><span id="local-6989586621684469477"><span id="local-6989586621684469568"><span class="annot"><span class="annottext">Int -&gt; Code a -&gt; ShowS
[Code a] -&gt; ShowS
Code a -&gt; String
(Int -&gt; Code a -&gt; ShowS)
-&gt; (Code a -&gt; String) -&gt; ([Code a] -&gt; ShowS) -&gt; Show (Code a)
forall a. Show a =&gt; Int -&gt; Code a -&gt; ShowS
forall a. Show a =&gt; [Code a] -&gt; ShowS
forall a. Show a =&gt; Code a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Code a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Code a] -&gt; ShowS
show :: Code a -&gt; String
$cshow :: forall a. Show a =&gt; Code a -&gt; String
showsPrec :: Int -&gt; Code a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Code a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | The volatility of a memory access or variable.  Feel free to</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- ignore this for backends where it makes no sense (anything but C</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- and similar low-level things)</span><span>
</span><span id="line-285"></span><span class="hs-keyword">data</span><span> </span><span id="Volatility"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatility"><span class="hs-identifier hs-var">Volatility</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Volatile"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Volatile"><span class="hs-identifier hs-var">Volatile</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Nonvolatile"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Nonvolatile"><span class="hs-identifier hs-var">Nonvolatile</span></a></span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469468"><span id="local-6989586621684469470"><span class="annot"><span class="annottext">Volatility -&gt; Volatility -&gt; Bool
(Volatility -&gt; Volatility -&gt; Bool)
-&gt; (Volatility -&gt; Volatility -&gt; Bool) -&gt; Eq Volatility
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Volatility -&gt; Volatility -&gt; Bool
$c/= :: Volatility -&gt; Volatility -&gt; Bool
== :: Volatility -&gt; Volatility -&gt; Bool
$c== :: Volatility -&gt; Volatility -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469449"><span id="local-6989586621684469451"><span id="local-6989586621684469454"><span id="local-6989586621684469457"><span id="local-6989586621684469460"><span id="local-6989586621684469462"><span id="local-6989586621684469464"><span class="annot"><span class="annottext">Eq Volatility
Eq Volatility
-&gt; (Volatility -&gt; Volatility -&gt; Ordering)
-&gt; (Volatility -&gt; Volatility -&gt; Bool)
-&gt; (Volatility -&gt; Volatility -&gt; Bool)
-&gt; (Volatility -&gt; Volatility -&gt; Bool)
-&gt; (Volatility -&gt; Volatility -&gt; Bool)
-&gt; (Volatility -&gt; Volatility -&gt; Volatility)
-&gt; (Volatility -&gt; Volatility -&gt; Volatility)
-&gt; Ord Volatility
Volatility -&gt; Volatility -&gt; Bool
Volatility -&gt; Volatility -&gt; Ordering
Volatility -&gt; Volatility -&gt; Volatility
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Volatility -&gt; Volatility -&gt; Volatility
$cmin :: Volatility -&gt; Volatility -&gt; Volatility
max :: Volatility -&gt; Volatility -&gt; Volatility
$cmax :: Volatility -&gt; Volatility -&gt; Volatility
&gt;= :: Volatility -&gt; Volatility -&gt; Bool
$c&gt;= :: Volatility -&gt; Volatility -&gt; Bool
&gt; :: Volatility -&gt; Volatility -&gt; Bool
$c&gt; :: Volatility -&gt; Volatility -&gt; Bool
&lt;= :: Volatility -&gt; Volatility -&gt; Bool
$c&lt;= :: Volatility -&gt; Volatility -&gt; Bool
&lt; :: Volatility -&gt; Volatility -&gt; Bool
$c&lt; :: Volatility -&gt; Volatility -&gt; Bool
compare :: Volatility -&gt; Volatility -&gt; Ordering
$ccompare :: Volatility -&gt; Volatility -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469443"><span id="local-6989586621684469445"><span id="local-6989586621684469447"><span class="annot"><span class="annottext">Int -&gt; Volatility -&gt; ShowS
[Volatility] -&gt; ShowS
Volatility -&gt; String
(Int -&gt; Volatility -&gt; ShowS)
-&gt; (Volatility -&gt; String)
-&gt; ([Volatility] -&gt; ShowS)
-&gt; Show Volatility
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Volatility] -&gt; ShowS
$cshowList :: [Volatility] -&gt; ShowS
show :: Volatility -&gt; String
$cshow :: Volatility -&gt; String
showsPrec :: Int -&gt; Volatility -&gt; ShowS
$cshowsPrec :: Int -&gt; Volatility -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span id="local-6989586621684470219"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469438"><span id="local-6989586621684469440"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470219"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><span class="annottext">Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span id="local-6989586621684469437"><span class="annot"><span class="annottext">&lt;&gt; :: Code a -&gt; Code a -&gt; Code a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621684469436"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469436"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469436"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621684469435"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469435"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469435"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621684469434"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469434"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621684469433"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469433"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469434"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Code a -&gt; Code a
forall a. Code a -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-var">:&gt;&gt;:</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469433"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621684470218"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469426"><span id="local-6989586621684469428"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470218"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621684469425"><span class="annot"><span class="annottext">mempty :: Code a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a
forall a. Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Find those memory blocks that are used only lexically.  That is,</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- are not used as the source or target of a 'SetMem', or are the</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- result of the function, nor passed as arguments to other functions.</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- This is interesting because such memory blocks do not need</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- reference counting, but can be managed in a purely stack-like</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- fashion.</span><span>
</span><span id="line-302"></span><span class="hs-comment">--</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- We do not look inside any 'Op's.  We assume that no 'Op' is going</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- to 'SetMem' a memory block declared outside it.</span><span>
</span><span id="line-305"></span><span id="local-6989586621684470217"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#lexicalMemoryUsage"><span class="hs-identifier hs-type">lexicalMemoryUsage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span></span><span>
</span><span id="line-306"></span><span id="lexicalMemoryUsage"><span class="annot"><span class="annottext">lexicalMemoryUsage :: forall a. Function a -&gt; Map VName Space
</span><a href="Futhark.CodeGen.ImpCode.html#lexicalMemoryUsage"><span class="hs-identifier hs-var hs-var">lexicalMemoryUsage</span></a></span></span><span> </span><span id="local-6989586621684469424"><span class="annot"><span class="annottext">Function a
</span><a href="#local-6989586621684469424"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">(VName -&gt; Space -&gt; Bool) -&gt; Map VName Space -&gt; Map VName Space
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Space -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Space -&gt; Bool)
-&gt; (VName -&gt; Bool) -&gt; VName -&gt; Space -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (VName -&gt; Bool) -&gt; VName -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Names -&gt; Bool
</span><a href="Futhark.IR.Prop.Names.html#nameIn"><span class="hs-operator hs-var">`nameIn`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684469418"><span class="hs-identifier hs-var">nonlexical</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map VName Space -&gt; Map VName Space)
-&gt; Map VName Space -&gt; Map VName Space
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">Code a -&gt; Map VName Space
forall {a}. Code a -&gt; Map VName Space
</span><a href="#local-6989586621684469417"><span class="hs-identifier hs-var">declared</span></a></span><span> </span><span class="annot"><span class="annottext">(Code a -&gt; Map VName Space) -&gt; Code a -&gt; Map VName Space
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Function a -&gt; Code a
forall a. FunctionT a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#functionBody"><span class="hs-identifier hs-var hs-var">functionBody</span></a></span><span> </span><span class="annot"><span class="annottext">Function a
</span><a href="#local-6989586621684469424"><span class="hs-identifier hs-var">func</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621684469418"><span class="annot"><span class="annottext">nonlexical :: Names
</span><a href="#local-6989586621684469418"><span class="hs-identifier hs-var hs-var">nonlexical</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="#local-6989586621684469414"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Function a -&gt; Code a
forall a. FunctionT a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#functionBody"><span class="hs-identifier hs-var hs-var">functionBody</span></a></span><span> </span><span class="annot"><span class="annottext">Function a
</span><a href="#local-6989586621684469424"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Param -&gt; VName) -&gt; [Param] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Param -&gt; VName
</span><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier hs-var">paramName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Function a -&gt; [Param]
forall a. FunctionT a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#functionOutput"><span class="hs-identifier hs-var hs-var">functionOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Function a
</span><a href="#local-6989586621684469424"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621684469406"><span class="annot"><span class="annottext">go :: (Code a -&gt; a) -&gt; Code a -&gt; a
</span><a href="#local-6989586621684469406"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621684469405"><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469405"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469404"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469404"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684469403"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469403"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469404"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469405"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469403"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621684469402"><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469402"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469401"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469401"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684469400"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469400"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469401"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469400"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621684469399"><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469399"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469398"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469398"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469399"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469398"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621684469397"><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469397"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469396"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469396"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469397"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469396"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621684469395"><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469395"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469394"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469394"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><a href="#local-6989586621684469395"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469394"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Code a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621684469417"><span class="annot"><span class="annottext">declared :: Code a -&gt; Map VName Space
</span><a href="#local-6989586621684469417"><span class="hs-identifier hs-var hs-var">declared</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-type">DeclareMem</span></a></span><span> </span><span id="local-6989586621684469389"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469389"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621684469388"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469388"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="annottext">VName -&gt; Space -&gt; Map VName Space
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469389"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469388"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="#local-6989586621684469417"><span class="hs-identifier hs-var">declared</span></a></span><span> </span><span id="local-6989586621684469386"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469386"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Code a -&gt; Map VName Space) -&gt; Code a -&gt; Map VName Space
forall {a} {a}. Monoid a =&gt; (Code a -&gt; a) -&gt; Code a -&gt; a
</span><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Map VName Space
</span><a href="#local-6989586621684469417"><span class="hs-identifier hs-var">declared</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469386"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621684469414"><span class="annot"><span class="annottext">set :: Code a -&gt; Names
</span><a href="#local-6989586621684469414"><span class="hs-identifier hs-var hs-var">set</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-type">SetMem</span></a></span><span> </span><span id="local-6989586621684469379"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469379"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684469378"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469378"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469379"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469378"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><a href="#local-6989586621684469414"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621684469377"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684469377"><span class="hs-identifier hs-var">dests</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469376"><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684469376"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-comment">-- Some of the dests might not be memory, but it does not matter.</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684469377"><span class="hs-identifier hs-var">dests</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Arg -&gt; Names) -&gt; [Arg] -&gt; Names
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Arg -&gt; Names
</span><a href="#local-6989586621684469374"><span class="hs-identifier hs-var">onArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684469376"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621684469374"><span class="annot"><span class="annottext">onArg :: Arg -&gt; Names
</span><a href="#local-6989586621684469374"><span class="hs-identifier hs-var hs-var">onArg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExpArg"><span class="hs-identifier hs-type">ExpArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><a href="#local-6989586621684469374"><span class="hs-identifier hs-var">onArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemArg"><span class="hs-identifier hs-type">MemArg</span></a></span><span> </span><span id="local-6989586621684469370"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469370"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469370"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621684469414"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span id="local-6989586621684469368"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469368"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Code a -&gt; Names) -&gt; Code a -&gt; Names
forall {a} {a}. Monoid a =&gt; (Code a -&gt; a) -&gt; Code a -&gt; a
</span><a href="#local-6989586621684469406"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
</span><a href="#local-6989586621684469414"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469368"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- | The set of functions that are called by this code.  Assumes there</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- are no function calls in 'Op's.</span><span>
</span><span id="line-336"></span><span id="local-6989586621684470193"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-type">calledFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470193"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span><span>
</span><span id="line-337"></span><span id="calledFuncs"><span class="annot"><span class="annottext">calledFuncs :: forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var hs-var">calledFuncs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469360"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469360"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684469359"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469359"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469360"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469359"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-338"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469358"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469358"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684469357"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469357"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469358"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469357"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469356"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469356"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469356"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469355"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469355"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469355"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469354"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469354"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Set Name
forall a. Code a -&gt; Set Name
</span><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684469354"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469353"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684469353"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Arg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684469353"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#calledFuncs"><span class="hs-identifier hs-var">calledFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Name
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | A side-effect free expression whose execution will produce a</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- single primitive value.</span><span>
</span><span id="line-347"></span><span class="hs-keyword">type</span><span> </span><span id="Exp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-var">Exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-comment">-- | Like 'Exp', but with a required/known type.</span><span>
</span><span id="line-350"></span><span class="hs-keyword">type</span><span> </span><span id="TExp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-var">TExp</span></a></span></span><span> </span><span id="local-6989586621684469351"><span class="annot"><a href="#local-6989586621684469351"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684469351"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | A function call argument.</span><span>
</span><span id="line-353"></span><span class="hs-keyword">data</span><span> </span><span id="Arg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ExpArg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExpArg"><span class="hs-identifier hs-var">ExpArg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MemArg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemArg"><span class="hs-identifier hs-var">MemArg</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469340"><span id="local-6989586621684469342"><span id="local-6989586621684469349"><span class="annot"><span class="annottext">Int -&gt; Arg -&gt; ShowS
[Arg] -&gt; ShowS
Arg -&gt; String
(Int -&gt; Arg -&gt; ShowS)
-&gt; (Arg -&gt; String) -&gt; ([Arg] -&gt; ShowS) -&gt; Show Arg
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Arg] -&gt; ShowS
$cshowList :: [Arg] -&gt; ShowS
show :: Arg -&gt; String
$cshow :: Arg -&gt; String
showsPrec :: Int -&gt; Arg -&gt; ShowS
$cshowsPrec :: Int -&gt; Arg -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | Phantom type for a count of elements.</span><span>
</span><span id="line-359"></span><span class="hs-keyword">data</span><span> </span><span id="Elements"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-var">Elements</span></a></span></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | Phantom type for a count of bytes.</span><span>
</span><span id="line-362"></span><span class="hs-keyword">data</span><span> </span><span id="Bytes"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-var">Bytes</span></a></span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | This expression counts elements.</span><span>
</span><span id="line-365"></span><span id="local-6989586621684470187"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#elements"><span class="hs-identifier hs-type">elements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684470187"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470187"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-366"></span><span id="elements"><span class="annot"><span class="annottext">elements :: forall a. a -&gt; Count Elements a
</span><a href="Futhark.CodeGen.ImpCode.html#elements"><span class="hs-identifier hs-var hs-var">elements</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Count Elements a
forall u e. e -&gt; Count u e
</span><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-var">Count</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | This expression counts bytes.</span><span>
</span><span id="line-369"></span><span id="local-6989586621684470185"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#bytes"><span class="hs-identifier hs-type">bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684470185"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470185"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-370"></span><span id="bytes"><span class="annot"><span class="annottext">bytes :: forall a. a -&gt; Count Bytes a
</span><a href="Futhark.CodeGen.ImpCode.html#bytes"><span class="hs-identifier hs-var hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Count Bytes a
forall u e. e -&gt; Count u e
</span><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-var">Count</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | Convert a count of elements into a count of bytes, given the</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- per-element size.</span><span>
</span><span id="line-374"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#withElemType"><span class="hs-identifier hs-type">withElemType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span id="withElemType"><span class="annot"><span class="annottext">withElemType :: Count Elements (TPrimExp Int64 VName)
-&gt; PrimType -&gt; Count Bytes (TPrimExp Int64 VName)
</span><a href="Futhark.CodeGen.ImpCode.html#withElemType"><span class="hs-identifier hs-var hs-var">withElemType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span id="local-6989586621684469338"><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684469338"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684469337"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469337"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName -&gt; Count Bytes (TPrimExp Int64 VName)
forall a. a -&gt; Count Bytes a
</span><a href="Futhark.CodeGen.ImpCode.html#bytes"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">(TPrimExp Int64 VName -&gt; Count Bytes (TPrimExp Int64 VName))
-&gt; TPrimExp Int64 VName -&gt; Count Bytes (TPrimExp Int64 VName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName -&gt; TPrimExp Int64 VName
forall t v. IntExp t =&gt; TPrimExp t v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#sExt64"><span class="hs-identifier hs-var">sExt64</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684469338"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
-&gt; TPrimExp Int64 VName -&gt; TPrimExp Int64 VName
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; TPrimExp Int64 VName
forall a. Num a =&gt; PrimType -&gt; a
</span><a href="Futhark.IR.Primitive.html#primByteSize"><span class="hs-identifier hs-var">primByteSize</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469337"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Turn a 'VName' into a 'Exp'.</span><span>
</span><span id="line-378"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#var"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-379"></span><span id="var"><span class="annot"><span class="annottext">var :: VName -&gt; PrimType -&gt; Exp
</span><a href="Futhark.CodeGen.ImpCode.html#var"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; PrimType -&gt; Exp
forall v. v -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- Prettyprinting definitions.</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621684470177"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469328"><span id="local-6989586621684469330"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470177"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470177"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621684469324"><span class="annot"><span class="annottext">ppr :: Definitions op -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span id="local-6989586621684469322"><span class="annot"><span class="annottext">Constants op
</span><a href="#local-6989586621684469322"><span class="hs-identifier hs-var">consts</span></a></span></span><span> </span><span id="local-6989586621684469321"><span class="annot"><span class="annottext">Functions op
</span><a href="#local-6989586621684469321"><span class="hs-identifier hs-var">funs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">Constants op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Constants op
</span><a href="#local-6989586621684469322"><span class="hs-identifier hs-var">consts</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Functions op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Functions op
</span><a href="#local-6989586621684469321"><span class="hs-identifier hs-var">funs</span></a></span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621684470176"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469315"><span id="local-6989586621684469317"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470176"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470176"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621684469309"><span class="annot"><span class="annottext">ppr :: Functions op -&gt; Doc
</span><a href="#local-6989586621684469309"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span id="local-6989586621684469308"><span class="annot"><span class="annottext">[(Name, Function op)]
</span><a href="#local-6989586621684469308"><span class="hs-identifier hs-var">funs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; [Doc] -&gt; [Doc]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">intersperse</span></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; [Doc]) -&gt; [Doc] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, Function op) -&gt; Doc) -&gt; [(Name, Function op)] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Name, Function op) -&gt; Doc
forall {a} {a}. (Pretty a, Pretty a) =&gt; (a, a) -&gt; Doc
</span><a href="#local-6989586621684469306"><span class="hs-identifier hs-var">ppFun</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Function op)]
</span><a href="#local-6989586621684469308"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>      </span><span id="local-6989586621684469306"><span class="annot"><span class="annottext">ppFun :: (a, a) -&gt; Doc
</span><a href="#local-6989586621684469306"><span class="hs-identifier hs-var hs-var">ppFun</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469298"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469298"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684469297"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469297"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Function &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469298"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469297"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621684470175"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469289"><span id="local-6989586621684469291"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470175"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-type">Constants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470175"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621684469285"><span class="annot"><span class="annottext">ppr :: Constants op -&gt; Doc
</span><a href="#local-6989586621684469285"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Constants"><span class="hs-identifier hs-type">Constants</span></a></span><span> </span><span id="local-6989586621684469284"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469284"><span class="hs-identifier hs-var">decls</span></a></span></span><span> </span><span id="local-6989586621684469283"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469283"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Constants:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Param -&gt; Doc) -&gt; [Param] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Param -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469284"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Initialisation:&quot;</span></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469283"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span id="local-6989586621684470174"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469278"><span id="local-6989586621684469280"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470174"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-type">FunctionT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470174"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621684469269"><span class="annot"><span class="annottext">ppr :: FunctionT op -&gt; Doc
</span><a href="#local-6989586621684469269"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684469268"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469268"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span id="local-6989586621684469267"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469267"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621684469266"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469266"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621684469265"><span class="annot"><span class="annottext">[ExternalValue]
</span><a href="#local-6989586621684469265"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span id="local-6989586621684469264"><span class="annot"><span class="annottext">[(Name, ExternalValue)]
</span><a href="#local-6989586621684469264"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Inputs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Doc
forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="#local-6989586621684469263"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469267"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Outputs:&quot;</span></span><span>
</span><span id="line-404"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Doc
forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="#local-6989586621684469263"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684469268"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Arguments:&quot;</span></span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, ExternalValue)] -&gt; Doc
forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="#local-6989586621684469263"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, ExternalValue)]
</span><a href="#local-6989586621684469264"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Result:&quot;</span></span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ExternalValue] -&gt; Doc
forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="#local-6989586621684469263"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">[ExternalValue]
</span><a href="#local-6989586621684469265"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body:&quot;</span></span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469266"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>      </span><span id="local-6989586621684470167"><span class="annot"><a href="#local-6989586621684469263"><span class="hs-identifier hs-type">block</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470167"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621684470167"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span></span><span>
</span><span id="line-413"></span><span>      </span><span id="local-6989586621684469263"><span class="annot"><span class="annottext">block :: forall a. Pretty a =&gt; [a] -&gt; Doc
</span><a href="#local-6989586621684469263"><span class="hs-identifier hs-var hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; ([a] -&gt; Doc) -&gt; [a] -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; ([a] -&gt; [Doc]) -&gt; [a] -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Doc) -&gt; [a] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469256"><span id="local-6989586621684469258"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621684469246"><span class="annot"><span class="annottext">ppr :: Param -&gt; Doc
</span><a href="#local-6989586621684469246"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarParam"><span class="hs-identifier hs-type">ScalarParam</span></a></span><span> </span><span id="local-6989586621684469245"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469245"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469244"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469244"><span class="hs-identifier hs-var">ptype</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469244"><span class="hs-identifier hs-var">ptype</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469245"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemParam"><span class="hs-identifier hs-type">MemParam</span></a></span><span> </span><span id="local-6989586621684469242"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469242"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469241"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469241"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469241"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469242"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469236"><span id="local-6989586621684469238"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier hs-type">ValueDesc</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621684469225"><span class="annot"><span class="annottext">ppr :: ValueDesc -&gt; Doc
</span><a href="#local-6989586621684469225"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarValue"><span class="hs-identifier hs-type">ScalarValue</span></a></span><span> </span><span id="local-6989586621684469224"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469224"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684469223"><span class="annot"><span class="annottext">Signedness
</span><a href="#local-6989586621684469223"><span class="hs-identifier hs-var">ept</span></a></span></span><span> </span><span id="local-6989586621684469222"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469222"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469224"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469222"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469221"><span class="hs-identifier hs-var">ept'</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621684469221"><span class="annot"><span class="annottext">ept' :: Doc
</span><a href="#local-6989586621684469221"><span class="hs-identifier hs-var hs-var">ept'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="#local-6989586621684469223"><span class="hs-identifier hs-var">ept</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-424"></span><span>        </span><span class="annot"><span class="annottext">Signedness
</span><a href="Futhark.CodeGen.ImpCode.html#TypeUnsigned"><span class="hs-identifier hs-var">TypeUnsigned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (unsigned)&quot;</span></span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><span class="annottext">Signedness
</span><a href="Futhark.CodeGen.ImpCode.html#TypeDirect"><span class="hs-identifier hs-var">TypeDirect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayValue"><span class="hs-identifier hs-type">ArrayValue</span></a></span><span> </span><span id="local-6989586621684469219"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469219"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621684469218"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469218"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684469217"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469217"><span class="hs-identifier hs-var">et</span></a></span></span><span> </span><span id="local-6989586621684469216"><span class="annot"><span class="annottext">Signedness
</span><a href="#local-6989586621684469216"><span class="hs-identifier hs-var">ept</span></a></span></span><span> </span><span id="local-6989586621684469215"><span class="annot"><span class="annottext">[DimSize]
</span><a href="#local-6989586621684469215"><span class="hs-identifier hs-var">shape</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">(DimSize -&gt; Doc -&gt; Doc) -&gt; Doc -&gt; [DimSize] -&gt; Doc
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">DimSize -&gt; Doc -&gt; Doc
forall {a}. Pretty a =&gt; a -&gt; Doc -&gt; Doc
</span><a href="#local-6989586621684469213"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469217"><span class="hs-identifier hs-var">et</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DimSize]
</span><a href="#local-6989586621684469215"><span class="hs-identifier hs-var">shape</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;at&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469219"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469218"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469212"><span class="hs-identifier hs-var">ept'</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621684469213"><span class="annot"><span class="annottext">f :: a -&gt; Doc -&gt; Doc
</span><a href="#local-6989586621684469213"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621684469207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469207"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621684469206"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469206"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469206"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">comma</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469207"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621684469212"><span class="annot"><span class="annottext">ept' :: Doc
</span><a href="#local-6989586621684469212"><span class="hs-identifier hs-var hs-var">ept'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Signedness
</span><a href="#local-6989586621684469216"><span class="hs-identifier hs-var">ept</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="annottext">Signedness
</span><a href="Futhark.CodeGen.ImpCode.html#TypeUnsigned"><span class="hs-identifier hs-var">TypeUnsigned</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; (unsigned)&quot;</span></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">Signedness
</span><a href="Futhark.CodeGen.ImpCode.html#TypeDirect"><span class="hs-identifier hs-var">TypeDirect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469198"><span id="local-6989586621684469200"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier hs-type">ExternalValue</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621684469190"><span class="annot"><span class="annottext">ppr :: ExternalValue -&gt; Doc
</span><a href="#local-6989586621684469190"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TransparentValue"><span class="hs-identifier hs-type">TransparentValue</span></a></span><span> </span><span id="local-6989586621684469189"><span class="annot"><span class="annottext">Uniqueness
</span><a href="#local-6989586621684469189"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621684469188"><span class="annot"><span class="annottext">ValueDesc
</span><a href="#local-6989586621684469188"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Uniqueness -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><a href="#local-6989586621684469189"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ValueDesc -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">ValueDesc
</span><a href="#local-6989586621684469188"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#OpaqueValue"><span class="hs-identifier hs-type">OpaqueValue</span></a></span><span> </span><span id="local-6989586621684469187"><span class="annot"><span class="annottext">Uniqueness
</span><a href="#local-6989586621684469187"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621684469186"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684469186"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span id="local-6989586621684469185"><span class="annot"><span class="annottext">[ValueDesc]
</span><a href="#local-6989586621684469185"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="annottext">Uniqueness -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><a href="#local-6989586621684469187"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;opaque&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684469186"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#nestedBlock"><span class="hs-identifier hs-var">nestedBlock</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ValueDesc -&gt; Doc) -&gt; [ValueDesc] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ValueDesc -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[ValueDesc]
</span><a href="#local-6989586621684469185"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469179"><span id="local-6989586621684469181"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayContents"><span class="hs-identifier hs-type">ArrayContents</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621684469174"><span class="annot"><span class="annottext">ppr :: ArrayContents -&gt; Doc
</span><a href="#local-6989586621684469174"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayValues"><span class="hs-identifier hs-type">ArrayValues</span></a></span><span> </span><span id="local-6989586621684469173"><span class="annot"><span class="annottext">[PrimValue]
</span><a href="#local-6989586621684469173"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; Doc) -&gt; [PrimValue] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[PrimValue]
</span><a href="#local-6989586621684469173"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayZeros"><span class="hs-identifier hs-type">ArrayZeros</span></a></span><span> </span><span id="local-6989586621684469170"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684469170"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">braces</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684469170"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span id="local-6989586621684470170"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684469165"><span id="local-6989586621684469167"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684470170"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470170"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621684469072"><span class="annot"><span class="annottext">ppr :: Code op -&gt; Doc
</span><a href="#local-6989586621684469072"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684469071"><span class="annot"><span class="annottext">op
</span><a href="#local-6989586621684469071"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">op
</span><a href="#local-6989586621684469071"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skip&quot;</span></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684469070"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469070"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684469069"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469069"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469070"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469069"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span id="local-6989586621684469068"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469068"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684469067"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469067"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621684469066"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469066"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;for&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469068"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">langle</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469067"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469066"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span id="local-6989586621684469064"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684469064"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684469063"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469063"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;while&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TExp Bool -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684469064"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469063"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-type">DeclareMem</span></a></span><span> </span><span id="local-6989586621684469062"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469062"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469061"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469061"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;var&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469062"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: mem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469061"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-type">DeclareScalar</span></a></span><span> </span><span id="local-6989586621684469060"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469060"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469059"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469059"><span class="hs-identifier hs-var">vol</span></a></span></span><span> </span><span id="local-6989586621684469058"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469058"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;var&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469060"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469057"><span class="hs-identifier hs-var">vol'</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469058"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>      </span><span id="local-6989586621684469057"><span class="annot"><span class="annottext">vol' :: Doc
</span><a href="#local-6989586621684469057"><span class="hs-identifier hs-var hs-var">vol'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469059"><span class="hs-identifier hs-var">vol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-462"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Volatile"><span class="hs-identifier hs-var">Volatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;volatile &quot;</span></span><span>
</span><span id="line-463"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Nonvolatile"><span class="hs-identifier hs-var">Nonvolatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-type">DeclareArray</span></a></span><span> </span><span id="local-6989586621684469055"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469055"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469054"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469054"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684469053"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469053"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684469052"><span class="annot"><span class="annottext">ArrayContents
</span><a href="#local-6989586621684469052"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;array&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469055"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469054"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469053"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">equals</span></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ArrayContents -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">ArrayContents
</span><a href="#local-6989586621684469052"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Allocate"><span class="hs-identifier hs-type">Allocate</span></a></span><span> </span><span id="local-6989586621684469050"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469050"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469049"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469049"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621684469048"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469048"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469050"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;malloc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469049"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469048"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span id="local-6989586621684469046"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469046"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469045"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469045"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;free&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469046"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469045"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Write"><span class="hs-identifier hs-type">Write</span></a></span><span> </span><span id="local-6989586621684469044"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469044"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469043"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469043"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684469042"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469042"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621684469041"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469041"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684469040"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469040"><span class="hs-identifier hs-var">vol</span></a></span></span><span> </span><span id="local-6989586621684469039"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469039"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469044"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">langle</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469038"><span class="hs-identifier hs-var">vol'</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469042"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469041"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">rangle</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469043"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469039"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>      </span><span id="local-6989586621684469038"><span class="annot"><span class="annottext">vol' :: Doc
</span><a href="#local-6989586621684469038"><span class="hs-identifier hs-var hs-var">vol'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469040"><span class="hs-identifier hs-var">vol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-478"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Volatile"><span class="hs-identifier hs-var">Volatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;volatile &quot;</span></span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Nonvolatile"><span class="hs-identifier hs-var">Nonvolatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span id="local-6989586621684469035"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469035"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469034"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469034"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684469033"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469033"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621684469032"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469032"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621684469031"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469031"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684469030"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469030"><span class="hs-identifier hs-var">vol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469035"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469034"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">langle</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684469029"><span class="hs-identifier hs-var">vol'</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684469032"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469031"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">rangle</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469033"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>      </span><span id="local-6989586621684469029"><span class="annot"><span class="annottext">vol' :: Doc
</span><a href="#local-6989586621684469029"><span class="hs-identifier hs-var hs-var">vol'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684469030"><span class="hs-identifier hs-var">vol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Volatile"><span class="hs-identifier hs-var">Volatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;volatile &quot;</span></span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><span class="annottext">Volatility
</span><a href="Futhark.CodeGen.ImpCode.html#Nonvolatile"><span class="hs-identifier hs-var">Nonvolatile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetScalar"><span class="hs-identifier hs-type">SetScalar</span></a></span><span> </span><span id="local-6989586621684469027"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469027"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684469026"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469026"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469027"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469026"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-type">SetMem</span></a></span><span> </span><span id="local-6989586621684469025"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469025"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684469024"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469024"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621684469023"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469023"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469025"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469024"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469023"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621684469022"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469022"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621684469021"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684469021"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="annottext">(SrcLoc, [SrcLoc])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;assert&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ErrorMsg Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684469021"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684469022"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Copy"><span class="hs-identifier hs-type">Copy</span></a></span><span> </span><span id="local-6989586621684469020"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469020"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684469019"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469019"><span class="hs-identifier hs-var">destoffset</span></a></span></span><span> </span><span id="local-6989586621684469018"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469018"><span class="hs-identifier hs-var">destspace</span></a></span></span><span> </span><span id="local-6989586621684469017"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469017"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621684469016"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469016"><span class="hs-identifier hs-var">srcoffset</span></a></span></span><span> </span><span id="local-6989586621684469015"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469015"><span class="hs-identifier hs-var">srcspace</span></a></span></span><span> </span><span id="local-6989586621684469014"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469014"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;memcpy&quot;</span></span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Count Bytes (TPrimExp Int64 VName) -&gt; Doc
forall {a} {a}. (Pretty a, Pretty a) =&gt; a -&gt; a -&gt; Doc
</span><a href="#local-6989586621684469013"><span class="hs-identifier hs-var">ppMemLoc</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469020"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469019"><span class="hs-identifier hs-var">destoffset</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469018"><span class="hs-identifier hs-var">destspace</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">comma</span></span><span>
</span><span id="line-497"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Count Bytes (TPrimExp Int64 VName) -&gt; Doc
forall {a} {a}. (Pretty a, Pretty a) =&gt; a -&gt; a -&gt; Doc
</span><a href="#local-6989586621684469013"><span class="hs-identifier hs-var">ppMemLoc</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684469017"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469016"><span class="hs-identifier hs-var">srcoffset</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684469015"><span class="hs-identifier hs-var">srcspace</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">comma</span></span><span>
</span><span id="line-498"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684469014"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-499"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621684469013"><span class="annot"><span class="annottext">ppMemLoc :: a -&gt; a -&gt; Doc
</span><a href="#local-6989586621684469013"><span class="hs-identifier hs-var hs-var">ppMemLoc</span></a></span></span><span> </span><span id="local-6989586621684469008"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469008"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span id="local-6989586621684469007"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469007"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469008"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684469007"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span id="local-6989586621684469006"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684469006"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684469005"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469005"><span class="hs-identifier hs-var">tbranch</span></a></span></span><span> </span><span id="local-6989586621684469004"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469004"><span class="hs-identifier hs-var">fbranch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TExp Bool -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684469006"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;then {&quot;</span></span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469005"><span class="hs-identifier hs-var">tbranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;} else {&quot;</span></span><span>
</span><span id="line-507"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684469004"><span class="hs-identifier hs-var">fbranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621684469003"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684469003"><span class="hs-identifier hs-var">dests</span></a></span></span><span> </span><span id="local-6989586621684469002"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684469002"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621684469001"><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684469001"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VName -&gt; Doc) -&gt; [VName] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684469003"><span class="hs-identifier hs-var">dests</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-511"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684469002"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Arg -&gt; Doc) -&gt; [Arg] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Arg -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684469001"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span id="local-6989586621684469000"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684469000"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684468999"><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684468999"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684469000"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code op -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code op
</span><a href="#local-6989586621684468999"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-type">DebugPrint</span></a></span><span> </span><span id="local-6989586621684468998"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468998"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684468997"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468997"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;debug&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468998"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468997"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-type">DebugPrint</span></a></span><span> </span><span id="local-6989586621684468995"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468995"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;debug&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShowS
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468995"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TracePrint"><span class="hs-identifier hs-type">TracePrint</span></a></span><span> </span><span id="local-6989586621684468994"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468994"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;trace&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorMsg Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468994"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468989"><span id="local-6989586621684468991"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-522"></span><span>  </span><span id="local-6989586621684468986"><span class="annot"><span class="annottext">ppr :: Arg -&gt; Doc
</span><a href="#local-6989586621684468986"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemArg"><span class="hs-identifier hs-type">MemArg</span></a></span><span> </span><span id="local-6989586621684468985"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468985"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468985"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExpArg"><span class="hs-identifier hs-type">ExpArg</span></a></span><span> </span><span id="local-6989586621684468984"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468984"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468984"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468981"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621684468979"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Functions a -&gt; Functions b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Functions a -&gt; Functions b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468945"><span id="local-6989586621684468947"><span id="local-6989586621684468949"><span id="local-6989586621684468951"><span id="local-6989586621684468953"><span id="local-6989586621684468955"><span id="local-6989586621684468957"><span id="local-6989586621684468959"><span id="local-6989586621684468961"><span id="local-6989586621684468963"><span id="local-6989586621684468965"><span id="local-6989586621684468967"><span id="local-6989586621684468969"><span id="local-6989586621684468971"><span id="local-6989586621684468973"><span id="local-6989586621684468976"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621684468940"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Functions a -&gt; m
</span><a href="#local-6989586621684468940"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Functions a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468928"><span id="local-6989586621684468930"><span id="local-6989586621684468932"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621684468918"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Functions a -&gt; f (Functions b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span id="local-6989586621684468916"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468916"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span id="local-6989586621684468915"><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684468915"><span class="hs-identifier hs-var">funs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">[(Name, Function b)] -&gt; Functions b
forall a. [(Name, Function a)] -&gt; Functions a
</span><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-var">Functions</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, Function b)] -&gt; Functions b)
-&gt; f [(Name, Function b)] -&gt; f (Functions b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Name, Function a) -&gt; f (Name, Function b))
-&gt; [(Name, Function a)] -&gt; f [(Name, Function b)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">(Name, Function a) -&gt; f (Name, Function b)
forall {t :: * -&gt; *} {t}. Traversable t =&gt; (t, t a) -&gt; f (t, t b)
</span><a href="#local-6989586621684468913"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684468915"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-535"></span><span>      </span><span id="local-6989586621684468913"><span class="annot"><span class="annottext">f' :: (t, t a) -&gt; f (t, t b)
</span><a href="#local-6989586621684468913"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684468908"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621684468908"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684468907"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621684468907"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621684468908"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(t b -&gt; (t, t b)) -&gt; f (t b) -&gt; f (t, t b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468916"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621684468907"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468904"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-type">FunctionT</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-538"></span><span>  </span><span id="local-6989586621684468902"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; FunctionT a -&gt; FunctionT b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; FunctionT a -&gt; FunctionT b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468869"><span id="local-6989586621684468871"><span id="local-6989586621684468873"><span id="local-6989586621684468875"><span id="local-6989586621684468877"><span id="local-6989586621684468879"><span id="local-6989586621684468881"><span id="local-6989586621684468883"><span id="local-6989586621684468885"><span id="local-6989586621684468887"><span id="local-6989586621684468889"><span id="local-6989586621684468891"><span id="local-6989586621684468893"><span id="local-6989586621684468895"><span id="local-6989586621684468897"><span id="local-6989586621684468900"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-type">FunctionT</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621684468865"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; FunctionT a -&gt; m
</span><a href="#local-6989586621684468865"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; FunctionT a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468854"><span id="local-6989586621684468856"><span id="local-6989586621684468858"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier hs-type">FunctionT</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>  </span><span id="local-6989586621684468844"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; FunctionT a -&gt; f (FunctionT b)
</span><a href="#local-6989586621684468844"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></a></span></span><span> </span><span id="local-6989586621684468843"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468843"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span id="local-6989586621684468842"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621684468842"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621684468841"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684468841"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span id="local-6989586621684468840"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684468840"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621684468839"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468839"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621684468838"><span class="annot"><span class="annottext">[ExternalValue]
</span><a href="#local-6989586621684468838"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span id="local-6989586621684468837"><span class="annot"><span class="annottext">[(Name, ExternalValue)]
</span><a href="#local-6989586621684468837"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
-&gt; [Param]
-&gt; [Param]
-&gt; Code b
-&gt; [ExternalValue]
-&gt; [(Name, ExternalValue)]
-&gt; FunctionT b
forall a.
Maybe Name
-&gt; [Param]
-&gt; [Param]
-&gt; Code a
-&gt; [ExternalValue]
-&gt; [(Name, ExternalValue)]
-&gt; FunctionT a
</span><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-var">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621684468842"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684468841"><span class="hs-identifier hs-var">outs</span></a></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684468840"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b
 -&gt; [ExternalValue] -&gt; [(Name, ExternalValue)] -&gt; FunctionT b)
-&gt; f (Code b)
-&gt; f ([ExternalValue] -&gt; [(Name, ExternalValue)] -&gt; FunctionT b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468843"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468839"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">f ([ExternalValue] -&gt; [(Name, ExternalValue)] -&gt; FunctionT b)
-&gt; f [ExternalValue] -&gt; f ([(Name, ExternalValue)] -&gt; FunctionT b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ExternalValue] -&gt; f [ExternalValue]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[ExternalValue]
</span><a href="#local-6989586621684468838"><span class="hs-identifier hs-var">results</span></a></span><span> </span><span class="annot"><span class="annottext">f ([(Name, ExternalValue)] -&gt; FunctionT b)
-&gt; f [(Name, ExternalValue)] -&gt; f (FunctionT b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, ExternalValue)] -&gt; f [(Name, ExternalValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[(Name, ExternalValue)]
</span><a href="#local-6989586621684468837"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468834"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-548"></span><span>  </span><span id="local-6989586621684468832"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Code a -&gt; Code b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Code a -&gt; Code b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468799"><span id="local-6989586621684468801"><span id="local-6989586621684468803"><span id="local-6989586621684468805"><span id="local-6989586621684468807"><span id="local-6989586621684468809"><span id="local-6989586621684468811"><span id="local-6989586621684468813"><span id="local-6989586621684468815"><span id="local-6989586621684468817"><span id="local-6989586621684468819"><span id="local-6989586621684468821"><span id="local-6989586621684468823"><span id="local-6989586621684468825"><span id="local-6989586621684468827"><span id="local-6989586621684468830"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621684468795"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Code a -&gt; m
</span><a href="#local-6989586621684468795"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Code a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684468784"><span id="local-6989586621684468786"><span id="local-6989586621684468788"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>  </span><span id="local-6989586621684468744"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
</span><a href="#local-6989586621684468744"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></a></span></span><span> </span><span id="local-6989586621684468743"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468743"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684468742"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468742"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684468741"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468741"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; Code b -&gt; Code b
forall a. Code a -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-var">(:&gt;&gt;:)</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b -&gt; Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468742"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468743"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468741"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684468740"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468740"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span id="local-6989586621684468739"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468739"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684468738"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468738"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621684468737"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468737"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Exp -&gt; Code b -&gt; Code b
forall a. VName -&gt; Exp -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-var">For</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468739"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468738"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468740"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468737"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684468736"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468736"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span id="local-6989586621684468735"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468735"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684468734"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468734"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><span class="annottext">TExp Bool -&gt; Code b -&gt; Code b
forall a. TExp Bool -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-var">While</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468735"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468736"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468734"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684468733"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468733"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span id="local-6989586621684468732"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468732"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684468731"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468731"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684468730"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468730"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">TExp Bool -&gt; Code b -&gt; Code b -&gt; Code b
forall a. TExp Bool -&gt; Code a -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-var">If</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468732"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b -&gt; Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468733"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468731"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468733"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468730"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684468729"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468729"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684468728"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684468728"><span class="hs-identifier hs-var">kernel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-563"></span><span>    </span><span class="annot"><span class="annottext">b -&gt; Code b
forall a. a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Code b) -&gt; f b -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468729"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684468728"><span class="hs-identifier hs-var">kernel</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Code b
forall a. Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-type">DeclareMem</span></a></span><span> </span><span id="local-6989586621684468727"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468727"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468726"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468726"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Space -&gt; Code b
forall a. VName -&gt; Space -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-var">DeclareMem</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468727"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468726"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-type">DeclareScalar</span></a></span><span> </span><span id="local-6989586621684468725"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468725"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468724"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468724"><span class="hs-identifier hs-var">vol</span></a></span></span><span> </span><span id="local-6989586621684468723"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468723"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Volatility -&gt; PrimType -&gt; Code b
forall a. VName -&gt; Volatility -&gt; PrimType -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-var">DeclareScalar</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468725"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468724"><span class="hs-identifier hs-var">vol</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468723"><span class="hs-identifier hs-var">bt</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-type">DeclareArray</span></a></span><span> </span><span id="local-6989586621684468722"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468722"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468721"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468721"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684468720"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468720"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684468719"><span class="annot"><span class="annottext">ArrayContents
</span><a href="#local-6989586621684468719"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Space -&gt; PrimType -&gt; ArrayContents -&gt; Code b
forall a. VName -&gt; Space -&gt; PrimType -&gt; ArrayContents -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-var">DeclareArray</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468722"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468721"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468720"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayContents
</span><a href="#local-6989586621684468719"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Allocate"><span class="hs-identifier hs-type">Allocate</span></a></span><span> </span><span id="local-6989586621684468718"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468718"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468717"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468717"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621684468716"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468716"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Count Bytes (TPrimExp Int64 VName) -&gt; Space -&gt; Code b
forall a.
VName -&gt; Count Bytes (TPrimExp Int64 VName) -&gt; Space -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Allocate"><span class="hs-identifier hs-var">Allocate</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468718"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468717"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468716"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span id="local-6989586621684468715"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468715"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468714"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468714"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Space -&gt; Code b
forall a. VName -&gt; Space -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Free"><span class="hs-identifier hs-var">Free</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468715"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468714"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Copy"><span class="hs-identifier hs-type">Copy</span></a></span><span> </span><span id="local-6989586621684468713"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468713"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684468712"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468712"><span class="hs-identifier hs-var">destoffset</span></a></span></span><span> </span><span id="local-6989586621684468711"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468711"><span class="hs-identifier hs-var">destspace</span></a></span></span><span> </span><span id="local-6989586621684468710"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468710"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621684468709"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468709"><span class="hs-identifier hs-var">srcoffset</span></a></span></span><span> </span><span id="local-6989586621684468708"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468708"><span class="hs-identifier hs-var">srcspace</span></a></span></span><span> </span><span id="local-6989586621684468707"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468707"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Space
-&gt; VName
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Space
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Code b
forall a.
VName
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Space
-&gt; VName
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Space
-&gt; Count Bytes (TPrimExp Int64 VName)
-&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Copy"><span class="hs-identifier hs-var">Copy</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468713"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468712"><span class="hs-identifier hs-var">destoffset</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468711"><span class="hs-identifier hs-var">destspace</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468710"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468709"><span class="hs-identifier hs-var">srcoffset</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468708"><span class="hs-identifier hs-var">srcspace</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468707"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Write"><span class="hs-identifier hs-type">Write</span></a></span><span> </span><span id="local-6989586621684468706"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468706"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468705"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468705"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684468704"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468704"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621684468703"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468703"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621684468702"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468702"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684468701"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468701"><span class="hs-identifier hs-var">vol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName
-&gt; Count Elements (TPrimExp Int64 VName)
-&gt; PrimType
-&gt; Space
-&gt; Volatility
-&gt; Exp
-&gt; Code b
forall a.
VName
-&gt; Count Elements (TPrimExp Int64 VName)
-&gt; PrimType
-&gt; Space
-&gt; Volatility
-&gt; Exp
-&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Write"><span class="hs-identifier hs-var">Write</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468706"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468705"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468704"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468703"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468702"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468701"><span class="hs-identifier hs-var">vol</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span id="local-6989586621684468700"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468700"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684468699"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468699"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468698"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468698"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684468697"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468697"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621684468696"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468696"><span class="hs-identifier hs-var">space</span></a></span></span><span> </span><span id="local-6989586621684468695"><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468695"><span class="hs-identifier hs-var">vol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName
-&gt; VName
-&gt; Count Elements (TPrimExp Int64 VName)
-&gt; PrimType
-&gt; Space
-&gt; Volatility
-&gt; Code b
forall a.
VName
-&gt; VName
-&gt; Count Elements (TPrimExp Int64 VName)
-&gt; PrimType
-&gt; Space
-&gt; Volatility
-&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Read"><span class="hs-identifier hs-var">Read</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468700"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468699"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468698"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684468697"><span class="hs-identifier hs-var">bt</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468696"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><a href="#local-6989586621684468695"><span class="hs-identifier hs-var">vol</span></a></span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetScalar"><span class="hs-identifier hs-type">SetScalar</span></a></span><span> </span><span id="local-6989586621684468694"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468694"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468693"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468693"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Exp -&gt; Code b
forall a. VName -&gt; Exp -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#SetScalar"><span class="hs-identifier hs-var">SetScalar</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468694"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468693"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-type">SetMem</span></a></span><span> </span><span id="local-6989586621684468692"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468692"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684468691"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468691"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621684468690"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468690"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Space -&gt; Code b
forall a. VName -&gt; VName -&gt; Space -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-var">SetMem</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468692"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468691"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468690"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621684468689"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468689"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621684468688"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468688"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621684468687"><span class="annot"><span class="annottext">(SrcLoc, [SrcLoc])
</span><a href="#local-6989586621684468687"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; ErrorMsg Exp -&gt; (SrcLoc, [SrcLoc]) -&gt; Code b
forall a. Exp -&gt; ErrorMsg Exp -&gt; (SrcLoc, [SrcLoc]) -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468689"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468688"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">(SrcLoc, [SrcLoc])
</span><a href="#local-6989586621684468687"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621684468686"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684468686"><span class="hs-identifier hs-var">dests</span></a></span></span><span> </span><span id="local-6989586621684468685"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684468685"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span id="local-6989586621684468684"><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684468684"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Name -&gt; [Arg] -&gt; Code b
forall a. [VName] -&gt; Name -&gt; [Arg] -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-var">Call</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684468686"><span class="hs-identifier hs-var">dests</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684468685"><span class="hs-identifier hs-var">fname</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684468684"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684468683"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468683"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span id="local-6989586621684468682"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468682"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684468681"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468681"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Code b -&gt; Code b
forall a. String -&gt; Code a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-var">Comment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468682"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; Code b) -&gt; f (Code b) -&gt; f (Code b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; Code a -&gt; f (Code b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684468683"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468681"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-type">DebugPrint</span></a></span><span> </span><span id="local-6989586621684468680"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468680"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684468679"><span class="annot"><span class="annottext">Maybe Exp
</span><a href="#local-6989586621684468679"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Exp -&gt; Code b
forall a. String -&gt; Maybe Exp -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-var">DebugPrint</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684468680"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><a href="#local-6989586621684468679"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-594"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TracePrint"><span class="hs-identifier hs-type">TracePrint</span></a></span><span> </span><span id="local-6989586621684468678"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468678"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><span class="annottext">Code b -&gt; f (Code b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Code b -&gt; f (Code b)) -&gt; Code b -&gt; f (Code b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp -&gt; Code b
forall a. ErrorMsg Exp -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#TracePrint"><span class="hs-identifier hs-var">TracePrint</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468678"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">-- | The names declared with 'DeclareMem', 'DeclareScalar', and</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- 'DeclareArray' in the given code.</span><span>
</span><span id="line-599"></span><span id="local-6989586621684468677"><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-type">declaredIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684468677"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-600"></span><span id="declaredIn"><span class="annot"><span class="annottext">declaredIn :: forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var hs-var">declaredIn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-type">DeclareMem</span></a></span><span> </span><span id="local-6989586621684468672"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468672"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468672"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-601"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-type">DeclareScalar</span></a></span><span> </span><span id="local-6989586621684468671"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468671"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468671"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-602"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-type">DeclareArray</span></a></span><span> </span><span id="local-6989586621684468670"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468670"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ArrayContents
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468670"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-603"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468669"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468669"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684468668"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468668"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468669"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468668"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-604"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684468667"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684468666"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468666"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468666"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-605"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span id="local-6989586621684468665"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468665"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468664"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468664"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468665"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468664"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-606"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468663"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468663"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468663"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-607"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468662"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468662"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468662"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span id="local-6989586621684470094"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470094"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470094"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621684468653"><span class="annot"><span class="annottext">freeIn' :: Functions a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Functions</span></a></span><span> </span><span id="local-6989586621684468651"><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684468651"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, Function a) -&gt; FV) -&gt; [(Name, Function a)] -&gt; FV
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Function a -&gt; FV
forall {a}. FreeIn a =&gt; FunctionT a -&gt; FV
</span><a href="#local-6989586621684468650"><span class="hs-identifier hs-var">onFun</span></a></span><span> </span><span class="annot"><span class="annottext">(Function a -&gt; FV)
-&gt; ((Name, Function a) -&gt; Function a) -&gt; (Name, Function a) -&gt; FV
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Function a) -&gt; Function a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, Function a)]
</span><a href="#local-6989586621684468651"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-613"></span><span>      </span><span id="local-6989586621684468650"><span class="annot"><span class="annottext">onFun :: FunctionT a -&gt; FV
</span><a href="#local-6989586621684468650"><span class="hs-identifier hs-var hs-var">onFun</span></a></span></span><span> </span><span id="local-6989586621684468637"><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-614"></span><span>        </span><span class="annot"><span class="annottext">Names -&gt; FV -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#fvBind"><span class="hs-identifier hs-var">fvBind</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684468635"><span class="hs-identifier hs-var">pnames</span></a></span><span> </span><span class="annot"><span class="annottext">(FV -&gt; FV) -&gt; FV -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-615"></span><span>          </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionT a -&gt; Code a
forall a. FunctionT a -&gt; Code a
</span><a href="Futhark.CodeGen.ImpCode.html#functionBody"><span class="hs-identifier hs-var hs-var">functionBody</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ExternalValue] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionT a -&gt; [ExternalValue]
forall a. FunctionT a -&gt; [ExternalValue]
</span><a href="Futhark.CodeGen.ImpCode.html#functionResult"><span class="hs-identifier hs-var hs-var">functionResult</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[ExternalValue] -&gt; [ExternalValue] -&gt; [ExternalValue]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Name, ExternalValue) -&gt; ExternalValue)
-&gt; [(Name, ExternalValue)] -&gt; [ExternalValue]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Name, ExternalValue) -&gt; ExternalValue
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunctionT a -&gt; [(Name, ExternalValue)]
forall a. FunctionT a -&gt; [(Name, ExternalValue)]
</span><a href="Futhark.CodeGen.ImpCode.html#functionArgs"><span class="hs-identifier hs-var hs-var">functionArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-617"></span><span>          </span><span id="local-6989586621684468635"><span class="annot"><span class="annottext">pnames :: Names
</span><a href="#local-6989586621684468635"><span class="hs-identifier hs-var hs-var">pnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-618"></span><span>            </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Names) -&gt; [VName] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Param -&gt; VName) -&gt; [Param] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Param -&gt; VName
</span><a href="Futhark.CodeGen.ImpCode.html#paramName"><span class="hs-identifier hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">([Param] -&gt; [VName]) -&gt; [Param] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunctionT a -&gt; [Param]
forall a. FunctionT a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#functionInput"><span class="hs-identifier hs-var hs-var">functionInput</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; [Param] -&gt; [Param]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FunctionT a -&gt; [Param]
forall a. FunctionT a -&gt; [Param]
</span><a href="Futhark.CodeGen.ImpCode.html#functionOutput"><span class="hs-identifier hs-var hs-var">functionOutput</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionT a
</span><a href="#local-6989586621684468637"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ValueDesc"><span class="hs-identifier hs-type">ValueDesc</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-621"></span><span>  </span><span id="local-6989586621684468624"><span class="annot"><span class="annottext">freeIn' :: ValueDesc -&gt; FV
</span><a href="#local-6989586621684468624"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ArrayValue"><span class="hs-identifier hs-type">ArrayValue</span></a></span><span> </span><span id="local-6989586621684468623"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468623"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Signedness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468622"><span class="annot"><span class="annottext">[DimSize]
</span><a href="#local-6989586621684468622"><span class="hs-identifier hs-var">dims</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468623"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DimSize] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">[DimSize]
</span><a href="#local-6989586621684468622"><span class="hs-identifier hs-var">dims</span></a></span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ScalarValue"><span class="hs-identifier hs-type">ScalarValue</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExternalValue"><span class="hs-identifier hs-type">ExternalValue</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-625"></span><span>  </span><span id="local-6989586621684468616"><span class="annot"><span class="annottext">freeIn' :: ExternalValue -&gt; FV
</span><a href="#local-6989586621684468616"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TransparentValue"><span class="hs-identifier hs-type">TransparentValue</span></a></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468615"><span class="annot"><span class="annottext">ValueDesc
</span><a href="#local-6989586621684468615"><span class="hs-identifier hs-var">vd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValueDesc -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">ValueDesc
</span><a href="#local-6989586621684468615"><span class="hs-identifier hs-var">vd</span></a></span><span>
</span><span id="line-626"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#OpaqueValue"><span class="hs-identifier hs-type">OpaqueValue</span></a></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468614"><span class="annot"><span class="annottext">[ValueDesc]
</span><a href="#local-6989586621684468614"><span class="hs-identifier hs-var">vds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ValueDesc -&gt; FV) -&gt; [ValueDesc] -&gt; FV
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">ValueDesc -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">[ValueDesc]
</span><a href="#local-6989586621684468614"><span class="hs-identifier hs-var">vds</span></a></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span id="local-6989586621684470088"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684470088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>  </span><span id="local-6989586621684468538"><span class="annot"><span class="annottext">freeIn' :: Code a -&gt; FV
</span><a href="#local-6989586621684468538"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684468537"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468537"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#%3A%3E%3E%3A"><span class="hs-operator hs-type">:&gt;&gt;:</span></a></span><span> </span><span id="local-6989586621684468536"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468536"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="annottext">Names -&gt; FV -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#fvBind"><span class="hs-identifier hs-var">fvBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code a -&gt; Names
forall {a}. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468537"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FV -&gt; FV) -&gt; FV -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468537"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468536"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="Futhark.CodeGen.ImpCode.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-633"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#For"><span class="hs-identifier hs-type">For</span></a></span><span> </span><span id="local-6989586621684468535"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468535"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684468534"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468534"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621684468533"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468533"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-634"></span><span>    </span><span class="annot"><span class="annottext">Names -&gt; FV -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#fvBind"><span class="hs-identifier hs-var">fvBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468535"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(FV -&gt; FV) -&gt; FV -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468534"><span class="hs-identifier hs-var">bound</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468533"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#While"><span class="hs-identifier hs-type">While</span></a></span><span> </span><span id="local-6989586621684468532"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468532"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684468531"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468531"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-636"></span><span>    </span><span class="annot"><span class="annottext">TExp Bool -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468532"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468531"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareMem"><span class="hs-identifier hs-type">DeclareMem</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468530"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468530"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-638"></span><span>    </span><span class="annot"><span class="annottext">Space -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468530"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareScalar"><span class="hs-identifier hs-type">DeclareScalar</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-641"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DeclareArray"><span class="hs-identifier hs-type">DeclareArray</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-643"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Allocate"><span class="hs-identifier hs-type">Allocate</span></a></span><span> </span><span id="local-6989586621684468529"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468529"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684468528"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468528"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621684468527"><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468527"><span class="hs-identifier hs-var">space</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468529"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468528"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Space -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><a href="#local-6989586621684468527"><span class="hs-identifier hs-var">space</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span id="local-6989586621684468526"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468526"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468526"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Copy"><span class="hs-identifier hs-type">Copy</span></a></span><span> </span><span id="local-6989586621684468525"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468525"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684468524"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468524"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468523"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468523"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621684468522"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468522"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468521"><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468521"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468525"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468524"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468523"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468522"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468521"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetMem"><span class="hs-identifier hs-type">SetMem</span></a></span><span> </span><span id="local-6989586621684468520"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468520"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684468519"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468519"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-650"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468520"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468519"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Write"><span class="hs-identifier hs-type">Write</span></a></span><span> </span><span id="local-6989586621684468518"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468518"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684468517"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468517"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468516"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468516"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-652"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468518"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468517"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468516"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Read"><span class="hs-identifier hs-type">Read</span></a></span><span> </span><span id="local-6989586621684468515"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468515"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684468514"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468514"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684468513"><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468513"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Volatility
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468515"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468514"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TPrimExp Int64 VName)
</span><a href="#local-6989586621684468513"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#SetScalar"><span class="hs-identifier hs-type">SetScalar</span></a></span><span> </span><span id="local-6989586621684468512"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468512"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684468511"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468511"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468512"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468511"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Call"><span class="hs-identifier hs-type">Call</span></a></span><span> </span><span id="local-6989586621684468510"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684468510"><span class="hs-identifier hs-var">dests</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468509"><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684468509"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><span class="annottext">[VName] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684468510"><span class="hs-identifier hs-var">dests</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Arg] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg]
</span><a href="#local-6989586621684468509"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span id="local-6989586621684468508"><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468508"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621684468507"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468507"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684468506"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468506"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-660"></span><span>    </span><span class="annot"><span class="annottext">TExp Bool -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">TExp Bool
</span><a href="#local-6989586621684468508"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468507"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468506"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span id="local-6989586621684468505"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468505"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621684468504"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468504"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="annottext">(SrcLoc, [SrcLoc])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468505"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; FV) -&gt; ErrorMsg Exp -&gt; FV
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468504"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684468503"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684468503"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684468503"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-665"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468502"><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468502"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><span class="annottext">Code a -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code a
</span><a href="#local-6989586621684468502"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-667"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#DebugPrint"><span class="hs-identifier hs-type">DebugPrint</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684468501"><span class="annot"><span class="annottext">Maybe Exp
</span><a href="#local-6989586621684468501"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><span class="annottext">FV -&gt; (Exp -&gt; FV) -&gt; Maybe Exp -&gt; FV
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Exp
</span><a href="#local-6989586621684468501"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TracePrint"><span class="hs-identifier hs-type">TracePrint</span></a></span><span> </span><span id="local-6989586621684468499"><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468499"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><span class="annottext">(Exp -&gt; FV) -&gt; ErrorMsg Exp -&gt; FV
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorMsg Exp
</span><a href="#local-6989586621684468499"><span class="hs-identifier hs-var">msg</span></a></span></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>  </span><span id="local-6989586621684468495"><span class="annot"><span class="annottext">freeIn' :: Arg -&gt; FV
</span><a href="#local-6989586621684468495"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#MemArg"><span class="hs-identifier hs-type">MemArg</span></a></span><span> </span><span id="local-6989586621684468494"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468494"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684468494"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#ExpArg"><span class="hs-identifier hs-type">ExpArg</span></a></span><span> </span><span id="local-6989586621684468493"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468493"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684468493"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-675"></span></pre></body></html>