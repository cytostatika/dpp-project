<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | A representation where all bindings are annotated with aliasing</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- information.</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.IR.Aliases</span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * The representation definition</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier">Aliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier">AliasDec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier">VarAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#ConsumedInExp"><span class="hs-identifier">ConsumedInExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#BodyAliasing"><span class="hs-identifier">BodyAliasing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html"><span class="hs-identifier">Futhark.IR.Prop.Aliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Module re-exports</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html"><span class="hs-identifier">Futhark.IR.Prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Traversals.html"><span class="hs-identifier">Futhark.IR.Traversals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html"><span class="hs-identifier">Futhark.IR.Pretty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html"><span class="hs-identifier">Futhark.IR.Syntax</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Adding aliases</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#addAliasesToPat"><span class="hs-identifier">addAliasesToPat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#mkAliasedLetStm"><span class="hs-identifier">mkAliasedLetStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#mkAliasedBody"><span class="hs-identifier">mkAliasedBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#mkPatAliases"><span class="hs-identifier">mkPatAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#mkBodyAliases"><span class="hs-identifier">mkBodyAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Removing aliases</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeProgAliases"><span class="hs-identifier">removeProgAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeFunDefAliases"><span class="hs-identifier">removeFunDefAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier">removeExpAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeStmAliases"><span class="hs-identifier">removeStmAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeLambdaAliases"><span class="hs-identifier">removeLambdaAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removePatAliases"><span class="hs-identifier">removePatAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#removeScopeAliases"><span class="hs-identifier">removeScopeAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Tracking aliases</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasesAndConsumed"><span class="hs-identifier">AliasesAndConsumed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#trackAliases"><span class="hs-identifier">trackAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#mkStmsAliases"><span class="hs-identifier">mkStmsAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Futhark.IR.Aliases.html#consumedInStms"><span class="hs-identifier">consumedInStms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Identity</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html"><span class="hs-identifier">Futhark.Analysis.Rephrase</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Builder.html"><span class="hs-identifier">Futhark.Builder</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html"><span class="hs-identifier">Futhark.IR.Pretty</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html"><span class="hs-identifier">Futhark.IR.Prop</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html"><span class="hs-identifier">Futhark.IR.Prop.Aliases</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html"><span class="hs-identifier">Futhark.IR.Syntax</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Traversals.html"><span class="hs-identifier">Futhark.IR.Traversals</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Transform.Rename.html"><span class="hs-identifier">Futhark.Transform.Rename</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Transform.Substitute.html"><span class="hs-identifier">Futhark.Transform.Substitute</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | The rep for the basic representation.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="Aliases"><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-var">Aliases</span></a></span></span><span> </span><span id="local-6989586621684350727"><span class="annot"><a href="#local-6989586621684350727"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | A wrapper around 'AliasDec' to get around the fact that we need an</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- 'Ord' instance, which 'AliasDec does not have.</span><span>
</span><span id="line-69"></span><span class="hs-keyword">newtype</span><span> </span><span id="AliasDec"><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AliasDec"><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unAliases"><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684350715"><span id="local-6989586621684350717"><span id="local-6989586621684350723"><span class="annot"><span class="annottext">Int -&gt; AliasDec -&gt; ShowS
[AliasDec] -&gt; ShowS
AliasDec -&gt; String
(Int -&gt; AliasDec -&gt; ShowS)
-&gt; (AliasDec -&gt; String) -&gt; ([AliasDec] -&gt; ShowS) -&gt; Show AliasDec
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AliasDec] -&gt; ShowS
$cshowList :: [AliasDec] -&gt; ShowS
show :: AliasDec -&gt; String
$cshow :: AliasDec -&gt; String
showsPrec :: Int -&gt; AliasDec -&gt; ShowS
$cshowsPrec :: Int -&gt; AliasDec -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350709"><span id="local-6989586621684350711"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621684350705"><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684350704"><span class="annot"><span class="annottext">&lt;&gt; :: AliasDec -&gt; AliasDec -&gt; AliasDec
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621684350703"><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350703"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; Names -&gt; AliasDec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350705"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350703"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350696"><span id="local-6989586621684350698"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621684350692"><span class="annot"><span class="annottext">mempty :: AliasDec
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350689"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">AliasDec
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684350687"><span class="annot"><span class="annottext">== :: AliasDec -&gt; AliasDec -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">AliasDec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350672"><span id="local-6989586621684350674"><span id="local-6989586621684350676"><span id="local-6989586621684350678"><span id="local-6989586621684350680"><span id="local-6989586621684350682"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="annottext">AliasDec
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684350670"><span class="annot"><span class="annottext">compare :: AliasDec -&gt; AliasDec -&gt; Ordering
</span><span class="hs-operator hs-var hs-var hs-var hs-var">`compare`</span></span></span><span> </span><span class="annot"><span class="annottext">AliasDec
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Transform.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621684350661"><span class="annot"><span class="annottext">rename :: AliasDec -&gt; RenameM AliasDec
</span><a href="Futhark.Transform.Rename.html#rename"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span> </span><span id="local-6989586621684350659"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350659"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; RenameM Names -&gt; RenameM AliasDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; RenameM Names
forall a. Rename a =&gt; a -&gt; RenameM a
</span><a href="Futhark.Transform.Rename.html#rename"><span class="hs-identifier hs-var">rename</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350659"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Transform.Substitute.html#Substitute"><span class="hs-identifier hs-type">Substitute</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621684350652"><span class="annot"><span class="annottext">substituteNames :: Map VName VName -&gt; AliasDec -&gt; AliasDec
</span><a href="Futhark.Transform.Substitute.html#substituteNames"><span class="hs-identifier hs-var hs-var hs-var hs-var">substituteNames</span></a></span></span><span> </span><span id="local-6989586621684350650"><span class="annot"><span class="annottext">Map VName VName
</span><a href="#local-6989586621684350650"><span class="hs-identifier hs-var">substs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span> </span><span id="local-6989586621684350649"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350649"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; Names -&gt; AliasDec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map VName VName -&gt; Names -&gt; Names
forall a. Substitute a =&gt; Map VName VName -&gt; a -&gt; a
</span><a href="Futhark.Transform.Substitute.html#substituteNames"><span class="hs-identifier hs-var">substituteNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName VName
</span><a href="#local-6989586621684350650"><span class="hs-identifier hs-var">substs</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350649"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621684350643"><span class="annot"><span class="annottext">freeIn' :: AliasDec -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV -&gt; AliasDec -&gt; FV
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350636"><span id="local-6989586621684350638"><span class="annot"><span class="hs-identifier hs-type">PP.Pretty</span></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621684350632"><span class="annot"><span class="annottext">ppr :: AliasDec -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">PP.braces</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; (AliasDec -&gt; Doc) -&gt; AliasDec -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">PP.commasep</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; (AliasDec -&gt; [Doc]) -&gt; AliasDec -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Doc) -&gt; [VName] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">PP.ppr</span></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; [Doc]) -&gt; (AliasDec -&gt; [VName]) -&gt; AliasDec -&gt; [Doc]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; [VName]) -&gt; (AliasDec -&gt; Names) -&gt; AliasDec -&gt; [VName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | The aliases of the let-bound variable.</span><span>
</span><span id="line-97"></span><span class="hs-keyword">type</span><span> </span><span id="VarAliases"><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-var">VarAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Everything consumed in the expression.</span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span id="ConsumedInExp"><span class="annot"><a href="Futhark.IR.Aliases.html#ConsumedInExp"><span class="hs-identifier hs-var">ConsumedInExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | The aliases of what is returned by the t'Body', and what is</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- consumed inside of it.</span><span>
</span><span id="line-104"></span><span class="hs-keyword">type</span><span> </span><span id="BodyAliasing"><span class="annot"><a href="Futhark.IR.Aliases.html#BodyAliasing"><span class="hs-identifier hs-var">BodyAliasing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-type">VarAliases</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#ConsumedInExp"><span class="hs-identifier hs-type">ConsumedInExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span id="local-6989586621684351033"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#RepTypes"><span class="hs-identifier hs-type">RepTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#RepTypes"><span class="hs-identifier hs-type">RepTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="LetDec"><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-var">LetDec</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-type">VarAliases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExpDec"><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-var">ExpDec</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#ConsumedInExp"><span class="hs-identifier hs-type">ConsumedInExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-type">ExpDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BodyDec"><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-var">BodyDec</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#BodyAliasing"><span class="hs-identifier hs-type">BodyAliasing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-type">BodyDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="FParamInfo"><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-var">FParamInfo</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="LParamInfo"><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-var">LParamInfo</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="RetType"><span class="annot"><a href="Futhark.IR.Rep.html#RetType"><span class="hs-identifier hs-var">RetType</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#RetType"><span class="hs-identifier hs-type">RetType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BranchType"><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-var">BranchType</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-type">BranchType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Op"><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span id="local-6989586621684351033"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-type">OpWithAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351033"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621684351029"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-type">VarAliases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621684351029"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621684350426"><span class="annot"><span class="annottext">aliasesOf :: (AliasDec, dec) -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var hs-var hs-var hs-var">aliasesOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(AliasDec -&gt; Names)
-&gt; ((AliasDec, dec) -&gt; AliasDec) -&gt; (AliasDec, dec) -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AliasDec, dec) -&gt; AliasDec
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684350421"><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeDec"><span class="hs-identifier hs-type">FreeDec</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621684351021"><span id="local-6989586621684351024"><span id="local-6989586621684351025"><span class="annot"><a href="Futhark.IR.Aliases.html#withoutAliases"><span class="hs-identifier hs-type">withoutAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#HasScope"><span class="hs-identifier hs-type">HasScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351025"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621684351024"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684351024"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351025"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621684351024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351021"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="#local-6989586621684351024"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351021"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-125"></span><span id="withoutAliases"><span class="annot"><span class="annottext">withoutAliases :: forall rep (m :: * -&gt; *) a.
(HasScope (Aliases rep) m, Monad m) =&gt;
ReaderT (Scope rep) m a -&gt; m a
</span><a href="Futhark.IR.Aliases.html#withoutAliases"><span class="hs-identifier hs-var hs-var">withoutAliases</span></a></span></span><span> </span><span id="local-6989586621684350414"><span class="annot"><span class="annottext">ReaderT (Scope rep) m a
</span><a href="#local-6989586621684350414"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621684350413"><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684350413"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scope (Aliases rep) -&gt; Scope rep) -&gt; m (Scope rep)
forall rep (m :: * -&gt; *) a.
HasScope rep m =&gt;
(Scope rep -&gt; a) -&gt; m a
</span><a href="Futhark.IR.Prop.Scope.html#asksScope"><span class="hs-identifier hs-var">asksScope</span></a></span><span> </span><span class="annot"><span class="annottext">Scope (Aliases rep) -&gt; Scope rep
forall rep. Scope (Aliases rep) -&gt; Scope rep
</span><a href="Futhark.IR.Aliases.html#removeScopeAliases"><span class="hs-identifier hs-var">removeScopeAliases</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">ReaderT (Scope rep) m a -&gt; Scope rep -&gt; m a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (Scope rep) m a
</span><a href="#local-6989586621684350414"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684350413"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621684350974"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350974"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350974"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350974"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621684350243"><span class="annot"><span class="annottext">expTypesFromPat :: forall (m :: * -&gt; *).
(HasScope (Aliases rep) m, Monad m) =&gt;
Pat (Aliases rep) -&gt; m [BranchType (Aliases rep)]
</span><a href="Futhark.IR.Prop.html#expTypesFromPat"><span class="hs-identifier hs-var hs-var hs-var hs-var">expTypesFromPat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">ReaderT (Scope rep) m [BranchType rep] -&gt; m [BranchType rep]
forall rep (m :: * -&gt; *) a.
(HasScope (Aliases rep) m, Monad m) =&gt;
ReaderT (Scope rep) m a -&gt; m a
</span><a href="Futhark.IR.Aliases.html#withoutAliases"><span class="hs-identifier hs-var">withoutAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (Scope rep) m [BranchType rep] -&gt; m [BranchType rep])
-&gt; (PatT (AliasDec, LetDec rep)
    -&gt; ReaderT (Scope rep) m [BranchType rep])
-&gt; PatT (AliasDec, LetDec rep)
-&gt; m [BranchType rep]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; ReaderT (Scope rep) m [BranchType rep]
forall rep (m :: * -&gt; *).
(ASTRep rep, HasScope rep m, Monad m) =&gt;
Pat rep -&gt; m [BranchType rep]
</span><a href="Futhark.IR.Prop.html#expTypesFromPat"><span class="hs-identifier hs-var">expTypesFromPat</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; ReaderT (Scope rep) m [BranchType rep])
-&gt; (PatT (AliasDec, LetDec rep) -&gt; PatT (LetDec rep))
-&gt; PatT (AliasDec, LetDec rep)
-&gt; ReaderT (Scope rep) m [BranchType rep]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT (AliasDec, LetDec rep) -&gt; PatT (LetDec rep)
forall a. PatT (AliasDec, a) -&gt; PatT a
</span><a href="Futhark.IR.Aliases.html#removePatAliases"><span class="hs-identifier hs-var">removePatAliases</span></a></span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621684350962"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350962"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350962"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350962"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621684350219"><span class="annot"><span class="annottext">bodyAliases :: Body (Aliases rep) -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var hs-var hs-var hs-var">bodyAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AliasDec -&gt; Names) -&gt; [AliasDec] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">([AliasDec] -&gt; [Names])
-&gt; (Body (Aliases rep) -&gt; [AliasDec])
-&gt; Body (Aliases rep)
-&gt; [Names]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BodyAliasing -&gt; [AliasDec]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(BodyAliasing -&gt; [AliasDec])
-&gt; (Body (Aliases rep) -&gt; BodyAliasing)
-&gt; Body (Aliases rep)
-&gt; [AliasDec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BodyAliasing, BodyDec rep) -&gt; BodyAliasing
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BodyAliasing, BodyDec rep) -&gt; BodyAliasing)
-&gt; (Body (Aliases rep) -&gt; (BodyAliasing, BodyDec rep))
-&gt; Body (Aliases rep)
-&gt; BodyAliasing
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Body (Aliases rep) -&gt; (BodyAliasing, BodyDec rep)
forall rep. BodyT rep -&gt; BodyDec rep
</span><a href="Futhark.IR.Syntax.html#bodyDec"><span class="hs-identifier hs-var hs-var">bodyDec</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621684350216"><span class="annot"><span class="annottext">consumedInBody :: Body (Aliases rep) -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var hs-var hs-var hs-var">consumedInBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(AliasDec -&gt; Names)
-&gt; (Body (Aliases rep) -&gt; AliasDec) -&gt; Body (Aliases rep) -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BodyAliasing -&gt; AliasDec
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(BodyAliasing -&gt; AliasDec)
-&gt; (Body (Aliases rep) -&gt; BodyAliasing)
-&gt; Body (Aliases rep)
-&gt; AliasDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BodyAliasing, BodyDec rep) -&gt; BodyAliasing
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BodyAliasing, BodyDec rep) -&gt; BodyAliasing)
-&gt; (Body (Aliases rep) -&gt; (BodyAliasing, BodyDec rep))
-&gt; Body (Aliases rep)
-&gt; BodyAliasing
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Body (Aliases rep) -&gt; (BodyAliasing, BodyDec rep)
forall rep. BodyT rep -&gt; BodyDec rep
</span><a href="Futhark.IR.Syntax.html#bodyDec"><span class="hs-identifier hs-var hs-var">bodyDec</span></a></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621684350214"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350214"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350214"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html#PrettyRep"><span class="hs-identifier hs-type">PrettyRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350214"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621684350148"><span class="annot"><span class="annottext">ppExpDec :: ExpDec (Aliases rep) -&gt; Exp (Aliases rep) -&gt; Maybe Doc
</span><a href="Futhark.IR.Pretty.html#ppExpDec"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppExpDec</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684350146"><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350146"><span class="hs-identifier hs-var">consumed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684350145"><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684350145"><span class="hs-identifier hs-var">inner</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684350144"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684350144"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">[Doc] -&gt; Maybe Doc
</span><a href="Futhark.IR.Aliases.html#maybeComment"><span class="hs-identifier hs-var">maybeComment</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Maybe Doc)
-&gt; ([Maybe Doc] -&gt; [Doc]) -&gt; [Maybe Doc] -&gt; Maybe Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Doc] -&gt; [Doc]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Doc] -&gt; Maybe Doc) -&gt; [Maybe Doc] -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Doc
</span><a href="#local-6989586621684350141"><span class="hs-identifier hs-var">exp_dec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Doc
</span><a href="#local-6989586621684350140"><span class="hs-identifier hs-var">merge_dec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpDec rep -&gt; Exp rep -&gt; Maybe Doc
forall rep. PrettyRep rep =&gt; ExpDec rep -&gt; Exp rep -&gt; Maybe Doc
</span><a href="Futhark.IR.Pretty.html#ppExpDec"><span class="hs-identifier hs-var">ppExpDec</span></a></span><span> </span><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684350145"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; Maybe Doc) -&gt; Exp rep -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Exp rep
forall rep. CanBeAliased (Op rep) =&gt; Exp (Aliases rep) -&gt; Exp rep
</span><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-var">removeExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684350144"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>      </span><span id="local-6989586621684350140"><span class="annot"><span class="annottext">merge_dec :: Maybe Doc
</span><a href="#local-6989586621684350140"><span class="hs-identifier hs-var hs-var">merge_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684350144"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>          </span><span class="annot"><a href="Futhark.IR.Syntax.html#DoLoop"><span class="hs-identifier hs-type">DoLoop</span></a></span><span> </span><span id="local-6989586621684350138"><span class="annot"><span class="annottext">[(FParam (Aliases rep), SubExp)]
</span><a href="#local-6989586621684350138"><span class="hs-identifier hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">LoopForm (Aliases rep)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684350137"><span class="annot"><span class="annottext">BodyT (Aliases rep)
</span><a href="#local-6989586621684350137"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684350133"><span class="annot"><span class="annottext">mergeParamAliases :: Param dec -&gt; Names -&gt; Maybe Doc
</span><a href="#local-6989586621684350133"><span class="hs-identifier hs-var hs-var">mergeParamAliases</span></a></span></span><span> </span><span id="local-6989586621684350132"><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684350132"><span class="hs-identifier hs-var">fparam</span></a></span></span><span> </span><span id="local-6989586621684350131"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350131"><span class="hs-identifier hs-var">als</span></a></span></span><span>
</span><span id="line-146"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TypeBase Shape NoUniqueness -&gt; Bool
forall shape u. TypeBase shape u -&gt; Bool
</span><a href="Futhark.IR.Prop.Types.html#primType"><span class="hs-identifier hs-var">primType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param dec -&gt; TypeBase Shape NoUniqueness
forall dec. Typed dec =&gt; Param dec -&gt; TypeBase Shape NoUniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#paramType"><span class="hs-identifier hs-var">paramType</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684350132"><span class="hs-identifier hs-var">fparam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-148"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>                    </span><span class="annot"><span class="annottext">VName -&gt; Names -&gt; Maybe Doc
forall a. Pretty a =&gt; a -&gt; Names -&gt; Maybe Doc
</span><a href="Futhark.IR.Aliases.html#resultAliasComment"><span class="hs-identifier hs-var">resultAliasComment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684350132"><span class="hs-identifier hs-var">fparam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350131"><span class="hs-identifier hs-var">als</span></a></span><span>
</span><span id="line-150"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Maybe Doc
</span><a href="Futhark.IR.Aliases.html#maybeComment"><span class="hs-identifier hs-var">maybeComment</span></a></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Maybe Doc)
-&gt; ([Maybe Doc] -&gt; [Doc]) -&gt; [Maybe Doc] -&gt; Maybe Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Doc] -&gt; [Doc]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Doc] -&gt; Maybe Doc) -&gt; [Maybe Doc] -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-151"></span><span>                  </span><span class="annot"><span class="annottext">(Param (FParamInfo rep) -&gt; Names -&gt; Maybe Doc)
-&gt; [Param (FParamInfo rep)] -&gt; [Names] -&gt; [Maybe Doc]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Param (FParamInfo rep) -&gt; Names -&gt; Maybe Doc
forall {dec}. Typed dec =&gt; Param dec -&gt; Names -&gt; Maybe Doc
</span><a href="#local-6989586621684350133"><span class="hs-identifier hs-var">mergeParamAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Param (FParamInfo rep), SubExp) -&gt; Param (FParamInfo rep))
-&gt; [(Param (FParamInfo rep), SubExp)] -&gt; [Param (FParamInfo rep)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Param (FParamInfo rep), SubExp) -&gt; Param (FParamInfo rep)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Param (FParamInfo rep), SubExp)]
[(FParam (Aliases rep), SubExp)]
</span><a href="#local-6989586621684350138"><span class="hs-identifier hs-var">merge</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; [Maybe Doc]) -&gt; [Names] -&gt; [Maybe Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-152"></span><span>                    </span><span class="annot"><span class="annottext">BodyT (Aliases rep) -&gt; [Names]
forall rep. Aliased rep =&gt; Body rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var">bodyAliases</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT (Aliases rep)
</span><a href="#local-6989586621684350137"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621684350141"><span class="annot"><span class="annottext">exp_dec :: Maybe Doc
</span><a href="#local-6989586621684350141"><span class="hs-identifier hs-var hs-var">exp_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; [VName]) -&gt; Names -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AliasDec -&gt; Names
</span><a href="Futhark.IR.Aliases.html#unAliases"><span class="hs-identifier hs-var hs-var">unAliases</span></a></span><span> </span><span class="annot"><span class="annottext">AliasDec
</span><a href="#local-6989586621684350146"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621684350125"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684350125"><span class="hs-identifier hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>          </span><span class="annot"><span class="annottext">Doc -&gt; Maybe Doc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Maybe Doc) -&gt; Doc -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#oneLine"><span class="hs-identifier hs-var">PP.oneLine</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-160"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-- Consumes &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">PP.commasep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VName -&gt; Doc) -&gt; [VName] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">PP.ppr</span></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684350125"><span class="hs-identifier hs-var">als</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="Futhark.IR.Aliases.html#maybeComment"><span class="hs-identifier hs-type">maybeComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PP.Doc</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PP.Doc</span></span><span>
</span><span id="line-163"></span><span id="maybeComment"><span class="annot"><span class="annottext">maybeComment :: [Doc] -&gt; Maybe Doc
</span><a href="Futhark.IR.Aliases.html#maybeComment"><span class="hs-identifier hs-var hs-var">maybeComment</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Futhark.IR.Aliases.html#maybeComment"><span class="hs-identifier hs-var">maybeComment</span></a></span><span> </span><span id="local-6989586621684350122"><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621684350122"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Maybe Doc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Maybe Doc) -&gt; Doc -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc -&gt; Doc) -&gt; [Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">PP.folddoc</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">(PP.&lt;/&gt;)</span></span><span> </span><span class="annot"><span class="annottext">[Doc]
</span><a href="#local-6989586621684350122"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span id="local-6989586621684350938"><span class="annot"><a href="Futhark.IR.Aliases.html#resultAliasComment"><span class="hs-identifier hs-type">resultAliasComment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PP.Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684350938"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684350938"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PP.Doc</span></span></span><span>
</span><span id="line-167"></span><span id="resultAliasComment"><span class="annot"><span class="annottext">resultAliasComment :: forall a. Pretty a =&gt; a -&gt; Names -&gt; Maybe Doc
</span><a href="Futhark.IR.Aliases.html#resultAliasComment"><span class="hs-identifier hs-var hs-var">resultAliasComment</span></a></span></span><span> </span><span id="local-6989586621684350113"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684350113"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684350112"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350112"><span class="hs-identifier hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684350112"><span class="hs-identifier hs-var">als</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Doc
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621684350111"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684350111"><span class="hs-identifier hs-var">als'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Maybe Doc
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Maybe Doc) -&gt; Doc -&gt; Maybe Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#oneLine"><span class="hs-identifier hs-var">PP.oneLine</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-- Result for &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">PP.ppr</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684350113"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">PP.text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; aliases &quot;</span></span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">PP.commasep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VName -&gt; Doc) -&gt; [VName] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">PP.ppr</span></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684350111"><span class="hs-identifier hs-var">als'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621684350932"><span class="annot"><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-type">removeAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350932"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350932"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621684350932"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-177"></span><span id="removeAliases"><span class="annot"><span class="annottext">removeAliases :: forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var hs-var">removeAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="annottext">Rephraser :: forall (m :: * -&gt; *) from to.
(ExpDec from -&gt; m (ExpDec to))
-&gt; (LetDec from -&gt; m (LetDec to))
-&gt; (FParamInfo from -&gt; m (FParamInfo to))
-&gt; (LParamInfo from -&gt; m (LParamInfo to))
-&gt; (BodyDec from -&gt; m (BodyDec to))
-&gt; (RetType from -&gt; m (RetType to))
-&gt; (BranchType from -&gt; m (BranchType to))
-&gt; (Op from -&gt; m (Op to))
-&gt; Rephraser m from to
</span><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rephraseExpDec :: ExpDec (Aliases rep) -&gt; Identity (ExpDec rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExpDec"><span class="hs-identifier hs-var">rephraseExpDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpDec rep -&gt; Identity (ExpDec rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ExpDec rep -&gt; Identity (ExpDec rep))
-&gt; ((AliasDec, ExpDec rep) -&gt; ExpDec rep)
-&gt; (AliasDec, ExpDec rep)
-&gt; Identity (ExpDec rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AliasDec, ExpDec rep) -&gt; ExpDec rep
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">rephraseLetBoundDec :: LetDec (Aliases rep) -&gt; Identity (LetDec rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLetBoundDec"><span class="hs-identifier hs-var">rephraseLetBoundDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LetDec rep -&gt; Identity (LetDec rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LetDec rep -&gt; Identity (LetDec rep))
-&gt; ((AliasDec, LetDec rep) -&gt; LetDec rep)
-&gt; (AliasDec, LetDec rep)
-&gt; Identity (LetDec rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AliasDec, LetDec rep) -&gt; LetDec rep
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">rephraseBodyDec :: BodyDec (Aliases rep) -&gt; Identity (BodyDec rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBodyDec"><span class="hs-identifier hs-var">rephraseBodyDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BodyDec rep -&gt; Identity (BodyDec rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(BodyDec rep -&gt; Identity (BodyDec rep))
-&gt; ((BodyAliasing, BodyDec rep) -&gt; BodyDec rep)
-&gt; (BodyAliasing, BodyDec rep)
-&gt; Identity (BodyDec rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BodyAliasing, BodyDec rep) -&gt; BodyDec rep
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">rephraseFParamDec :: FParamInfo (Aliases rep) -&gt; Identity (FParamInfo rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFParamDec"><span class="hs-identifier hs-var">rephraseFParamDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FParamInfo (Aliases rep) -&gt; Identity (FParamInfo rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="annottext">rephraseLParamDec :: LParamInfo (Aliases rep) -&gt; Identity (LParamInfo rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLParamDec"><span class="hs-identifier hs-var">rephraseLParamDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LParamInfo (Aliases rep) -&gt; Identity (LParamInfo rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">rephraseRetType :: RetType (Aliases rep) -&gt; Identity (RetType rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseRetType"><span class="hs-identifier hs-var">rephraseRetType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RetType (Aliases rep) -&gt; Identity (RetType rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">rephraseBranchType :: BranchType (Aliases rep) -&gt; Identity (BranchType rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBranchType"><span class="hs-identifier hs-var">rephraseBranchType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BranchType (Aliases rep) -&gt; Identity (BranchType rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">rephraseOp :: Op (Aliases rep) -&gt; Identity (Op rep)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseOp"><span class="hs-identifier hs-var">rephraseOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Op rep -&gt; Identity (Op rep)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Op rep -&gt; Identity (Op rep))
-&gt; (OpWithAliases (Op rep) -&gt; Op rep)
-&gt; OpWithAliases (Op rep)
-&gt; Identity (Op rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OpWithAliases (Op rep) -&gt; Op rep
forall op. CanBeAliased op =&gt; OpWithAliases op -&gt; op
</span><a href="Futhark.IR.Prop.Aliases.html#removeOpAliases"><span class="hs-identifier hs-var">removeOpAliases</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621684351013"><span class="annot"><a href="Futhark.IR.Aliases.html#removeScopeAliases"><span class="hs-identifier hs-type">removeScopeAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351013"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684351013"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-190"></span><span id="removeScopeAliases"><span class="annot"><span class="annottext">removeScopeAliases :: forall rep. Scope (Aliases rep) -&gt; Scope rep
</span><a href="Futhark.IR.Aliases.html#removeScopeAliases"><span class="hs-identifier hs-var hs-var">removeScopeAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NameInfo (Aliases rep) -&gt; NameInfo rep)
-&gt; Map VName (NameInfo (Aliases rep)) -&gt; Map VName (NameInfo rep)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">NameInfo (Aliases rep) -&gt; NameInfo rep
forall {rep} {a} {rep}.
(LetDec rep ~ (a, LetDec rep), FParamInfo rep ~ FParamInfo rep,
 LParamInfo rep ~ LParamInfo rep) =&gt;
NameInfo rep -&gt; NameInfo rep
</span><a href="#local-6989586621684350079"><span class="hs-identifier hs-var">unAlias</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621684350079"><span class="annot"><span class="annottext">unAlias :: NameInfo rep -&gt; NameInfo rep
</span><a href="#local-6989586621684350079"><span class="hs-identifier hs-var hs-var">unAlias</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#LetName"><span class="hs-identifier hs-type">LetName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684350062"><span class="annot"><span class="annottext">LetDec rep
</span><a href="#local-6989586621684350062"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LetDec rep -&gt; NameInfo rep
forall rep. LetDec rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#LetName"><span class="hs-identifier hs-var">LetName</span></a></span><span> </span><span class="annot"><span class="annottext">LetDec rep
</span><a href="#local-6989586621684350062"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="#local-6989586621684350079"><span class="hs-identifier hs-var">unAlias</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#FParamName"><span class="hs-identifier hs-type">FParamName</span></a></span><span> </span><span id="local-6989586621684350060"><span class="annot"><span class="annottext">FParamInfo rep
</span><a href="#local-6989586621684350060"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FParamInfo rep -&gt; NameInfo rep
forall rep. FParamInfo rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#FParamName"><span class="hs-identifier hs-var">FParamName</span></a></span><span> </span><span class="annot"><span class="annottext">FParamInfo rep
FParamInfo rep
</span><a href="#local-6989586621684350060"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621684350079"><span class="hs-identifier hs-var">unAlias</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#LParamName"><span class="hs-identifier hs-type">LParamName</span></a></span><span> </span><span id="local-6989586621684350058"><span class="annot"><span class="annottext">LParamInfo rep
</span><a href="#local-6989586621684350058"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LParamInfo rep -&gt; NameInfo rep
forall rep. LParamInfo rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#LParamName"><span class="hs-identifier hs-var">LParamName</span></a></span><span> </span><span class="annot"><span class="annottext">LParamInfo rep
LParamInfo rep
</span><a href="#local-6989586621684350058"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="#local-6989586621684350079"><span class="hs-identifier hs-var">unAlias</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#IndexName"><span class="hs-identifier hs-type">IndexName</span></a></span><span> </span><span id="local-6989586621684350056"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684350056"><span class="hs-identifier hs-var">it</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; NameInfo rep
forall rep. IntType -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#IndexName"><span class="hs-identifier hs-var">IndexName</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684350056"><span class="hs-identifier hs-var">it</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621684350913"><span class="annot"><a href="Futhark.IR.Aliases.html#removeProgAliases"><span class="hs-identifier hs-type">removeProgAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350913"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350913"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350913"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-201"></span><span id="removeProgAliases"><span class="annot"><span class="annottext">removeProgAliases :: forall rep. CanBeAliased (Op rep) =&gt; Prog (Aliases rep) -&gt; Prog rep
</span><a href="Futhark.IR.Aliases.html#removeProgAliases"><span class="hs-identifier hs-var hs-var">removeProgAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Prog rep) -&gt; Prog rep
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Prog rep) -&gt; Prog rep)
-&gt; (Prog (Aliases rep) -&gt; Identity (Prog rep))
-&gt; Prog (Aliases rep)
-&gt; Prog rep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
-&gt; Prog (Aliases rep) -&gt; Identity (Prog rep)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Prog from -&gt; m (Prog to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseProg"><span class="hs-identifier hs-var">rephraseProg</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var">removeAliases</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621684350906"><span class="annot"><a href="Futhark.IR.Aliases.html#removeFunDefAliases"><span class="hs-identifier hs-type">removeFunDefAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350906"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350906"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350906"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-207"></span><span id="removeFunDefAliases"><span class="annot"><span class="annottext">removeFunDefAliases :: forall rep.
CanBeAliased (Op rep) =&gt;
FunDef (Aliases rep) -&gt; FunDef rep
</span><a href="Futhark.IR.Aliases.html#removeFunDefAliases"><span class="hs-identifier hs-var hs-var">removeFunDefAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (FunDef rep) -&gt; FunDef rep
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (FunDef rep) -&gt; FunDef rep)
-&gt; (FunDef (Aliases rep) -&gt; Identity (FunDef rep))
-&gt; FunDef (Aliases rep)
-&gt; FunDef rep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
-&gt; FunDef (Aliases rep) -&gt; Identity (FunDef rep)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; FunDef from -&gt; m (FunDef to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFunDef"><span class="hs-identifier hs-var">rephraseFunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var">removeAliases</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621684350951"><span class="annot"><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-type">removeExpAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350951"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350951"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350951"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-213"></span><span id="removeExpAliases"><span class="annot"><span class="annottext">removeExpAliases :: forall rep. CanBeAliased (Op rep) =&gt; Exp (Aliases rep) -&gt; Exp rep
</span><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-var hs-var">removeExpAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Exp rep) -&gt; Exp rep
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Exp rep) -&gt; Exp rep)
-&gt; (Exp (Aliases rep) -&gt; Identity (Exp rep))
-&gt; Exp (Aliases rep)
-&gt; Exp rep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
-&gt; Exp (Aliases rep) -&gt; Identity (Exp rep)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Exp from -&gt; m (Exp to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExp"><span class="hs-identifier hs-var">rephraseExp</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var">removeAliases</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span id="local-6989586621684350896"><span class="annot"><a href="Futhark.IR.Aliases.html#removeStmAliases"><span class="hs-identifier hs-type">removeStmAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350896"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350896"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350896"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-219"></span><span id="removeStmAliases"><span class="annot"><span class="annottext">removeStmAliases :: forall rep. CanBeAliased (Op rep) =&gt; Stm (Aliases rep) -&gt; Stm rep
</span><a href="Futhark.IR.Aliases.html#removeStmAliases"><span class="hs-identifier hs-var hs-var">removeStmAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Stm rep) -&gt; Stm rep
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Stm rep) -&gt; Stm rep)
-&gt; (Stm (Aliases rep) -&gt; Identity (Stm rep))
-&gt; Stm (Aliases rep)
-&gt; Stm rep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
-&gt; Stm (Aliases rep) -&gt; Identity (Stm rep)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier hs-var">rephraseStm</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var">removeAliases</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621684350890"><span class="annot"><a href="Futhark.IR.Aliases.html#removeLambdaAliases"><span class="hs-identifier hs-type">removeLambdaAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350890"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350890"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350890"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-225"></span><span id="removeLambdaAliases"><span class="annot"><span class="annottext">removeLambdaAliases :: forall rep.
CanBeAliased (Op rep) =&gt;
Lambda (Aliases rep) -&gt; Lambda rep
</span><a href="Futhark.IR.Aliases.html#removeLambdaAliases"><span class="hs-identifier hs-var hs-var">removeLambdaAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Lambda rep) -&gt; Lambda rep
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (Lambda rep) -&gt; Lambda rep)
-&gt; (Lambda (Aliases rep) -&gt; Identity (Lambda rep))
-&gt; Lambda (Aliases rep)
-&gt; Lambda rep
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
-&gt; Lambda (Aliases rep) -&gt; Identity (Lambda rep)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Lambda from -&gt; m (Lambda to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLambda"><span class="hs-identifier hs-var">rephraseLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser Identity (Aliases rep) rep
forall rep.
CanBeAliased (Op rep) =&gt;
Rephraser Identity (Aliases rep) rep
</span><a href="Futhark.IR.Aliases.html#removeAliases"><span class="hs-identifier hs-var">removeAliases</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621684350967"><span class="annot"><a href="Futhark.IR.Aliases.html#removePatAliases"><span class="hs-identifier hs-type">removePatAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-type">AliasDec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621684350967"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350967"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-230"></span><span id="removePatAliases"><span class="annot"><span class="annottext">removePatAliases :: forall a. PatT (AliasDec, a) -&gt; PatT a
</span><a href="Futhark.IR.Aliases.html#removePatAliases"><span class="hs-identifier hs-var hs-var">removePatAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (PatT a) -&gt; PatT a
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (PatT a) -&gt; PatT a)
-&gt; (PatT (AliasDec, a) -&gt; Identity (PatT a))
-&gt; PatT (AliasDec, a)
-&gt; PatT a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AliasDec, a) -&gt; Identity a)
-&gt; PatT (AliasDec, a) -&gt; Identity (PatT a)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; PatT from -&gt; m (PatT to)
</span><a href="Futhark.Analysis.Rephrase.html#rephrasePat"><span class="hs-identifier hs-var">rephrasePat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Identity a)
-&gt; ((AliasDec, a) -&gt; a) -&gt; (AliasDec, a) -&gt; Identity a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AliasDec, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621684350879"><span id="local-6989586621684350880"><span class="annot"><a href="Futhark.IR.Aliases.html#addAliasesToPat"><span class="hs-identifier hs-type">addAliasesToPat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350880"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350880"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350879"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350879"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350880"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-type">VarAliases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621684350879"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-237"></span><span id="addAliasesToPat"><span class="annot"><span class="annottext">addAliasesToPat :: forall rep dec.
(ASTRep rep, CanBeAliased (Op rep), Typed dec) =&gt;
PatT dec -&gt; Exp (Aliases rep) -&gt; PatT (AliasDec, dec)
</span><a href="Futhark.IR.Aliases.html#addAliasesToPat"><span class="hs-identifier hs-var hs-var">addAliasesToPat</span></a></span></span><span> </span><span id="local-6989586621684350018"><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684350018"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621684350017"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684350017"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">[PatElemT (AliasDec, dec)] -&gt; PatT (AliasDec, dec)
forall dec. [PatElemT dec] -&gt; PatT dec
</span><a href="Futhark.IR.Syntax.html#Pat"><span class="hs-identifier hs-var">Pat</span></a></span><span> </span><span class="annot"><span class="annottext">([PatElemT (AliasDec, dec)] -&gt; PatT (AliasDec, dec))
-&gt; [PatElemT (AliasDec, dec)] -&gt; PatT (AliasDec, dec)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatT dec -&gt; Exp (Aliases rep) -&gt; [PatElemT (AliasDec, dec)]
forall rep dec.
(Aliased rep, Typed dec) =&gt;
PatT dec -&gt; Exp rep -&gt; [PatElemT (AliasDec, dec)]
</span><a href="Futhark.IR.Aliases.html#mkPatAliases"><span class="hs-identifier hs-var">mkPatAliases</span></a></span><span> </span><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684350018"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684350017"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="local-6989586621684350872"><span class="annot"><a href="Futhark.IR.Aliases.html#mkAliasedBody"><span class="hs-identifier hs-type">mkAliasedBody</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350872"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350872"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-type">BodyDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350872"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stms"><span class="hs-identifier hs-type">Stms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350872"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350872"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-246"></span><span id="mkAliasedBody"><span class="annot"><span class="annottext">mkAliasedBody :: forall rep.
(ASTRep rep, CanBeAliased (Op rep)) =&gt;
BodyDec rep -&gt; Stms (Aliases rep) -&gt; Result -&gt; Body (Aliases rep)
</span><a href="Futhark.IR.Aliases.html#mkAliasedBody"><span class="hs-identifier hs-var hs-var">mkAliasedBody</span></a></span></span><span> </span><span id="local-6989586621684350008"><span class="annot"><span class="annottext">BodyDec rep
</span><a href="#local-6989586621684350008"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621684350007"><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684350007"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684350006"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684350006"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">BodyDec (Aliases rep)
-&gt; Stms (Aliases rep) -&gt; Result -&gt; BodyT (Aliases rep)
forall rep. BodyDec rep -&gt; Stms rep -&gt; Result -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stms (Aliases rep) -&gt; Result -&gt; BodyAliasing
forall rep. Aliased rep =&gt; Stms rep -&gt; Result -&gt; BodyAliasing
</span><a href="Futhark.IR.Aliases.html#mkBodyAliases"><span class="hs-identifier hs-var">mkBodyAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684350007"><span class="hs-identifier hs-var">stms</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684350006"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BodyDec rep
</span><a href="#local-6989586621684350008"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684350007"><span class="hs-identifier hs-var">stms</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684350006"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621684350873"><span id="local-6989586621684350874"><span class="annot"><a href="Futhark.IR.Aliases.html#mkPatAliases"><span class="hs-identifier hs-type">mkPatAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350874"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350873"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350873"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350874"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#PatElemT"><span class="hs-identifier hs-type">PatElemT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#VarAliases"><span class="hs-identifier hs-type">VarAliases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621684350873"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-254"></span><span id="mkPatAliases"><span class="annot"><span class="annottext">mkPatAliases :: forall rep dec.
(Aliased rep, Typed dec) =&gt;
PatT dec -&gt; Exp rep -&gt; [PatElemT (AliasDec, dec)]
</span><a href="Futhark.IR.Aliases.html#mkPatAliases"><span class="hs-identifier hs-var hs-var">mkPatAliases</span></a></span></span><span> </span><span id="local-6989586621684349999"><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684349999"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621684349998"><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684349998"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684349997"><span class="annot"><span class="annottext">als :: [Names]
</span><a href="#local-6989586621684349997"><span class="hs-identifier hs-var hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp rep -&gt; [Names]
forall rep. Aliased rep =&gt; Exp rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684349998"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Names] -&gt; [Names] -&gt; [Names]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [Names]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-256"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- In case the pattern has</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-comment">-- more elements (this</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-comment">-- implies a type error).</span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">(PatElemT dec -&gt; Names -&gt; PatElemT (AliasDec, dec))
-&gt; [PatElemT dec] -&gt; [Names] -&gt; [PatElemT (AliasDec, dec)]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">PatElemT dec -&gt; Names -&gt; PatElemT (AliasDec, dec)
forall {b}.
Typed b =&gt;
PatElemT b -&gt; Names -&gt; PatElemT (AliasDec, b)
</span><a href="#local-6989586621684349994"><span class="hs-identifier hs-var">annotatePatElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatT dec -&gt; [PatElemT dec]
forall dec. PatT dec -&gt; [PatElemT dec]
</span><a href="Futhark.IR.Syntax.html#patElems"><span class="hs-identifier hs-var hs-var">patElems</span></a></span><span> </span><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684349999"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684349997"><span class="hs-identifier hs-var">als</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621684349994"><span class="annot"><span class="annottext">annotatePatElem :: PatElemT b -&gt; Names -&gt; PatElemT (AliasDec, b)
</span><a href="#local-6989586621684349994"><span class="hs-identifier hs-var hs-var">annotatePatElem</span></a></span></span><span> </span><span id="local-6989586621684349989"><span class="annot"><span class="annottext">PatElemT b
</span><a href="#local-6989586621684349989"><span class="hs-identifier hs-var">bindee</span></a></span></span><span> </span><span id="local-6989586621684349988"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349988"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">PatElemT b
</span><a href="#local-6989586621684349989"><span class="hs-identifier hs-var">bindee</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT b -&gt; (AliasDec, b) -&gt; PatElemT (AliasDec, b)
forall oldattr newattr.
PatElemT oldattr -&gt; newattr -&gt; PatElemT newattr
</span><a href="Futhark.IR.Prop.Patterns.html#setPatElemDec"><span class="hs-operator hs-var">`setPatElemDec`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349986"><span class="hs-identifier hs-var">names'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PatElemT b -&gt; b
forall dec. PatElemT dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#patElemDec"><span class="hs-identifier hs-var hs-var">patElemDec</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT b
</span><a href="#local-6989586621684349989"><span class="hs-identifier hs-var">bindee</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621684349986"><span class="annot"><span class="annottext">names' :: Names
</span><a href="#local-6989586621684349986"><span class="hs-identifier hs-var hs-var">names'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PatElemT b -&gt; TypeBase Shape NoUniqueness
forall dec.
Typed dec =&gt;
PatElemT dec -&gt; TypeBase Shape NoUniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#patElemType"><span class="hs-identifier hs-var">patElemType</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT b
</span><a href="#local-6989586621684349989"><span class="hs-identifier hs-var">bindee</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349988"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Mem"><span class="hs-identifier hs-type">Mem</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349988"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><span class="annottext">TypeBase Shape NoUniqueness
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span id="local-6989586621684350868"><span class="annot"><a href="Futhark.IR.Aliases.html#mkBodyAliases"><span class="hs-identifier hs-type">mkBodyAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350868"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stms"><span class="hs-identifier hs-type">Stms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350868"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Futhark.IR.Aliases.html#BodyAliasing"><span class="hs-identifier hs-type">BodyAliasing</span></a></span></span><span>
</span><span id="line-275"></span><span id="mkBodyAliases"><span class="annot"><span class="annottext">mkBodyAliases :: forall rep. Aliased rep =&gt; Stms rep -&gt; Result -&gt; BodyAliasing
</span><a href="Futhark.IR.Aliases.html#mkBodyAliases"><span class="hs-identifier hs-var hs-var">mkBodyAliases</span></a></span></span><span> </span><span id="local-6989586621684349975"><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684349975"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684349974"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349974"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-comment">-- We need to remove the names that are bound in stms from the alias</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-comment">-- and consumption sets.  We do this by computing the transitive</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">-- closure of the alias map (within stms), then removing anything</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">-- bound in stms.</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349973"><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684349973"><span class="hs-identifier hs-var">aliases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684349972"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349972"><span class="hs-identifier hs-var">consumed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stms rep -&gt; Result -&gt; ([Names], Names)
forall rep. Aliased rep =&gt; Stms rep -&gt; Result -&gt; ([Names], Names)
</span><a href="Futhark.IR.Aliases.html#mkStmsAliases"><span class="hs-identifier hs-var">mkStmsAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684349975"><span class="hs-identifier hs-var">stms</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349974"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621684349971"><span class="annot"><span class="annottext">boundNames :: Names
</span><a href="#local-6989586621684349971"><span class="hs-identifier hs-var hs-var">boundNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Names) -&gt; Stms rep -&gt; Names
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Names) -&gt; (Stm rep -&gt; [VName]) -&gt; Stm rep -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; [VName])
-&gt; (Stm rep -&gt; PatT (LetDec rep)) -&gt; Stm rep -&gt; [VName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; PatT (LetDec rep)
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684349975"><span class="hs-identifier hs-var">stms</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621684349966"><span class="annot"><span class="annottext">aliases' :: [Names]
</span><a href="#local-6989586621684349966"><span class="hs-identifier hs-var hs-var">aliases'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; [Names] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesSubtract"><span class="hs-operator hs-var">`namesSubtract`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349971"><span class="hs-identifier hs-var">boundNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684349973"><span class="hs-identifier hs-var">aliases</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621684349964"><span class="annot"><span class="annottext">consumed' :: Names
</span><a href="#local-6989586621684349964"><span class="hs-identifier hs-var hs-var">consumed'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349972"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesSubtract"><span class="hs-operator hs-var">`namesSubtract`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349971"><span class="hs-identifier hs-var">boundNames</span></a></span><span>
</span><span id="line-284"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; [Names] -&gt; [AliasDec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684349966"><span class="hs-identifier hs-var">aliases'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349964"><span class="hs-identifier hs-var">consumed'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | The aliases of the result and everything consumed in the given</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- statements.</span><span>
</span><span id="line-288"></span><span id="local-6989586621684350854"><span class="annot"><a href="Futhark.IR.Aliases.html#mkStmsAliases"><span class="hs-identifier hs-type">mkStmsAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-289"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350854"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stms"><span class="hs-identifier hs-type">Stms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350854"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-293"></span><span id="mkStmsAliases"><span class="annot"><span class="annottext">mkStmsAliases :: forall rep. Aliased rep =&gt; Stms rep -&gt; Result -&gt; ([Names], Names)
</span><a href="Futhark.IR.Aliases.html#mkStmsAliases"><span class="hs-identifier hs-var hs-var">mkStmsAliases</span></a></span></span><span> </span><span id="local-6989586621684349954"><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684349954"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684349953"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349953"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AliasesAndConsumed -&gt; [Stm rep] -&gt; ([Names], Names)
</span><a href="#local-6989586621684349952"><span class="hs-identifier hs-var">delve</span></a></span><span> </span><span class="annot"><span class="annottext">AliasesAndConsumed
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">([Stm rep] -&gt; ([Names], Names)) -&gt; [Stm rep] -&gt; ([Names], Names)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stms rep -&gt; [Stm rep]
forall rep. Stms rep -&gt; [Stm rep]
</span><a href="Futhark.IR.Syntax.html#stmsToList"><span class="hs-identifier hs-var">stmsToList</span></a></span><span> </span><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684349954"><span class="hs-identifier hs-var">stms</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621684349952"><span class="annot"><span class="annottext">delve :: AliasesAndConsumed -&gt; [Stm rep] -&gt; ([Names], Names)
</span><a href="#local-6989586621684349952"><span class="hs-identifier hs-var hs-var">delve</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349950"><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349950"><span class="hs-identifier hs-var">aliasmap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684349949"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349949"><span class="hs-identifier hs-var">consumed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(SubExpRes -&gt; Names) -&gt; Result -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map VName Names -&gt; Names -&gt; Names
</span><a href="#local-6989586621684349948"><span class="hs-identifier hs-var">aliasClosure</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349950"><span class="hs-identifier hs-var">aliasmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; (SubExpRes -&gt; Names) -&gt; SubExpRes -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Names) -&gt; (SubExpRes -&gt; SubExp) -&gt; SubExpRes -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SubExpRes -&gt; SubExp
</span><a href="Futhark.IR.Syntax.html#resSubExp"><span class="hs-identifier hs-var hs-var">resSubExp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349953"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349949"><span class="hs-identifier hs-var">consumed</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="#local-6989586621684349952"><span class="hs-identifier hs-var">delve</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349945"><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349945"><span class="hs-identifier hs-var">aliasmap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684349944"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349944"><span class="hs-identifier hs-var">consumed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349943"><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684349943"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621684349942"><span class="annot"><span class="annottext">[Stm rep]
</span><a href="#local-6989586621684349942"><span class="hs-identifier hs-var">stms'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">AliasesAndConsumed -&gt; [Stm rep] -&gt; ([Names], Names)
</span><a href="#local-6989586621684349952"><span class="hs-identifier hs-var">delve</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AliasesAndConsumed -&gt; Stm rep -&gt; AliasesAndConsumed
forall rep.
Aliased rep =&gt;
AliasesAndConsumed -&gt; Stm rep -&gt; AliasesAndConsumed
</span><a href="Futhark.IR.Aliases.html#trackAliases"><span class="hs-identifier hs-var">trackAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349945"><span class="hs-identifier hs-var">aliasmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349944"><span class="hs-identifier hs-var">consumed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684349943"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Stm rep]
</span><a href="#local-6989586621684349942"><span class="hs-identifier hs-var">stms'</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621684349948"><span class="annot"><span class="annottext">aliasClosure :: Map VName Names -&gt; Names -&gt; Names
</span><a href="#local-6989586621684349948"><span class="hs-identifier hs-var hs-var">aliasClosure</span></a></span></span><span> </span><span id="local-6989586621684349937"><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349937"><span class="hs-identifier hs-var">aliasmap</span></a></span></span><span> </span><span id="local-6989586621684349936"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349936"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349936"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VName -&gt; Names) -&gt; [VName] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="#local-6989586621684349935"><span class="hs-identifier hs-var">look</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; [Names]) -&gt; [VName] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349936"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621684349935"><span class="annot"><span class="annottext">look :: VName -&gt; Names
</span><a href="#local-6989586621684349935"><span class="hs-identifier hs-var hs-var">look</span></a></span></span><span> </span><span id="local-6989586621684349934"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349934"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; VName -&gt; Map VName Names -&gt; Names
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">M.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349934"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349937"><span class="hs-identifier hs-var">aliasmap</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-keyword">type</span><span> </span><span id="AliasesAndConsumed"><span class="annot"><a href="Futhark.IR.Aliases.html#AliasesAndConsumed"><span class="hs-identifier hs-var">AliasesAndConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | The variables consumed in these statements.</span><span>
</span><span id="line-312"></span><span id="local-6989586621684350837"><span class="annot"><a href="Futhark.IR.Aliases.html#consumedInStms"><span class="hs-identifier hs-type">consumedInStms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350837"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stms"><span class="hs-identifier hs-type">Stms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350837"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-313"></span><span id="consumedInStms"><span class="annot"><span class="annottext">consumedInStms :: forall rep. Aliased rep =&gt; Stms rep -&gt; Names
</span><a href="Futhark.IR.Aliases.html#consumedInStms"><span class="hs-identifier hs-var hs-var">consumedInStms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Names], Names) -&gt; Names
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(([Names], Names) -&gt; Names)
-&gt; (Stms rep -&gt; ([Names], Names)) -&gt; Stms rep -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stms rep -&gt; Result -&gt; ([Names], Names))
-&gt; Result -&gt; Stms rep -&gt; ([Names], Names)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Stms rep -&gt; Result -&gt; ([Names], Names)
forall rep. Aliased rep =&gt; Stms rep -&gt; Result -&gt; ([Names], Names)
</span><a href="Futhark.IR.Aliases.html#mkStmsAliases"><span class="hs-identifier hs-var">mkStmsAliases</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span id="local-6989586621684350840"><span class="annot"><a href="Futhark.IR.Aliases.html#trackAliases"><span class="hs-identifier hs-type">trackAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350840"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasesAndConsumed"><span class="hs-identifier hs-type">AliasesAndConsumed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350840"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="Futhark.IR.Aliases.html#AliasesAndConsumed"><span class="hs-identifier hs-type">AliasesAndConsumed</span></a></span></span><span>
</span><span id="line-320"></span><span id="trackAliases"><span class="annot"><span class="annottext">trackAliases :: forall rep.
Aliased rep =&gt;
AliasesAndConsumed -&gt; Stm rep -&gt; AliasesAndConsumed
</span><a href="Futhark.IR.Aliases.html#trackAliases"><span class="hs-identifier hs-var hs-var">trackAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349913"><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349913"><span class="hs-identifier hs-var">aliasmap</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684349912"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349912"><span class="hs-identifier hs-var">consumed</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684349911"><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684349911"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684349910"><span class="annot"><span class="annottext">pat :: Pat rep
</span><a href="#local-6989586621684349910"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Pat rep
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684349911"><span class="hs-identifier hs-var">stm</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621684349909"><span class="annot"><span class="annottext">pe_als :: [(VName, Names)]
</span><a href="#local-6989586621684349909"><span class="hs-identifier hs-var hs-var">pe_als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">[VName] -&gt; [Names] -&gt; [(VName, Names)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat rep -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349910"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; [(VName, Names)]) -&gt; [Names] -&gt; [(VName, Names)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; [Names] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names
</span><a href="#local-6989586621684349908"><span class="hs-identifier hs-var">addAliasesOfAliases</span></a></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; [Names]) -&gt; [Names] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat rep -&gt; [Names]
forall dec. AliasesOf dec =&gt; PatT dec -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#patAliases"><span class="hs-identifier hs-var">patAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349910"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621684349906"><span class="annot"><span class="annottext">als :: Map VName Names
</span><a href="#local-6989586621684349906"><span class="hs-identifier hs-var hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(VName, Names)] -&gt; Map VName Names
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(VName, Names)]
</span><a href="#local-6989586621684349909"><span class="hs-identifier hs-var">pe_als</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span id="local-6989586621684349904"><span class="annot"><span class="annottext">rev_als :: Map VName Names
</span><a href="#local-6989586621684349904"><span class="hs-identifier hs-var hs-var">rev_als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((VName, Names) -&gt; Map VName Names)
-&gt; [(VName, Names)] -&gt; Map VName Names
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">(VName, Names) -&gt; Map VName Names
</span><a href="#local-6989586621684349903"><span class="hs-identifier hs-var">revAls</span></a></span><span> </span><span class="annot"><span class="annottext">[(VName, Names)]
</span><a href="#local-6989586621684349909"><span class="hs-identifier hs-var">pe_als</span></a></span><span>
</span><span id="line-326"></span><span>      </span><span id="local-6989586621684349903"><span class="annot"><span class="annottext">revAls :: (VName, Names) -&gt; Map VName Names
</span><a href="#local-6989586621684349903"><span class="hs-identifier hs-var hs-var">revAls</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684349901"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349901"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684349900"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349900"><span class="hs-identifier hs-var">v_als</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><span class="annottext">[(VName, Names)] -&gt; Map VName Names
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(VName, Names)] -&gt; Map VName Names)
-&gt; [(VName, Names)] -&gt; Map VName Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; (VName, Names)) -&gt; [VName] -&gt; [(VName, Names)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349901"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; [(VName, Names)]) -&gt; [VName] -&gt; [(VName, Names)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349900"><span class="hs-identifier hs-var">v_als</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span id="local-6989586621684349896"><span class="annot"><span class="annottext">comb :: Map VName Names -&gt; Map VName Names -&gt; Map VName Names
</span><a href="#local-6989586621684349896"><span class="hs-identifier hs-var hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names -&gt; Names)
-&gt; Map VName Names -&gt; Map VName Names -&gt; Map VName Names
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionWith</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-329"></span><span>      </span><span id="local-6989586621684349894"><span class="annot"><span class="annottext">aliasmap' :: Map VName Names
</span><a href="#local-6989586621684349894"><span class="hs-identifier hs-var hs-var">aliasmap'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349904"><span class="hs-identifier hs-var">rev_als</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names -&gt; Map VName Names -&gt; Map VName Names
</span><a href="#local-6989586621684349896"><span class="hs-operator hs-var">`comb`</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349906"><span class="hs-identifier hs-var">als</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names -&gt; Map VName Names -&gt; Map VName Names
</span><a href="#local-6989586621684349896"><span class="hs-operator hs-var">`comb`</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349913"><span class="hs-identifier hs-var">aliasmap</span></a></span><span>
</span><span id="line-330"></span><span>      </span><span id="local-6989586621684349893"><span class="annot"><span class="annottext">consumed' :: Names
</span><a href="#local-6989586621684349893"><span class="hs-identifier hs-var hs-var">consumed'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349912"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names
</span><a href="#local-6989586621684349908"><span class="hs-identifier hs-var">addAliasesOfAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stm rep -&gt; Names
forall rep. Aliased rep =&gt; Stm rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInStm"><span class="hs-identifier hs-var">consumedInStm</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684349911"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349894"><span class="hs-identifier hs-var">aliasmap'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349893"><span class="hs-identifier hs-var">consumed'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621684349908"><span class="annot"><span class="annottext">addAliasesOfAliases :: Names -&gt; Names
</span><a href="#local-6989586621684349908"><span class="hs-identifier hs-var hs-var">addAliasesOfAliases</span></a></span></span><span> </span><span id="local-6989586621684349891"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349891"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349891"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names
</span><a href="#local-6989586621684349890"><span class="hs-identifier hs-var">aliasesOfAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684349891"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621684349890"><span class="annot"><span class="annottext">aliasesOfAliases :: Names -&gt; Names
</span><a href="#local-6989586621684349890"><span class="hs-identifier hs-var hs-var">aliasesOfAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; Names) -&gt; (Names -&gt; [Names]) -&gt; Names -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Names) -&gt; [VName] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="#local-6989586621684349889"><span class="hs-identifier hs-var">look</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; [Names]) -&gt; (Names -&gt; [VName]) -&gt; Names -&gt; [Names]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621684349889"><span class="annot"><span class="annottext">look :: VName -&gt; Names
</span><a href="#local-6989586621684349889"><span class="hs-identifier hs-var hs-var">look</span></a></span></span><span> </span><span id="local-6989586621684349888"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349888"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; VName -&gt; Map VName Names -&gt; Names
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><span class="hs-identifier hs-var">M.findWithDefault</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684349888"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName Names
</span><a href="#local-6989586621684349913"><span class="hs-identifier hs-var">aliasmap</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621684350823"><span class="annot"><a href="Futhark.IR.Aliases.html#mkAliasedLetStm"><span class="hs-identifier hs-type">mkAliasedLetStm</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-type">StmAux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-type">ExpDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-341"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350823"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-343"></span><span id="mkAliasedLetStm"><span class="annot"><span class="annottext">mkAliasedLetStm :: forall rep.
(ASTRep rep, CanBeAliased (Op rep)) =&gt;
Pat rep
-&gt; StmAux (ExpDec rep) -&gt; Exp (Aliases rep) -&gt; Stm (Aliases rep)
</span><a href="Futhark.IR.Aliases.html#mkAliasedLetStm"><span class="hs-identifier hs-var hs-var">mkAliasedLetStm</span></a></span></span><span> </span><span id="local-6989586621684349873"><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349873"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-type">StmAux</span></a></span><span> </span><span id="local-6989586621684349871"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684349871"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621684349870"><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684349870"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621684349869"><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684349869"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684349868"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349868"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">Pat (Aliases rep)
-&gt; StmAux (ExpDec (Aliases rep))
-&gt; Exp (Aliases rep)
-&gt; Stm (Aliases rep)
forall rep. Pat rep -&gt; StmAux (ExpDec rep) -&gt; Exp rep -&gt; Stm rep
</span><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat rep -&gt; Exp (Aliases rep) -&gt; PatT (AliasDec, LetDec rep)
forall rep dec.
(ASTRep rep, CanBeAliased (Op rep), Typed dec) =&gt;
PatT dec -&gt; Exp (Aliases rep) -&gt; PatT (AliasDec, dec)
</span><a href="Futhark.IR.Aliases.html#addAliasesToPat"><span class="hs-identifier hs-var">addAliasesToPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349873"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349868"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs
-&gt; Attrs -&gt; (AliasDec, ExpDec rep) -&gt; StmAux (AliasDec, ExpDec rep)
forall dec. Certs -&gt; Attrs -&gt; dec -&gt; StmAux dec
</span><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-var">StmAux</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684349871"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684349870"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; Names -&gt; AliasDec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Names
forall rep. Aliased rep =&gt; Exp rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349868"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684349869"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349868"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span id="local-6989586621684350805"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Builder.Class.html#Buildable"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350805"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350805"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Builder.Class.html#Buildable"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350805"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621684349802"><span class="annot"><span class="annottext">mkExpDec :: Pat (Aliases rep) -&gt; Exp (Aliases rep) -&gt; ExpDec (Aliases rep)
</span><a href="Futhark.Builder.Class.html#mkExpDec"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkExpDec</span></a></span></span><span> </span><span id="local-6989586621684349800"><span class="annot"><span class="annottext">Pat (Aliases rep)
</span><a href="#local-6989586621684349800"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621684349799"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349799"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684349798"><span class="annot"><span class="annottext">dec :: ExpDec rep
</span><a href="#local-6989586621684349798"><span class="hs-identifier hs-var hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat rep -&gt; Exp rep -&gt; ExpDec rep
forall rep. Buildable rep =&gt; Pat rep -&gt; Exp rep -&gt; ExpDec rep
</span><a href="Futhark.Builder.Class.html#mkExpDec"><span class="hs-identifier hs-var">mkExpDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatT (AliasDec, LetDec rep) -&gt; Pat rep
forall a. PatT (AliasDec, a) -&gt; PatT a
</span><a href="Futhark.IR.Aliases.html#removePatAliases"><span class="hs-identifier hs-var">removePatAliases</span></a></span><span> </span><span class="annot"><span class="annottext">PatT (AliasDec, LetDec rep)
Pat (Aliases rep)
</span><a href="#local-6989586621684349800"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; ExpDec rep) -&gt; Exp rep -&gt; ExpDec rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Exp rep
forall rep. CanBeAliased (Op rep) =&gt; Exp (Aliases rep) -&gt; Exp rep
</span><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-var">removeExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349799"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-352"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; AliasDec
</span><a href="Futhark.IR.Aliases.html#AliasDec"><span class="hs-identifier hs-var">AliasDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; AliasDec) -&gt; Names -&gt; AliasDec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Names
forall rep. Aliased rep =&gt; Exp rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349799"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684349798"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621684349792"><span class="annot"><span class="annottext">mkExpPat :: [Ident] -&gt; Exp (Aliases rep) -&gt; Pat (Aliases rep)
</span><a href="Futhark.Builder.Class.html#mkExpPat"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkExpPat</span></a></span></span><span> </span><span id="local-6989586621684349790"><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621684349790"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span id="local-6989586621684349789"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349789"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">Pat rep -&gt; Exp (Aliases rep) -&gt; PatT (AliasDec, LetDec rep)
forall rep dec.
(ASTRep rep, CanBeAliased (Op rep), Typed dec) =&gt;
PatT dec -&gt; Exp (Aliases rep) -&gt; PatT (AliasDec, dec)
</span><a href="Futhark.IR.Aliases.html#addAliasesToPat"><span class="hs-identifier hs-var">addAliasesToPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ident] -&gt; Exp rep -&gt; Pat rep
forall rep. Buildable rep =&gt; [Ident] -&gt; Exp rep -&gt; Pat rep
</span><a href="Futhark.Builder.Class.html#mkExpPat"><span class="hs-identifier hs-var">mkExpPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Ident]
</span><a href="#local-6989586621684349790"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; Pat rep) -&gt; Exp rep -&gt; Pat rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Exp rep
forall rep. CanBeAliased (Op rep) =&gt; Exp (Aliases rep) -&gt; Exp rep
</span><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-var">removeExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349789"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349789"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621684349771"><span class="annot"><span class="annottext">mkLetNames :: forall (m :: * -&gt; *).
(MonadFreshNames m, HasScope (Aliases rep) m) =&gt;
[VName] -&gt; Exp (Aliases rep) -&gt; m (Stm (Aliases rep))
</span><a href="Futhark.Builder.Class.html#mkLetNames"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkLetNames</span></a></span></span><span> </span><span id="local-6989586621684349769"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684349769"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621684349768"><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349768"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621684349767"><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684349767"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Scope (Aliases rep) -&gt; Scope rep) -&gt; m (Scope rep)
forall rep (m :: * -&gt; *) a.
HasScope rep m =&gt;
(Scope rep -&gt; a) -&gt; m a
</span><a href="Futhark.IR.Prop.Scope.html#asksScope"><span class="hs-identifier hs-var">asksScope</span></a></span><span> </span><span class="annot"><span class="annottext">Scope (Aliases rep) -&gt; Scope rep
forall rep. Scope (Aliases rep) -&gt; Scope rep
</span><a href="Futhark.IR.Aliases.html#removeScopeAliases"><span class="hs-identifier hs-var">removeScopeAliases</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">(ReaderT (Scope rep) m (Stm (Aliases rep))
 -&gt; Scope rep -&gt; m (Stm (Aliases rep)))
-&gt; Scope rep
-&gt; ReaderT (Scope rep) m (Stm (Aliases rep))
-&gt; m (Stm (Aliases rep))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (Scope rep) m (Stm (Aliases rep))
-&gt; Scope rep -&gt; m (Stm (Aliases rep))
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684349767"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (Scope rep) m (Stm (Aliases rep))
 -&gt; m (Stm (Aliases rep)))
-&gt; ReaderT (Scope rep) m (Stm (Aliases rep))
-&gt; m (Stm (Aliases rep))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621684349766"><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349766"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621684349765"><span class="annot"><span class="annottext">StmAux (ExpDec rep)
</span><a href="#local-6989586621684349765"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Exp rep -&gt; ReaderT (Scope rep) m (Stm rep)
forall rep (m :: * -&gt; *).
(Buildable rep, MonadFreshNames m, HasScope rep m) =&gt;
[VName] -&gt; Exp rep -&gt; m (Stm rep)
</span><a href="Futhark.Builder.Class.html#mkLetNames"><span class="hs-identifier hs-var">mkLetNames</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684349769"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; ReaderT (Scope rep) m (Stm rep))
-&gt; Exp rep -&gt; ReaderT (Scope rep) m (Stm rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep) -&gt; Exp rep
forall rep. CanBeAliased (Op rep) =&gt; Exp (Aliases rep) -&gt; Exp rep
</span><a href="Futhark.IR.Aliases.html#removeExpAliases"><span class="hs-identifier hs-var">removeExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349768"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="annot"><span class="annottext">Stm (Aliases rep) -&gt; ReaderT (Scope rep) m (Stm (Aliases rep))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Stm (Aliases rep) -&gt; ReaderT (Scope rep) m (Stm (Aliases rep)))
-&gt; Stm (Aliases rep) -&gt; ReaderT (Scope rep) m (Stm (Aliases rep))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat rep
-&gt; StmAux (ExpDec rep) -&gt; Exp (Aliases rep) -&gt; Stm (Aliases rep)
forall rep.
(ASTRep rep, CanBeAliased (Op rep)) =&gt;
Pat rep
-&gt; StmAux (ExpDec rep) -&gt; Exp (Aliases rep) -&gt; Stm (Aliases rep)
</span><a href="Futhark.IR.Aliases.html#mkAliasedLetStm"><span class="hs-identifier hs-var">mkAliasedLetStm</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684349766"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">StmAux (ExpDec rep)
</span><a href="#local-6989586621684349765"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">Exp (Aliases rep)
</span><a href="#local-6989586621684349768"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621684349758"><span class="annot"><span class="annottext">mkBody :: Stms (Aliases rep) -&gt; Result -&gt; Body (Aliases rep)
</span><a href="Futhark.Builder.Class.html#mkBody"><span class="hs-identifier hs-var hs-var hs-var hs-var">mkBody</span></a></span></span><span> </span><span id="local-6989586621684349756"><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684349756"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684349755"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349755"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span id="local-6989586621684349754"><span class="annot"><span class="annottext">BodyDec rep
</span><a href="#local-6989586621684349754"><span class="hs-identifier hs-var">bodyrep</span></a></span></span><span> </span><span class="annot"><span class="annottext">Stms rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stms rep -&gt; Result -&gt; BodyT rep
forall rep. Buildable rep =&gt; Stms rep -&gt; Result -&gt; Body rep
</span><a href="Futhark.Builder.Class.html#mkBody"><span class="hs-identifier hs-var">mkBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stm (Aliases rep) -&gt; Stm rep) -&gt; Stms (Aliases rep) -&gt; Stms rep
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Stm (Aliases rep) -&gt; Stm rep
forall rep. CanBeAliased (Op rep) =&gt; Stm (Aliases rep) -&gt; Stm rep
</span><a href="Futhark.IR.Aliases.html#removeStmAliases"><span class="hs-identifier hs-var">removeStmAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684349756"><span class="hs-identifier hs-var">stms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349755"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-365"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BodyDec rep -&gt; Stms (Aliases rep) -&gt; Result -&gt; Body (Aliases rep)
forall rep.
(ASTRep rep, CanBeAliased (Op rep)) =&gt;
BodyDec rep -&gt; Stms (Aliases rep) -&gt; Result -&gt; Body (Aliases rep)
</span><a href="Futhark.IR.Aliases.html#mkAliasedBody"><span class="hs-identifier hs-var">mkAliasedBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyDec rep
</span><a href="#local-6989586621684349754"><span class="hs-identifier hs-var">bodyrep</span></a></span><span> </span><span class="annot"><span class="annottext">Stms (Aliases rep)
</span><a href="#local-6989586621684349756"><span class="hs-identifier hs-var">stms</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684349755"><span class="hs-identifier hs-var">res</span></a></span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span id="local-6989586621684350793"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684349746"><span id="local-6989586621684349748"><span id="local-6989586621684349750"><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350793"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Builder.Class.html#Buildable"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350793"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Builder.html#BuilderOps"><span class="hs-identifier hs-type">BuilderOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Aliases.html#Aliases"><span class="hs-identifier hs-type">Aliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684350793"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-368"></span></pre></body></html>