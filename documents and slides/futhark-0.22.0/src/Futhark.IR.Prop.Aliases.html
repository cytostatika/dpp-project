<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | The IR tracks aliases, mostly to ensure the soundness of in-place</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- updates, but it can also be used for other things (such as memory</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- optimisations).  This module contains the raw building blocks for</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- determining the aliases of the values produced by expressions.  It</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- also contains some building blocks for inspecting consumption.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- One important caveat is that all aliases computed here are /local/.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Thus, they do not take aliases-of-aliases into account.  See</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- &quot;Futhark.Analysis.Alias&quot; if this is not what you want.</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.IR.Prop.Aliases</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier">subExpAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier">expAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#patAliases"><span class="hs-identifier">patAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#lookupAliases"><span class="hs-identifier">lookupAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier">Aliased</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier">AliasesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Consumption</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInStm"><span class="hs-identifier">consumedInStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier">consumedInExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedByLambda"><span class="hs-identifier">consumedByLambda</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extensibility</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasTable"><span class="hs-identifier">AliasTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasedOp"><span class="hs-identifier">AliasedOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html"><span class="hs-identifier">Futhark.IR.Prop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier">IsOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#NameInfo"><span class="hs-identifier">NameInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier">Scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Patterns.html"><span class="hs-identifier">Futhark.IR.Prop.Patterns</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html"><span class="hs-identifier">Futhark.IR.Prop.Types</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html"><span class="hs-identifier">Futhark.IR.Syntax</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | The class of representations that contain aliasing information.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#RepTypes"><span class="hs-identifier hs-type">RepTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasedOp"><span class="hs-identifier hs-type">AliasedOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Aliased"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-var">Aliased</span></a></span></span><span> </span><span id="local-6989586621684346052"><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-comment">-- | The aliases of the body results.</span><span>
</span><span id="line-47"></span><span>  </span><span id="bodyAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-type">bodyAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">-- | The variables consumed in the body.</span><span>
</span><span id="line-50"></span><span>  </span><span id="consumedInBody"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-type">consumedInBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346052"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-type">vnameAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-53"></span><span id="vnameAliases"><span class="annot"><span class="annottext">vnameAliases :: VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var hs-var">vnameAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | The alises of a subexpression.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-type">subExpAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-57"></span><span id="subExpAliases"><span class="annot"><span class="annottext">subExpAliases :: SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var hs-var">subExpAliases</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345855"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345855"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345855"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-type">basicOpAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="basicOpAliases"><span class="annot"><span class="annottext">basicOpAliases :: BasicOp -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var hs-var">basicOpAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span id="local-6989586621684345852"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345852"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345852"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Opaque"><span class="hs-identifier hs-type">Opaque</span></a></span><span> </span><span class="annot"><span class="annottext">OpaqueOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345850"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345850"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345850"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#ArrayLit"><span class="hs-identifier hs-type">ArrayLit</span></a></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#ConvOp"><span class="hs-identifier hs-type">ConvOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#CmpOp"><span class="hs-identifier hs-type">CmpOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#UnOp"><span class="hs-identifier hs-type">UnOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span id="local-6989586621684345843"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345843"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span class="annot"><span class="annottext">Slice SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345843"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#FlatIndex"><span class="hs-identifier hs-type">FlatIndex</span></a></span><span> </span><span id="local-6989586621684345840"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345840"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span class="annot"><span class="annottext">FlatSlice SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345840"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#FlatUpdate"><span class="hs-identifier hs-type">FlatUpdate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Iota"><span class="hs-identifier hs-type">Iota</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Replicate"><span class="hs-identifier hs-type">Replicate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Scratch"><span class="hs-identifier hs-type">Scratch</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Reshape"><span class="hs-identifier hs-type">Reshape</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeChange SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345834"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345834"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345834"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Rearrange"><span class="hs-identifier hs-type">Rearrange</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345832"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345832"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345832"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Rotate"><span class="hs-identifier hs-type">Rotate</span></a></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345830"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345830"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#vnameAliases"><span class="hs-identifier hs-var">vnameAliases</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345830"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Concat"><span class="hs-identifier hs-type">Concat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Copy"><span class="hs-identifier hs-type">Copy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Manifest"><span class="hs-identifier hs-type">Manifest</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Assert"><span class="hs-identifier hs-type">Assert</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#UpdateAcc"><span class="hs-identifier hs-type">UpdateAcc</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#ifAliases"><span class="hs-identifier hs-type">ifAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span id="ifAliases"><span class="annot"><span class="annottext">ifAliases :: ([Names], Names) -&gt; ([Names], Names) -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#ifAliases"><span class="hs-identifier hs-var hs-var">ifAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345823"><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345823"><span class="hs-identifier hs-var">als1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345822"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345822"><span class="hs-identifier hs-var">cons1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345821"><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345821"><span class="hs-identifier hs-var">als2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345820"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345820"><span class="hs-identifier hs-var">cons2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; [Names] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesSubtract"><span class="hs-operator hs-var">`namesSubtract`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345818"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; [Names]) -&gt; [Names] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names -&gt; Names) -&gt; [Names] -&gt; [Names] -&gt; [Names]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345823"><span class="hs-identifier hs-var">als1</span></a></span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345821"><span class="hs-identifier hs-var">als2</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621684345818"><span class="annot"><span class="annottext">cons :: Names
</span><a href="#local-6989586621684345818"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345822"><span class="hs-identifier hs-var">cons1</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345820"><span class="hs-identifier hs-var">cons2</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621684346026"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#funcallAliases"><span class="hs-identifier hs-type">funcallAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Diet"><span class="hs-identifier hs-type">Diet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#TypeBase"><span class="hs-identifier hs-type">TypeBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346026"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Uniqueness"><span class="hs-identifier hs-type">Uniqueness</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-91"></span><span id="funcallAliases"><span class="annot"><span class="annottext">funcallAliases :: forall shape.
[(SubExp, Diet)] -&gt; [TypeBase shape Uniqueness] -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#funcallAliases"><span class="hs-identifier hs-var hs-var">funcallAliases</span></a></span></span><span> </span><span id="local-6989586621684345815"><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345815"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621684345814"><span class="annot"><span class="annottext">[TypeBase shape Uniqueness]
</span><a href="#local-6989586621684345814"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">[TypeBase shape Uniqueness] -&gt; [(Names, Diet)] -&gt; [Names]
forall shape.
[TypeBase shape Uniqueness] -&gt; [(Names, Diet)] -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#returnAliases"><span class="hs-identifier hs-var">returnAliases</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeBase shape Uniqueness]
</span><a href="#local-6989586621684345814"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345812"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Diet
</span><a href="#local-6989586621684345811"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345812"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684345812"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345811"><span class="annot"><span class="annottext">Diet
</span><a href="#local-6989586621684345811"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345815"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | The aliases of an expression, one per non-context value returned.</span><span>
</span><span id="line-95"></span><span id="local-6989586621684346021"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-type">expAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346021"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346021"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-96"></span><span id="expAliases"><span class="annot"><span class="annottext">expAliases :: forall rep. Aliased rep =&gt; Exp rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var hs-var">expAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345764"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345764"><span class="hs-identifier hs-var">tb</span></a></span></span><span> </span><span id="local-6989586621684345763"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345763"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621684345762"><span class="annot"><span class="annottext">IfDec (BranchType rep)
</span><a href="#local-6989586621684345762"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; [Names] -&gt; [Names]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Names] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345759"><span class="hs-identifier hs-var">all_aliases</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[BranchType rep] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[BranchType rep]
</span><a href="#local-6989586621684345758"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345759"><span class="hs-identifier hs-var">all_aliases</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621684345758"><span class="annot"><span class="annottext">ts :: [BranchType rep]
</span><a href="#local-6989586621684345758"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IfDec (BranchType rep) -&gt; [BranchType rep]
forall rt. IfDec rt -&gt; [rt]
</span><a href="Futhark.IR.Syntax.html#ifReturns"><span class="hs-identifier hs-var hs-var">ifReturns</span></a></span><span> </span><span class="annot"><span class="annottext">IfDec (BranchType rep)
</span><a href="#local-6989586621684345762"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621684345759"><span class="annot"><span class="annottext">all_aliases :: [Names]
</span><a href="#local-6989586621684345759"><span class="hs-identifier hs-var hs-var">all_aliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">([Names], Names) -&gt; ([Names], Names) -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#ifAliases"><span class="hs-identifier hs-var">ifAliases</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [Names]
forall rep. Aliased rep =&gt; Body rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var">bodyAliases</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345764"><span class="hs-identifier hs-var">tb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345764"><span class="hs-identifier hs-var">tb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [Names]
forall rep. Aliased rep =&gt; Body rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var">bodyAliases</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345763"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345763"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span id="local-6989586621684345755"><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345755"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BasicOp -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#basicOpAliases"><span class="hs-identifier hs-var">basicOpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345755"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#DoLoop"><span class="hs-identifier hs-type">DoLoop</span></a></span><span> </span><span id="local-6989586621684345753"><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><a href="#local-6989586621684345753"><span class="hs-identifier hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">LoopForm rep
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345752"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345752"><span class="hs-identifier hs-var">loopbody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621684345751"><span class="annot"><span class="annottext">FParam rep
</span><a href="#local-6989586621684345751"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345750"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345750"><span class="hs-identifier hs-var">als</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">[(FParam rep, Names)] -&gt; [(FParam rep, Names)]
forall {dec}.
Eq dec =&gt;
[(Param dec, Names)] -&gt; [(Param dec, Names)]
</span><a href="#local-6989586621684345749"><span class="hs-identifier hs-var">transitive</span></a></span><span> </span><span class="annot"><span class="annottext">([(FParam rep, Names)] -&gt; [(FParam rep, Names)])
-&gt; ([Names] -&gt; [(FParam rep, Names)])
-&gt; [Names]
-&gt; [(FParam rep, Names)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[FParam rep] -&gt; [Names] -&gt; [(FParam rep, Names)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[FParam rep]
</span><a href="#local-6989586621684345747"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; [(FParam rep, Names)])
-&gt; [Names] -&gt; [(FParam rep, Names)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names -&gt; Names) -&gt; [Names] -&gt; [Names] -&gt; [Names]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">[Names]
</span><a href="#local-6989586621684345746"><span class="hs-identifier hs-var">arg_aliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [Names]
forall rep. Aliased rep =&gt; Body rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var">bodyAliases</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345752"><span class="hs-identifier hs-var">loopbody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684345745"><span class="annot"><span class="annottext">als' :: Names
</span><a href="#local-6989586621684345745"><span class="hs-identifier hs-var hs-var">als'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345750"><span class="hs-identifier hs-var">als</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesSubtract"><span class="hs-operator hs-var">`namesSubtract`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345744"><span class="hs-identifier hs-var">param_names</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TypeBase Shape Uniqueness -&gt; Bool
forall shape. TypeBase shape Uniqueness -&gt; Bool
</span><a href="Futhark.IR.Prop.Types.html#unique"><span class="hs-identifier hs-var">unique</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeBase Shape Uniqueness -&gt; Bool)
-&gt; TypeBase Shape Uniqueness -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; TypeBase Shape Uniqueness
forall dec. DeclTyped dec =&gt; Param dec -&gt; TypeBase Shape Uniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#paramDeclType"><span class="hs-identifier hs-var">paramDeclType</span></a></span><span> </span><span class="annot"><span class="annottext">FParam rep
</span><a href="#local-6989586621684345751"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Names -&gt; [Names]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Names -&gt; [Names]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345745"><span class="hs-identifier hs-var">als'</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621684345746"><span class="annot"><span class="annottext">arg_aliases :: [Names]
</span><a href="#local-6989586621684345746"><span class="hs-identifier hs-var hs-var">arg_aliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FParam rep, SubExp) -&gt; Names)
-&gt; [(FParam rep, SubExp)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Names)
-&gt; ((FParam rep, SubExp) -&gt; SubExp)
-&gt; (FParam rep, SubExp)
-&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FParam rep, SubExp) -&gt; SubExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><a href="#local-6989586621684345753"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621684345747"><span class="annot"><span class="annottext">params :: [FParam rep]
</span><a href="#local-6989586621684345747"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FParam rep, SubExp) -&gt; FParam rep)
-&gt; [(FParam rep, SubExp)] -&gt; [FParam rep]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FParam rep, SubExp) -&gt; FParam rep
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><a href="#local-6989586621684345753"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621684345744"><span class="annot"><span class="annottext">param_names :: Names
</span><a href="#local-6989586621684345744"><span class="hs-identifier hs-var hs-var">param_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Names) -&gt; [VName] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FParam rep -&gt; VName) -&gt; [FParam rep] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">[FParam rep]
</span><a href="#local-6989586621684345747"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621684345749"><span class="annot"><span class="annottext">transitive :: [(Param dec, Names)] -&gt; [(Param dec, Names)]
</span><a href="#local-6989586621684345749"><span class="hs-identifier hs-var hs-var">transitive</span></a></span></span><span> </span><span id="local-6989586621684345720"><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345720"><span class="hs-identifier hs-var">merge_and_als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684345719"><span class="annot"><span class="annottext">merge_and_als' :: [(Param dec, Names)]
</span><a href="#local-6989586621684345719"><span class="hs-identifier hs-var hs-var">merge_and_als'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Param dec, Names) -&gt; (Param dec, Names))
-&gt; [(Param dec, Names)] -&gt; [(Param dec, Names)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; (Param dec, Names) -&gt; (Param dec, Names)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names
</span><a href="#local-6989586621684345718"><span class="hs-identifier hs-var">expand</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345720"><span class="hs-identifier hs-var">merge_and_als</span></a></span><span>
</span><span id="line-118"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345719"><span class="hs-identifier hs-var">merge_and_als'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)] -&gt; [(Param dec, Names)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345720"><span class="hs-identifier hs-var">merge_and_als</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345720"><span class="hs-identifier hs-var">merge_and_als</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)] -&gt; [(Param dec, Names)]
</span><a href="#local-6989586621684345749"><span class="hs-identifier hs-var">transitive</span></a></span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345719"><span class="hs-identifier hs-var">merge_and_als'</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>        </span><span id="local-6989586621684345717"><span class="annot"><span class="annottext">look :: VName -&gt; Names
</span><a href="#local-6989586621684345717"><span class="hs-identifier hs-var hs-var">look</span></a></span></span><span> </span><span id="local-6989586621684345716"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345716"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
-&gt; ((Param dec, Names) -&gt; Names)
-&gt; Maybe (Param dec, Names)
-&gt; Names
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Param dec, Names) -&gt; Names
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Param dec, Names) -&gt; Names)
-&gt; Maybe (Param dec, Names) -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Param dec, Names) -&gt; Bool)
-&gt; [(Param dec, Names)] -&gt; Maybe (Param dec, Names)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345716"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Bool)
-&gt; ((Param dec, Names) -&gt; VName) -&gt; (Param dec, Names) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">(Param dec -&gt; VName)
-&gt; ((Param dec, Names) -&gt; Param dec) -&gt; (Param dec, Names) -&gt; VName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Param dec, Names) -&gt; Param dec
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Param dec, Names)]
</span><a href="#local-6989586621684345720"><span class="hs-identifier hs-var">merge_and_als</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span id="local-6989586621684345718"><span class="annot"><span class="annottext">expand :: Names -&gt; Names
</span><a href="#local-6989586621684345718"><span class="hs-identifier hs-var hs-var">expand</span></a></span></span><span> </span><span id="local-6989586621684345714"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345714"><span class="hs-identifier hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345714"><span class="hs-identifier hs-var">als</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Names) -&gt; [VName] -&gt; Names
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="#local-6989586621684345717"><span class="hs-identifier hs-var">look</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345714"><span class="hs-identifier hs-var">als</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345710"><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345710"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621684345709"><span class="annot"><span class="annottext">[RetType rep]
</span><a href="#local-6989586621684345709"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="annottext">(Safety, SrcLoc, [SrcLoc])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">[(SubExp, Diet)] -&gt; [TypeBase ExtShape Uniqueness] -&gt; [Names]
forall shape.
[(SubExp, Diet)] -&gt; [TypeBase shape Uniqueness] -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#funcallAliases"><span class="hs-identifier hs-var">funcallAliases</span></a></span><span> </span><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345710"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">([TypeBase ExtShape Uniqueness] -&gt; [Names])
-&gt; [TypeBase ExtShape Uniqueness] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RetType rep -&gt; TypeBase ExtShape Uniqueness)
-&gt; [RetType rep] -&gt; [TypeBase ExtShape Uniqueness]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">RetType rep -&gt; TypeBase ExtShape Uniqueness
forall t. DeclExtTyped t =&gt; t -&gt; TypeBase ExtShape Uniqueness
</span><a href="Futhark.IR.Prop.Types.html#declExtTypeOf"><span class="hs-identifier hs-var">declExtTypeOf</span></a></span><span> </span><span class="annot"><span class="annottext">[RetType rep]
</span><a href="#local-6989586621684345709"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#WithAcc"><span class="hs-identifier hs-type">WithAcc</span></a></span><span> </span><span id="local-6989586621684345706"><span class="annot"><span class="annottext">[WithAccInput rep]
</span><a href="#local-6989586621684345706"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span id="local-6989586621684345705"><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345705"><span class="hs-identifier hs-var">lam</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">(WithAccInput rep -&gt; [Names]) -&gt; [WithAccInput rep] -&gt; [Names]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">WithAccInput rep -&gt; [Names]
forall {t :: * -&gt; *} {a} {a} {a} {c}.
(Foldable t, Monoid a) =&gt;
(a, t a, c) -&gt; [a]
</span><a href="#local-6989586621684345703"><span class="hs-identifier hs-var">inputAliases</span></a></span><span> </span><span class="annot"><span class="annottext">[WithAccInput rep]
</span><a href="#local-6989586621684345706"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">[Names] -&gt; [Names] -&gt; [Names]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Names] -&gt; [Names]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345702"><span class="hs-identifier hs-var">num_accs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [Names]
forall rep. Aliased rep =&gt; Body rep -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#bodyAliases"><span class="hs-identifier hs-var">bodyAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; BodyT rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345705"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621684345703"><span class="annot"><span class="annottext">inputAliases :: (a, t a, c) -&gt; [a]
</span><a href="#local-6989586621684345703"><span class="hs-identifier hs-var hs-var">inputAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345696"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621684345696"><span class="hs-identifier hs-var">arrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; [a]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621684345696"><span class="hs-identifier hs-var">arrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621684345702"><span class="annot"><span class="annottext">num_accs :: Int
</span><a href="#local-6989586621684345702"><span class="hs-identifier hs-var hs-var">num_accs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WithAccInput rep] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[WithAccInput rep]
</span><a href="#local-6989586621684345706"><span class="hs-identifier hs-var">inputs</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#expAliases"><span class="hs-identifier hs-var">expAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684345693"><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345693"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Op rep -&gt; [Names]
forall op. AliasedOp op =&gt; op -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#opAliases"><span class="hs-identifier hs-var">opAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345693"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621684346022"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#returnAliases"><span class="hs-identifier hs-type">returnAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#TypeBase"><span class="hs-identifier hs-type">TypeBase</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346022"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Uniqueness"><span class="hs-identifier hs-type">Uniqueness</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Diet"><span class="hs-identifier hs-type">Diet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-134"></span><span id="returnAliases"><span class="annot"><span class="annottext">returnAliases :: forall shape.
[TypeBase shape Uniqueness] -&gt; [(Names, Diet)] -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#returnAliases"><span class="hs-identifier hs-var hs-var">returnAliases</span></a></span></span><span> </span><span id="local-6989586621684345685"><span class="annot"><span class="annottext">[TypeBase shape Uniqueness]
</span><a href="#local-6989586621684345685"><span class="hs-identifier hs-var">rts</span></a></span></span><span> </span><span id="local-6989586621684345684"><span class="annot"><span class="annottext">[(Names, Diet)]
</span><a href="#local-6989586621684345684"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TypeBase shape Uniqueness -&gt; Names)
-&gt; [TypeBase shape Uniqueness] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TypeBase shape Uniqueness -&gt; Names
</span><a href="#local-6989586621684345683"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeBase shape Uniqueness]
</span><a href="#local-6989586621684345685"><span class="hs-identifier hs-var">rts</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621684345683"><span class="annot"><span class="annottext">returnType' :: TypeBase shape Uniqueness -&gt; Names
</span><a href="#local-6989586621684345683"><span class="hs-identifier hs-var hs-var">returnType'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shape
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><a href="Language.Futhark.Core.html#Nonunique"><span class="hs-identifier hs-var">Nonunique</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; Names) -&gt; [Names] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Names, Diet) -&gt; Names) -&gt; [(Names, Diet)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Names -&gt; Diet -&gt; Names) -&gt; (Names, Diet) -&gt; Names
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Diet -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-var">maskAliases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Names, Diet)]
</span><a href="#local-6989586621684345684"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="#local-6989586621684345683"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Array"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shape
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><a href="Language.Futhark.Core.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="#local-6989586621684345683"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="#local-6989586621684345683"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Acc"><span class="hs-identifier hs-type">Acc</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Names
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;returnAliases Acc&quot;</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="#local-6989586621684345683"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Mem"><span class="hs-identifier hs-type">Mem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; Names) -&gt; [Names] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Names, Diet) -&gt; Names) -&gt; [(Names, Diet)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Names -&gt; Diet -&gt; Names) -&gt; (Names, Diet) -&gt; Names
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Diet -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-var">maskAliases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Names, Diet)]
</span><a href="#local-6989586621684345684"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-type">maskAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Diet"><span class="hs-identifier hs-type">Diet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-148"></span><span id="maskAliases"><span class="annot"><span class="annottext">maskAliases :: Names -&gt; Diet -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-var hs-var">maskAliases</span></a></span></span><span> </span><span class="annot"><span class="annottext">Names
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Diet
</span><a href="Futhark.IR.Syntax.Core.html#Consume"><span class="hs-identifier hs-var">Consume</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-149"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-var">maskAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Diet
</span><a href="Futhark.IR.Syntax.Core.html#ObservePrim"><span class="hs-identifier hs-var">ObservePrim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#maskAliases"><span class="hs-identifier hs-var">maskAliases</span></a></span><span> </span><span id="local-6989586621684345671"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345671"><span class="hs-identifier hs-var">als</span></a></span></span><span> </span><span class="annot"><span class="annottext">Diet
</span><a href="Futhark.IR.Syntax.Core.html#Observe"><span class="hs-identifier hs-var">Observe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345671"><span class="hs-identifier hs-var">als</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | The variables consumed in this statement.</span><span>
</span><span id="line-153"></span><span id="local-6989586621684345939"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInStm"><span class="hs-identifier hs-type">consumedInStm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345939"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345939"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-154"></span><span id="consumedInStm"><span class="annot"><span class="annottext">consumedInStm :: forall rep. Aliased rep =&gt; Stm rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInStm"><span class="hs-identifier hs-var hs-var">consumedInStm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp rep -&gt; Names
forall rep. Aliased rep =&gt; Exp rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; Names) -&gt; (Stm rep -&gt; Exp rep) -&gt; Stm rep -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Exp rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | The variables consumed in this expression.</span><span>
</span><span id="line-157"></span><span id="local-6989586621684345936"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-type">consumedInExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345936"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345936"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-158"></span><span id="consumedInExp"><span class="annot"><span class="annottext">consumedInExp :: forall rep. Aliased rep =&gt; Exp rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var hs-var">consumedInExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345641"><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345641"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">[RetType rep]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Safety, SrcLoc, [SrcLoc])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((SubExp, Diet) -&gt; Names) -&gt; [(SubExp, Diet)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Names, Diet) -&gt; Names
forall {a}. Monoid a =&gt; (a, Diet) -&gt; a
</span><a href="#local-6989586621684345640"><span class="hs-identifier hs-var">consumeArg</span></a></span><span> </span><span class="annot"><span class="annottext">((Names, Diet) -&gt; Names)
-&gt; ((SubExp, Diet) -&gt; (Names, Diet)) -&gt; (SubExp, Diet) -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Names) -&gt; (SubExp, Diet) -&gt; (Names, Diet)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><a href="#local-6989586621684345641"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621684345640"><span class="annot"><span class="annottext">consumeArg :: (a, Diet) -&gt; a
</span><a href="#local-6989586621684345640"><span class="hs-identifier hs-var hs-var">consumeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345637"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684345637"><span class="hs-identifier hs-var">als</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Diet
</span><a href="Futhark.IR.Syntax.Core.html#Consume"><span class="hs-identifier hs-var">Consume</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684345637"><span class="hs-identifier hs-var">als</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="#local-6989586621684345640"><span class="hs-identifier hs-var">consumeArg</span></a></span><span> </span><span class="annot"><span class="annottext">(a, Diet)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345636"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345636"><span class="hs-identifier hs-var">tb</span></a></span></span><span> </span><span id="local-6989586621684345635"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345635"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="annot"><span class="annottext">IfDec (BranchType rep)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">BodyT rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345636"><span class="hs-identifier hs-var">tb</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345635"><span class="hs-identifier hs-var">fb</span></a></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#DoLoop"><span class="hs-identifier hs-type">DoLoop</span></a></span><span> </span><span id="local-6989586621684345634"><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><a href="#local-6989586621684345634"><span class="hs-identifier hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621684345633"><span class="annot"><span class="annottext">LoopForm rep
</span><a href="#local-6989586621684345633"><span class="hs-identifier hs-var">form</span></a></span></span><span> </span><span id="local-6989586621684345632"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345632"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">((FParam rep, SubExp) -&gt; Names)
-&gt; [(FParam rep, SubExp)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubExp -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#subExpAliases"><span class="hs-identifier hs-var">subExpAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Names)
-&gt; ((FParam rep, SubExp) -&gt; SubExp)
-&gt; (FParam rep, SubExp)
-&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FParam rep, SubExp) -&gt; SubExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(FParam rep, SubExp)] -&gt; [Names])
-&gt; [(FParam rep, SubExp)] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">((FParam rep, SubExp) -&gt; Bool)
-&gt; [(FParam rep, SubExp)] -&gt; [(FParam rep, SubExp)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeBase Shape Uniqueness -&gt; Bool
forall shape. TypeBase shape Uniqueness -&gt; Bool
</span><a href="Futhark.IR.Prop.Types.html#unique"><span class="hs-identifier hs-var">unique</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeBase Shape Uniqueness -&gt; Bool)
-&gt; ((FParam rep, SubExp) -&gt; TypeBase Shape Uniqueness)
-&gt; (FParam rep, SubExp)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; TypeBase Shape Uniqueness
forall dec. DeclTyped dec =&gt; Param dec -&gt; TypeBase Shape Uniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#paramDeclType"><span class="hs-identifier hs-var">paramDeclType</span></a></span><span> </span><span class="annot"><span class="annottext">(FParam rep -&gt; TypeBase Shape Uniqueness)
-&gt; ((FParam rep, SubExp) -&gt; FParam rep)
-&gt; (FParam rep, SubExp)
-&gt; TypeBase Shape Uniqueness
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FParam rep, SubExp) -&gt; FParam rep
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><a href="#local-6989586621684345634"><span class="hs-identifier hs-var">merge</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">LoopForm rep -&gt; Names
</span><a href="#local-6989586621684345631"><span class="hs-identifier hs-var">consumedInForm</span></a></span><span> </span><span class="annot"><span class="annottext">LoopForm rep
</span><a href="#local-6989586621684345633"><span class="hs-identifier hs-var">form</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621684345630"><span class="annot"><span class="annottext">body_consumed :: Names
</span><a href="#local-6989586621684345630"><span class="hs-identifier hs-var hs-var">body_consumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345632"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span id="local-6989586621684345629"><span class="annot"><span class="annottext">varConsumed :: (Param (LParamInfo rep), VName) -&gt; Bool
</span><a href="#local-6989586621684345629"><span class="hs-identifier hs-var hs-var">varConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Names -&gt; Bool
</span><a href="Futhark.IR.Prop.Names.html#nameIn"><span class="hs-operator hs-var">`nameIn`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684345630"><span class="hs-identifier hs-var">body_consumed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Bool)
-&gt; ((Param (LParamInfo rep), VName) -&gt; VName)
-&gt; (Param (LParamInfo rep), VName)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep) -&gt; VName)
-&gt; ((Param (LParamInfo rep), VName) -&gt; Param (LParamInfo rep))
-&gt; (Param (LParamInfo rep), VName)
-&gt; VName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep), VName) -&gt; Param (LParamInfo rep)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621684345631"><span class="annot"><span class="annottext">consumedInForm :: LoopForm rep -&gt; Names
</span><a href="#local-6989586621684345631"><span class="hs-identifier hs-var hs-var">consumedInForm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#ForLoop"><span class="hs-identifier hs-type">ForLoop</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345626"><span class="annot"><span class="annottext">[(Param (LParamInfo rep), VName)]
</span><a href="#local-6989586621684345626"><span class="hs-identifier hs-var">loopvars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Names) -&gt; [VName] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Param (LParamInfo rep), VName) -&gt; VName)
-&gt; [(Param (LParamInfo rep), VName)] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep), VName) -&gt; VName
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(Param (LParamInfo rep), VName)] -&gt; [VName])
-&gt; [(Param (LParamInfo rep), VName)] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Param (LParamInfo rep), VName) -&gt; Bool)
-&gt; [(Param (LParamInfo rep), VName)]
-&gt; [(Param (LParamInfo rep), VName)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep), VName) -&gt; Bool
</span><a href="#local-6989586621684345629"><span class="hs-identifier hs-var">varConsumed</span></a></span><span> </span><span class="annot"><span class="annottext">[(Param (LParamInfo rep), VName)]
</span><a href="#local-6989586621684345626"><span class="hs-identifier hs-var">loopvars</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="#local-6989586621684345631"><span class="hs-identifier hs-var">consumedInForm</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#WhileLoop"><span class="hs-identifier hs-type">WhileLoop</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-178"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#WithAcc"><span class="hs-identifier hs-type">WithAcc</span></a></span><span> </span><span id="local-6989586621684345624"><span class="annot"><span class="annottext">[WithAccInput rep]
</span><a href="#local-6989586621684345624"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span id="local-6989586621684345623"><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345623"><span class="hs-identifier hs-var">lam</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WithAccInput rep -&gt; Names) -&gt; [WithAccInput rep] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WithAccInput rep -&gt; Names
forall {a} {c}. (a, [VName], c) -&gt; Names
</span><a href="#local-6989586621684345622"><span class="hs-identifier hs-var">inputConsumed</span></a></span><span> </span><span class="annot"><span class="annottext">[WithAccInput rep]
</span><a href="#local-6989586621684345624"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; Names
forall rep. Aliased rep =&gt; Lambda rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedByLambda"><span class="hs-identifier hs-var">consumedByLambda</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345623"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-181"></span><span>           </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesSubtract"><span class="hs-operator hs-var">`namesSubtract`</span></a></span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Param (LParamInfo rep) -&gt; VName)
-&gt; [Param (LParamInfo rep)] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345623"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621684345622"><span class="annot"><span class="annottext">inputConsumed :: (a, [VName], c) -&gt; Names
</span><a href="#local-6989586621684345622"><span class="hs-identifier hs-var hs-var">inputConsumed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345620"><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684345620"><span class="hs-identifier hs-var">arrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684345620"><span class="hs-identifier hs-var">arrs</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345619"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345619"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="annot"><span class="annottext">Slice SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345619"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#FlatUpdate"><span class="hs-identifier hs-type">FlatUpdate</span></a></span><span> </span><span id="local-6989586621684345618"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345618"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="annot"><span class="annottext">FlatSlice SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345618"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#UpdateAcc"><span class="hs-identifier hs-type">UpdateAcc</span></a></span><span> </span><span id="local-6989586621684345617"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345617"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345617"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="annot"><span class="annottext">BasicOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInExp"><span class="hs-identifier hs-var">consumedInExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684345616"><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345616"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Op rep -&gt; Names
forall op. AliasedOp op =&gt; op -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInOp"><span class="hs-identifier hs-var">consumedInOp</span></a></span><span> </span><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345616"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | The variables consumed by this lambda.</span><span>
</span><span id="line-192"></span><span id="local-6989586621684345924"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedByLambda"><span class="hs-identifier hs-type">consumedByLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345924"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345924"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-193"></span><span id="consumedByLambda"><span class="annot"><span class="annottext">consumedByLambda :: forall rep. Aliased rep =&gt; Lambda rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedByLambda"><span class="hs-identifier hs-var hs-var">consumedByLambda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Body rep -&gt; Names
forall rep. Aliased rep =&gt; Body rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInBody"><span class="hs-identifier hs-var">consumedInBody</span></a></span><span> </span><span class="annot"><span class="annottext">(Body rep -&gt; Names)
-&gt; (LambdaT rep -&gt; Body rep) -&gt; LambdaT rep -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LambdaT rep -&gt; Body rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | The aliases of each pattern element (including the context).</span><span>
</span><span id="line-196"></span><span id="local-6989586621684345921"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#patAliases"><span class="hs-identifier hs-type">patAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345921"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345921"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-197"></span><span id="patAliases"><span class="annot"><span class="annottext">patAliases :: forall dec. AliasesOf dec =&gt; PatT dec -&gt; [Names]
</span><a href="Futhark.IR.Prop.Aliases.html#patAliases"><span class="hs-identifier hs-var hs-var">patAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PatElemT dec -&gt; Names) -&gt; [PatElemT dec] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">dec -&gt; Names
forall a. AliasesOf a =&gt; a -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var">aliasesOf</span></a></span><span> </span><span class="annot"><span class="annottext">(dec -&gt; Names) -&gt; (PatElemT dec -&gt; dec) -&gt; PatElemT dec -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatElemT dec -&gt; dec
forall dec. PatElemT dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#patElemDec"><span class="hs-identifier hs-var hs-var">patElemDec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PatElemT dec] -&gt; [Names])
-&gt; (PatT dec -&gt; [PatElemT dec]) -&gt; PatT dec -&gt; [Names]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT dec -&gt; [PatElemT dec]
forall dec. PatT dec -&gt; [PatElemT dec]
</span><a href="Futhark.IR.Syntax.html#patElems"><span class="hs-identifier hs-var hs-var">patElems</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Something that contains alias information.</span><span>
</span><span id="line-200"></span><span class="hs-keyword">class</span><span> </span><span id="AliasesOf"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-var">AliasesOf</span></a></span></span><span> </span><span id="local-6989586621684345917"><span class="annot"><a href="#local-6989586621684345917"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- | The alias of the argument element.</span><span>
</span><span id="line-202"></span><span>  </span><span id="aliasesOf"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-type">aliasesOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345917"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621684345604"><span class="annot"><span class="annottext">aliasesOf :: Names -&gt; Names
</span><a href="#local-6989586621684345604"><span class="hs-identifier hs-var hs-var hs-var hs-var">aliasesOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621684345912"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345912"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#PatElemT"><span class="hs-identifier hs-type">PatElemT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345912"><span class="hs-identifier hs-type">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621684345598"><span class="annot"><span class="annottext">aliasesOf :: PatElemT dec -&gt; Names
</span><a href="#local-6989586621684345598"><span class="hs-identifier hs-var hs-var hs-var hs-var">aliasesOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dec -&gt; Names
forall a. AliasesOf a =&gt; a -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var">aliasesOf</span></a></span><span> </span><span class="annot"><span class="annottext">(dec -&gt; Names) -&gt; (PatElemT dec -&gt; dec) -&gt; PatElemT dec -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatElemT dec -&gt; dec
forall dec. PatElemT dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#patElemDec"><span class="hs-identifier hs-var hs-var">patElemDec</span></a></span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Also includes the name itself.</span><span>
</span><span id="line-211"></span><span id="local-6989586621684345911"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#lookupAliases"><span class="hs-identifier hs-type">lookupAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasesOf"><span class="hs-identifier hs-type">AliasesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345911"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345911"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-212"></span><span id="lookupAliases"><span class="annot"><span class="annottext">lookupAliases :: forall rep. AliasesOf (LetDec rep) =&gt; VName -&gt; Scope rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#lookupAliases"><span class="hs-identifier hs-var hs-var">lookupAliases</span></a></span></span><span> </span><span id="local-6989586621684345588"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345588"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684345587"><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684345587"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Scope rep -&gt; Maybe (NameInfo rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345588"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684345587"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#LetName"><span class="hs-identifier hs-type">LetName</span></a></span><span> </span><span id="local-6989586621684345584"><span class="annot"><span class="annottext">LetDec rep
</span><a href="#local-6989586621684345584"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345588"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Names) -&gt; [VName] -&gt; Names
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Scope rep -&gt; Names
forall rep. AliasesOf (LetDec rep) =&gt; VName -&gt; Scope rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#lookupAliases"><span class="hs-operator hs-var">`lookupAliases`</span></a></span><span> </span><span class="annot"><span class="annottext">Scope rep
</span><a href="#local-6989586621684345587"><span class="hs-identifier hs-var">scope</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LetDec rep -&gt; Names
forall a. AliasesOf a =&gt; a -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var">aliasesOf</span></a></span><span> </span><span class="annot"><span class="annottext">LetDec rep
</span><a href="#local-6989586621684345584"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NameInfo rep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345588"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | The class of operations that can produce aliasing and consumption</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- information.</span><span>
</span><span id="line-220"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-type">IsOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345948"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="AliasedOp"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasedOp"><span class="hs-identifier hs-var">AliasedOp</span></a></span></span><span> </span><span id="local-6989586621684345948"><span class="annot"><a href="#local-6989586621684345948"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="opAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#opAliases"><span class="hs-identifier hs-type">opAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345948"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>  </span><span id="consumedInOp"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#consumedInOp"><span class="hs-identifier hs-type">consumedInOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345948"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasedOp"><span class="hs-identifier hs-type">AliasedOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621684345575"><span class="annot"><span class="annottext">opAliases :: () -&gt; [Names]
</span><a href="#local-6989586621684345575"><span class="hs-identifier hs-var hs-var hs-var hs-var">opAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621684345573"><span class="annot"><span class="annottext">consumedInOp :: () -&gt; Names
</span><a href="#local-6989586621684345573"><span class="hs-identifier hs-var hs-var hs-var hs-var">consumedInOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Pre-existing aliases for variables.  Used to add transitive</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- aliases.</span><span>
</span><span id="line-230"></span><span class="hs-keyword">type</span><span> </span><span id="AliasTable"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasTable"><span class="hs-identifier hs-var">AliasTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | The class of operations that can be given aliasing information.</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- This is a somewhat subtle concept that is only used in the</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- simplifier and when using &quot;rep adapters&quot;.</span><span>
</span><span id="line-235"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasedOp"><span class="hs-identifier hs-type">AliasedOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-type">OpWithAliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="CanBeAliased"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-var">CanBeAliased</span></a></span></span><span> </span><span id="local-6989586621684345902"><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- | The op that results when we add aliases to this op.</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OpWithAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-var">OpWithAliases</span></a></span></span><span> </span><span id="local-6989586621684345902"><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Kind.Type</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- | Remove aliases from this op.</span><span>
</span><span id="line-240"></span><span>  </span><span id="removeOpAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#removeOpAliases"><span class="hs-identifier hs-type">removeOpAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-type">OpWithAliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- | Add aliases to this op.</span><span>
</span><span id="line-243"></span><span>  </span><span id="addOpAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#addOpAliases"><span class="hs-identifier hs-type">addOpAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#AliasTable"><span class="hs-identifier hs-type">AliasTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-type">OpWithAliases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345902"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#CanBeAliased"><span class="hs-identifier hs-type">CanBeAliased</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OpWithAliases"><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#OpWithAliases"><span class="hs-identifier hs-var">OpWithAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621684345562"><span class="annot"><span class="annottext">removeOpAliases :: OpWithAliases () -&gt; ()
</span><a href="#local-6989586621684345562"><span class="hs-identifier hs-var hs-var hs-var hs-var">removeOpAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpWithAliases () -&gt; ()
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621684345561"><span class="annot"><span class="annottext">addOpAliases :: AliasTable -&gt; () -&gt; OpWithAliases ()
</span><a href="#local-6989586621684345561"><span class="hs-identifier hs-var hs-var hs-var hs-var">addOpAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; ()) -&gt; AliasTable -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; ()
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-249"></span></pre></body></html>