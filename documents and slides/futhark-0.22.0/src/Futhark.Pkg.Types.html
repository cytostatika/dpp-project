<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Types (and a few other simple definitions) for futhark-pkg.</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Pkg.Types</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier">PkgPath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgPathFilePath"><span class="hs-identifier">pkgPathFilePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier">PkgRevDeps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">Data.Versions</span></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Versions</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#commitVersion"><span class="hs-identifier">commitVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#isCommitVersion"><span class="hs-identifier">isCommitVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#parseVersion"><span class="hs-identifier">parseVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Package manifests</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier">PkgManifest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#newPkgManifest"><span class="hs-identifier">newPkgManifest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgRevDeps"><span class="hs-identifier">pkgRevDeps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgDir"><span class="hs-identifier">pkgDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#addRequiredToManifest"><span class="hs-identifier">addRequiredToManifest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#removeRequiredFromManifest"><span class="hs-identifier">removeRequiredFromManifest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#prettyPkgManifest"><span class="hs-identifier">prettyPkgManifest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier">Comment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier">Commented</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier">Required</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#futharkPkg"><span class="hs-identifier">futharkPkg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parsing package manifests</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#parsePkgManifest"><span class="hs-identifier">parsePkgManifest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#parsePkgManifestFromFile"><span class="hs-identifier">parsePkgManifestFromFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-identifier">errorBundlePretty</span></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Build list</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#BuildList"><span class="hs-identifier">BuildList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.Pkg.Types.html#prettyBuildList"><span class="hs-identifier">prettyBuildList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sortOn</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Versions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SemVer</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VUnit</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">prettySemVer</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath.Posix</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Posix</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">many</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">some</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.Char</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | A package path is a unique identifier for a package, for example</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- @github.com/user/foo@.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">type</span><span> </span><span id="PkgPath"><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-var">PkgPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Turn a package path (which always uses forward slashes) into a</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- file path in the local file system (which might use different</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- slashes).</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgPathFilePath"><span class="hs-identifier hs-type">pkgPathFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-66"></span><span id="pkgPathFilePath"><span class="annot"><span class="annottext">pkgPathFilePath :: PkgPath -&gt; FilePath
</span><a href="Futhark.Pkg.Types.html#pkgPathFilePath"><span class="hs-identifier hs-var hs-var">pkgPathFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">joinPath</span></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; FilePath)
-&gt; (PkgPath -&gt; [FilePath]) -&gt; PkgPath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><span class="hs-identifier hs-var">Posix.splitPath</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [FilePath])
-&gt; (PkgPath -&gt; FilePath) -&gt; PkgPath -&gt; [FilePath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Versions of the form (0,0,0)-timestamp+hash are treated</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- specially, as a reference to the commit identified uniquely with</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- @hash@ (typically the Git commit ID).  This function detects such</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- versions.</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Futhark.Pkg.Types.html#isCommitVersion"><span class="hs-identifier hs-type">isCommitVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-73"></span><span id="isCommitVersion"><span class="annot"><span class="annottext">isCommitVersion :: SemVer -&gt; Maybe PkgPath
</span><a href="Futhark.Pkg.Types.html#isCommitVersion"><span class="hs-identifier hs-var hs-var">isCommitVersion</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VChunk
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684315405"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315405"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; Maybe PkgPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315405"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Futhark.Pkg.Types.html#isCommitVersion"><span class="hs-identifier hs-var">isCommitVersion</span></a></span><span> </span><span class="annot"><span class="annottext">SemVer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PkgPath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | @commitVersion timestamp commit@ constructs a commit version.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Futhark.Pkg.Types.html#commitVersion"><span class="hs-identifier hs-type">commitVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span>
</span><span id="line-78"></span><span id="commitVersion"><span class="annot"><span class="annottext">commitVersion :: PkgPath -&gt; PkgPath -&gt; SemVer
</span><a href="Futhark.Pkg.Types.html#commitVersion"><span class="hs-identifier hs-var hs-var">commitVersion</span></a></span></span><span> </span><span id="local-6989586621684315404"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315404"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span id="local-6989586621684315403"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315403"><span class="hs-identifier hs-var">commit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer
</span><span class="hs-identifier hs-var">SemVer</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PkgPath -&gt; VUnit
</span><span class="hs-identifier hs-var">Str</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315404"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">VUnit -&gt; [VUnit] -&gt; VChunk
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; Maybe PkgPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315403"><span class="hs-identifier hs-var">commit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Unfortunately, Data.Versions has a buggy semver parser that</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- collapses consecutive zeroes in the metadata field.  So, we define</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- our own parser here.  It's a little simpler too, since we don't</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- need full semver.</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Futhark.Pkg.Types.html#parseVersion"><span class="hs-identifier hs-type">parseVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span>
</span><span id="line-86"></span><span id="parseVersion"><span class="annot"><span class="annottext">parseVersion :: PkgPath -&gt; Either (ParseErrorBundle PkgPath Void) SemVer
</span><a href="Futhark.Pkg.Types.html#parseVersion"><span class="hs-identifier hs-var hs-var">parseVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec Void PkgPath SemVer
-&gt; FilePath
-&gt; PkgPath
-&gt; Either (ParseErrorBundle PkgPath Void) SemVer
forall e s a.
Parsec e s a -&gt; FilePath -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">parse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec Void PkgPath SemVer
</span><a href="Futhark.Pkg.Types.html#semver%27"><span class="hs-identifier hs-var">semver'</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec Void PkgPath SemVer
-&gt; ParsecT Void PkgPath Identity () -&gt; Parsec Void PkgPath SemVer
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Semantic Version&quot;</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Futhark.Pkg.Types.html#semver%27"><span class="hs-identifier hs-type">semver'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span>
</span><span id="line-89"></span><span id="semver%27"><span class="annot"><span class="annottext">semver' :: Parsec Void PkgPath SemVer
</span><a href="Futhark.Pkg.Types.html#semver%27"><span class="hs-identifier hs-var hs-var">semver'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer
</span><span class="hs-identifier hs-var">SemVer</span></span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word -&gt; Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
-&gt; ParsecT Void PkgPath Identity Word
-&gt; ParsecT
     Void
     PkgPath
     Identity
     (Word -&gt; Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315395"><span class="hs-identifier hs-var">majorP</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  Void
  PkgPath
  Identity
  (Word -&gt; Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
-&gt; ParsecT Void PkgPath Identity Word
-&gt; ParsecT
     Void PkgPath Identity (Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315394"><span class="hs-identifier hs-var">minorP</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  Void PkgPath Identity (Word -&gt; [VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
-&gt; ParsecT Void PkgPath Identity Word
-&gt; ParsecT
     Void PkgPath Identity ([VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315393"><span class="hs-identifier hs-var">patchP</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ([VChunk] -&gt; Maybe PkgPath -&gt; SemVer)
-&gt; ParsecT Void PkgPath Identity [VChunk]
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath -&gt; SemVer)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity [VChunk]
</span><a href="#local-6989586621684315392"><span class="hs-identifier hs-var">preRel</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath -&gt; SemVer)
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
-&gt; Parsec Void PkgPath SemVer
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath)
</span><a href="#local-6989586621684315391"><span class="hs-identifier hs-var">metaData</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621684315395"><span class="annot"><span class="annottext">majorP :: ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315395"><span class="hs-identifier hs-var hs-var">majorP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315386"><span class="hs-identifier hs-var">digitsP</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
-&gt; ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity Word
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Token PkgPath -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token PkgPath
</span><span class="hs-char">'.'</span></span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621684315394"><span class="annot"><span class="annottext">minorP :: ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315394"><span class="hs-identifier hs-var hs-var">minorP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315395"><span class="hs-identifier hs-var">majorP</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621684315393"><span class="annot"><span class="annottext">patchP :: ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315393"><span class="hs-identifier hs-var hs-var">patchP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315386"><span class="hs-identifier hs-var">digitsP</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621684315386"><span class="annot"><span class="annottext">digitsP :: ParsecT Void PkgPath Identity Word
</span><a href="#local-6989586621684315386"><span class="hs-identifier hs-var hs-var">digitsP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word
forall a. Read a =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Word)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity Word
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; FilePath)
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Tokens PkgPath -&gt; ParsecT Void PkgPath Identity (Tokens PkgPath)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens PkgPath
</span><span class="hs-string">&quot;0&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">digitChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621684315392"><span class="annot"><span class="annottext">preRel :: ParsecT Void PkgPath Identity [VChunk]
</span><a href="#local-6989586621684315392"><span class="hs-identifier hs-var hs-var">preRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VChunk] -&gt; (VChunk -&gt; [VChunk]) -&gt; Maybe VChunk -&gt; [VChunk]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">VChunk -&gt; [VChunk]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe VChunk -&gt; [VChunk])
-&gt; ParsecT Void PkgPath Identity (Maybe VChunk)
-&gt; ParsecT Void PkgPath Identity [VChunk]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity VChunk
-&gt; ParsecT Void PkgPath Identity (Maybe VChunk)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity VChunk
</span><a href="#local-6989586621684315363"><span class="hs-identifier hs-var">preRel'</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621684315363"><span class="annot"><span class="annottext">preRel' :: ParsecT Void PkgPath Identity VChunk
</span><a href="#local-6989586621684315363"><span class="hs-identifier hs-var hs-var">preRel'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token PkgPath -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token PkgPath
</span><span class="hs-char">'-'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity VChunk
-&gt; ParsecT Void PkgPath Identity VChunk
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VUnit -&gt; VChunk
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(VUnit -&gt; VChunk) -&gt; (FilePath -&gt; VUnit) -&gt; FilePath -&gt; VChunk
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; VUnit
</span><span class="hs-identifier hs-var">Str</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; VUnit) -&gt; (FilePath -&gt; PkgPath) -&gt; FilePath -&gt; VUnit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; VChunk)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity VChunk
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">digitChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621684315391"><span class="annot"><span class="annottext">metaData :: ParsecT Void PkgPath Identity (Maybe PkgPath)
</span><a href="#local-6989586621684315391"><span class="hs-identifier hs-var hs-var">metaData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315349"><span class="hs-identifier hs-var">metaData'</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621684315349"><span class="annot"><span class="annottext">metaData' :: ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315349"><span class="hs-identifier hs-var hs-var">metaData'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token PkgPath -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token PkgPath
</span><span class="hs-char">'+'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PkgPath)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">alphaNumChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | The dependencies of a (revision of a) package is a mapping from</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- package paths to minimum versions (and an optional hash pinning).</span><span>
</span><span id="line-102"></span><span class="hs-keyword">newtype</span><span> </span><span id="PkgRevDeps"><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-var">PkgRevDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PkgRevDeps"><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-var">PkgRevDeps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684315326"><span id="local-6989586621684315328"><span id="local-6989586621684315336"><span class="annot"><span class="annottext">Int -&gt; PkgRevDeps -&gt; ShowS
[PkgRevDeps] -&gt; ShowS
PkgRevDeps -&gt; FilePath
(Int -&gt; PkgRevDeps -&gt; ShowS)
-&gt; (PkgRevDeps -&gt; FilePath)
-&gt; ([PkgRevDeps] -&gt; ShowS)
-&gt; Show PkgRevDeps
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PkgRevDeps] -&gt; ShowS
$cshowList :: [PkgRevDeps] -&gt; ShowS
show :: PkgRevDeps -&gt; FilePath
$cshow :: PkgRevDeps -&gt; FilePath
showsPrec :: Int -&gt; PkgRevDeps -&gt; ShowS
$cshowsPrec :: Int -&gt; PkgRevDeps -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684315314"><span id="local-6989586621684315316"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-type">PkgRevDeps</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-type">PkgRevDeps</span></a></span><span> </span><span id="local-6989586621684315310"><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
</span><a href="#local-6989586621684315310"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684315309"><span class="annot"><span class="annottext">&lt;&gt; :: PkgRevDeps -&gt; PkgRevDeps -&gt; PkgRevDeps
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-type">PkgRevDeps</span></a></span><span> </span><span id="local-6989586621684315308"><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
</span><a href="#local-6989586621684315308"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps
</span><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-var">PkgRevDeps</span></a></span><span> </span><span class="annot"><span class="annottext">(Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps)
-&gt; Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
</span><a href="#local-6989586621684315310"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
-&gt; Map PkgPath (SemVer, Maybe PkgPath)
-&gt; Map PkgPath (SemVer, Maybe PkgPath)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
</span><a href="#local-6989586621684315308"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684315301"><span id="local-6989586621684315303"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-type">PkgRevDeps</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621684315297"><span class="annot"><span class="annottext">mempty :: PkgRevDeps
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps
</span><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-var">PkgRevDeps</span></a></span><span> </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">--- Package manifest</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | A line comment.</span><span>
</span><span id="line-114"></span><span class="hs-keyword">type</span><span> </span><span id="Comment"><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier hs-var">Comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Wraps a value with an annotation of preceding line comments.</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- This is important to our goal of being able to programmatically</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- modify the @futhark.pkg@ file while keeping comments intact.</span><span>
</span><span id="line-119"></span><span class="hs-keyword">data</span><span> </span><span id="Commented"><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span></span><span> </span><span id="local-6989586621684315737"><span class="annot"><a href="#local-6989586621684315737"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Commented"><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="comments"><span class="annot"><span class="annottext">forall a. Commented a -&gt; [PkgPath]
</span><a href="Futhark.Pkg.Types.html#comments"><span class="hs-identifier hs-var hs-var">comments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span id="commented"><span class="annot"><span class="annottext">forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684315737"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684315283"><span id="local-6989586621684315285"><span id="local-6989586621684315292"><span class="annot"><span class="annottext">Int -&gt; Commented a -&gt; ShowS
[Commented a] -&gt; ShowS
Commented a -&gt; FilePath
(Int -&gt; Commented a -&gt; ShowS)
-&gt; (Commented a -&gt; FilePath)
-&gt; ([Commented a] -&gt; ShowS)
-&gt; Show (Commented a)
forall a. Show a =&gt; Int -&gt; Commented a -&gt; ShowS
forall a. Show a =&gt; [Commented a] -&gt; ShowS
forall a. Show a =&gt; Commented a -&gt; FilePath
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Commented a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Commented a] -&gt; ShowS
show :: Commented a -&gt; FilePath
$cshow :: forall a. Show a =&gt; Commented a -&gt; FilePath
showsPrec :: Int -&gt; Commented a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Commented a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684315276"><span id="local-6989586621684315281"><span class="annot"><span class="annottext">Commented a -&gt; Commented a -&gt; Bool
(Commented a -&gt; Commented a -&gt; Bool)
-&gt; (Commented a -&gt; Commented a -&gt; Bool) -&gt; Eq (Commented a)
forall a. Eq a =&gt; Commented a -&gt; Commented a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Commented a -&gt; Commented a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Commented a -&gt; Commented a -&gt; Bool
== :: Commented a -&gt; Commented a -&gt; Bool
$c== :: forall a. Eq a =&gt; Commented a -&gt; Commented a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684315272"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621684315269"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; Commented a -&gt; Commented b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Commented a -&gt; Commented b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684315235"><span id="local-6989586621684315237"><span id="local-6989586621684315239"><span id="local-6989586621684315241"><span id="local-6989586621684315243"><span id="local-6989586621684315245"><span id="local-6989586621684315247"><span id="local-6989586621684315249"><span id="local-6989586621684315251"><span id="local-6989586621684315253"><span id="local-6989586621684315255"><span id="local-6989586621684315257"><span id="local-6989586621684315259"><span id="local-6989586621684315261"><span id="local-6989586621684315263"><span id="local-6989586621684315266"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621684315230"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Commented a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; Commented a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684315217"><span id="local-6989586621684315219"><span id="local-6989586621684315221"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621684315211"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Commented a -&gt; f (Commented b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span id="local-6989586621684315209"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684315209"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span><span> </span><span id="local-6989586621684315208"><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315208"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621684315207"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684315207"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PkgPath] -&gt; b -&gt; Commented b
forall a. [PkgPath] -&gt; a -&gt; Commented a
</span><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315208"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Commented b) -&gt; f b -&gt; f (Commented b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684315209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684315207"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | An entry in the @required@ section of a @futhark.pkg@ file.</span><span>
</span><span id="line-135"></span><span class="hs-keyword">data</span><span> </span><span id="Required"><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-var">Required</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Required"><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-var">Required</span></a></span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Name of the required package.</span><span>
</span><span id="line-137"></span><span>    </span><span id="requiredPkg"><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- | The minimum revision.</span><span>
</span><span id="line-139"></span><span>    </span><span id="requiredPkgRev"><span class="annot"><span class="annottext">Required -&gt; SemVer
</span><a href="Futhark.Pkg.Types.html#requiredPkgRev"><span class="hs-identifier hs-var hs-var">requiredPkgRev</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- | An optional hash indicating what</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- this revision looked like the last</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- time we saw it.  Used for integrity</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- checking.</span><span>
</span><span id="line-144"></span><span>    </span><span id="requiredHash"><span class="annot"><span class="annottext">Required -&gt; Maybe PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredHash"><span class="hs-identifier hs-var hs-var">requiredHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684315193"><span id="local-6989586621684315195"><span id="local-6989586621684315201"><span class="annot"><span class="annottext">Int -&gt; Required -&gt; ShowS
[Required] -&gt; ShowS
Required -&gt; FilePath
(Int -&gt; Required -&gt; ShowS)
-&gt; (Required -&gt; FilePath) -&gt; ([Required] -&gt; ShowS) -&gt; Show Required
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Required] -&gt; ShowS
$cshowList :: [Required] -&gt; ShowS
show :: Required -&gt; FilePath
$cshow :: Required -&gt; FilePath
showsPrec :: Int -&gt; Required -&gt; ShowS
$cshowsPrec :: Int -&gt; Required -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684315184"><span id="local-6989586621684315191"><span class="annot"><span class="annottext">Required -&gt; Required -&gt; Bool
(Required -&gt; Required -&gt; Bool)
-&gt; (Required -&gt; Required -&gt; Bool) -&gt; Eq Required
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Required -&gt; Required -&gt; Bool
$c/= :: Required -&gt; Required -&gt; Bool
== :: Required -&gt; Required -&gt; Bool
$c== :: Required -&gt; Required -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | The name of the file containing the futhark-pkg manifest.</span><span>
</span><span id="line-149"></span><span class="annot"><a href="Futhark.Pkg.Types.html#futharkPkg"><span class="hs-identifier hs-type">futharkPkg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-150"></span><span id="futharkPkg"><span class="annot"><span class="annottext">futharkPkg :: FilePath
</span><a href="Futhark.Pkg.Types.html#futharkPkg"><span class="hs-identifier hs-var hs-var">futharkPkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;futhark.pkg&quot;</span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | A structure corresponding to a @futhark.pkg@ file, including</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- comments.  It is an invariant that duplicate required packages do</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- not occcur (the parser will verify this).</span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="PkgManifest"><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-var">PkgManifest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PkgManifest"><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-var">PkgManifest</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | The name of the package.</span><span>
</span><span id="line-157"></span><span>    </span><span id="manifestPkgPath"><span class="annot"><span class="annottext">PkgManifest -&gt; Commented (Maybe PkgPath)
</span><a href="Futhark.Pkg.Types.html#manifestPkgPath"><span class="hs-identifier hs-var hs-var">manifestPkgPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span id="manifestRequire"><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-type">Commented</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>    </span><span id="manifestEndComments"><span class="annot"><span class="annottext">PkgManifest -&gt; [PkgPath]
</span><a href="Futhark.Pkg.Types.html#manifestEndComments"><span class="hs-identifier hs-var hs-var">manifestEndComments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684315167"><span id="local-6989586621684315169"><span id="local-6989586621684315178"><span class="annot"><span class="annottext">Int -&gt; PkgManifest -&gt; ShowS
[PkgManifest] -&gt; ShowS
PkgManifest -&gt; FilePath
(Int -&gt; PkgManifest -&gt; ShowS)
-&gt; (PkgManifest -&gt; FilePath)
-&gt; ([PkgManifest] -&gt; ShowS)
-&gt; Show PkgManifest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PkgManifest] -&gt; ShowS
$cshowList :: [PkgManifest] -&gt; ShowS
show :: PkgManifest -&gt; FilePath
$cshow :: PkgManifest -&gt; FilePath
showsPrec :: Int -&gt; PkgManifest -&gt; ShowS
$cshowsPrec :: Int -&gt; PkgManifest -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684315155"><span id="local-6989586621684315162"><span class="annot"><span class="annottext">PkgManifest -&gt; PkgManifest -&gt; Bool
(PkgManifest -&gt; PkgManifest -&gt; Bool)
-&gt; (PkgManifest -&gt; PkgManifest -&gt; Bool) -&gt; Eq PkgManifest
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PkgManifest -&gt; PkgManifest -&gt; Bool
$c/= :: PkgManifest -&gt; PkgManifest -&gt; Bool
== :: PkgManifest -&gt; PkgManifest -&gt; Bool
$c== :: PkgManifest -&gt; PkgManifest -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Possibly given a package path, construct an otherwise-empty manifest file.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Futhark.Pkg.Types.html#newPkgManifest"><span class="hs-identifier hs-type">newPkgManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span>
</span><span id="line-165"></span><span id="newPkgManifest"><span class="annot"><span class="annottext">newPkgManifest :: Maybe PkgPath -&gt; PkgManifest
</span><a href="Futhark.Pkg.Types.html#newPkgManifest"><span class="hs-identifier hs-var hs-var">newPkgManifest</span></a></span></span><span> </span><span id="local-6989586621684315151"><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315151"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath)
-&gt; Commented [Either PkgPath Required] -&gt; [PkgPath] -&gt; PkgManifest
</span><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-var">PkgManifest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PkgPath] -&gt; Maybe PkgPath -&gt; Commented (Maybe PkgPath)
forall a. [PkgPath] -&gt; a -&gt; Commented a
</span><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315151"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PkgPath]
-&gt; [Either PkgPath Required] -&gt; Commented [Either PkgPath Required]
forall a. [PkgPath] -&gt; a -&gt; Commented a
</span><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PkgPath]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Prettyprint a package manifest such that it can be written to a</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- @futhark.pkg@ file.</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Futhark.Pkg.Types.html#prettyPkgManifest"><span class="hs-identifier hs-type">prettyPkgManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-171"></span><span id="prettyPkgManifest"><span class="annot"><span class="annottext">prettyPkgManifest :: PkgManifest -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#prettyPkgManifest"><span class="hs-identifier hs-var hs-var">prettyPkgManifest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span id="local-6989586621684315150"><span class="annot"><span class="annottext">Commented (Maybe PkgPath)
</span><a href="#local-6989586621684315150"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684315149"><span class="annot"><span class="annottext">Commented [Either PkgPath Required]
</span><a href="#local-6989586621684315149"><span class="hs-identifier hs-var">required</span></a></span></span><span> </span><span id="local-6989586621684315148"><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315148"><span class="hs-identifier hs-var">endcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><span class="annottext">[PkgPath] -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([PkgPath] -&gt; PkgPath) -&gt; [PkgPath] -&gt; PkgPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">[[PkgPath]] -&gt; [PkgPath]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath) -&gt; [PkgPath]
forall a. Commented a -&gt; [PkgPath]
</span><a href="#local-6989586621684315145"><span class="hs-identifier hs-var">prettyComments</span></a></span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath)
</span><a href="#local-6989586621684315150"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">[PkgPath] -&gt; (PkgPath -&gt; [PkgPath]) -&gt; Maybe PkgPath -&gt; [PkgPath]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; [PkgPath]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; [PkgPath])
-&gt; (PkgPath -&gt; PkgPath) -&gt; PkgPath -&gt; [PkgPath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;package &quot;</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; PkgPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; PkgPath) -&gt; (PkgPath -&gt; PkgPath) -&gt; PkgPath -&gt; PkgPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; PkgPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe PkgPath -&gt; [PkgPath]) -&gt; Maybe PkgPath -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath) -&gt; Maybe PkgPath
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath)
</span><a href="#local-6989586621684315150"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required] -&gt; [PkgPath]
forall a. Commented a -&gt; [PkgPath]
</span><a href="#local-6989586621684315145"><span class="hs-identifier hs-var">prettyComments</span></a></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required]
</span><a href="#local-6989586621684315149"><span class="hs-identifier hs-var">required</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;require {&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">(Either PkgPath Required -&gt; PkgPath)
-&gt; [Either PkgPath Required] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;  &quot;</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; PkgPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; PkgPath)
-&gt; (Either PkgPath Required -&gt; PkgPath)
-&gt; Either PkgPath Required
-&gt; PkgPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either PkgPath Required -&gt; PkgPath
</span><a href="#local-6989586621684315144"><span class="hs-identifier hs-var">prettyRequired</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Either PkgPath Required] -&gt; [PkgPath])
-&gt; [Either PkgPath Required] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required]
</span><a href="#local-6989586621684315149"><span class="hs-identifier hs-var">required</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">(PkgPath -&gt; PkgPath) -&gt; [PkgPath] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath
</span><a href="#local-6989586621684315143"><span class="hs-identifier hs-var">prettyComment</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315148"><span class="hs-identifier hs-var">endcs</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621684315145"><span class="annot"><span class="annottext">prettyComments :: Commented a -&gt; [PkgPath]
</span><a href="#local-6989586621684315145"><span class="hs-identifier hs-var hs-var">prettyComments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; PkgPath) -&gt; [PkgPath] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath
</span><a href="#local-6989586621684315143"><span class="hs-identifier hs-var">prettyComment</span></a></span><span> </span><span class="annot"><span class="annottext">([PkgPath] -&gt; [PkgPath])
-&gt; (Commented a -&gt; [PkgPath]) -&gt; Commented a -&gt; [PkgPath]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Commented a -&gt; [PkgPath]
forall a. Commented a -&gt; [PkgPath]
</span><a href="Futhark.Pkg.Types.html#comments"><span class="hs-identifier hs-var hs-var">comments</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621684315143"><span class="annot"><span class="annottext">prettyComment :: PkgPath -&gt; PkgPath
</span><a href="#local-6989586621684315143"><span class="hs-identifier hs-var hs-var">prettyComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; PkgPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621684315144"><span class="annot"><span class="annottext">prettyRequired :: Either PkgPath Required -&gt; PkgPath
</span><a href="#local-6989586621684315144"><span class="hs-identifier hs-var hs-var">prettyRequired</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684315137"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315137"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath
</span><a href="#local-6989586621684315143"><span class="hs-identifier hs-var">prettyComment</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315137"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621684315144"><span class="hs-identifier hs-var">prettyRequired</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span> </span><span id="local-6989586621684315136"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315136"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621684315135"><span class="annot"><span class="annottext">SemVer
</span><a href="#local-6989586621684315135"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621684315134"><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315134"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">[PkgPath] -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.unwords</span></span><span> </span><span class="annot"><span class="annottext">([PkgPath] -&gt; PkgPath) -&gt; [PkgPath] -&gt; PkgPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">[Maybe PkgPath] -&gt; [PkgPath]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; Maybe PkgPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315136"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="annottext">PkgPath -&gt; Maybe PkgPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; Maybe PkgPath) -&gt; PkgPath -&gt; Maybe PkgPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SemVer -&gt; PkgPath
</span><span class="hs-identifier hs-var">prettySemVer</span></span><span> </span><span class="annot"><span class="annottext">SemVer
</span><a href="#local-6989586621684315135"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; PkgPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; PkgPath) -&gt; Maybe PkgPath -&gt; Maybe PkgPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315134"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | The required packages listed in a package manifest.</span><span>
</span><span id="line-195"></span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgRevDeps"><span class="hs-identifier hs-type">pkgRevDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-type">PkgRevDeps</span></a></span><span>
</span><span id="line-196"></span><span id="pkgRevDeps"><span class="annot"><span class="annottext">pkgRevDeps :: PkgManifest -&gt; PkgRevDeps
</span><a href="Futhark.Pkg.Types.html#pkgRevDeps"><span class="hs-identifier hs-var hs-var">pkgRevDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><span class="annottext">Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps
</span><a href="Futhark.Pkg.Types.html#PkgRevDeps"><span class="hs-identifier hs-var">PkgRevDeps</span></a></span><span> </span><span class="annot"><span class="annottext">(Map PkgPath (SemVer, Maybe PkgPath) -&gt; PkgRevDeps)
-&gt; (PkgManifest -&gt; Map PkgPath (SemVer, Maybe PkgPath))
-&gt; PkgManifest
-&gt; PkgRevDeps
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(PkgPath, (SemVer, Maybe PkgPath))]
-&gt; Map PkgPath (SemVer, Maybe PkgPath)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(PkgPath, (SemVer, Maybe PkgPath))]
 -&gt; Map PkgPath (SemVer, Maybe PkgPath))
-&gt; (PkgManifest -&gt; [(PkgPath, (SemVer, Maybe PkgPath))])
-&gt; PkgManifest
-&gt; Map PkgPath (SemVer, Maybe PkgPath)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Either PkgPath Required
 -&gt; Maybe (PkgPath, (SemVer, Maybe PkgPath)))
-&gt; [Either PkgPath Required]
-&gt; [(PkgPath, (SemVer, Maybe PkgPath))]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Either PkgPath Required -&gt; Maybe (PkgPath, (SemVer, Maybe PkgPath))
forall {a}.
Either a Required -&gt; Maybe (PkgPath, (SemVer, Maybe PkgPath))
</span><a href="#local-6989586621684315129"><span class="hs-identifier hs-var">onR</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">([Either PkgPath Required] -&gt; [(PkgPath, (SemVer, Maybe PkgPath))])
-&gt; (PkgManifest -&gt; [Either PkgPath Required])
-&gt; PkgManifest
-&gt; [(PkgPath, (SemVer, Maybe PkgPath))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">(Commented [Either PkgPath Required] -&gt; [Either PkgPath Required])
-&gt; (PkgManifest -&gt; Commented [Either PkgPath Required])
-&gt; PkgManifest
-&gt; [Either PkgPath Required]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621684315129"><span class="annot"><span class="annottext">onR :: Either a Required -&gt; Maybe (PkgPath, (SemVer, Maybe PkgPath))
</span><a href="#local-6989586621684315129"><span class="hs-identifier hs-var hs-var">onR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684315128"><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315128"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PkgPath, (SemVer, Maybe PkgPath))
-&gt; Maybe (PkgPath, (SemVer, Maybe PkgPath))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315128"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Required -&gt; SemVer
</span><a href="Futhark.Pkg.Types.html#requiredPkgRev"><span class="hs-identifier hs-var hs-var">requiredPkgRev</span></a></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315128"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Required -&gt; Maybe PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredHash"><span class="hs-identifier hs-var hs-var">requiredHash</span></a></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315128"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="#local-6989586621684315129"><span class="hs-identifier hs-var">onR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PkgPath, (SemVer, Maybe PkgPath))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Where in the corresponding repository archive we can expect to</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- find the package files.</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Futhark.Pkg.Types.html#pkgDir"><span class="hs-identifier hs-type">pkgDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Posix.FilePath</span></span><span>
</span><span id="line-207"></span><span id="pkgDir"><span class="annot"><span class="annottext">pkgDir :: PkgManifest -&gt; Maybe FilePath
</span><a href="Futhark.Pkg.Types.html#pkgDir"><span class="hs-identifier hs-var hs-var">pkgDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">(PkgPath -&gt; FilePath) -&gt; Maybe PkgPath -&gt; Maybe FilePath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">Posix.addTrailingPathSeparator</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (PkgPath -&gt; FilePath) -&gt; PkgPath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;lib&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ShowS
</span><span class="hs-operator hs-var">Posix.&lt;/&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="annottext">ShowS -&gt; (PkgPath -&gt; FilePath) -&gt; PkgPath -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">(Maybe PkgPath -&gt; Maybe FilePath)
-&gt; (PkgManifest -&gt; Maybe PkgPath) -&gt; PkgManifest -&gt; Maybe FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath) -&gt; Maybe PkgPath
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">(Commented (Maybe PkgPath) -&gt; Maybe PkgPath)
-&gt; (PkgManifest -&gt; Commented (Maybe PkgPath))
-&gt; PkgManifest
-&gt; Maybe PkgPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented (Maybe PkgPath)
</span><a href="Futhark.Pkg.Types.html#manifestPkgPath"><span class="hs-identifier hs-var hs-var">manifestPkgPath</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Add new required package to the package manifest.  If the package</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- was already present, return the old version.</span><span>
</span><span id="line-217"></span><span class="annot"><a href="Futhark.Pkg.Types.html#addRequiredToManifest"><span class="hs-identifier hs-type">addRequiredToManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span id="addRequiredToManifest"><span class="annot"><span class="annottext">addRequiredToManifest :: Required -&gt; PkgManifest -&gt; (PkgManifest, Maybe Required)
</span><a href="Futhark.Pkg.Types.html#addRequiredToManifest"><span class="hs-identifier hs-var hs-var">addRequiredToManifest</span></a></span></span><span> </span><span id="local-6989586621684315125"><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315125"><span class="hs-identifier hs-var">new_r</span></a></span></span><span> </span><span id="local-6989586621684315124"><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684315121"><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315121"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684315120"><span class="annot"><span class="annottext">[Either PkgPath Required]
</span><a href="#local-6989586621684315120"><span class="hs-identifier hs-var">requires'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Required
 -&gt; Either PkgPath Required
 -&gt; (Maybe Required, Either PkgPath Required))
-&gt; Maybe Required
-&gt; [Either PkgPath Required]
-&gt; (Maybe Required, [Either PkgPath Required])
forall (t :: * -&gt; *) a b c.
Traversable t =&gt;
(a -&gt; b -&gt; (a, c)) -&gt; a -&gt; t b -&gt; (a, t c)
</span><span class="hs-identifier hs-var">mapAccumL</span></span><span> </span><span class="annot"><span class="annottext">Maybe Required
-&gt; Either PkgPath Required
-&gt; (Maybe Required, Either PkgPath Required)
forall {a}.
Maybe Required
-&gt; Either a Required -&gt; (Maybe Required, Either a Required)
</span><a href="#local-6989586621684315118"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Required
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">([Either PkgPath Required]
 -&gt; (Maybe Required, [Either PkgPath Required]))
-&gt; [Either PkgPath Required]
-&gt; (Maybe Required, [Either PkgPath Required])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">(Commented [Either PkgPath Required] -&gt; [Either PkgPath Required])
-&gt; Commented [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-220"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Required -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315121"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">manifestRequire :: Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var">manifestRequire</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required]
</span><a href="#local-6989586621684315120"><span class="hs-identifier hs-var">requires'</span></a></span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required]
-&gt; Commented [Either PkgPath Required]
-&gt; Commented [Either PkgPath Required]
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">manifestRequire :: Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var">manifestRequire</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either PkgPath Required]
-&gt; [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Required -&gt; Either PkgPath Required
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315125"><span class="hs-identifier hs-var">new_r</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Either PkgPath Required] -&gt; [Either PkgPath Required])
-&gt; Commented [Either PkgPath Required]
-&gt; Commented [Either PkgPath Required]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315124"><span class="hs-identifier hs-var">pm</span></a></span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315121"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621684315118"><span class="annot"><span class="annottext">add :: Maybe Required
-&gt; Either a Required -&gt; (Maybe Required, Either a Required)
</span><a href="#local-6989586621684315118"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621684315114"><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315114"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684315113"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684315113"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315114"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a Required
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684315113"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="#local-6989586621684315118"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span id="local-6989586621684315112"><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315112"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684315111"><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315111"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315111"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315125"><span class="hs-identifier hs-var">new_r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Required -&gt; Maybe Required
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315111"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Required -&gt; Either a Required
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315125"><span class="hs-identifier hs-var">new_r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Required
</span><a href="#local-6989586621684315112"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Required -&gt; Either a Required
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315111"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Check if the manifest specifies a required package with the given</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- package path.</span><span>
</span><span id="line-233"></span><span class="annot"><a href="Futhark.Pkg.Types.html#requiredInManifest"><span class="hs-identifier hs-type">requiredInManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span>
</span><span id="line-234"></span><span id="requiredInManifest"><span class="annot"><span class="annottext">requiredInManifest :: PkgPath -&gt; PkgManifest -&gt; Maybe Required
</span><a href="Futhark.Pkg.Types.html#requiredInManifest"><span class="hs-identifier hs-var hs-var">requiredInManifest</span></a></span></span><span> </span><span id="local-6989586621684315109"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315109"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">(Required -&gt; Bool) -&gt; [Required] -&gt; Maybe Required
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315109"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; Bool) -&gt; (Required -&gt; PkgPath) -&gt; Required -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Required] -&gt; Maybe Required)
-&gt; (PkgManifest -&gt; [Required]) -&gt; PkgManifest -&gt; Maybe Required
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required] -&gt; [Required]
forall a b. [Either a b] -&gt; [b]
</span><span class="hs-identifier hs-var">rights</span></span><span> </span><span class="annot"><span class="annottext">([Either PkgPath Required] -&gt; [Required])
-&gt; (PkgManifest -&gt; [Either PkgPath Required])
-&gt; PkgManifest
-&gt; [Required]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Commented [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. Commented a -&gt; a
</span><a href="Futhark.Pkg.Types.html#commented"><span class="hs-identifier hs-var hs-var">commented</span></a></span><span> </span><span class="annot"><span class="annottext">(Commented [Either PkgPath Required] -&gt; [Either PkgPath Required])
-&gt; (PkgManifest -&gt; Commented [Either PkgPath Required])
-&gt; PkgManifest
-&gt; [Either PkgPath Required]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Remove a required package from the manifest.  Returns 'Nothing'</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- if the package was not found in the manifest, and otherwise the new</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- manifest and the 'Required' that was present.</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Futhark.Pkg.Types.html#removeRequiredFromManifest"><span class="hs-identifier hs-type">removeRequiredFromManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-type">Required</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="removeRequiredFromManifest"><span class="annot"><span class="annottext">removeRequiredFromManifest :: PkgPath -&gt; PkgManifest -&gt; Maybe (PkgManifest, Required)
</span><a href="Futhark.Pkg.Types.html#removeRequiredFromManifest"><span class="hs-identifier hs-var hs-var">removeRequiredFromManifest</span></a></span></span><span> </span><span id="local-6989586621684315106"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315106"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621684315105"><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315105"><span class="hs-identifier hs-var">pm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621684315104"><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315104"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; PkgManifest -&gt; Maybe Required
</span><a href="Futhark.Pkg.Types.html#requiredInManifest"><span class="hs-identifier hs-var">requiredInManifest</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315106"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315105"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">(PkgManifest, Required) -&gt; Maybe (PkgManifest, Required)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315105"><span class="hs-identifier hs-var">pm</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">manifestRequire :: Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var">manifestRequire</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either PkgPath Required -&gt; Bool)
-&gt; [Either PkgPath Required] -&gt; [Either PkgPath Required]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (Either PkgPath Required -&gt; Bool)
-&gt; Either PkgPath Required
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either PkgPath Required -&gt; Bool
forall {a}. Either a Required -&gt; Bool
</span><a href="#local-6989586621684315102"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Either PkgPath Required] -&gt; [Either PkgPath Required])
-&gt; Commented [Either PkgPath Required]
-&gt; Commented [Either PkgPath Required]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; Commented [Either PkgPath Required]
</span><a href="Futhark.Pkg.Types.html#manifestRequire"><span class="hs-identifier hs-var hs-var">manifestRequire</span></a></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684315105"><span class="hs-identifier hs-var">pm</span></a></span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="annottext">Required
</span><a href="#local-6989586621684315104"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621684315102"><span class="annot"><span class="annottext">matches :: Either a Required -&gt; Bool
</span><a href="#local-6989586621684315102"><span class="hs-identifier hs-var hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; (Required -&gt; Bool) -&gt; Either a Required -&gt; Bool
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; PkgPath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315106"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; Bool) -&gt; (Required -&gt; PkgPath) -&gt; Required -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Required -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#requiredPkg"><span class="hs-identifier hs-var hs-var">requiredPkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">--- Parsing futhark.pkg.</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Futhark.Pkg.Types.html#pPkgManifest"><span class="hs-identifier hs-type">pPkgManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span>
</span><span id="line-255"></span><span id="pPkgManifest"><span class="annot"><span class="annottext">pPkgManifest :: Parser PkgManifest
</span><a href="Futhark.Pkg.Types.html#pPkgManifest"><span class="hs-identifier hs-var hs-var">pPkgManifest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621684315097"><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315097"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [PkgPath]
</span><a href="#local-6989586621684315096"><span class="hs-identifier hs-var">pComments</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621684315095"><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315095"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity PkgPath
 -&gt; ParsecT Void PkgPath Identity (Maybe PkgPath))
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; ParsecT Void PkgPath Identity ()
</span><a href="#local-6989586621684315094"><span class="hs-identifier hs-var">lexstr</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;package&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315093"><span class="hs-identifier hs-var">pPkgPath</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">space</span></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621684315091"><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315091"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [PkgPath]
</span><a href="#local-6989586621684315096"><span class="hs-identifier hs-var">pComments</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621684315090"><span class="annot"><span class="annottext">[Either PkgPath Required]
</span><a href="#local-6989586621684315090"><span class="hs-identifier hs-var">required</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; ParsecT Void PkgPath Identity ()
</span><a href="#local-6989586621684315094"><span class="hs-identifier hs-var">lexstr</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;require&quot;</span></span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity [Either PkgPath Required]
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315089"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity (Either PkgPath Required)
 -&gt; ParsecT Void PkgPath Identity [Either PkgPath Required])
-&gt; ParsecT Void PkgPath Identity (Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PkgPath -&gt; Either PkgPath Required
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Either PkgPath Required)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315087"><span class="hs-identifier hs-var">pComment</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity (Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity (Either PkgPath Required)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Required -&gt; Either PkgPath Required
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Required -&gt; Either PkgPath Required)
-&gt; ParsecT Void PkgPath Identity Required
-&gt; ParsecT Void PkgPath Identity (Either PkgPath Required)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Required
</span><a href="#local-6989586621684315086"><span class="hs-identifier hs-var">pRequired</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity [Either PkgPath Required]
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required]
-&gt; ParsecT Void PkgPath Identity [Either PkgPath Required]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621684315085"><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315085"><span class="hs-identifier hs-var">c3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [PkgPath]
</span><a href="#local-6989586621684315096"><span class="hs-identifier hs-var">pComments</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="annottext">PkgManifest -&gt; Parser PkgManifest
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PkgManifest -&gt; Parser PkgManifest)
-&gt; PkgManifest -&gt; Parser PkgManifest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Commented (Maybe PkgPath)
-&gt; Commented [Either PkgPath Required] -&gt; [PkgPath] -&gt; PkgManifest
</span><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-var">PkgManifest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PkgPath] -&gt; Maybe PkgPath -&gt; Commented (Maybe PkgPath)
forall a. [PkgPath] -&gt; a -&gt; Commented a
</span><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315097"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PkgPath
</span><a href="#local-6989586621684315095"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PkgPath]
-&gt; [Either PkgPath Required] -&gt; Commented [Either PkgPath Required]
forall a. [PkgPath] -&gt; a -&gt; Commented a
</span><a href="Futhark.Pkg.Types.html#Commented"><span class="hs-identifier hs-var">Commented</span></a></span><span> </span><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315091"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="annot"><span class="annottext">[Either PkgPath Required]
</span><a href="#local-6989586621684315090"><span class="hs-identifier hs-var">required</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PkgPath]
</span><a href="#local-6989586621684315085"><span class="hs-identifier hs-var">c3</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621684315084"><span class="annot"><a href="#local-6989586621684315083"><span class="hs-identifier hs-type">lexeme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684315084"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684315084"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621684315083"><span class="annot"><span class="annottext">lexeme :: forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315083"><span class="hs-identifier hs-var hs-var">lexeme</span></a></span></span><span> </span><span id="local-6989586621684315078"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684315078"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684315078"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParsecT Void PkgPath Identity () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">space</span></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621684315076"><span class="annot"><span class="annottext">lexeme' :: ParsecT Void PkgPath Identity a -&gt; ParsecT Void PkgPath Identity a
</span><a href="#local-6989586621684315076"><span class="hs-identifier hs-var hs-var">lexeme'</span></a></span></span><span> </span><span id="local-6989586621684315075"><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity a
</span><a href="#local-6989586621684315075"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity a
</span><a href="#local-6989586621684315075"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity a
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity FilePath
</span><a href="#local-6989586621684315074"><span class="hs-identifier hs-var">spaceNoEol</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="#local-6989586621684315094"><span class="hs-identifier hs-type">lexstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621684315094"><span class="annot"><span class="annottext">lexstr :: PkgPath -&gt; ParsecT Void PkgPath Identity ()
</span><a href="#local-6989586621684315094"><span class="hs-identifier hs-var hs-var">lexstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity PkgPath
 -&gt; ParsecT Void PkgPath Identity ())
-&gt; (PkgPath -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; PkgPath
-&gt; ParsecT Void PkgPath Identity ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity PkgPath
 -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; (PkgPath -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315083"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity PkgPath
 -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; (PkgPath -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; ParsecT Void PkgPath Identity PkgPath
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621684315645"><span class="annot"><a href="#local-6989586621684315089"><span class="hs-identifier hs-type">braces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684315645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684315645"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621684315089"><span class="annot"><span class="annottext">braces :: forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315089"><span class="hs-identifier hs-var hs-var">braces</span></a></span></span><span> </span><span id="local-6989586621684315067"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684315067"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; ParsecT Void PkgPath Identity ()
</span><a href="#local-6989586621684315094"><span class="hs-identifier hs-var">lexstr</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity () -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684315067"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; ParsecT Void PkgPath Identity () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; ParsecT Void PkgPath Identity ()
</span><a href="#local-6989586621684315094"><span class="hs-identifier hs-var">lexstr</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621684315074"><span class="annot"><span class="annottext">spaceNoEol :: ParsecT Void PkgPath Identity FilePath
</span><a href="#local-6989586621684315074"><span class="hs-identifier hs-var hs-var">spaceNoEol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity Char
 -&gt; ParsecT Void PkgPath Identity FilePath)
-&gt; ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Token PkgPath] -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall (f :: * -&gt; *) e s (m :: * -&gt; *).
(Foldable f, MonadParsec e s m) =&gt;
f (Token s) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; \t&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621684315093"><span class="annot"><span class="annottext">pPkgPath :: ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315093"><span class="hs-identifier hs-var hs-var">pPkgPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PkgPath)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">alphaNumChar</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity Char
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Token PkgPath] -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall (f :: * -&gt; *) e s (m :: * -&gt; *).
(Foldable f, MonadParsec e s m) =&gt;
f (Token s) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">oneOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;@-/.:&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; FilePath -&gt; ParsecT Void PkgPath Identity PkgPath
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; FilePath -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;package path&quot;</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621684315086"><span class="annot"><span class="annottext">pRequired :: ParsecT Void PkgPath Identity Required
</span><a href="#local-6989586621684315086"><span class="hs-identifier hs-var hs-var">pRequired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">space</span></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity Required
-&gt; ParsecT Void PkgPath Identity Required
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; SemVer -&gt; Maybe PkgPath -&gt; Required
</span><a href="Futhark.Pkg.Types.html#Required"><span class="hs-identifier hs-var">Required</span></a></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; SemVer -&gt; Maybe PkgPath -&gt; Required)
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT
     Void PkgPath Identity (SemVer -&gt; Maybe PkgPath -&gt; Required)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315076"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315093"><span class="hs-identifier hs-var">pPkgPath</span></a></span><span>
</span><span id="line-289"></span><span>               </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (SemVer -&gt; Maybe PkgPath -&gt; Required)
-&gt; Parsec Void PkgPath SemVer
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath -&gt; Required)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parsec Void PkgPath SemVer -&gt; Parsec Void PkgPath SemVer
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315076"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec Void PkgPath SemVer
</span><a href="Futhark.Pkg.Types.html#semver%27"><span class="hs-identifier hs-var">semver'</span></a></span><span>
</span><span id="line-290"></span><span>               </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath -&gt; Required)
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
-&gt; ParsecT Void PkgPath Identity Required
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315076"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315039"><span class="hs-identifier hs-var">pHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Required
-&gt; ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity Required
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">space</span></span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Required
-&gt; FilePath -&gt; ParsecT Void PkgPath Identity Required
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; FilePath -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;package requirement&quot;</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621684315039"><span class="annot"><span class="annottext">pHash :: ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315039"><span class="hs-identifier hs-var hs-var">pHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Token PkgPath -&gt; ParsecT Void PkgPath Identity (Token PkgPath)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
Token s -&gt; m (Token s)
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
Token PkgPath
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PkgPath)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">alphaNumChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621684315087"><span class="annot"><span class="annottext">pComment :: ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315087"><span class="hs-identifier hs-var hs-var">pComment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall a. Parser a -&gt; Parser a
</span><a href="#local-6989586621684315083"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void PkgPath Identity PkgPath
 -&gt; ParsecT Void PkgPath Identity PkgPath)
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PkgPath)
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity PkgPath
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tokens PkgPath -&gt; ParsecT Void PkgPath Identity (Tokens PkgPath)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">Tokens PkgPath
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity FilePath
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m (Token s)
</span><span class="hs-identifier hs-var">anySingle</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity FilePath
forall (m :: * -&gt; *) a end. MonadPlus m =&gt; m a -&gt; m end -&gt; m [a]
</span><span class="hs-operator hs-var">`manyTill`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Tokens s)
</span><span class="hs-identifier hs-var">eol</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity ()
-&gt; ParsecT Void PkgPath Identity ()
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="#local-6989586621684315096"><span class="hs-identifier hs-type">pComments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Pkg.Types.html#Comment"><span class="hs-identifier hs-type">Comment</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621684315096"><span class="annot"><span class="annottext">pComments :: Parser [PkgPath]
</span><a href="#local-6989586621684315096"><span class="hs-identifier hs-var hs-var">pComments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe PkgPath] -&gt; [PkgPath]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe PkgPath] -&gt; [PkgPath])
-&gt; ParsecT Void PkgPath Identity [Maybe PkgPath]
-&gt; Parser [PkgPath]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath)
-&gt; ParsecT Void PkgPath Identity [Maybe PkgPath]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath)
</span><a href="#local-6989586621684315011"><span class="hs-identifier hs-var">comment</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath)
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity (Maybe PkgPath)
forall {a}. ParsecT Void PkgPath Identity (Maybe a)
</span><a href="#local-6989586621684315010"><span class="hs-identifier hs-var">blankLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621684315011"><span class="annot"><span class="annottext">comment :: ParsecT Void PkgPath Identity (Maybe PkgPath)
</span><a href="#local-6989586621684315011"><span class="hs-identifier hs-var hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PkgPath -&gt; Maybe PkgPath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath -&gt; Maybe PkgPath)
-&gt; ParsecT Void PkgPath Identity PkgPath
-&gt; ParsecT Void PkgPath Identity (Maybe PkgPath)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity PkgPath
</span><a href="#local-6989586621684315087"><span class="hs-identifier hs-var">pComment</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621684315010"><span class="annot"><span class="annottext">blankLine :: ParsecT Void PkgPath Identity (Maybe a)
</span><a href="#local-6989586621684315010"><span class="hs-identifier hs-var hs-var">blankLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
-&gt; ParsecT Void PkgPath Identity FilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">spaceChar</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void PkgPath Identity FilePath
-&gt; ParsecT Void PkgPath Identity (Maybe a)
-&gt; ParsecT Void PkgPath Identity (Maybe a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; ParsecT Void PkgPath Identity (Maybe a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Parse a text as a 'PkgManifest'.  The 'FilePath' is used for any error messages.</span><span>
</span><span id="line-306"></span><span class="annot"><a href="Futhark.Pkg.Types.html#parsePkgManifest"><span class="hs-identifier hs-type">parsePkgManifest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParseErrorBundle</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span>
</span><span id="line-307"></span><span id="parsePkgManifest"><span class="annot"><span class="annottext">parsePkgManifest :: FilePath
-&gt; PkgPath -&gt; Either (ParseErrorBundle PkgPath Void) PkgManifest
</span><a href="Futhark.Pkg.Types.html#parsePkgManifest"><span class="hs-identifier hs-var hs-var">parsePkgManifest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser PkgManifest
-&gt; FilePath
-&gt; PkgPath
-&gt; Either (ParseErrorBundle PkgPath Void) PkgManifest
forall e s a.
Parsec e s a -&gt; FilePath -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">parse</span></span><span> </span><span class="annot"><span class="annottext">Parser PkgManifest
</span><a href="Futhark.Pkg.Types.html#pPkgManifest"><span class="hs-identifier hs-var">pPkgManifest</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Read contents of file and pass it to 'parsePkgManifest'.</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Futhark.Pkg.Types.html#parsePkgManifestFromFile"><span class="hs-identifier hs-type">parsePkgManifestFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgManifest"><span class="hs-identifier hs-type">PkgManifest</span></a></span><span>
</span><span id="line-311"></span><span id="parsePkgManifestFromFile"><span class="annot"><span class="annottext">parsePkgManifestFromFile :: FilePath -&gt; IO PkgManifest
</span><a href="Futhark.Pkg.Types.html#parsePkgManifestFromFile"><span class="hs-identifier hs-var hs-var">parsePkgManifestFromFile</span></a></span></span><span> </span><span id="local-6989586621684315001"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621684315001"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621684315000"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315000"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO PkgPath
</span><span class="hs-identifier hs-var">T.readFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621684315001"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; PkgPath -&gt; Either (ParseErrorBundle PkgPath Void) PkgManifest
</span><a href="Futhark.Pkg.Types.html#parsePkgManifest"><span class="hs-identifier hs-var">parsePkgManifest</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621684315001"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684315000"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684314998"><span class="annot"><span class="annottext">ParseErrorBundle PkgPath Void
</span><a href="#local-6989586621684314998"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO PkgManifest
forall (m :: * -&gt; *) a. MonadFail m =&gt; FilePath -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO PkgManifest) -&gt; FilePath -&gt; IO PkgManifest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle PkgPath Void -&gt; FilePath
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; FilePath
</span><span class="hs-identifier hs-var">errorBundlePretty</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle PkgPath Void
</span><a href="#local-6989586621684314998"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684314997"><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684314997"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PkgManifest -&gt; IO PkgManifest
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PkgManifest
</span><a href="#local-6989586621684314997"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | A mapping from package paths to their chosen revisions.  This is</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- the result of the version solver.</span><span>
</span><span id="line-319"></span><span class="hs-keyword">newtype</span><span> </span><span id="BuildList"><span class="annot"><a href="Futhark.Pkg.Types.html#BuildList"><span class="hs-identifier hs-var">BuildList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BuildList"><span class="annot"><a href="Futhark.Pkg.Types.html#BuildList"><span class="hs-identifier hs-var">BuildList</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unBuildList"><span class="annot"><span class="annottext">BuildList -&gt; Map PkgPath SemVer
</span><a href="Futhark.Pkg.Types.html#unBuildList"><span class="hs-identifier hs-var hs-var">unBuildList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#PkgPath"><span class="hs-identifier hs-type">PkgPath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SemVer</span></span><span class="hs-special">}</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684314987"><span id="local-6989586621684314993"><span class="annot"><span class="annottext">BuildList -&gt; BuildList -&gt; Bool
(BuildList -&gt; BuildList -&gt; Bool)
-&gt; (BuildList -&gt; BuildList -&gt; Bool) -&gt; Eq BuildList
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BuildList -&gt; BuildList -&gt; Bool
$c/= :: BuildList -&gt; BuildList -&gt; Bool
== :: BuildList -&gt; BuildList -&gt; Bool
$c== :: BuildList -&gt; BuildList -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684314973"><span id="local-6989586621684314975"><span id="local-6989586621684314981"><span class="annot"><span class="annottext">Int -&gt; BuildList -&gt; ShowS
[BuildList] -&gt; ShowS
BuildList -&gt; FilePath
(Int -&gt; BuildList -&gt; ShowS)
-&gt; (BuildList -&gt; FilePath)
-&gt; ([BuildList] -&gt; ShowS)
-&gt; Show BuildList
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; FilePath) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BuildList] -&gt; ShowS
$cshowList :: [BuildList] -&gt; ShowS
show :: BuildList -&gt; FilePath
$cshow :: BuildList -&gt; FilePath
showsPrec :: Int -&gt; BuildList -&gt; ShowS
$cshowsPrec :: Int -&gt; BuildList -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Prettyprint a build list; one package per line and</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- newline-terminated.</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Futhark.Pkg.Types.html#prettyBuildList"><span class="hs-identifier hs-type">prettyBuildList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Pkg.Types.html#BuildList"><span class="hs-identifier hs-type">BuildList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-325"></span><span id="prettyBuildList"><span class="annot"><span class="annottext">prettyBuildList :: BuildList -&gt; PkgPath
</span><a href="Futhark.Pkg.Types.html#prettyBuildList"><span class="hs-identifier hs-var hs-var">prettyBuildList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Pkg.Types.html#BuildList"><span class="hs-identifier hs-type">BuildList</span></a></span><span> </span><span id="local-6989586621684314972"><span class="annot"><span class="annottext">Map PkgPath SemVer
</span><a href="#local-6989586621684314972"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PkgPath] -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([PkgPath] -&gt; PkgPath) -&gt; [PkgPath] -&gt; PkgPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((PkgPath, SemVer) -&gt; PkgPath) -&gt; [(PkgPath, SemVer)] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath, SemVer) -&gt; PkgPath
</span><a href="#local-6989586621684314971"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([(PkgPath, SemVer)] -&gt; [PkgPath])
-&gt; [(PkgPath, SemVer)] -&gt; [PkgPath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((PkgPath, SemVer) -&gt; PkgPath)
-&gt; [(PkgPath, SemVer)] -&gt; [(PkgPath, SemVer)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="annot"><span class="annottext">(PkgPath, SemVer) -&gt; PkgPath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(PkgPath, SemVer)] -&gt; [(PkgPath, SemVer)])
-&gt; [(PkgPath, SemVer)] -&gt; [(PkgPath, SemVer)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map PkgPath SemVer -&gt; [(PkgPath, SemVer)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map PkgPath SemVer
</span><a href="#local-6989586621684314972"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621684314971"><span class="annot"><span class="annottext">f :: (PkgPath, SemVer) -&gt; PkgPath
</span><a href="#local-6989586621684314971"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684314968"><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684314968"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684314967"><span class="annot"><span class="annottext">SemVer
</span><a href="#local-6989586621684314967"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PkgPath] -&gt; PkgPath
</span><span class="hs-identifier hs-var">T.unwords</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PkgPath
</span><a href="#local-6989586621684314968"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PkgPath
</span><span class="hs-string">&quot;=&gt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SemVer -&gt; PkgPath
</span><span class="hs-identifier hs-var">prettySemVer</span></span><span> </span><span class="annot"><span class="annottext">SemVer
</span><a href="#local-6989586621684314967"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span></pre></body></html>