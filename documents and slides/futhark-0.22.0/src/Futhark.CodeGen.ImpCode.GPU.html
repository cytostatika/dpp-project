<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621684473608"><span id="local-6989586621684473609"></span></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Variation of &quot;Futhark.CodeGen.ImpCode&quot; that contains the notion</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- of a kernel invocation.</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.CodeGen.ImpCode.GPU</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Program"><span class="hs-identifier">Program</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier">FunctionT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Code"><span class="hs-identifier">Code</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelCode"><span class="hs-identifier">KernelCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConst"><span class="hs-identifier">KernelConst</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConstExp"><span class="hs-identifier">KernelConstExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier">HostOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier">KernelOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Fence"><span class="hs-identifier">Fence</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOp"><span class="hs-identifier">AtomicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier">Kernel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelUse"><span class="hs-identifier">KernelUse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html"><span class="hs-identifier">Futhark.IR.GPU.Sizes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier">Code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Imp</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html"><span class="hs-identifier">Futhark.IR.GPU.Sizes</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html"><span class="hs-identifier">Futhark.IR.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | A program that calls kernels.</span><span>
</span><span id="line-32"></span><span class="hs-keyword">type</span><span> </span><span id="Program"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Definitions"><span class="hs-identifier hs-type">Imp.Definitions</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-type">HostOp</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | A function that calls kernels.</span><span>
</span><span id="line-35"></span><span class="hs-keyword">type</span><span> </span><span id="Function"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Function"><span class="hs-identifier hs-var">Function</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Imp.Function</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-type">HostOp</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Host-level code that can call kernels.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">type</span><span> </span><span id="Code"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Code"><span class="hs-identifier hs-var">Code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Imp.Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-type">HostOp</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Code inside a kernel.</span><span>
</span><span id="line-41"></span><span class="hs-keyword">type</span><span> </span><span id="KernelCode"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelCode"><span class="hs-identifier hs-var">KernelCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Imp.Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier hs-type">KernelOp</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | A run-time constant related to kernels.</span><span>
</span><span id="line-44"></span><span class="hs-keyword">newtype</span><span> </span><span id="KernelConst"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConst"><span class="hs-identifier hs-var">KernelConst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SizeConst"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#SizeConst"><span class="hs-identifier hs-var">SizeConst</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473589"><span id="local-6989586621684473594"><span class="annot"><span class="annottext">KernelConst -&gt; KernelConst -&gt; Bool
(KernelConst -&gt; KernelConst -&gt; Bool)
-&gt; (KernelConst -&gt; KernelConst -&gt; Bool) -&gt; Eq KernelConst
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: KernelConst -&gt; KernelConst -&gt; Bool
$c/= :: KernelConst -&gt; KernelConst -&gt; Bool
== :: KernelConst -&gt; KernelConst -&gt; Bool
$c== :: KernelConst -&gt; KernelConst -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473556"><span id="local-6989586621684473560"><span id="local-6989586621684473564"><span id="local-6989586621684473568"><span id="local-6989586621684473572"><span id="local-6989586621684473576"><span id="local-6989586621684473581"><span class="annot"><span class="annottext">Eq KernelConst
Eq KernelConst
-&gt; (KernelConst -&gt; KernelConst -&gt; Ordering)
-&gt; (KernelConst -&gt; KernelConst -&gt; Bool)
-&gt; (KernelConst -&gt; KernelConst -&gt; Bool)
-&gt; (KernelConst -&gt; KernelConst -&gt; Bool)
-&gt; (KernelConst -&gt; KernelConst -&gt; Bool)
-&gt; (KernelConst -&gt; KernelConst -&gt; KernelConst)
-&gt; (KernelConst -&gt; KernelConst -&gt; KernelConst)
-&gt; Ord KernelConst
KernelConst -&gt; KernelConst -&gt; Bool
KernelConst -&gt; KernelConst -&gt; Ordering
KernelConst -&gt; KernelConst -&gt; KernelConst
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: KernelConst -&gt; KernelConst -&gt; KernelConst
$cmin :: KernelConst -&gt; KernelConst -&gt; KernelConst
max :: KernelConst -&gt; KernelConst -&gt; KernelConst
$cmax :: KernelConst -&gt; KernelConst -&gt; KernelConst
&gt;= :: KernelConst -&gt; KernelConst -&gt; Bool
$c&gt;= :: KernelConst -&gt; KernelConst -&gt; Bool
&gt; :: KernelConst -&gt; KernelConst -&gt; Bool
$c&gt; :: KernelConst -&gt; KernelConst -&gt; Bool
&lt;= :: KernelConst -&gt; KernelConst -&gt; Bool
$c&lt;= :: KernelConst -&gt; KernelConst -&gt; Bool
&lt; :: KernelConst -&gt; KernelConst -&gt; Bool
$c&lt; :: KernelConst -&gt; KernelConst -&gt; Bool
compare :: KernelConst -&gt; KernelConst -&gt; Ordering
$ccompare :: KernelConst -&gt; KernelConst -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473542"><span id="local-6989586621684473544"><span id="local-6989586621684473550"><span class="annot"><span class="annottext">Int -&gt; KernelConst -&gt; ShowS
[KernelConst] -&gt; ShowS
KernelConst -&gt; String
(Int -&gt; KernelConst -&gt; ShowS)
-&gt; (KernelConst -&gt; String)
-&gt; ([KernelConst] -&gt; ShowS)
-&gt; Show KernelConst
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [KernelConst] -&gt; ShowS
$cshowList :: [KernelConst] -&gt; ShowS
show :: KernelConst -&gt; String
$cshow :: KernelConst -&gt; String
showsPrec :: Int -&gt; KernelConst -&gt; ShowS
$cshowsPrec :: Int -&gt; KernelConst -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | An expression whose variables are kernel constants.</span><span>
</span><span id="line-48"></span><span class="hs-keyword">type</span><span> </span><span id="KernelConstExp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConstExp"><span class="hs-identifier hs-var">KernelConstExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConst"><span class="hs-identifier hs-type">KernelConst</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | An operation that runs on the host (CPU).</span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="HostOp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-var">HostOp</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CallKernel"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CallKernel"><span class="hs-identifier hs-var">CallKernel</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier hs-type">Kernel</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetSize"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSize"><span class="hs-identifier hs-var">GetSize</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#SizeClass"><span class="hs-identifier hs-type">SizeClass</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CmpSizeLe"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CmpSizeLe"><span class="hs-identifier hs-var">CmpSizeLe</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#SizeClass"><span class="hs-identifier hs-type">SizeClass</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Imp.Exp</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetSizeMax"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSizeMax"><span class="hs-identifier hs-var">GetSizeMax</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#SizeClass"><span class="hs-identifier hs-type">SizeClass</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473514"><span id="local-6989586621684473516"><span id="local-6989586621684473535"><span class="annot"><span class="annottext">Int -&gt; HostOp -&gt; ShowS
[HostOp] -&gt; ShowS
HostOp -&gt; String
(Int -&gt; HostOp -&gt; ShowS)
-&gt; (HostOp -&gt; String) -&gt; ([HostOp] -&gt; ShowS) -&gt; Show HostOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HostOp] -&gt; ShowS
$cshowList :: [HostOp] -&gt; ShowS
show :: HostOp -&gt; String
$cshow :: HostOp -&gt; String
showsPrec :: Int -&gt; HostOp -&gt; ShowS
$cshowsPrec :: Int -&gt; HostOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | A generic kernel containing arbitrary kernel code.</span><span>
</span><span id="line-59"></span><span class="hs-keyword">data</span><span> </span><span id="Kernel"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier hs-var">Kernel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Kernel"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier hs-var">Kernel</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="kernelBody"><span class="annot"><span class="annottext">Kernel -&gt; Code KernelOp
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelBody"><span class="hs-identifier hs-var hs-var">kernelBody</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Imp.Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier hs-type">KernelOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- | The host variables referenced by the kernel.</span><span>
</span><span id="line-62"></span><span>    </span><span id="kernelUses"><span class="annot"><span class="annottext">Kernel -&gt; [KernelUse]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelUses"><span class="hs-identifier hs-var hs-var">kernelUses</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelUse"><span class="hs-identifier hs-type">KernelUse</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span id="kernelNumGroups"><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelNumGroups"><span class="hs-identifier hs-var hs-var">kernelNumGroups</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Imp.Exp</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span id="kernelGroupSize"><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelGroupSize"><span class="hs-identifier hs-var hs-var">kernelGroupSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Imp.Exp</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- | A short descriptive and _unique_ name - should be</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- alphanumeric and without spaces.</span><span>
</span><span id="line-67"></span><span>    </span><span id="kernelName"><span class="annot"><span class="annottext">Kernel -&gt; Name
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelName"><span class="hs-identifier hs-var hs-var">kernelName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- | If true, this kernel does not need to check</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- whether we are in a failing state, as it can cope.</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- Intuitively, it means that the kernel does not</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- depend on any non-scalar parameters to make control</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- flow decisions.  Replication, transpose, and copy</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- kernels are examples of this.</span><span>
</span><span id="line-74"></span><span>    </span><span id="kernelFailureTolerant"><span class="annot"><span class="annottext">Kernel -&gt; Bool
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelFailureTolerant"><span class="hs-identifier hs-var hs-var">kernelFailureTolerant</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473488"><span id="local-6989586621684473490"><span id="local-6989586621684473505"><span class="annot"><span class="annottext">Int -&gt; Kernel -&gt; ShowS
[Kernel] -&gt; ShowS
Kernel -&gt; String
(Int -&gt; Kernel -&gt; ShowS)
-&gt; (Kernel -&gt; String) -&gt; ([Kernel] -&gt; ShowS) -&gt; Show Kernel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Kernel] -&gt; ShowS
$cshowList :: [Kernel] -&gt; ShowS
show :: Kernel -&gt; String
$cshow :: Kernel -&gt; String
showsPrec :: Int -&gt; Kernel -&gt; ShowS
$cshowsPrec :: Int -&gt; Kernel -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Information about a host-level variable that is used inside this</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- kernel.  When generating the actual kernel code, this is used to</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- deduce which parameters are needed.</span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="KernelUse"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelUse"><span class="hs-identifier hs-var">KernelUse</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ScalarUse"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ScalarUse"><span class="hs-identifier hs-var">ScalarUse</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MemoryUse"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#MemoryUse"><span class="hs-identifier hs-var">MemoryUse</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ConstUse"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ConstUse"><span class="hs-identifier hs-var">ConstUse</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConstExp"><span class="hs-identifier hs-type">KernelConstExp</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473471"><span id="local-6989586621684473482"><span class="annot"><span class="annottext">KernelUse -&gt; KernelUse -&gt; Bool
(KernelUse -&gt; KernelUse -&gt; Bool)
-&gt; (KernelUse -&gt; KernelUse -&gt; Bool) -&gt; Eq KernelUse
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: KernelUse -&gt; KernelUse -&gt; Bool
$c/= :: KernelUse -&gt; KernelUse -&gt; Bool
== :: KernelUse -&gt; KernelUse -&gt; Bool
$c== :: KernelUse -&gt; KernelUse -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473437"><span id="local-6989586621684473439"><span id="local-6989586621684473442"><span id="local-6989586621684473445"><span id="local-6989586621684473448"><span id="local-6989586621684473456"><span id="local-6989586621684473467"><span class="annot"><span class="annottext">Eq KernelUse
Eq KernelUse
-&gt; (KernelUse -&gt; KernelUse -&gt; Ordering)
-&gt; (KernelUse -&gt; KernelUse -&gt; Bool)
-&gt; (KernelUse -&gt; KernelUse -&gt; Bool)
-&gt; (KernelUse -&gt; KernelUse -&gt; Bool)
-&gt; (KernelUse -&gt; KernelUse -&gt; Bool)
-&gt; (KernelUse -&gt; KernelUse -&gt; KernelUse)
-&gt; (KernelUse -&gt; KernelUse -&gt; KernelUse)
-&gt; Ord KernelUse
KernelUse -&gt; KernelUse -&gt; Bool
KernelUse -&gt; KernelUse -&gt; Ordering
KernelUse -&gt; KernelUse -&gt; KernelUse
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: KernelUse -&gt; KernelUse -&gt; KernelUse
$cmin :: KernelUse -&gt; KernelUse -&gt; KernelUse
max :: KernelUse -&gt; KernelUse -&gt; KernelUse
$cmax :: KernelUse -&gt; KernelUse -&gt; KernelUse
&gt;= :: KernelUse -&gt; KernelUse -&gt; Bool
$c&gt;= :: KernelUse -&gt; KernelUse -&gt; Bool
&gt; :: KernelUse -&gt; KernelUse -&gt; Bool
$c&gt; :: KernelUse -&gt; KernelUse -&gt; Bool
&lt;= :: KernelUse -&gt; KernelUse -&gt; Bool
$c&lt;= :: KernelUse -&gt; KernelUse -&gt; Bool
&lt; :: KernelUse -&gt; KernelUse -&gt; Bool
$c&lt; :: KernelUse -&gt; KernelUse -&gt; Bool
compare :: KernelUse -&gt; KernelUse -&gt; Ordering
$ccompare :: KernelUse -&gt; KernelUse -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473421"><span id="local-6989586621684473423"><span id="local-6989586621684473435"><span class="annot"><span class="annottext">Int -&gt; KernelUse -&gt; ShowS
[KernelUse] -&gt; ShowS
KernelUse -&gt; String
(Int -&gt; KernelUse -&gt; ShowS)
-&gt; (KernelUse -&gt; String)
-&gt; ([KernelUse] -&gt; ShowS)
-&gt; Show KernelUse
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [KernelUse] -&gt; ShowS
$cshowList :: [KernelUse] -&gt; ShowS
show :: KernelUse -&gt; String
$cshow :: KernelUse -&gt; String
showsPrec :: Int -&gt; KernelUse -&gt; ShowS
$cshowsPrec :: Int -&gt; KernelUse -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684473416"><span id="local-6989586621684473418"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelConst"><span class="hs-identifier hs-type">KernelConst</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621684473410"><span class="annot"><span class="annottext">ppr :: KernelConst -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#SizeConst"><span class="hs-identifier hs-type">SizeConst</span></a></span><span> </span><span id="local-6989586621684473408"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473408"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473408"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684473401"><span id="local-6989586621684473403"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelUse"><span class="hs-identifier hs-type">KernelUse</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621684473388"><span class="annot"><span class="annottext">ppr :: KernelUse -&gt; Doc
</span><a href="#local-6989586621684473388"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ScalarUse"><span class="hs-identifier hs-type">ScalarUse</span></a></span><span> </span><span id="local-6989586621684473387"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473387"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684473386"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684473386"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#oneLine"><span class="hs-identifier hs-var">oneLine</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scalar_copy&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473387"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684473386"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#MemoryUse"><span class="hs-identifier hs-type">MemoryUse</span></a></span><span> </span><span id="local-6989586621684473383"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473383"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#oneLine"><span class="hs-identifier hs-var">oneLine</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mem_copy&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473383"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ConstUse"><span class="hs-identifier hs-type">ConstUse</span></a></span><span> </span><span id="local-6989586621684473382"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473382"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684473381"><span class="annot"><span class="annottext">KernelConstExp
</span><a href="#local-6989586621684473381"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#oneLine"><span class="hs-identifier hs-var">oneLine</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; Doc) -&gt; Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;const&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473382"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KernelConstExp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">KernelConstExp
</span><a href="#local-6989586621684473381"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684473376"><span id="local-6989586621684473378"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-type">HostOp</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621684473361"><span class="annot"><span class="annottext">ppr :: HostOp -&gt; Doc
</span><a href="#local-6989586621684473361"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSize"><span class="hs-identifier hs-type">GetSize</span></a></span><span> </span><span id="local-6989586621684473360"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473360"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684473359"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473359"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621684473358"><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473358"><span class="hs-identifier hs-var">size_class</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473360"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473359"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SizeClass -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473358"><span class="hs-identifier hs-var">size_class</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSizeMax"><span class="hs-identifier hs-type">GetSizeMax</span></a></span><span> </span><span id="local-6989586621684473356"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473356"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684473355"><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473355"><span class="hs-identifier hs-var">size_class</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473356"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_size_max&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SizeClass -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473355"><span class="hs-identifier hs-var">size_class</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CmpSizeLe"><span class="hs-identifier hs-type">CmpSizeLe</span></a></span><span> </span><span id="local-6989586621684473354"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473354"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684473353"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473353"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684473352"><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473352"><span class="hs-identifier hs-var">size_class</span></a></span></span><span> </span><span id="local-6989586621684473351"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473351"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473354"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;get_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684473353"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SizeClass -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><a href="#local-6989586621684473352"><span class="hs-identifier hs-var">size_class</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473351"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CallKernel"><span class="hs-identifier hs-type">CallKernel</span></a></span><span> </span><span id="local-6989586621684473350"><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473350"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">Kernel -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473350"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#HostOp"><span class="hs-identifier hs-type">HostOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621684473336"><span class="annot"><span class="annottext">freeIn' :: HostOp -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CallKernel"><span class="hs-identifier hs-type">CallKernel</span></a></span><span> </span><span id="local-6989586621684473334"><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473334"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">Kernel -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473334"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#CmpSizeLe"><span class="hs-identifier hs-type">CmpSizeLe</span></a></span><span> </span><span id="local-6989586621684473333"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473333"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473332"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473332"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473333"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473332"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSizeMax"><span class="hs-identifier hs-type">GetSizeMax</span></a></span><span> </span><span id="local-6989586621684473331"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473331"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473331"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetSize"><span class="hs-identifier hs-type">GetSize</span></a></span><span> </span><span id="local-6989586621684473330"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473330"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SizeClass
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473330"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier hs-type">Kernel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621684473318"><span class="annot"><span class="annottext">freeIn' :: Kernel -&gt; FV
</span><a href="#local-6989586621684473318"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span id="local-6989586621684473317"><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473317"><span class="hs-identifier hs-var">kernel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">Code KernelOp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kernel -&gt; Code KernelOp
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelBody"><span class="hs-identifier hs-var hs-var">kernelBody</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473317"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[Exp]] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelNumGroups"><span class="hs-identifier hs-var hs-var">kernelNumGroups</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473317"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelGroupSize"><span class="hs-identifier hs-var hs-var">kernelGroupSize</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473317"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684473312"><span id="local-6989586621684473314"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Kernel"><span class="hs-identifier hs-type">Kernel</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621684473300"><span class="annot"><span class="annottext">ppr :: Kernel -&gt; Doc
</span><a href="#local-6989586621684473300"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span id="local-6989586621684473299"><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kernel&quot;</span></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;groups&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">([Exp] -&gt; Doc) -&gt; [Exp] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelNumGroups"><span class="hs-identifier hs-var hs-var">kernelNumGroups</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;group_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">([Exp] -&gt; Doc) -&gt; [Exp] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; [Exp]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelGroupSize"><span class="hs-identifier hs-var hs-var">kernelGroupSize</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uses&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(KernelUse -&gt; Doc) -&gt; [KernelUse] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">KernelUse -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">([KernelUse] -&gt; [Doc]) -&gt; [KernelUse] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; [KernelUse]
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelUses"><span class="hs-identifier hs-var hs-var">kernelUses</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;failure_tolerant&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Doc) -&gt; Bool -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; Bool
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelFailureTolerant"><span class="hs-identifier hs-var hs-var">kernelFailureTolerant</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var">brace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code KernelOp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">(Code KernelOp -&gt; Doc) -&gt; Code KernelOp -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Kernel -&gt; Code KernelOp
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#kernelBody"><span class="hs-identifier hs-var hs-var">kernelBody</span></a></span><span> </span><span class="annot"><span class="annottext">Kernel
</span><a href="#local-6989586621684473299"><span class="hs-identifier hs-var">kernel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | When we do a barrier or fence, is it at the local or global</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- level?  By the 'Ord' instance, global is greater than local.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">data</span><span> </span><span id="Fence"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Fence"><span class="hs-identifier hs-var">Fence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FenceLocal"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceLocal"><span class="hs-identifier hs-var">FenceLocal</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="FenceGlobal"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceGlobal"><span class="hs-identifier hs-var">FenceGlobal</span></a></span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473289"><span id="local-6989586621684473291"><span id="local-6989586621684473293"><span class="annot"><span class="annottext">Int -&gt; Fence -&gt; ShowS
[Fence] -&gt; ShowS
Fence -&gt; String
(Int -&gt; Fence -&gt; ShowS)
-&gt; (Fence -&gt; String) -&gt; ([Fence] -&gt; ShowS) -&gt; Show Fence
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Fence] -&gt; ShowS
$cshowList :: [Fence] -&gt; ShowS
show :: Fence -&gt; String
$cshow :: Fence -&gt; String
showsPrec :: Int -&gt; Fence -&gt; ShowS
$cshowsPrec :: Int -&gt; Fence -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473285"><span id="local-6989586621684473287"><span class="annot"><span class="annottext">Fence -&gt; Fence -&gt; Bool
(Fence -&gt; Fence -&gt; Bool) -&gt; (Fence -&gt; Fence -&gt; Bool) -&gt; Eq Fence
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Fence -&gt; Fence -&gt; Bool
$c/= :: Fence -&gt; Fence -&gt; Bool
== :: Fence -&gt; Fence -&gt; Bool
$c== :: Fence -&gt; Fence -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684473266"><span id="local-6989586621684473268"><span id="local-6989586621684473271"><span id="local-6989586621684473274"><span id="local-6989586621684473277"><span id="local-6989586621684473279"><span id="local-6989586621684473281"><span class="annot"><span class="annottext">Eq Fence
Eq Fence
-&gt; (Fence -&gt; Fence -&gt; Ordering)
-&gt; (Fence -&gt; Fence -&gt; Bool)
-&gt; (Fence -&gt; Fence -&gt; Bool)
-&gt; (Fence -&gt; Fence -&gt; Bool)
-&gt; (Fence -&gt; Fence -&gt; Bool)
-&gt; (Fence -&gt; Fence -&gt; Fence)
-&gt; (Fence -&gt; Fence -&gt; Fence)
-&gt; Ord Fence
Fence -&gt; Fence -&gt; Bool
Fence -&gt; Fence -&gt; Ordering
Fence -&gt; Fence -&gt; Fence
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Fence -&gt; Fence -&gt; Fence
$cmin :: Fence -&gt; Fence -&gt; Fence
max :: Fence -&gt; Fence -&gt; Fence
$cmax :: Fence -&gt; Fence -&gt; Fence
&gt;= :: Fence -&gt; Fence -&gt; Bool
$c&gt;= :: Fence -&gt; Fence -&gt; Bool
&gt; :: Fence -&gt; Fence -&gt; Bool
$c&gt; :: Fence -&gt; Fence -&gt; Bool
&lt;= :: Fence -&gt; Fence -&gt; Bool
$c&lt;= :: Fence -&gt; Fence -&gt; Bool
&lt; :: Fence -&gt; Fence -&gt; Bool
$c&lt; :: Fence -&gt; Fence -&gt; Bool
compare :: Fence -&gt; Fence -&gt; Ordering
$ccompare :: Fence -&gt; Fence -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | An operation that occurs within a kernel body.</span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="KernelOp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier hs-var">KernelOp</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GetGroupId"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGroupId"><span class="hs-identifier hs-var">GetGroupId</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetLocalId"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLocalId"><span class="hs-identifier hs-var">GetLocalId</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetLocalSize"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLocalSize"><span class="hs-identifier hs-var">GetLocalSize</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetGlobalSize"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGlobalSize"><span class="hs-identifier hs-var">GetGlobalSize</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetGlobalId"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGlobalId"><span class="hs-identifier hs-var">GetGlobalId</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GetLockstepWidth"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLockstepWidth"><span class="hs-identifier hs-var">GetLockstepWidth</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Atomic"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-var">Atomic</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Space"><span class="hs-identifier hs-type">Space</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOp"><span class="hs-identifier hs-type">AtomicOp</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Barrier"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Barrier"><span class="hs-identifier hs-var">Barrier</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Fence"><span class="hs-identifier hs-type">Fence</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MemFence"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#MemFence"><span class="hs-identifier hs-var">MemFence</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Fence"><span class="hs-identifier hs-type">Fence</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LocalAlloc"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#LocalAlloc"><span class="hs-identifier hs-var">LocalAlloc</span></a></span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Perform a barrier and also check whether any</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- threads have failed an assertion.  Make sure all</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- threads would reach all 'ErrorSync's if any of them</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- do.  A failing assertion will jump to the next</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">-- following 'ErrorSync', so make sure it's not inside</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- control flow or similar.</span><span>
</span><span id="line-161"></span><span>    </span><span id="ErrorSync"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ErrorSync"><span class="hs-identifier hs-var">ErrorSync</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Fence"><span class="hs-identifier hs-type">Fence</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473216"><span id="local-6989586621684473218"><span id="local-6989586621684473253"><span class="annot"><span class="annottext">Int -&gt; KernelOp -&gt; ShowS
[KernelOp] -&gt; ShowS
KernelOp -&gt; String
(Int -&gt; KernelOp -&gt; ShowS)
-&gt; (KernelOp -&gt; String) -&gt; ([KernelOp] -&gt; ShowS) -&gt; Show KernelOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [KernelOp] -&gt; ShowS
$cshowList :: [KernelOp] -&gt; ShowS
show :: KernelOp -&gt; String
$cshow :: KernelOp -&gt; String
showsPrec :: Int -&gt; KernelOp -&gt; ShowS
$cshowsPrec :: Int -&gt; KernelOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Atomic operations return the value stored before the update.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- This old value is stored in the first 'VName'.  The second 'VName'</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- is the memory block to update.  The 'Exp' is the new value.</span><span>
</span><span id="line-167"></span><span class="hs-keyword">data</span><span> </span><span id="AtomicOp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOp"><span class="hs-identifier hs-var">AtomicOp</span></a></span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AtomicAdd"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAdd"><span class="hs-identifier hs-var">AtomicAdd</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicFAdd"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicFAdd"><span class="hs-identifier hs-var">AtomicFAdd</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicSMax"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMax"><span class="hs-identifier hs-var">AtomicSMax</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicSMin"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMin"><span class="hs-identifier hs-var">AtomicSMin</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicUMax"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMax"><span class="hs-identifier hs-var">AtomicUMax</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicUMin"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMin"><span class="hs-identifier hs-var">AtomicUMin</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicAnd"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAnd"><span class="hs-identifier hs-var">AtomicAnd</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicOr"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOr"><span class="hs-identifier hs-var">AtomicOr</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicXor"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXor"><span class="hs-identifier hs-var">AtomicXor</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicCmpXchg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicCmpXchg"><span class="hs-identifier hs-var">AtomicCmpXchg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicXchg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXchg"><span class="hs-identifier hs-var">AtomicXchg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684473128"><span id="local-6989586621684473130"><span id="local-6989586621684473202"><span class="annot"><span class="annottext">Int -&gt; AtomicOp -&gt; ShowS
[AtomicOp] -&gt; ShowS
AtomicOp -&gt; String
(Int -&gt; AtomicOp -&gt; ShowS)
-&gt; (AtomicOp -&gt; String) -&gt; ([AtomicOp] -&gt; ShowS) -&gt; Show AtomicOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AtomicOp] -&gt; ShowS
$cshowList :: [AtomicOp] -&gt; ShowS
show :: AtomicOp -&gt; String
$cshow :: AtomicOp -&gt; String
showsPrec :: Int -&gt; AtomicOp -&gt; ShowS
$cshowsPrec :: Int -&gt; AtomicOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOp"><span class="hs-identifier hs-type">AtomicOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621684473065"><span class="annot"><span class="annottext">freeIn' :: AtomicOp -&gt; FV
</span><a href="#local-6989586621684473065"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAdd"><span class="hs-identifier hs-type">AtomicAdd</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473064"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473064"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473063"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473063"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473062"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473062"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473064"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473063"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473062"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicFAdd"><span class="hs-identifier hs-type">AtomicFAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473061"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473061"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473060"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473060"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473059"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473059"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473061"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473060"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473059"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMax"><span class="hs-identifier hs-type">AtomicSMax</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473058"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473058"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473057"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473057"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473056"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473056"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473058"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473057"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473056"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMin"><span class="hs-identifier hs-type">AtomicSMin</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473055"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473055"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473054"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473054"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473053"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473053"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473055"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473054"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473053"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMax"><span class="hs-identifier hs-type">AtomicUMax</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473052"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473052"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473051"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473051"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473050"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473050"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473052"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473051"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473050"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMin"><span class="hs-identifier hs-type">AtomicUMin</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473049"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473049"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473048"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473048"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473047"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473047"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473049"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473047"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAnd"><span class="hs-identifier hs-type">AtomicAnd</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473046"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473046"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473045"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473045"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473044"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473044"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473046"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473045"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473044"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOr"><span class="hs-identifier hs-type">AtomicOr</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473043"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473043"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473042"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473042"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473041"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473041"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473043"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473042"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473041"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXor"><span class="hs-identifier hs-type">AtomicXor</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473040"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473040"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473039"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473039"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473038"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473038"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473040"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473039"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473038"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicCmpXchg"><span class="hs-identifier hs-type">AtomicCmpXchg</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473037"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473037"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473036"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473036"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473035"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473035"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684473034"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473034"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473037"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473036"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473035"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473034"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXchg"><span class="hs-identifier hs-type">AtomicXchg</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684473033"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473033"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684473032"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473032"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684473031"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473031"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684473033"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684473032"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684473031"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684473026"><span id="local-6989586621684473028"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier hs-type">KernelOp</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621684472870"><span class="annot"><span class="annottext">ppr :: KernelOp -&gt; Doc
</span><a href="#local-6989586621684472870"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGroupId"><span class="hs-identifier hs-type">GetGroupId</span></a></span><span> </span><span id="local-6989586621684472869"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472869"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684472868"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472868"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472869"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_group_id&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472868"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLocalId"><span class="hs-identifier hs-type">GetLocalId</span></a></span><span> </span><span id="local-6989586621684472867"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472867"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684472866"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472866"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472867"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_local_id&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472866"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLocalSize"><span class="hs-identifier hs-type">GetLocalSize</span></a></span><span> </span><span id="local-6989586621684472865"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472865"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684472864"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472864"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472865"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_local_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472864"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGlobalSize"><span class="hs-identifier hs-type">GetGlobalSize</span></a></span><span> </span><span id="local-6989586621684472863"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472863"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684472862"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472862"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472863"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_global_size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472862"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetGlobalId"><span class="hs-identifier hs-type">GetGlobalId</span></a></span><span> </span><span id="local-6989586621684472861"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472861"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span id="local-6989586621684472860"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472860"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472861"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_global_id&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684472860"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#GetLockstepWidth"><span class="hs-identifier hs-type">GetLockstepWidth</span></a></span><span> </span><span id="local-6989586621684472859"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472859"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472859"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;get_lockstep_width()&quot;</span></span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Barrier"><span class="hs-identifier hs-type">Barrier</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceLocal"><span class="hs-identifier hs-var">FenceLocal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;local_barrier()&quot;</span></span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Barrier"><span class="hs-identifier hs-type">Barrier</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceGlobal"><span class="hs-identifier hs-var">FenceGlobal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;global_barrier()&quot;</span></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#MemFence"><span class="hs-identifier hs-type">MemFence</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceLocal"><span class="hs-identifier hs-var">FenceLocal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;mem_fence_local()&quot;</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#MemFence"><span class="hs-identifier hs-type">MemFence</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceGlobal"><span class="hs-identifier hs-var">FenceGlobal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;mem_fence_global()&quot;</span></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#LocalAlloc"><span class="hs-identifier hs-type">LocalAlloc</span></a></span><span> </span><span id="local-6989586621684472858"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472858"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684472857"><span class="annot"><span class="annottext">Count Bytes (TExp Int64)
</span><a href="#local-6989586621684472857"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472858"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">equals</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;local_alloc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Bytes (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Bytes (TExp Int64)
</span><a href="#local-6989586621684472857"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ErrorSync"><span class="hs-identifier hs-type">ErrorSync</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceLocal"><span class="hs-identifier hs-var">FenceLocal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;error_sync_local()&quot;</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#ErrorSync"><span class="hs-identifier hs-type">ErrorSync</span></a></span><span> </span><span class="annot"><span class="annottext">Fence
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#FenceGlobal"><span class="hs-identifier hs-var">FenceGlobal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;error_sync_global()&quot;</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAdd"><span class="hs-identifier hs-type">AtomicAdd</span></a></span><span> </span><span id="local-6989586621684472855"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472855"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472854"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472854"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472853"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472853"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472852"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472852"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472851"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472851"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472854"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_add_&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472855"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472853"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472852"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472851"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicFAdd"><span class="hs-identifier hs-type">AtomicFAdd</span></a></span><span> </span><span id="local-6989586621684472849"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684472849"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472848"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472848"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472847"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472847"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472846"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472846"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472845"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472845"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472848"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_fadd_&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684472849"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472847"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472846"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472845"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMax"><span class="hs-identifier hs-type">AtomicSMax</span></a></span><span> </span><span id="local-6989586621684472844"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472844"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472843"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472843"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472842"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472842"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472841"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472841"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472840"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472840"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472843"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_smax&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472844"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472842"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472841"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472840"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicSMin"><span class="hs-identifier hs-type">AtomicSMin</span></a></span><span> </span><span id="local-6989586621684472839"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472839"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472838"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472838"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472837"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472837"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472836"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472836"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472835"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472835"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472838"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_smin&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472839"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472837"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472836"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472835"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMax"><span class="hs-identifier hs-type">AtomicUMax</span></a></span><span> </span><span id="local-6989586621684472834"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472834"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472833"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472833"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472832"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472832"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472831"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472831"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472830"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472830"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472833"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_umax&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472834"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472832"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472831"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472830"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicUMin"><span class="hs-identifier hs-type">AtomicUMin</span></a></span><span> </span><span id="local-6989586621684472829"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472829"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472828"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472828"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472827"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472827"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472826"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472826"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472825"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472825"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472828"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_umin&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472829"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472827"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472826"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472825"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicAnd"><span class="hs-identifier hs-type">AtomicAnd</span></a></span><span> </span><span id="local-6989586621684472824"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472824"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472823"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472823"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472822"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472822"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472821"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472821"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472820"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472820"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472823"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_and&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472824"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472822"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472821"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472820"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicOr"><span class="hs-identifier hs-type">AtomicOr</span></a></span><span> </span><span id="local-6989586621684472819"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472819"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472818"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472818"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472817"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472817"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472816"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472816"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472815"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472815"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472818"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_or&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472819"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472817"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472816"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472815"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXor"><span class="hs-identifier hs-type">AtomicXor</span></a></span><span> </span><span id="local-6989586621684472814"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472814"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472813"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472813"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472812"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472812"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472811"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472811"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472810"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472810"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472813"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_xor&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684472814"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472812"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472811"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472810"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicCmpXchg"><span class="hs-identifier hs-type">AtomicCmpXchg</span></a></span><span> </span><span id="local-6989586621684472809"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684472809"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472808"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472808"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472807"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472807"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472806"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472806"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472805"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472805"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684472804"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472804"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472808"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_cmp_xchg&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684472809"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472807"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472806"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472805"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472804"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#AtomicXchg"><span class="hs-identifier hs-type">AtomicXchg</span></a></span><span> </span><span id="local-6989586621684472803"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684472803"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621684472802"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472802"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621684472801"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472801"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472800"><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472800"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621684472799"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472799"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472802"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&lt;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;atomic_xchg&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684472803"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472801"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">brackets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Count Elements (TExp Int64) -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int64)
</span><a href="#local-6989586621684472800"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472799"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#KernelOp"><span class="hs-identifier hs-type">KernelOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621684472794"><span class="annot"><span class="annottext">freeIn' :: KernelOp -&gt; FV
</span><a href="#local-6989586621684472794"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">Space
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472793"><span class="annot"><span class="annottext">AtomicOp
</span><a href="#local-6989586621684472793"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AtomicOp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicOp
</span><a href="#local-6989586621684472793"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">KernelOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FV
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-type">brace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span>
</span><span id="line-266"></span><span id="brace"><span class="annot"><span class="annottext">brace :: Doc -&gt; Doc
</span><a href="Futhark.CodeGen.ImpCode.GPU.html#brace"><span class="hs-identifier hs-var hs-var">brace</span></a></span></span><span> </span><span id="local-6989586621684472792"><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684472792"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot; {&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; Doc
</span><span class="hs-identifier hs-var">indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621684472792"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-267"></span></pre></body></html>