<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Facilities for changing the rep of some fragment, with no</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- context.  We call this &quot;rephrasing&quot;, for no deep reason.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Analysis.Rephrase</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseProg"><span class="hs-identifier">rephraseProg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseFunDef"><span class="hs-identifier">rephraseFunDef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseExp"><span class="hs-identifier">rephraseExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier">rephraseBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier">rephraseStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseLambda"><span class="hs-identifier">rephraseLambda</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephrasePat"><span class="hs-identifier">rephrasePat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephrasePatElem"><span class="hs-identifier">rephrasePatElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier">Rephraser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.html"><span class="hs-identifier">Futhark.IR</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | A collection of functions that together allow us to rephrase some</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- IR fragment, in some monad @m@.  If we let @m@ be the 'Maybe'</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- monad, we can conveniently do rephrasing that might fail.  This is</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- useful if you want to see if some IR in e.g. the @Kernels@ rep</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- actually uses any @Kernels@-specific operations.</span><span>
</span><span id="line-25"></span><span class="hs-keyword">data</span><span> </span><span id="Rephraser"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-var">Rephraser</span></a></span></span><span> </span><span id="local-6989586621684346857"><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621684346856"><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span></span><span> </span><span id="local-6989586621684346855"><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Rephraser"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-var">Rephraser</span></a></span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="rephraseExpDec"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; ExpDec from -&gt; m (ExpDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExpDec"><span class="hs-identifier hs-var hs-var">rephraseExpDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-type">ExpDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-type">ExpDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span id="rephraseLetBoundDec"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; LetDec from -&gt; m (LetDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLetBoundDec"><span class="hs-identifier hs-var hs-var">rephraseLetBoundDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span id="rephraseFParamDec"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; FParamInfo from -&gt; m (FParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFParamDec"><span class="hs-identifier hs-var hs-var">rephraseFParamDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span id="rephraseLParamDec"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; LParamInfo from -&gt; m (LParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLParamDec"><span class="hs-identifier hs-var hs-var">rephraseLParamDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span id="rephraseBodyDec"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; BodyDec from -&gt; m (BodyDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBodyDec"><span class="hs-identifier hs-var hs-var">rephraseBodyDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-type">BodyDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-type">BodyDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span id="rephraseRetType"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; RetType from -&gt; m (RetType to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseRetType"><span class="hs-identifier hs-var hs-var">rephraseRetType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#RetType"><span class="hs-identifier hs-type">RetType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#RetType"><span class="hs-identifier hs-type">RetType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span id="rephraseBranchType"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; BranchType from -&gt; m (BranchType to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBranchType"><span class="hs-identifier hs-var hs-var">rephraseBranchType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-type">BranchType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-type">BranchType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span id="rephraseOp"><span class="annot"><span class="annottext">forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; Op from -&gt; m (Op to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseOp"><span class="hs-identifier hs-var hs-var">rephraseOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346856"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346855"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Rephrase an entire program.</span><span>
</span><span id="line-37"></span><span id="local-6989586621684346819"><span id="local-6989586621684346820"><span id="local-6989586621684346821"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseProg"><span class="hs-identifier hs-type">rephraseProg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346820"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346819"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346820"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346821"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346819"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-38"></span><span id="rephraseProg"><span class="annot"><span class="annottext">rephraseProg :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Prog from -&gt; m (Prog to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseProg"><span class="hs-identifier hs-var hs-var">rephraseProg</span></a></span></span><span> </span><span id="local-6989586621684346667"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346667"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621684346665"><span class="annot"><span class="annottext">Stms from
</span><a href="#local-6989586621684346665"><span class="hs-identifier hs-var">consts</span></a></span></span><span> </span><span id="local-6989586621684346664"><span class="annot"><span class="annottext">[FunDef from]
</span><a href="#local-6989586621684346664"><span class="hs-identifier hs-var">funs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="annottext">Stms to -&gt; [FunDef to] -&gt; Prog to
forall rep. Stms rep -&gt; [FunDef rep] -&gt; Prog rep
</span><a href="Futhark.IR.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="annottext">(Stms to -&gt; [FunDef to] -&gt; Prog to)
-&gt; m (Stms to) -&gt; m ([FunDef to] -&gt; Prog to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Stm from -&gt; m (Stm to)) -&gt; Stms from -&gt; m (Stms to)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier hs-var">rephraseStm</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346667"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stms from
</span><a href="#local-6989586621684346665"><span class="hs-identifier hs-var">consts</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="annottext">m ([FunDef to] -&gt; Prog to) -&gt; m [FunDef to] -&gt; m (Prog to)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FunDef from -&gt; m (FunDef to)) -&gt; [FunDef from] -&gt; m [FunDef to]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; FunDef from -&gt; m (FunDef to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; FunDef from -&gt; m (FunDef to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFunDef"><span class="hs-identifier hs-var">rephraseFunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346667"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDef from]
</span><a href="#local-6989586621684346664"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Rephrase a function definition.</span><span>
</span><span id="line-44"></span><span id="local-6989586621684346793"><span id="local-6989586621684346794"><span id="local-6989586621684346795"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseFunDef"><span class="hs-identifier hs-type">rephraseFunDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346795"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346795"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346794"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346793"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346794"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346795"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346793"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-45"></span><span id="rephraseFunDef"><span class="annot"><span class="annottext">rephraseFunDef :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; FunDef from -&gt; m (FunDef to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFunDef"><span class="hs-identifier hs-var hs-var">rephraseFunDef</span></a></span></span><span> </span><span id="local-6989586621684346650"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346650"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span id="local-6989586621684346649"><span class="annot"><span class="annottext">FunDef from
</span><a href="#local-6989586621684346649"><span class="hs-identifier hs-var">fundec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621684346648"><span class="annot"><span class="annottext">Body to
</span><a href="#local-6989586621684346648"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Body from -&gt; m (Body to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Body from -&gt; m (Body to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier hs-var">rephraseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346650"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">(Body from -&gt; m (Body to)) -&gt; Body from -&gt; m (Body to)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunDef from -&gt; Body from
forall rep. FunDef rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#funDefBody"><span class="hs-identifier hs-var hs-var">funDefBody</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef from
</span><a href="#local-6989586621684346649"><span class="hs-identifier hs-var">fundec</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621684346646"><span class="annot"><span class="annottext">[Param (FParamInfo to)]
</span><a href="#local-6989586621684346646"><span class="hs-identifier hs-var">params'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Param (FParamInfo from) -&gt; m (Param (FParamInfo to)))
-&gt; [Param (FParamInfo from)] -&gt; m [Param (FParamInfo to)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FParamInfo from -&gt; m (FParamInfo to))
-&gt; Param (FParamInfo from) -&gt; m (Param (FParamInfo to))
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; Param from -&gt; m (Param to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-var">rephraseParam</span></a></span><span> </span><span class="annot"><span class="annottext">((FParamInfo from -&gt; m (FParamInfo to))
 -&gt; Param (FParamInfo from) -&gt; m (Param (FParamInfo to)))
-&gt; (FParamInfo from -&gt; m (FParamInfo to))
-&gt; Param (FParamInfo from)
-&gt; m (Param (FParamInfo to))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; FParamInfo from -&gt; m (FParamInfo to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; FParamInfo from -&gt; m (FParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFParamDec"><span class="hs-identifier hs-var hs-var">rephraseFParamDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346650"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Param (FParamInfo from)] -&gt; m [Param (FParamInfo to)])
-&gt; [Param (FParamInfo from)] -&gt; m [Param (FParamInfo to)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunDef from -&gt; [Param (FParamInfo from)]
forall rep. FunDef rep -&gt; [FParam rep]
</span><a href="Futhark.IR.Syntax.html#funDefParams"><span class="hs-identifier hs-var hs-var">funDefParams</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef from
</span><a href="#local-6989586621684346649"><span class="hs-identifier hs-var">fundec</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621684346643"><span class="annot"><span class="annottext">[RetType to]
</span><a href="#local-6989586621684346643"><span class="hs-identifier hs-var">rettype'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(RetType from -&gt; m (RetType to))
-&gt; [RetType from] -&gt; m [RetType to]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; RetType from -&gt; m (RetType to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; RetType from -&gt; m (RetType to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseRetType"><span class="hs-identifier hs-var hs-var">rephraseRetType</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346650"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([RetType from] -&gt; m [RetType to])
-&gt; [RetType from] -&gt; m [RetType to]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunDef from -&gt; [RetType from]
forall rep. FunDef rep -&gt; [RetType rep]
</span><a href="Futhark.IR.Syntax.html#funDefRetType"><span class="hs-identifier hs-var hs-var">funDefRetType</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef from
</span><a href="#local-6989586621684346649"><span class="hs-identifier hs-var">fundec</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">FunDef to -&gt; m (FunDef to)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FunDef from
</span><a href="#local-6989586621684346649"><span class="hs-identifier hs-var">fundec</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">funDefBody :: Body to
</span><a href="Futhark.IR.Syntax.html#funDefBody"><span class="hs-identifier hs-var">funDefBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Body to
</span><a href="#local-6989586621684346648"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funDefParams :: [Param (FParamInfo to)]
</span><a href="Futhark.IR.Syntax.html#funDefParams"><span class="hs-identifier hs-var">funDefParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Param (FParamInfo to)]
</span><a href="#local-6989586621684346646"><span class="hs-identifier hs-var">params'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funDefRetType :: [RetType to]
</span><a href="Futhark.IR.Syntax.html#funDefRetType"><span class="hs-identifier hs-var">funDefRetType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RetType to]
</span><a href="#local-6989586621684346643"><span class="hs-identifier hs-var">rettype'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Rephrase an expression.</span><span>
</span><span id="line-52"></span><span id="local-6989586621684346772"><span id="local-6989586621684346773"><span id="local-6989586621684346774"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseExp"><span class="hs-identifier hs-type">rephraseExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346773"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346772"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346773"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346774"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346772"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-53"></span><span id="rephraseExp"><span class="annot"><span class="annottext">rephraseExp :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Exp from -&gt; m (Exp to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExp"><span class="hs-identifier hs-var hs-var">rephraseExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mapper from to m -&gt; Exp from -&gt; m (Exp to)
forall (m :: * -&gt; *) frep trep.
(Applicative m, Monad m) =&gt;
Mapper frep trep m -&gt; Exp frep -&gt; m (Exp trep)
</span><a href="Futhark.IR.Traversals.html#mapExpM"><span class="hs-identifier hs-var">mapExpM</span></a></span><span> </span><span class="annot"><span class="annottext">(Mapper from to m -&gt; Exp from -&gt; m (Exp to))
-&gt; (Rephraser m from to -&gt; Mapper from to m)
-&gt; Rephraser m from to
-&gt; Exp from
-&gt; m (Exp to)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Mapper from to m
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Mapper from to m
</span><a href="Futhark.Analysis.Rephrase.html#mapper"><span class="hs-identifier hs-var">mapper</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Rephrase a statement.</span><span>
</span><span id="line-56"></span><span id="local-6989586621684346798"><span id="local-6989586621684346799"><span id="local-6989586621684346800"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier hs-type">rephraseStm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346800"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346800"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346799"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346798"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346799"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346800"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346798"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-57"></span><span id="rephraseStm"><span class="annot"><span class="annottext">rephraseStm :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier hs-var hs-var">rephraseStm</span></a></span></span><span> </span><span id="local-6989586621684346624"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346624"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621684346622"><span class="annot"><span class="annottext">Pat from
</span><a href="#local-6989586621684346622"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-type">StmAux</span></a></span><span> </span><span id="local-6989586621684346620"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684346620"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621684346619"><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684346619"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621684346618"><span class="annot"><span class="annottext">ExpDec from
</span><a href="#local-6989586621684346618"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684346617"><span class="annot"><span class="annottext">Exp from
</span><a href="#local-6989586621684346617"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="annottext">Pat to -&gt; StmAux (ExpDec to) -&gt; Exp to -&gt; Stm to
forall rep. Pat rep -&gt; StmAux (ExpDec rep) -&gt; Exp rep -&gt; Stm rep
</span><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="annottext">(Pat to -&gt; StmAux (ExpDec to) -&gt; Exp to -&gt; Stm to)
-&gt; m (Pat to) -&gt; m (StmAux (ExpDec to) -&gt; Exp to -&gt; Stm to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(LetDec from -&gt; m (LetDec to)) -&gt; Pat from -&gt; m (Pat to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; PatT from -&gt; m (PatT to)
</span><a href="Futhark.Analysis.Rephrase.html#rephrasePat"><span class="hs-identifier hs-var">rephrasePat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; LetDec from -&gt; m (LetDec to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; LetDec from -&gt; m (LetDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLetBoundDec"><span class="hs-identifier hs-var hs-var">rephraseLetBoundDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346624"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Pat from
</span><a href="#local-6989586621684346622"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="annottext">m (StmAux (ExpDec to) -&gt; Exp to -&gt; Stm to)
-&gt; m (StmAux (ExpDec to)) -&gt; m (Exp to -&gt; Stm to)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs -&gt; Attrs -&gt; ExpDec to -&gt; StmAux (ExpDec to)
forall dec. Certs -&gt; Attrs -&gt; dec -&gt; StmAux dec
</span><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-var">StmAux</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684346620"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684346619"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpDec to -&gt; StmAux (ExpDec to))
-&gt; m (ExpDec to) -&gt; m (StmAux (ExpDec to))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; ExpDec from -&gt; m (ExpDec to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; ExpDec from -&gt; m (ExpDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExpDec"><span class="hs-identifier hs-var hs-var">rephraseExpDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346624"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">ExpDec from
</span><a href="#local-6989586621684346618"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">m (Exp to -&gt; Stm to) -&gt; m (Exp to) -&gt; m (Stm to)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Exp from -&gt; m (Exp to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Exp from -&gt; m (Exp to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseExp"><span class="hs-identifier hs-var">rephraseExp</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346624"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">Exp from
</span><a href="#local-6989586621684346617"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Rephrase a pattern.</span><span>
</span><span id="line-64"></span><span id="local-6989586621684346747"><span id="local-6989586621684346748"><span id="local-6989586621684346749"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephrasePat"><span class="hs-identifier hs-type">rephrasePat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346749"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684346748"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346749"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346747"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346748"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="#local-6989586621684346749"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346747"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-69"></span><span id="rephrasePat"><span class="annot"><span class="annottext">rephrasePat :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; PatT from -&gt; m (PatT to)
</span><a href="Futhark.Analysis.Rephrase.html#rephrasePat"><span class="hs-identifier hs-var hs-var">rephrasePat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(from -&gt; m to) -&gt; PatT from -&gt; m (PatT to)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Rephrase a pattern element.</span><span>
</span><span id="line-72"></span><span id="local-6989586621684346736"><span id="local-6989586621684346737"><span id="local-6989586621684346738"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephrasePatElem"><span class="hs-identifier hs-type">rephrasePatElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684346737"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346736"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#PatElemT"><span class="hs-identifier hs-type">PatElemT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346737"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346738"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#PatElemT"><span class="hs-identifier hs-type">PatElemT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346736"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-73"></span><span id="rephrasePatElem"><span class="annot"><span class="annottext">rephrasePatElem :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; PatElemT from -&gt; m (PatElemT to)
</span><a href="Futhark.Analysis.Rephrase.html#rephrasePatElem"><span class="hs-identifier hs-var hs-var">rephrasePatElem</span></a></span></span><span> </span><span id="local-6989586621684346606"><span class="annot"><span class="annottext">from -&gt; m to
</span><a href="#local-6989586621684346606"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#PatElem"><span class="hs-identifier hs-type">PatElem</span></a></span><span> </span><span id="local-6989586621684346604"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684346604"><span class="hs-identifier hs-var">ident</span></a></span></span><span> </span><span id="local-6989586621684346603"><span class="annot"><span class="annottext">from
</span><a href="#local-6989586621684346603"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">VName -&gt; to -&gt; PatElemT to
forall dec. VName -&gt; dec -&gt; PatElemT dec
</span><a href="Futhark.IR.Syntax.Core.html#PatElem"><span class="hs-identifier hs-var">PatElem</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684346604"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">(to -&gt; PatElemT to) -&gt; m to -&gt; m (PatElemT to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">from -&gt; m to
</span><a href="#local-6989586621684346606"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">from
</span><a href="#local-6989586621684346603"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Rephrase a parameter.</span><span>
</span><span id="line-77"></span><span id="local-6989586621684346777"><span id="local-6989586621684346778"><span id="local-6989586621684346779"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-type">rephraseParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346779"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684346778"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346779"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346777"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346778"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346779"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346777"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-78"></span><span id="rephraseParam"><span class="annot"><span class="annottext">rephraseParam :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; Param from -&gt; m (Param to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-var hs-var">rephraseParam</span></a></span></span><span> </span><span id="local-6989586621684346598"><span class="annot"><span class="annottext">from -&gt; m to
</span><a href="#local-6989586621684346598"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span> </span><span id="local-6989586621684346596"><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684346596"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621684346595"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684346595"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684346594"><span class="annot"><span class="annottext">from
</span><a href="#local-6989586621684346594"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">Attrs -&gt; VName -&gt; to -&gt; Param to
forall dec. Attrs -&gt; VName -&gt; dec -&gt; Param dec
</span><a href="Futhark.IR.Syntax.Core.html#Param"><span class="hs-identifier hs-var">Param</span></a></span><span> </span><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684346596"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684346595"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(to -&gt; Param to) -&gt; m to -&gt; m (Param to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">from -&gt; m to
</span><a href="#local-6989586621684346598"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">from
</span><a href="#local-6989586621684346594"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Rephrase a body.</span><span>
</span><span id="line-82"></span><span id="local-6989586621684346786"><span id="local-6989586621684346787"><span id="local-6989586621684346788"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier hs-type">rephraseBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346788"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346788"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346787"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346786"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346787"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346788"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346786"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-83"></span><span id="rephraseBody"><span class="annot"><span class="annottext">rephraseBody :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Body from -&gt; m (Body to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier hs-var hs-var">rephraseBody</span></a></span></span><span> </span><span id="local-6989586621684346582"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346582"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span id="local-6989586621684346580"><span class="annot"><span class="annottext">BodyDec from
</span><a href="#local-6989586621684346580"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span id="local-6989586621684346579"><span class="annot"><span class="annottext">Stms from
</span><a href="#local-6989586621684346579"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684346578"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684346578"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="annottext">BodyDec to -&gt; Stms to -&gt; Result -&gt; BodyT to
forall rep. BodyDec rep -&gt; Stms rep -&gt; Result -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">(BodyDec to -&gt; Stms to -&gt; Result -&gt; BodyT to)
-&gt; m (BodyDec to) -&gt; m (Stms to -&gt; Result -&gt; BodyT to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; BodyDec from -&gt; m (BodyDec to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; BodyDec from -&gt; m (BodyDec to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBodyDec"><span class="hs-identifier hs-var hs-var">rephraseBodyDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346582"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">BodyDec from
</span><a href="#local-6989586621684346580"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">m (Stms to -&gt; Result -&gt; BodyT to)
-&gt; m (Stms to) -&gt; m (Result -&gt; BodyT to)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stm to] -&gt; Stms to
forall rep. [Stm rep] -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#stmsFromList"><span class="hs-identifier hs-var">stmsFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Stm to] -&gt; Stms to) -&gt; m [Stm to] -&gt; m (Stms to)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Stm from -&gt; m (Stm to)) -&gt; [Stm from] -&gt; m [Stm to]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Stm from -&gt; m (Stm to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseStm"><span class="hs-identifier hs-var">rephraseStm</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346582"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stms from -&gt; [Stm from]
forall rep. Stms rep -&gt; [Stm rep]
</span><a href="Futhark.IR.Syntax.html#stmsToList"><span class="hs-identifier hs-var">stmsToList</span></a></span><span> </span><span class="annot"><span class="annottext">Stms from
</span><a href="#local-6989586621684346579"><span class="hs-identifier hs-var">stms</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">m (Result -&gt; BodyT to) -&gt; m Result -&gt; m (BodyT to)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; m Result
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621684346578"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Rephrase a lambda.</span><span>
</span><span id="line-90"></span><span id="local-6989586621684346715"><span id="local-6989586621684346716"><span id="local-6989586621684346717"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#rephraseLambda"><span class="hs-identifier hs-type">rephraseLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346717"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346717"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346716"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346715"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346716"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684346717"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346715"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-91"></span><span id="rephraseLambda"><span class="annot"><span class="annottext">rephraseLambda :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Lambda from -&gt; m (Lambda to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLambda"><span class="hs-identifier hs-var hs-var">rephraseLambda</span></a></span></span><span> </span><span id="local-6989586621684346567"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346567"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span id="local-6989586621684346566"><span class="annot"><span class="annottext">Lambda from
</span><a href="#local-6989586621684346566"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621684346565"><span class="annot"><span class="annottext">Body to
</span><a href="#local-6989586621684346565"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Body from -&gt; m (Body to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Body from -&gt; m (Body to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier hs-var">rephraseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346567"><span class="hs-identifier hs-var">rephraser</span></a></span><span> </span><span class="annot"><span class="annottext">(Body from -&gt; m (Body to)) -&gt; Body from -&gt; m (Body to)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda from -&gt; Body from
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda from
</span><a href="#local-6989586621684346566"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621684346563"><span class="annot"><span class="annottext">[Param (LParamInfo to)]
</span><a href="#local-6989586621684346563"><span class="hs-identifier hs-var">params'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo from) -&gt; m (Param (LParamInfo to)))
-&gt; [Param (LParamInfo from)] -&gt; m [Param (LParamInfo to)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LParamInfo from -&gt; m (LParamInfo to))
-&gt; Param (LParamInfo from) -&gt; m (Param (LParamInfo to))
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; Param from -&gt; m (Param to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-var">rephraseParam</span></a></span><span> </span><span class="annot"><span class="annottext">((LParamInfo from -&gt; m (LParamInfo to))
 -&gt; Param (LParamInfo from) -&gt; m (Param (LParamInfo to)))
-&gt; (LParamInfo from -&gt; m (LParamInfo to))
-&gt; Param (LParamInfo from)
-&gt; m (Param (LParamInfo to))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; LParamInfo from -&gt; m (LParamInfo to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; LParamInfo from -&gt; m (LParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLParamDec"><span class="hs-identifier hs-var hs-var">rephraseLParamDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346567"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Param (LParamInfo from)] -&gt; m [Param (LParamInfo to)])
-&gt; [Param (LParamInfo from)] -&gt; m [Param (LParamInfo to)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda from -&gt; [Param (LParamInfo from)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda from
</span><a href="#local-6989586621684346566"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="annottext">Lambda to -&gt; m (Lambda to)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Lambda from
</span><a href="#local-6989586621684346566"><span class="hs-identifier hs-var">lam</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">lambdaBody :: Body to
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var">lambdaBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Body to
</span><a href="#local-6989586621684346565"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">lambdaParams :: [Param (LParamInfo to)]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var">lambdaParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Param (LParamInfo to)]
</span><a href="#local-6989586621684346563"><span class="hs-identifier hs-var">params'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621684346758"><span id="local-6989586621684346759"><span id="local-6989586621684346760"><span class="annot"><a href="Futhark.Analysis.Rephrase.html#mapper"><span class="hs-identifier hs-type">mapper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684346760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.Rephrase.html#Rephraser"><span class="hs-identifier hs-type">Rephraser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346760"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346759"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346758"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Traversals.html#Mapper"><span class="hs-identifier hs-type">Mapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346759"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346758"><span class="hs-identifier hs-type">to</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684346760"><span class="hs-identifier hs-type">m</span></a></span></span></span></span><span>
</span><span id="line-97"></span><span id="mapper"><span class="annot"><span class="annottext">mapper :: forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Mapper from to m
</span><a href="Futhark.Analysis.Rephrase.html#mapper"><span class="hs-identifier hs-var hs-var">mapper</span></a></span></span><span> </span><span id="local-6989586621684346556"><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">Mapper Any Any m
forall (m :: * -&gt; *) rep. Monad m =&gt; Mapper rep rep m
</span><a href="Futhark.IR.Traversals.html#identityMapper"><span class="hs-identifier hs-var">identityMapper</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mapOnBody :: Scope to -&gt; Body from -&gt; m (Body to)
</span><a href="Futhark.IR.Traversals.html#mapOnBody"><span class="hs-identifier hs-var">mapOnBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Body from -&gt; m (Body to)) -&gt; Scope to -&gt; Body from -&gt; m (Body to)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Body from -&gt; m (Body to))
 -&gt; Scope to -&gt; Body from -&gt; m (Body to))
-&gt; (Body from -&gt; m (Body to))
-&gt; Scope to
-&gt; Body from
-&gt; m (Body to)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Body from -&gt; m (Body to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
Rephraser m from to -&gt; Body from -&gt; m (Body to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBody"><span class="hs-identifier hs-var">rephraseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">mapOnRetType :: RetType from -&gt; m (RetType to)
</span><a href="Futhark.IR.Traversals.html#mapOnRetType"><span class="hs-identifier hs-var">mapOnRetType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; RetType from -&gt; m (RetType to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; RetType from -&gt; m (RetType to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseRetType"><span class="hs-identifier hs-var hs-var">rephraseRetType</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">mapOnBranchType :: BranchType from -&gt; m (BranchType to)
</span><a href="Futhark.IR.Traversals.html#mapOnBranchType"><span class="hs-identifier hs-var">mapOnBranchType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; BranchType from -&gt; m (BranchType to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; BranchType from -&gt; m (BranchType to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseBranchType"><span class="hs-identifier hs-var hs-var">rephraseBranchType</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">mapOnFParam :: FParam from -&gt; m (FParam to)
</span><a href="Futhark.IR.Traversals.html#mapOnFParam"><span class="hs-identifier hs-var">mapOnFParam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FParamInfo from -&gt; m (FParamInfo to))
-&gt; FParam from -&gt; m (FParam to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; Param from -&gt; m (Param to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-var">rephraseParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; FParamInfo from -&gt; m (FParamInfo to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; FParamInfo from -&gt; m (FParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseFParamDec"><span class="hs-identifier hs-var hs-var">rephraseFParamDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">mapOnLParam :: LParam from -&gt; m (LParam to)
</span><a href="Futhark.IR.Traversals.html#mapOnLParam"><span class="hs-identifier hs-var">mapOnLParam</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LParamInfo from -&gt; m (LParamInfo to))
-&gt; LParam from -&gt; m (LParam to)
forall (m :: * -&gt; *) from to.
Monad m =&gt;
(from -&gt; m to) -&gt; Param from -&gt; m (Param to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseParam"><span class="hs-identifier hs-var">rephraseParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rephraser m from to -&gt; LParamInfo from -&gt; m (LParamInfo to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; LParamInfo from -&gt; m (LParamInfo to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseLParamDec"><span class="hs-identifier hs-var hs-var">rephraseLParamDec</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">mapOnOp :: Op from -&gt; m (Op to)
</span><a href="Futhark.IR.Traversals.html#mapOnOp"><span class="hs-identifier hs-var">mapOnOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rephraser m from to -&gt; Op from -&gt; m (Op to)
forall (m :: * -&gt; *) from to.
Rephraser m from to -&gt; Op from -&gt; m (Op to)
</span><a href="Futhark.Analysis.Rephrase.html#rephraseOp"><span class="hs-identifier hs-var hs-var">rephraseOp</span></a></span><span> </span><span class="annot"><span class="annottext">Rephraser m from to
</span><a href="#local-6989586621684346556"><span class="hs-identifier hs-var">rephraser</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-106"></span></pre></body></html>