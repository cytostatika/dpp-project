<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Multicore imperative code.</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.CodeGen.ImpCode.Multicore</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Program"><span class="hs-identifier">Program</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#FunctionT"><span class="hs-identifier">FunctionT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier">Code</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier">Multicore</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Scheduling"><span class="hs-identifier">Scheduling</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier">SchedulerInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOp"><span class="hs-identifier">AtomicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier">ParallelTask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier">Code</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier">Function</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html"><span class="hs-identifier">Futhark.CodeGen.ImpCode</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Imp</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | An imperative program.</span><span>
</span><span id="line-21"></span><span class="hs-keyword">type</span><span> </span><span id="Program"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Program"><span class="hs-identifier hs-var">Program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Functions"><span class="hs-identifier hs-type">Imp.Functions</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-type">Multicore</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | An imperative function.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">type</span><span> </span><span id="Function"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Function"><span class="hs-identifier hs-var">Function</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Function"><span class="hs-identifier hs-type">Imp.Function</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-type">Multicore</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | A piece of imperative code, with multicore operations inside.</span><span>
</span><span id="line-27"></span><span class="hs-keyword">type</span><span> </span><span id="Code"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier hs-var">Code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Code"><span class="hs-identifier hs-type">Imp.Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-type">Multicore</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | A multicore operation.</span><span>
</span><span id="line-30"></span><span class="hs-keyword">data</span><span> </span><span id="Multicore"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-var">Multicore</span></a></span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Segop"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Segop"><span class="hs-identifier hs-var">Segop</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-type">SchedulerInfo</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ParLoop"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParLoop"><span class="hs-identifier hs-var">ParLoop</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Param"><span class="hs-identifier hs-type">Param</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Atomic"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Atomic"><span class="hs-identifier hs-var">Atomic</span></a></span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOp"><span class="hs-identifier hs-type">AtomicOp</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | Atomic operations return the value stored before the update.</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- This old value is stored in the first 'VName'.  The second 'VName'</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- is the memory block to update.  The 'Exp' is the new value.</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="AtomicOp"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOp"><span class="hs-identifier hs-var">AtomicOp</span></a></span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AtomicAdd"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicAdd"><span class="hs-identifier hs-var">AtomicAdd</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicSub"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicSub"><span class="hs-identifier hs-var">AtomicSub</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicAnd"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicAnd"><span class="hs-identifier hs-var">AtomicAnd</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicOr"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOr"><span class="hs-identifier hs-var">AtomicOr</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicXor"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicXor"><span class="hs-identifier hs-var">AtomicXor</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicXchg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicXchg"><span class="hs-identifier hs-var">AtomicXchg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AtomicCmpXchg"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicCmpXchg"><span class="hs-identifier hs-var">AtomicCmpXchg</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.GPU.Sizes.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Elements"><span class="hs-identifier hs-type">Elements</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#TExp"><span class="hs-identifier hs-type">Imp.TExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684472288"><span id="local-6989586621684472290"><span id="local-6989586621684472342"><span class="annot"><span class="annottext">Int -&gt; AtomicOp -&gt; ShowS
[AtomicOp] -&gt; ShowS
AtomicOp -&gt; String
(Int -&gt; AtomicOp -&gt; ShowS)
-&gt; (AtomicOp -&gt; String) -&gt; ([AtomicOp] -&gt; ShowS) -&gt; Show AtomicOp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AtomicOp] -&gt; ShowS
$cshowList :: [AtomicOp] -&gt; ShowS
show :: AtomicOp -&gt; String
$cshow :: AtomicOp -&gt; String
showsPrec :: Int -&gt; AtomicOp -&gt; ShowS
$cshowsPrec :: Int -&gt; AtomicOp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOp"><span class="hs-identifier hs-type">AtomicOp</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621684472239"><span class="annot"><span class="annottext">freeIn' :: AtomicOp -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicAdd"><span class="hs-identifier hs-type">AtomicAdd</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472237"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472237"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472236"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472236"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472235"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472235"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472237"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472236"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472235"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicSub"><span class="hs-identifier hs-type">AtomicSub</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472234"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472234"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472233"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472233"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472232"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472232"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472234"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472233"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472232"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicAnd"><span class="hs-identifier hs-type">AtomicAnd</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472231"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472231"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472230"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472230"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472229"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472229"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472231"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472230"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472229"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicOr"><span class="hs-identifier hs-type">AtomicOr</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472228"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472228"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472227"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472227"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472226"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472226"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472228"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472227"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472226"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicXor"><span class="hs-identifier hs-type">AtomicXor</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472225"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472225"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472224"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472224"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472223"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472223"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472225"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472224"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472223"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicCmpXchg"><span class="hs-identifier hs-type">AtomicCmpXchg</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472222"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472222"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472221"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472221"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472220"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472220"><span class="hs-identifier hs-var">retval</span></a></span></span><span> </span><span id="local-6989586621684472219"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472219"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472222"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472221"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472219"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472220"><span class="hs-identifier hs-var">retval</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#AtomicXchg"><span class="hs-identifier hs-type">AtomicXchg</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472218"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472218"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684472217"><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472217"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472216"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472216"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472218"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32) -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Count Elements (TExp Int32)
</span><a href="#local-6989586621684472217"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472216"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">data</span><span> </span><span id="SchedulerInfo"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-var">SchedulerInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SchedulerInfo"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-var">SchedulerInfo</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="nsubtasks"><span class="annot"><span class="annottext">SchedulerInfo -&gt; VName
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#nsubtasks"><span class="hs-identifier hs-var hs-var">nsubtasks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- The variable that describes how many subtasks the scheduler created</span><span>
</span><span id="line-59"></span><span>    </span><span id="iterations"><span class="annot"><span class="annottext">SchedulerInfo -&gt; Exp
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#iterations"><span class="hs-identifier hs-var hs-var">iterations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.html#Exp"><span class="hs-identifier hs-type">Imp.Exp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- The number of total iterations for a task</span><span>
</span><span id="line-60"></span><span>    </span><span id="scheduling"><span class="annot"><span class="annottext">SchedulerInfo -&gt; Scheduling
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#scheduling"><span class="hs-identifier hs-var hs-var">scheduling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Scheduling"><span class="hs-identifier hs-type">Scheduling</span></a></span><span> </span><span class="hs-comment">-- The type scheduling for the task</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="ParallelTask"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-var">ParallelTask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ParallelTask"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-var">ParallelTask</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="task_code"><span class="annot"><span class="annottext">ParallelTask -&gt; Code
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#task_code"><span class="hs-identifier hs-var hs-var">task_code</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span id="flatTid"><span class="annot"><span class="annottext">ParallelTask -&gt; VName
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#flatTid"><span class="hs-identifier hs-var hs-var">flatTid</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-comment">-- The variable for the thread id execution the code</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Whether the Scheduler should schedule the tasks as Dynamic</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- or it is restainted to Static</span><span>
</span><span id="line-70"></span><span class="hs-keyword">data</span><span> </span><span id="Scheduling"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Scheduling"><span class="hs-identifier hs-var">Scheduling</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Dynamic"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Dynamic"><span class="hs-identifier hs-var">Dynamic</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Static"><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Static"><span class="hs-identifier hs-var">Static</span></a></span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684472202"><span id="local-6989586621684472204"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Scheduling"><span class="hs-identifier hs-type">Scheduling</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621684472200"><span class="annot"><span class="annottext">ppr :: Scheduling -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></span></span><span> </span><span class="annot"><span class="annottext">Scheduling
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#Dynamic"><span class="hs-identifier hs-var">Dynamic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Dynamic&quot;</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Scheduling
</span><a href="Futhark.CodeGen.ImpCode.Multicore.html#Static"><span class="hs-identifier hs-var">Static</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Static&quot;</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- TODO fix all of this!</span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684472193"><span id="local-6989586621684472195"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-type">SchedulerInfo</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621684472187"><span class="annot"><span class="annottext">ppr :: SchedulerInfo -&gt; Doc
</span><a href="#local-6989586621684472187"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-type">SchedulerInfo</span></a></span><span> </span><span id="local-6989586621684472186"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472186"><span class="hs-identifier hs-var">nsubtask</span></a></span></span><span> </span><span id="local-6989586621684472185"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472185"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472184"><span class="annot"><span class="annottext">Scheduling
</span><a href="#local-6989586621684472184"><span class="hs-identifier hs-var">sched</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SchedulingInfo&quot;</span></span><span>
</span><span id="line-82"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;number of subtasks&quot;</span></span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472186"><span class="hs-identifier hs-var">nsubtask</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scheduling&quot;</span></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Scheduling -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Scheduling
</span><a href="#local-6989586621684472184"><span class="hs-identifier hs-var">sched</span></a></span><span>
</span><span id="line-86"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;iter&quot;</span></span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472185"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684472178"><span id="local-6989586621684472180"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621684472174"><span class="annot"><span class="annottext">ppr :: ParallelTask -&gt; Doc
</span><a href="#local-6989586621684472174"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span><span> </span><span id="local-6989586621684472173"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472173"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472173"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684472168"><span id="local-6989586621684472170"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-type">Multicore</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621684472148"><span class="annot"><span class="annottext">ppr :: Multicore -&gt; Doc
</span><a href="#local-6989586621684472148"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Segop"><span class="hs-identifier hs-type">Segop</span></a></span><span> </span><span id="local-6989586621684472147"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684472147"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684472146"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472146"><span class="hs-identifier hs-var">free</span></a></span></span><span> </span><span id="local-6989586621684472145"><span class="annot"><span class="annottext">ParallelTask
</span><a href="#local-6989586621684472145"><span class="hs-identifier hs-var">_par_code</span></a></span></span><span> </span><span id="local-6989586621684472144"><span class="annot"><span class="annottext">Maybe ParallelTask
</span><a href="#local-6989586621684472144"><span class="hs-identifier hs-var">seq_code</span></a></span></span><span> </span><span id="local-6989586621684472143"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472143"><span class="hs-identifier hs-var">retval</span></a></span></span><span> </span><span id="local-6989586621684472142"><span class="annot"><span class="annottext">SchedulerInfo
</span><a href="#local-6989586621684472142"><span class="hs-identifier hs-var">scheduler</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parfor&quot;</span></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">SchedulerInfo -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">SchedulerInfo
</span><a href="#local-6989586621684472142"><span class="hs-identifier hs-var">scheduler</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472146"><span class="hs-identifier hs-var">free</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684472147"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;seq_code&quot;</span></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#nestedBlock"><span class="hs-identifier hs-var">nestedBlock</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ParallelTask -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Maybe ParallelTask
</span><a href="#local-6989586621684472144"><span class="hs-identifier hs-var">seq_code</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;retvals&quot;</span></span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472143"><span class="hs-identifier hs-var">retval</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParLoop"><span class="hs-identifier hs-type">ParLoop</span></a></span><span> </span><span id="local-6989586621684472140"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684472140"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684472139"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472139"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621684472138"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472138"><span class="hs-identifier hs-var">prebody</span></a></span></span><span> </span><span id="local-6989586621684472137"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472137"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621684472136"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472136"><span class="hs-identifier hs-var">postbody</span></a></span></span><span> </span><span id="local-6989586621684472135"><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472135"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621684472134"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472134"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parloop&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684472140"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472139"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472138"><span class="hs-identifier hs-var">prebody</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Param] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><a href="#local-6989586621684472135"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472134"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-identifier hs-var">langle</span></span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Doc -&gt; Doc
</span><a href="Futhark.Util.Pretty.html#nestedBlock"><span class="hs-identifier hs-var">nestedBlock</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472137"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472136"><span class="hs-identifier hs-var">postbody</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicOp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AtomicOp&quot;</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-type">SchedulerInfo</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621684472126"><span class="annot"><span class="annottext">freeIn' :: SchedulerInfo -&gt; FV
</span><a href="#local-6989586621684472126"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#SchedulerInfo"><span class="hs-identifier hs-type">SchedulerInfo</span></a></span><span> </span><span id="local-6989586621684472125"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472125"><span class="hs-identifier hs-var">nsubtask</span></a></span></span><span> </span><span id="local-6989586621684472124"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472124"><span class="hs-identifier hs-var">iter</span></a></span></span><span> </span><span class="annot"><span class="annottext">Scheduling
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">Exp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684472124"><span class="hs-identifier hs-var">iter</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684472125"><span class="hs-identifier hs-var">nsubtask</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621684472117"><span class="annot"><span class="annottext">freeIn' :: ParallelTask -&gt; FV
</span><a href="#local-6989586621684472117"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParallelTask"><span class="hs-identifier hs-type">ParallelTask</span></a></span><span> </span><span id="local-6989586621684472116"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472116"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472116"><span class="hs-identifier hs-var">code</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Multicore"><span class="hs-identifier hs-type">Multicore</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621684472101"><span class="annot"><span class="annottext">freeIn' :: Multicore -&gt; FV
</span><a href="#local-6989586621684472101"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Segop"><span class="hs-identifier hs-type">Segop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472100"><span class="annot"><span class="annottext">ParallelTask
</span><a href="#local-6989586621684472100"><span class="hs-identifier hs-var">par_code</span></a></span></span><span> </span><span id="local-6989586621684472099"><span class="annot"><span class="annottext">Maybe ParallelTask
</span><a href="#local-6989586621684472099"><span class="hs-identifier hs-var">seq_code</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472098"><span class="annot"><span class="annottext">SchedulerInfo
</span><a href="#local-6989586621684472098"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">ParallelTask -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">ParallelTask
</span><a href="#local-6989586621684472100"><span class="hs-identifier hs-var">par_code</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ParallelTask -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ParallelTask
</span><a href="#local-6989586621684472099"><span class="hs-identifier hs-var">seq_code</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SchedulerInfo -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">SchedulerInfo
</span><a href="#local-6989586621684472098"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#ParLoop"><span class="hs-identifier hs-type">ParLoop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684472097"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472097"><span class="hs-identifier hs-var">prebody</span></a></span></span><span> </span><span id="local-6989586621684472096"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472096"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621684472095"><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472095"><span class="hs-identifier hs-var">postbody</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Param]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472097"><span class="hs-identifier hs-var">prebody</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; FV -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#fvBind"><span class="hs-identifier hs-var">fvBind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code -&gt; Names
forall a. Code a -&gt; Names
</span><a href="Futhark.CodeGen.ImpCode.html#declaredIn"><span class="hs-identifier hs-var">Imp.declaredIn</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472097"><span class="hs-identifier hs-var">prebody</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Code -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">(Code -&gt; FV) -&gt; Code -&gt; FV
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472096"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Code -&gt; Code
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="#local-6989586621684472095"><span class="hs-identifier hs-var">postbody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.CodeGen.ImpCode.Multicore.html#Atomic"><span class="hs-identifier hs-type">Atomic</span></a></span><span> </span><span id="local-6989586621684472092"><span class="annot"><span class="annottext">AtomicOp
</span><a href="#local-6989586621684472092"><span class="hs-identifier hs-var">aop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AtomicOp -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">AtomicOp
</span><a href="#local-6989586621684472092"><span class="hs-identifier hs-var">aop</span></a></span><span>
</span><span id="line-127"></span></pre></body></html>