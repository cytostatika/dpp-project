<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621684340962"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-redundant-constraints #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- | A primitive expression is an expression where the non-leaves are</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- primitive operators.  Our representation does not guarantee that</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- the expression is type-correct.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Analysis.PrimExp</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier">PrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier">TPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt8"><span class="hs-identifier">isInt8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt16"><span class="hs-identifier">isInt16</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier">isInt32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier">isInt64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isBool"><span class="hs-identifier">isBool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier">isF16</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier">isF32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier">isF64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier">evalPrimExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier">primExpType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpSizeAtLeast"><span class="hs-identifier">primExpSizeAtLeast</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#coerceIntPrimExp"><span class="hs-identifier">coerceIntPrimExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier">leafExpTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#true"><span class="hs-identifier">true</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#false"><span class="hs-identifier">false</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier">constFoldPrimExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Construction</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html"><span class="hs-identifier">Futhark.IR.Primitive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier">NumExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier">IntExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier">FloatExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier">sExt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier">zExt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%26%26."><span class="hs-operator">(.&amp;&amp;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%7C%7C."><span class="hs-operator">(.||.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C."><span class="hs-operator">(.&lt;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C%3D."><span class="hs-operator">(.&lt;=.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E."><span class="hs-operator">(.&gt;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E%3D."><span class="hs-operator">(.&gt;=.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3D%3D."><span class="hs-operator">(.==.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%26."><span class="hs-operator">(.&amp;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%7C."><span class="hs-operator">(.|.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%5E."><span class="hs-operator">(.^.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E%3E."><span class="hs-operator">(.&gt;&gt;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C%3C."><span class="hs-operator">(.&lt;&lt;.)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#bNot"><span class="hs-identifier">bNot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMax32"><span class="hs-identifier">sMax32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMin32"><span class="hs-identifier">sMin32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMax64"><span class="hs-identifier">sMax64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMin64"><span class="hs-identifier">sMin64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt32"><span class="hs-identifier">sExt32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt64"><span class="hs-identifier">sExt64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt32"><span class="hs-identifier">zExt32</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt64"><span class="hs-identifier">zExt64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fMin64"><span class="hs-identifier">fMin64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fMax64"><span class="hs-identifier">fMax64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Untyped construction</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2A~"><span class="hs-operator">(~*~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2F~"><span class="hs-operator">(~/~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2B~"><span class="hs-operator">(~+~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~-~"><span class="hs-operator">(~-~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Category</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html"><span class="hs-identifier">Futhark.IR.Primitive</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.IntegralExp.html"><span class="hs-identifier">Futhark.Util.IntegralExp</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">id</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | A primitive expression parametrised over the representation of</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- free variables.  Note that the 'Functor', 'Traversable', and 'Num'</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- instances perform automatic (but simple) constant folding.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- Note also that the 'Num' instance assumes 'OverflowUndef'</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- semantics!</span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="PrimExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-var">PrimExp</span></a></span></span><span> </span><span id="local-6989586621684341419"><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LeafExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ValueExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimValue"><span class="hs-identifier hs-type">PrimValue</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BinOpExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CmpOpExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#CmpOp"><span class="hs-identifier hs-type">CmpOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UnOpExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UnOp"><span class="hs-identifier hs-type">UnOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ConvOpExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#ConvOp"><span class="hs-identifier hs-type">ConvOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FunExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341419"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684340880"><span id="local-6989586621684340906"><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v -&gt; Bool
(PrimExp v -&gt; PrimExp v -&gt; Bool)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Bool) -&gt; Eq (PrimExp v)
forall v. Eq v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c/= :: forall v. Eq v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
== :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c== :: forall v. Eq v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684340838"><span id="local-6989586621684340840"><span id="local-6989586621684340842"><span id="local-6989586621684340844"><span id="local-6989586621684340846"><span id="local-6989586621684340848"><span id="local-6989586621684340874"><span class="annot"><span class="annottext">Eq (PrimExp v)
Eq (PrimExp v)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Ordering)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Bool)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Bool)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Bool)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; Bool)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; PrimExp v)
-&gt; (PrimExp v -&gt; PrimExp v -&gt; PrimExp v)
-&gt; Ord (PrimExp v)
PrimExp v -&gt; PrimExp v -&gt; Bool
PrimExp v -&gt; PrimExp v -&gt; Ordering
PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {v}. Ord v =&gt; Eq (PrimExp v)
forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Ordering
forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
min :: PrimExp v -&gt; PrimExp v -&gt; PrimExp v
$cmin :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
max :: PrimExp v -&gt; PrimExp v -&gt; PrimExp v
$cmax :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
&gt;= :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c&gt;= :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
&gt; :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c&gt; :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
&lt;= :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c&lt;= :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
&lt; :: PrimExp v -&gt; PrimExp v -&gt; Bool
$c&lt; :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Bool
compare :: PrimExp v -&gt; PrimExp v -&gt; Ordering
$ccompare :: forall v. Ord v =&gt; PrimExp v -&gt; PrimExp v -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684340798"><span id="local-6989586621684340800"><span id="local-6989586621684340834"><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; ShowS
[PrimExp v] -&gt; ShowS
PrimExp v -&gt; String
(Int -&gt; PrimExp v -&gt; ShowS)
-&gt; (PrimExp v -&gt; String)
-&gt; ([PrimExp v] -&gt; ShowS)
-&gt; Show (PrimExp v)
forall v. Show v =&gt; Int -&gt; PrimExp v -&gt; ShowS
forall v. Show v =&gt; [PrimExp v] -&gt; ShowS
forall v. Show v =&gt; PrimExp v -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PrimExp v] -&gt; ShowS
$cshowList :: forall v. Show v =&gt; [PrimExp v] -&gt; ShowS
show :: PrimExp v -&gt; String
$cshow :: forall v. Show v =&gt; PrimExp v -&gt; String
showsPrec :: Int -&gt; PrimExp v -&gt; ShowS
$cshowsPrec :: forall v. Show v =&gt; Int -&gt; PrimExp v -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340793"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621684340790"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; PrimExp a -&gt; PrimExp b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; PrimExp a -&gt; PrimExp b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340756"><span id="local-6989586621684340758"><span id="local-6989586621684340760"><span id="local-6989586621684340762"><span id="local-6989586621684340764"><span id="local-6989586621684340766"><span id="local-6989586621684340768"><span id="local-6989586621684340770"><span id="local-6989586621684340772"><span id="local-6989586621684340774"><span id="local-6989586621684340776"><span id="local-6989586621684340778"><span id="local-6989586621684340780"><span id="local-6989586621684340782"><span id="local-6989586621684340784"><span id="local-6989586621684340787"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621684340751"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; PrimExp a -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; PrimExp a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340738"><span id="local-6989586621684340740"><span id="local-6989586621684340742"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621684340702"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></span></span><span> </span><span id="local-6989586621684340700"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340700"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span id="local-6989586621684340699"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684340699"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684340698"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684340698"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">b -&gt; PrimType -&gt; PrimExp b
forall v. v -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; PrimType -&gt; PrimExp b) -&gt; f b -&gt; f (PrimType -&gt; PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340700"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684340699"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">f (PrimType -&gt; PrimExp b) -&gt; f PrimType -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; f PrimType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684340698"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684340696"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340696"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">PrimExp b -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; f (PrimExp b)) -&gt; PrimExp b -&gt; f (PrimExp b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp b
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340696"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684340695"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340695"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684340694"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684340694"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684340693"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340693"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340692"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340692"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">PrimExp b -&gt; PrimExp b
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; PrimExp b) -&gt; f (PrimExp b) -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp b -&gt; PrimExp b -&gt; PrimExp b
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684340694"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; PrimExp b -&gt; PrimExp b)
-&gt; f (PrimExp b) -&gt; f (PrimExp b -&gt; PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340695"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340693"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (PrimExp b -&gt; PrimExp b) -&gt; f (PrimExp b) -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340695"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340692"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684340691"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340691"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span id="local-6989586621684340690"><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684340690"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684340689"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340688"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340688"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimExp b -&gt; PrimExp b -&gt; PrimExp b
forall v. CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684340690"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; PrimExp b -&gt; PrimExp b)
-&gt; f (PrimExp b) -&gt; f (PrimExp b -&gt; PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340691"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340689"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (PrimExp b -&gt; PrimExp b) -&gt; f (PrimExp b) -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340691"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340688"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684340687"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340687"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span id="local-6989586621684340686"><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684340686"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684340685"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340685"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp b -&gt; PrimExp b
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684340686"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; PrimExp b) -&gt; f (PrimExp b) -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340687"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340685"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684340684"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340684"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span id="local-6989586621684340683"><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684340683"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684340682"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340682"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp b -&gt; PrimExp b
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684340683"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; PrimExp b) -&gt; f (PrimExp b) -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340684"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340682"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">traverse</span></span><span> </span><span id="local-6989586621684340681"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340681"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span id="local-6989586621684340680"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684340680"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621684340679"><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684340679"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621684340678"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684340678"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; [PrimExp b] -&gt; PrimType -&gt; PrimExp b
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684340680"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimExp b] -&gt; PrimType -&gt; PrimExp b)
-&gt; f [PrimExp b] -&gt; f (PrimType -&gt; PrimExp b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; f (PrimExp b)) -&gt; [PrimExp a] -&gt; f [PrimExp b]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340681"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684340679"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">f (PrimType -&gt; PrimExp b) -&gt; f PrimType -&gt; f (PrimExp b)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; f PrimType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684340678"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span id="local-6989586621684341346"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341346"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341346"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621684340669"><span class="annot"><span class="annottext">freeIn' :: PrimExp v -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; FV) -&gt; PrimExp v -&gt; FV
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | A 'PrimExp' tagged with a phantom type used to provide type-safe</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- construction.  Does not guarantee that the underlying expression is</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- actually type correct.</span><span>
</span><span id="line-122"></span><span class="hs-keyword">newtype</span><span> </span><span id="TPrimExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span></span><span> </span><span id="local-6989586621684341345"><span class="annot"><a href="#local-6989586621684341345"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621684341344"><span class="annot"><a href="#local-6989586621684341344"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TPrimExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span></span><span> </span><span class="hs-special">{</span><span id="untyped"><span class="annot"><span class="annottext">forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341344"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684340659"><span id="local-6989586621684340663"><span class="annot"><span class="annottext">TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
(TPrimExp t v -&gt; TPrimExp t v -&gt; Bool)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Bool) -&gt; Eq (TPrimExp t v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall t v. Eq v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
/= :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c/= :: forall t v. Eq v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
== :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c== :: forall t v. Eq v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684340626"><span id="local-6989586621684340630"><span id="local-6989586621684340634"><span id="local-6989586621684340638"><span id="local-6989586621684340642"><span id="local-6989586621684340646"><span id="local-6989586621684340650"><span class="annot"><span class="annottext">Eq (TPrimExp t v)
Eq (TPrimExp t v)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Ordering)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Bool)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Bool)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Bool)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; Bool)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v)
-&gt; (TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v)
-&gt; Ord (TPrimExp t v)
TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
TPrimExp t v -&gt; TPrimExp t v -&gt; Ordering
TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {t} {v}. Ord v =&gt; Eq (TPrimExp t v)
forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Ordering
forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
min :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
$cmin :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
max :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
$cmax :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
&gt;= :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c&gt;= :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
&gt; :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c&gt; :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
&lt;= :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c&lt;= :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
&lt; :: TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
$c&lt; :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Bool
compare :: TPrimExp t v -&gt; TPrimExp t v -&gt; Ordering
$ccompare :: forall t v. Ord v =&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684340615"><span id="local-6989586621684340617"><span id="local-6989586621684340621"><span class="annot"><span class="annottext">Int -&gt; TPrimExp t v -&gt; ShowS
[TPrimExp t v] -&gt; ShowS
TPrimExp t v -&gt; String
(Int -&gt; TPrimExp t v -&gt; ShowS)
-&gt; (TPrimExp t v -&gt; String)
-&gt; ([TPrimExp t v] -&gt; ShowS)
-&gt; Show (TPrimExp t v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall t v. Show v =&gt; Int -&gt; TPrimExp t v -&gt; ShowS
forall t v. Show v =&gt; [TPrimExp t v] -&gt; ShowS
forall t v. Show v =&gt; TPrimExp t v -&gt; String
showList :: [TPrimExp t v] -&gt; ShowS
$cshowList :: forall t v. Show v =&gt; [TPrimExp t v] -&gt; ShowS
show :: TPrimExp t v -&gt; String
$cshow :: forall t v. Show v =&gt; TPrimExp t v -&gt; String
showsPrec :: Int -&gt; TPrimExp t v -&gt; ShowS
$cshowsPrec :: forall t v. Show v =&gt; Int -&gt; TPrimExp t v -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621684341337"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340612"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341337"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621684340610"><span class="annot"><span class="annottext">fmap :: forall a b. (a -&gt; b) -&gt; TPrimExp t a -&gt; TPrimExp t b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; TPrimExp t a -&gt; TPrimExp t b
forall (t :: * -&gt; *) a b. Traversable t =&gt; (a -&gt; b) -&gt; t a -&gt; t b
</span><span class="hs-identifier hs-var">fmapDefault</span></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621684341333"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340577"><span id="local-6989586621684340579"><span id="local-6989586621684340581"><span id="local-6989586621684340583"><span id="local-6989586621684340585"><span id="local-6989586621684340587"><span id="local-6989586621684340589"><span id="local-6989586621684340591"><span id="local-6989586621684340593"><span id="local-6989586621684340595"><span id="local-6989586621684340597"><span id="local-6989586621684340599"><span id="local-6989586621684340601"><span id="local-6989586621684340603"><span id="local-6989586621684340605"><span id="local-6989586621684340608"><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341333"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621684340573"><span class="annot"><span class="annottext">foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; TPrimExp t a -&gt; m
</span><a href="#local-6989586621684340573"><span class="hs-identifier hs-var hs-var hs-var hs-var">foldMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m) -&gt; TPrimExp t a -&gt; m
forall (t :: * -&gt; *) m a.
(Traversable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMapDefault</span></span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621684341336"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340562"><span id="local-6989586621684340564"><span id="local-6989586621684340566"><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341336"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>  </span><span id="local-6989586621684340556"><span class="annot"><span class="annottext">traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; TPrimExp t a -&gt; f (TPrimExp t b)
</span><a href="#local-6989586621684340556"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverse</span></a></span></span><span> </span><span id="local-6989586621684340555"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340555"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340554"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340554"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp b -&gt; TPrimExp t b
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp b -&gt; TPrimExp t b) -&gt; f (PrimExp b) -&gt; f (TPrimExp t b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f b) -&gt; PrimExp a -&gt; f (PrimExp b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621684340555"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684340554"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621684341324"><span id="local-6989586621684341325"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341325"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341324"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341325"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621684340547"><span class="annot"><span class="annottext">freeIn' :: TPrimExp t v -&gt; FV
</span><a href="#local-6989586621684340547"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; FV)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; FV
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | This expression is of type t'Int8'.</span><span>
</span><span id="line-138"></span><span id="local-6989586621684341317"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt8"><span class="hs-identifier hs-type">isInt8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341317"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="annot"><a href="#local-6989586621684341317"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-139"></span><span id="isInt8"><span class="annot"><span class="annottext">isInt8 :: forall v. PrimExp v -&gt; TPrimExp Int8 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt8"><span class="hs-identifier hs-var hs-var">isInt8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int8 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | This expression is of type t'Int16'.</span><span>
</span><span id="line-142"></span><span id="local-6989586621684341315"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt16"><span class="hs-identifier hs-type">isInt16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341315"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="annot"><a href="#local-6989586621684341315"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-143"></span><span id="isInt16"><span class="annot"><span class="annottext">isInt16 :: forall v. PrimExp v -&gt; TPrimExp Int16 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt16"><span class="hs-identifier hs-var hs-var">isInt16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int16 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | This expression is of type t'Int32'.</span><span>
</span><span id="line-146"></span><span id="local-6989586621684341313"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-type">isInt32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341313"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684341313"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-147"></span><span id="isInt32"><span class="annot"><span class="annottext">isInt32 :: forall v. PrimExp v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-var hs-var">isInt32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | This expression is of type t'Int64'.</span><span>
</span><span id="line-150"></span><span id="local-6989586621684341311"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-type">isInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341311"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684341311"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-151"></span><span id="isInt64"><span class="annot"><span class="annottext">isInt64 :: forall v. PrimExp v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-var hs-var">isInt64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | This is a boolean expression.</span><span>
</span><span id="line-154"></span><span id="local-6989586621684341309"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isBool"><span class="hs-identifier hs-type">isBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341309"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341309"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-155"></span><span id="isBool"><span class="annot"><span class="annottext">isBool :: forall v. PrimExp v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#isBool"><span class="hs-identifier hs-var hs-var">isBool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | This expression is of type t'Half'.</span><span>
</span><span id="line-158"></span><span id="local-6989586621684341307"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-type">isF16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341307"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Half</span></span><span> </span><span class="annot"><a href="#local-6989586621684341307"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-159"></span><span id="isF16"><span class="annot"><span class="annottext">isF16 :: forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var hs-var">isF16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | This expression is of type t'Float'.</span><span>
</span><span id="line-162"></span><span id="local-6989586621684341305"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-type">isF32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341305"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="annot"><a href="#local-6989586621684341305"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-163"></span><span id="isF32"><span class="annot"><span class="annottext">isF32 :: forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var hs-var">isF32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | This expression is of type t'Double'.</span><span>
</span><span id="line-166"></span><span id="local-6989586621684341303"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-type">isF64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341303"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684341303"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-167"></span><span id="isF64"><span class="annot"><span class="annottext">isF64 :: forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var hs-var">isF64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | True if the 'PrimExp' has at least this many nodes.  This can be</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- much more efficient than comparing with 'length' for large</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- 'PrimExp's, as this function is lazy.</span><span>
</span><span id="line-172"></span><span id="local-6989586621684341301"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpSizeAtLeast"><span class="hs-identifier hs-type">primExpSizeAtLeast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341301"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-173"></span><span id="primExpSizeAtLeast"><span class="annot"><span class="annottext">primExpSizeAtLeast :: forall v. Int -&gt; PrimExp v -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#primExpSizeAtLeast"><span class="hs-identifier hs-var hs-var">primExpSizeAtLeast</span></a></span></span><span> </span><span id="local-6989586621684340543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340543"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340543"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Bool)
-&gt; (PrimExp v -&gt; Maybe Int) -&gt; PrimExp v -&gt; Bool
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
forall {v}. Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621684340541"><span class="annot"><span class="annottext">descend :: Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var hs-var">descend</span></a></span></span><span> </span><span id="local-6989586621684340518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340518"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340518"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340543"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340517"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340517"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340515"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340515"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340515"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340514"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340514"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684340513"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340513"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340512"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340512"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>      </span><span id="local-6989586621684340511"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340511"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340514"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340513"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340511"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340512"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340510"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340510"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684340509"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340509"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340508"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340508"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>      </span><span id="local-6989586621684340507"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340507"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340510"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340509"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340507"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340508"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340506"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684340505"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340505"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340506"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340505"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340504"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340504"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684340503"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340503"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340504"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340503"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span id="local-6989586621684340502"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340502"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684340501"><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684340501"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PrimExp v -&gt; Maybe Int) -&gt; Int -&gt; [PrimExp v] -&gt; Maybe Int
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PrimExp v -&gt; Maybe Int
</span><a href="#local-6989586621684340541"><span class="hs-identifier hs-var">descend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684340502"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684340501"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Perform quick and dirty constant folding on the top level of a</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- PrimExp.  This is necessary because we want to consider</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- e.g. equality modulo constant folding.</span><span>
</span><span id="line-192"></span><span id="local-6989586621684341351"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-type">constFoldPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341351"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341351"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-193"></span><span id="constFoldPrimExp"><span class="annot"><span class="annottext">constFoldPrimExp :: forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var hs-var">constFoldPrimExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340495"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340495"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340494"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340494"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340495"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340494"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340494"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340495"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#Sub"><span class="hs-identifier hs-type">Sub</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340491"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340491"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340490"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340490"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340490"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340491"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#Mul"><span class="hs-identifier hs-type">Mul</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340488"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340488"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340487"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340487"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340488"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340487"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340487"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340488"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340488"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684340484"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340484"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340487"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue) -&gt; IntValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Int -&gt; IntValue
forall int. Integral int =&gt; IntType -&gt; int -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#intValue"><span class="hs-identifier hs-var">intValue</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340484"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340487"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684340481"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340481"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340488"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue) -&gt; IntValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Int -&gt; IntValue
forall int. Integral int =&gt; IntType -&gt; int -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#intValue"><span class="hs-identifier hs-var">intValue</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340481"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-identifier hs-type">SDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340479"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340479"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340478"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340478"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340478"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340479"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SQuot"><span class="hs-identifier hs-type">SQuot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340476"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340476"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340475"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340475"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340475"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340476"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UDiv"><span class="hs-identifier hs-type">UDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621684340473"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340473"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340472"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340472"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340472"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340473"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684340471"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684340471"><span class="hs-identifier hs-var">bop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684340470"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340470"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684340469"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340469"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684340468"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340468"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimValue -&gt; PrimValue -&gt; Maybe PrimValue
</span><a href="Futhark.IR.Primitive.html#doBinOp"><span class="hs-identifier hs-var">doBinOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684340471"><span class="hs-identifier hs-var">bop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340470"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340469"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684340468"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span> </span><span id="local-6989586621684340465"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340465"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340464"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340464"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340465"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340464"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340464"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340465"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340465"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340465"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340464"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340464"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span> </span><span id="local-6989586621684340462"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340462"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340461"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340461"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340462"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340461"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340461"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340462"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340461"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340461"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340462"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span id="local-6989586621684340460"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340460"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340460"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | The class of numeric types that can be used for constructing</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- 'TPrimExp's.</span><span>
</span><span id="line-230"></span><span class="hs-keyword">class</span><span> </span><span id="NumExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-var">NumExp</span></a></span></span><span> </span><span id="local-6989586621684341281"><span class="annot"><a href="#local-6989586621684341281"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- | Construct a typed expression from an integer.</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621684341283"><span id="fromInteger%27"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fromInteger%27"><span class="hs-identifier hs-type">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341281"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341283"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">-- | Construct a numeric expression from a boolean expression.  This</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- can be used to encode arithmetic control flow.</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621684341282"><span id="fromBoolExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fromBoolExp"><span class="hs-identifier hs-type">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341282"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341281"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341282"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | The class of integer types that can be used for constructing</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- 'TPrimExp's.</span><span>
</span><span id="line-240"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341285"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IntExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-var">IntExp</span></a></span></span><span> </span><span id="local-6989586621684341285"><span class="annot"><a href="#local-6989586621684341285"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621684340446"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Int8 v
</span><a href="#local-6989586621684340446"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int8 v
forall v. PrimExp v -&gt; TPrimExp Int8 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt8"><span class="hs-identifier hs-var">isInt8</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int8 v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Int8 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue)
-&gt; (Integer -&gt; IntValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int8 -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#Int8Value"><span class="hs-identifier hs-var">Int8Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Int8 -&gt; IntValue) -&gt; (Integer -&gt; Int8) -&gt; Integer -&gt; IntValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int8
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621684340442"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Int8 v
</span><a href="#local-6989586621684340442"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int8 v
forall v. PrimExp v -&gt; TPrimExp Int8 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt8"><span class="hs-identifier hs-var">isInt8</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int8 v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Int8 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int8"><span class="hs-identifier hs-var">Int8</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621684340426"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Int16 v
</span><a href="#local-6989586621684340426"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int16 v
forall v. PrimExp v -&gt; TPrimExp Int16 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt16"><span class="hs-identifier hs-var">isInt16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int16 v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Int16 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue)
-&gt; (Integer -&gt; IntValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#Int16Value"><span class="hs-identifier hs-var">Int16Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Int16 -&gt; IntValue) -&gt; (Integer -&gt; Int16) -&gt; Integer -&gt; IntValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int16
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621684340422"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Int16 v
</span><a href="#local-6989586621684340422"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int16 v
forall v. PrimExp v -&gt; TPrimExp Int16 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt16"><span class="hs-identifier hs-var">isInt16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int16 v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Int16 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int16"><span class="hs-identifier hs-var">Int16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621684340408"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Int32 v
</span><a href="#local-6989586621684340408"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall v. PrimExp v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-var">isInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Int32 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue)
-&gt; (Integer -&gt; IntValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#Int32Value"><span class="hs-identifier hs-var">Int32Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; IntValue) -&gt; (Integer -&gt; Int32) -&gt; Integer -&gt; IntValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int32
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621684340404"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Int32 v
</span><a href="#local-6989586621684340404"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall v. PrimExp v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-var">isInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Int32 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621684340390"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Int64 v
</span><a href="#local-6989586621684340390"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall v. PrimExp v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-var">isInt64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Int64 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue)
-&gt; (Integer -&gt; IntValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#Int64Value"><span class="hs-identifier hs-var">Int64Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; IntValue) -&gt; (Integer -&gt; Int64) -&gt; Integer -&gt; IntValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621684340386"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Int64 v
</span><a href="#local-6989586621684340386"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall v. PrimExp v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-var">isInt64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Int64 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | The class of floating-point types that can be used for</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- constructing 'TPrimExp's.</span><span>
</span><span id="line-268"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341272"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="FloatExp"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier hs-var">FloatExp</span></a></span></span><span> </span><span id="local-6989586621684341272"><span class="annot"><a href="#local-6989586621684341272"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-comment">-- | Construct a typed expression from a rational.</span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621684341263"><span id="fromRational%27"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fromRational%27"><span class="hs-identifier hs-type">fromRational'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341272"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341263"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Half</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621684340371"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Half v
</span><a href="#local-6989586621684340371"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Half v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Integer -&gt; FloatValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Half -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float16Value"><span class="hs-identifier hs-var">Float16Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Half -&gt; FloatValue) -&gt; (Integer -&gt; Half) -&gt; Integer -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Half
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621684340365"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Half v
</span><a href="#local-6989586621684340365"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Half v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; FloatType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#SIToFP"><span class="hs-identifier hs-var">SIToFP</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int16"><span class="hs-identifier hs-var">Int16</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int16"><span class="hs-identifier hs-var">Int16</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621684340353"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340353"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Float v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Integer -&gt; FloatValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float32Value"><span class="hs-identifier hs-var">Float32Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; FloatValue)
-&gt; (Integer -&gt; Float) -&gt; Integer -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621684340348"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340348"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Float v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; FloatType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#SIToFP"><span class="hs-identifier hs-var">SIToFP</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621684340337"><span class="annot"><span class="annottext">fromInteger' :: forall v. Integer -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340337"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v)
-&gt; (Integer -&gt; PrimExp v) -&gt; Integer -&gt; TPrimExp Double v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Integer -&gt; PrimValue) -&gt; Integer -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Integer -&gt; FloatValue) -&gt; Integer -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float64Value"><span class="hs-identifier hs-var">Float64Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FloatValue)
-&gt; (Integer -&gt; Double) -&gt; Integer -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621684340332"><span class="annot"><span class="annottext">fromBoolExp :: forall v. TPrimExp Bool v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340332"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBoolExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Double v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; FloatType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#SIToFP"><span class="hs-identifier hs-var">SIToFP</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#BToI"><span class="hs-identifier hs-var">BToI</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier hs-type">FloatExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Half</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621684340319"><span class="annot"><span class="annottext">fromRational' :: forall v. Rational -&gt; TPrimExp Half v
</span><a href="#local-6989586621684340319"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v)
-&gt; (Rational -&gt; PrimExp v) -&gt; Rational -&gt; TPrimExp Half v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Rational -&gt; PrimValue) -&gt; Rational -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Rational -&gt; FloatValue) -&gt; Rational -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Half -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float16Value"><span class="hs-identifier hs-var">Float16Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Half -&gt; FloatValue)
-&gt; (Rational -&gt; Half) -&gt; Rational -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Half
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier hs-type">FloatExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621684340308"><span class="annot"><span class="annottext">fromRational' :: forall v. Rational -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340308"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v)
-&gt; (Rational -&gt; PrimExp v) -&gt; Rational -&gt; TPrimExp Float v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Rational -&gt; PrimValue) -&gt; Rational -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Rational -&gt; FloatValue) -&gt; Rational -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float32Value"><span class="hs-identifier hs-var">Float32Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; FloatValue)
-&gt; (Rational -&gt; Float) -&gt; Rational -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Float
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier hs-type">FloatExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621684340297"><span class="annot"><span class="annottext">fromRational' :: forall v. Rational -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340297"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v)
-&gt; (Rational -&gt; PrimExp v) -&gt; Rational -&gt; TPrimExp Double v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v)
-&gt; (Rational -&gt; PrimValue) -&gt; Rational -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue)
-&gt; (Rational -&gt; FloatValue) -&gt; Rational -&gt; PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float64Value"><span class="hs-identifier hs-var">Float64Value</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FloatValue)
-&gt; (Rational -&gt; Double) -&gt; Rational -&gt; FloatValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621684341257"><span id="local-6989586621684341258"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340292"><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#NumExp"><span class="hs-identifier hs-type">NumExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341258"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341257"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341258"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341257"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340280"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340280"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340279"><span class="annot"><span class="annottext">+ :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="#local-6989586621684340279"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340278"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340278"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684340277"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340277"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-297"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Add"><span class="hs-operator hs-var">`Add`</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340280"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340278"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var">asFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FAdd"><span class="hs-identifier hs-var">FAdd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340280"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340278"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-299"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340277"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340280"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340278"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340265"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340265"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340264"><span class="annot"><span class="annottext">- :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340263"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340263"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684340262"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340262"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Sub"><span class="hs-operator hs-var">`Sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340265"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340263"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><span class="annottext">(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var">asFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FSub"><span class="hs-identifier hs-var">FSub</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340265"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340263"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340262"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340265"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340263"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340255"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340255"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340254"><span class="annot"><span class="annottext">* :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340252"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340252"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684340251"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340251"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-315"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Mul"><span class="hs-operator hs-var">`Mul`</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340255"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340252"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>            </span><span class="annot"><span class="annottext">(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var">asFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FMul"><span class="hs-identifier hs-var">FMul</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340255"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340252"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-317"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340251"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340255"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340252"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621684340248"><span class="annot"><span class="annottext">abs :: TPrimExp t v -&gt; TPrimExp t v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">abs</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340246"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684340245"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340245"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp v -&gt; PrimExp v
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; UnOp
</span><a href="Futhark.IR.Primitive.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340245"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684340242"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684340242"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp v -&gt; PrimExp v
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; UnOp
</span><a href="Futhark.IR.Primitive.html#FAbs"><span class="hs-identifier hs-var">FAbs</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684340242"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;abs&quot;</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340246"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621684340239"><span class="annot"><span class="annottext">signum :: TPrimExp t v -&gt; TPrimExp t v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">signum</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340237"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340237"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684340236"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340236"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340237"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp v -&gt; PrimExp v
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; UnOp
</span><a href="Futhark.IR.Primitive.html#SSignum"><span class="hs-identifier hs-var">SSignum</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684340236"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340237"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signum&quot;</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340237"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621684340233"><span class="annot"><span class="annottext">fromInteger :: Integer -&gt; TPrimExp t v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromInteger</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; TPrimExp t v
forall t v. NumExp t =&gt; Integer -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#fromInteger%27"><span class="hs-identifier hs-var">fromInteger'</span></a></span></span></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="local-6989586621684341243"><span id="local-6989586621684341244"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340228"><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FloatExp"><span class="hs-identifier hs-type">FloatExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341244"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341243"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341244"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341243"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340220"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340220"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340219"><span class="annot"><span class="annottext">/ :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><span class="hs-operator hs-var hs-var hs-var hs-var">/</span></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684340217"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340217"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684340216"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340216"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var">asFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FDiv"><span class="hs-identifier hs-var">FDiv</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340220"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340217"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340216"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340220"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684340217"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621684340213"><span class="annot"><span class="annottext">fromRational :: Rational -&gt; TPrimExp t v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fromRational</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; TPrimExp t v
forall t v. FloatExp t =&gt; Rational -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#fromRational%27"><span class="hs-identifier hs-var">fromRational'</span></a></span></span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621684341241"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340182"><span id="local-6989586621684340184"><span id="local-6989586621684340186"><span id="local-6989586621684340188"><span id="local-6989586621684340202"><span id="local-6989586621684340205"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341241"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Half</span></span><span> </span><span class="annot"><a href="#local-6989586621684341241"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621684340180"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340180"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340179"><span class="annot"><span class="annottext">** :: TPrimExp Half v -&gt; TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-operator hs-var hs-var hs-var hs-var">**</span></span></span><span> </span><span id="local-6989586621684340177"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340177"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FPow"><span class="hs-identifier hs-var">FPow</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340180"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340177"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621684340173"><span class="annot"><span class="annottext">pi :: TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pi</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue) -&gt; FloatValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Half -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float16Value"><span class="hs-identifier hs-var">Float16Value</span></a></span><span> </span><span class="annot"><span class="annottext">Half
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621684340171"><span class="annot"><span class="annottext">exp :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">exp</span></span></span><span> </span><span id="local-6989586621684340169"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340169"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exp16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340169"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621684340168"><span class="annot"><span class="annottext">log :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">log</span></span></span><span> </span><span id="local-6989586621684340166"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340166"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340166"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621684340165"><span class="annot"><span class="annottext">sin :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sin</span></span></span><span> </span><span id="local-6989586621684340163"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sin16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340163"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621684340162"><span class="annot"><span class="annottext">cos :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">cos</span></span></span><span> </span><span id="local-6989586621684340160"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340160"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cos16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340160"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621684340159"><span class="annot"><span class="annottext">tan :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">tan</span></span></span><span> </span><span id="local-6989586621684340157"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340157"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tan16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340157"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621684340156"><span class="annot"><span class="annottext">asin :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">asin</span></span></span><span> </span><span id="local-6989586621684340154"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340154"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asin16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340154"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621684340153"><span class="annot"><span class="annottext">acos :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">acos</span></span></span><span> </span><span id="local-6989586621684340151"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340151"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acos16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340151"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621684340150"><span class="annot"><span class="annottext">atan :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">atan</span></span></span><span> </span><span id="local-6989586621684340148"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340148"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atan16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340148"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621684340147"><span class="annot"><span class="annottext">sinh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">sinh</span></span></span><span> </span><span id="local-6989586621684340145"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340145"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340145"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621684340144"><span class="annot"><span class="annottext">cosh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">cosh</span></span></span><span> </span><span id="local-6989586621684340142"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340142"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340142"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621684340141"><span class="annot"><span class="annottext">tanh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">tanh</span></span></span><span> </span><span id="local-6989586621684340139"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340139"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340139"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621684340138"><span class="annot"><span class="annottext">asinh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">asinh</span></span></span><span> </span><span id="local-6989586621684340136"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340136"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340136"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621684340135"><span class="annot"><span class="annottext">acosh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">acosh</span></span></span><span> </span><span id="local-6989586621684340133"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340133"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340133"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621684340132"><span class="annot"><span class="annottext">atanh :: TPrimExp Half v -&gt; TPrimExp Half v
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">atanh</span></span></span><span> </span><span id="local-6989586621684340130"><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340130"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Half v
forall v. PrimExp v -&gt; TPrimExp Half v
</span><a href="Futhark.Analysis.PrimExp.html#isF16"><span class="hs-identifier hs-var">isF16</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Half v) -&gt; PrimExp v -&gt; TPrimExp Half v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanh16&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Half v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Half v
</span><a href="#local-6989586621684340130"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float16"><span class="hs-identifier hs-var">Float16</span></a></span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span id="local-6989586621684341240"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340099"><span id="local-6989586621684340101"><span id="local-6989586621684340103"><span id="local-6989586621684340105"><span id="local-6989586621684340119"><span id="local-6989586621684340122"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341240"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="annot"><a href="#local-6989586621684341240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621684340098"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340098"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340097"><span class="annot"><span class="annottext">** :: TPrimExp Float v -&gt; TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340097"><span class="hs-operator hs-var hs-var hs-var hs-var">**</span></a></span></span><span> </span><span id="local-6989586621684340096"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340096"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FPow"><span class="hs-identifier hs-var">FPow</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340098"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340096"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621684340093"><span class="annot"><span class="annottext">pi :: TPrimExp Float v
</span><a href="#local-6989586621684340093"><span class="hs-identifier hs-var hs-var hs-var hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue) -&gt; FloatValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float32Value"><span class="hs-identifier hs-var">Float32Value</span></a></span><span> </span><span class="annot"><span class="annottext">Float
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621684340092"><span class="annot"><span class="annottext">exp :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340092"><span class="hs-identifier hs-var hs-var hs-var hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621684340091"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340091"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exp32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340091"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621684340090"><span class="annot"><span class="annottext">log :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340090"><span class="hs-identifier hs-var hs-var hs-var hs-var">log</span></a></span></span><span> </span><span id="local-6989586621684340089"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340089"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340089"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621684340088"><span class="annot"><span class="annottext">sin :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340088"><span class="hs-identifier hs-var hs-var hs-var hs-var">sin</span></a></span></span><span> </span><span id="local-6989586621684340087"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340087"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sin32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340087"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621684340086"><span class="annot"><span class="annottext">cos :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340086"><span class="hs-identifier hs-var hs-var hs-var hs-var">cos</span></a></span></span><span> </span><span id="local-6989586621684340085"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340085"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cos32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340085"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621684340084"><span class="annot"><span class="annottext">tan :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340084"><span class="hs-identifier hs-var hs-var hs-var hs-var">tan</span></a></span></span><span> </span><span id="local-6989586621684340083"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340083"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tan32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340083"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621684340082"><span class="annot"><span class="annottext">asin :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340082"><span class="hs-identifier hs-var hs-var hs-var hs-var">asin</span></a></span></span><span> </span><span id="local-6989586621684340081"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340081"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asin32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340081"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621684340080"><span class="annot"><span class="annottext">acos :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340080"><span class="hs-identifier hs-var hs-var hs-var hs-var">acos</span></a></span></span><span> </span><span id="local-6989586621684340079"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340079"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acos32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340079"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621684340078"><span class="annot"><span class="annottext">atan :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340078"><span class="hs-identifier hs-var hs-var hs-var hs-var">atan</span></a></span></span><span> </span><span id="local-6989586621684340077"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340077"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atan32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340077"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621684340076"><span class="annot"><span class="annottext">sinh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340076"><span class="hs-identifier hs-var hs-var hs-var hs-var">sinh</span></a></span></span><span> </span><span id="local-6989586621684340075"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340075"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340075"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621684340074"><span class="annot"><span class="annottext">cosh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340074"><span class="hs-identifier hs-var hs-var hs-var hs-var">cosh</span></a></span></span><span> </span><span id="local-6989586621684340073"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340073"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340073"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621684340072"><span class="annot"><span class="annottext">tanh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340072"><span class="hs-identifier hs-var hs-var hs-var hs-var">tanh</span></a></span></span><span> </span><span id="local-6989586621684340071"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340071"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340071"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621684340070"><span class="annot"><span class="annottext">asinh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340070"><span class="hs-identifier hs-var hs-var hs-var hs-var">asinh</span></a></span></span><span> </span><span id="local-6989586621684340069"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340069"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340069"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621684340068"><span class="annot"><span class="annottext">acosh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340068"><span class="hs-identifier hs-var hs-var hs-var hs-var">acosh</span></a></span></span><span> </span><span id="local-6989586621684340067"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340067"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340067"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621684340066"><span class="annot"><span class="annottext">atanh :: TPrimExp Float v -&gt; TPrimExp Float v
</span><a href="#local-6989586621684340066"><span class="hs-identifier hs-var hs-var hs-var hs-var">atanh</span></a></span></span><span> </span><span id="local-6989586621684340065"><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340065"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Float v
forall v. PrimExp v -&gt; TPrimExp Float v
</span><a href="Futhark.Analysis.PrimExp.html#isF32"><span class="hs-identifier hs-var">isF32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Float v) -&gt; PrimExp v -&gt; TPrimExp Float v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanh32&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Float v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Float v
</span><a href="#local-6989586621684340065"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float32"><span class="hs-identifier hs-var">Float32</span></a></span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span id="local-6989586621684341239"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684340034"><span id="local-6989586621684340036"><span id="local-6989586621684340038"><span id="local-6989586621684340040"><span id="local-6989586621684340054"><span id="local-6989586621684340057"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341239"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Floating</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684341239"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621684340033"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340033"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684340032"><span class="annot"><span class="annottext">** :: TPrimExp Double v -&gt; TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340032"><span class="hs-operator hs-var hs-var hs-var hs-var">**</span></a></span></span><span> </span><span id="local-6989586621684340031"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340031"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FPow"><span class="hs-identifier hs-var">FPow</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340033"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340031"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621684340028"><span class="annot"><span class="annottext">pi :: TPrimExp Double v
</span><a href="#local-6989586621684340028"><span class="hs-identifier hs-var hs-var hs-var hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#FloatValue"><span class="hs-identifier hs-var">FloatValue</span></a></span><span> </span><span class="annot"><span class="annottext">(FloatValue -&gt; PrimValue) -&gt; FloatValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FloatValue
</span><a href="Futhark.IR.Primitive.html#Float64Value"><span class="hs-identifier hs-var">Float64Value</span></a></span><span> </span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621684340027"><span class="annot"><span class="annottext">exp :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340027"><span class="hs-identifier hs-var hs-var hs-var hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621684340026"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340026"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exp64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340026"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621684340025"><span class="annot"><span class="annottext">log :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340025"><span class="hs-identifier hs-var hs-var hs-var hs-var">log</span></a></span></span><span> </span><span id="local-6989586621684340024"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340024"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;log64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340024"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621684340023"><span class="annot"><span class="annottext">sin :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340023"><span class="hs-identifier hs-var hs-var hs-var hs-var">sin</span></a></span></span><span> </span><span id="local-6989586621684340022"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340022"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sin64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340022"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621684340021"><span class="annot"><span class="annottext">cos :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340021"><span class="hs-identifier hs-var hs-var hs-var hs-var">cos</span></a></span></span><span> </span><span id="local-6989586621684340020"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340020"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cos64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340020"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621684340019"><span class="annot"><span class="annottext">tan :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340019"><span class="hs-identifier hs-var hs-var hs-var hs-var">tan</span></a></span></span><span> </span><span id="local-6989586621684340018"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340018"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tan64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340018"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621684340017"><span class="annot"><span class="annottext">asin :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340017"><span class="hs-identifier hs-var hs-var hs-var hs-var">asin</span></a></span></span><span> </span><span id="local-6989586621684340016"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340016"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asin64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340016"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621684340015"><span class="annot"><span class="annottext">acos :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340015"><span class="hs-identifier hs-var hs-var hs-var hs-var">acos</span></a></span></span><span> </span><span id="local-6989586621684340014"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340014"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acos64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340014"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span id="local-6989586621684340013"><span class="annot"><span class="annottext">atan :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340013"><span class="hs-identifier hs-var hs-var hs-var hs-var">atan</span></a></span></span><span> </span><span id="local-6989586621684340012"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340012"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atan64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340012"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621684340011"><span class="annot"><span class="annottext">sinh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340011"><span class="hs-identifier hs-var hs-var hs-var hs-var">sinh</span></a></span></span><span> </span><span id="local-6989586621684340010"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340010"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sinh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340010"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span id="local-6989586621684340009"><span class="annot"><span class="annottext">cosh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340009"><span class="hs-identifier hs-var hs-var hs-var hs-var">cosh</span></a></span></span><span> </span><span id="local-6989586621684340008"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340008"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cosh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340008"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621684340007"><span class="annot"><span class="annottext">tanh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340007"><span class="hs-identifier hs-var hs-var hs-var hs-var">tanh</span></a></span></span><span> </span><span id="local-6989586621684340006"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340006"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tanh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340006"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621684340005"><span class="annot"><span class="annottext">asinh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340005"><span class="hs-identifier hs-var hs-var hs-var hs-var">asinh</span></a></span></span><span> </span><span id="local-6989586621684340004"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340004"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;asinh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340004"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621684340003"><span class="annot"><span class="annottext">acosh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340003"><span class="hs-identifier hs-var hs-var hs-var hs-var">acosh</span></a></span></span><span> </span><span id="local-6989586621684340002"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340002"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acosh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340002"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621684340001"><span class="annot"><span class="annottext">atanh :: TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="#local-6989586621684340001"><span class="hs-identifier hs-var hs-var hs-var hs-var">atanh</span></a></span></span><span> </span><span id="local-6989586621684340000"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340000"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall v. PrimExp v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#isF64"><span class="hs-identifier hs-var">isF64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;atanh64&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684340000"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; PrimExp v) -&gt; PrimType -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-var">FloatType</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621684341233"><span id="local-6989586621684341234"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341234"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Util.IntegralExp.html#IntegralExp"><span class="hs-identifier hs-type">IntegralExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341234"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341233"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339981"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339981"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339980"><span class="annot"><span class="annottext">div :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Util.IntegralExp.html#div"><span class="hs-operator hs-var hs-var hs-var hs-var">`div`</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339978"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339978"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684339977"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339977"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-397"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-operator hs-var">`SDiv`</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339981"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339978"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-398"></span><span>            </span><span class="annot"><span class="annottext">(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var">asFloatOp</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FDiv"><span class="hs-identifier hs-var">FDiv</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339981"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339978"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-399"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339977"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;div&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339981"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339978"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339970"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339970"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339969"><span class="annot"><span class="annottext">mod :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Util.IntegralExp.html#mod"><span class="hs-operator hs-var hs-var hs-var hs-var">`mod`</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339967"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339967"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684339966"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339966"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SMod"><span class="hs-operator hs-var">`SMod`</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339970"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339967"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339966"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mod&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339970"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339967"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339959"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339959"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339958"><span class="annot"><span class="annottext">quot :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Util.IntegralExp.html#quot"><span class="hs-operator hs-var hs-var hs-var hs-var">`quot`</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339956"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339956"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Bool
forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339956"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339959"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684339955"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339955"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SQuot"><span class="hs-operator hs-var">`SQuot`</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339959"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339956"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339955"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;quot&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339959"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339956"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339949"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339949"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339948"><span class="annot"><span class="annottext">rem :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Util.IntegralExp.html#rem"><span class="hs-operator hs-var hs-var hs-var hs-var">`rem`</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339946"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339946"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684339945"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339945"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SRem"><span class="hs-operator hs-var">`SRem`</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339949"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339946"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339945"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rem&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339949"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339946"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339938"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339938"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339937"><span class="annot"><span class="annottext">divUp :: TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Util.IntegralExp.html#divUp"><span class="hs-operator hs-var hs-var hs-var hs-var">`divUp`</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339935"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339935"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684339934"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339934"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (PrimExp v)] -&gt; Maybe (PrimExp v)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var">asIntOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SDivUp"><span class="hs-operator hs-var">`SDivUp`</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339938"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339935"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339934"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (PrimExp v, PrimExp v) -&gt; TPrimExp t v
forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var">numBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;divRoundingUp&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339938"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339935"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621684339930"><span class="annot"><span class="annottext">sgn :: TPrimExp t v -&gt; Maybe Int
</span><a href="Futhark.Util.IntegralExp.html#sgn"><span class="hs-identifier hs-var hs-var hs-var hs-var">sgn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-type">IntValue</span></a></span><span> </span><span id="local-6989586621684339928"><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339928"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; Int -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; Int
forall int. Integral int =&gt; IntValue -&gt; int
</span><a href="Futhark.IR.Primitive.html#valueIntegral"><span class="hs-identifier hs-var">valueIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339928"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="annot"><a href="Futhark.Util.IntegralExp.html#sgn"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="hs-comment">-- | Lifted logical conjunction.</span><span>
</span><span id="line-428"></span><span id="local-6989586621684341230"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%26%26."><span class="hs-operator hs-type">(.&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341230"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341230"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339926"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339926"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%26%26."><span class="annot"><span class="annottext">.&amp;&amp;. :: forall v. TPrimExp Bool v -&gt; TPrimExp Bool v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%26%26."><span class="hs-operator hs-var hs-var">.&amp;&amp;.</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339925"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339925"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339926"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339925"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- | Lifted logical conjunction.</span><span>
</span><span id="line-432"></span><span id="local-6989586621684339924"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%7C%7C."><span class="hs-operator hs-type">(.||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684339924"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684339924"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684339924"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-433"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339923"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339923"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%7C%7C."><span class="annot"><span class="annottext">.||. :: forall v. TPrimExp Bool v -&gt; TPrimExp Bool v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%7C%7C."><span class="hs-operator hs-var hs-var">.||.</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339922"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339922"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339923"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339922"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Lifted relational operators; assuming signed numbers in case of</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- integers.</span><span>
</span><span id="line-437"></span><span id="local-6989586621684341226"><span id="local-6989586621684341227"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C."><span class="hs-operator hs-type">(.&lt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E."><span class="hs-operator hs-type">(.&gt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C%3D."><span class="hs-operator hs-type">(.&lt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E%3D."><span class="hs-operator hs-type">(.&gt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3D%3D."><span class="hs-operator hs-type">(.==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341227"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341227"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341226"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341226"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-438"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339921"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339921"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%3C."><span class="annot"><span class="annottext">.&lt;. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3C."><span class="hs-operator hs-var hs-var">.&lt;.</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339920"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339920"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-440"></span><span>    </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339919"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339920"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>    </span><span id="local-6989586621684339919"><span class="annot"><span class="annottext">cmp :: CmpOp
</span><a href="#local-6989586621684339919"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339918"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339918"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; CmpOp
</span><a href="Futhark.IR.Primitive.html#CmpSlt"><span class="hs-identifier hs-var">CmpSlt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339918"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339916"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339916"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; CmpOp
</span><a href="Futhark.IR.Primitive.html#FCmpLt"><span class="hs-identifier hs-var">FCmpLt</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339916"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Futhark.IR.Primitive.html#CmpLlt"><span class="hs-identifier hs-var">CmpLlt</span></a></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339913"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339913"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%3C%3D."><span class="annot"><span class="annottext">.&lt;=. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3C%3D."><span class="hs-operator hs-var hs-var">.&lt;=.</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339912"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339912"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339911"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339913"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339912"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621684339911"><span class="annot"><span class="annottext">cmp :: CmpOp
</span><a href="#local-6989586621684339911"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339913"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339910"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339910"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; CmpOp
</span><a href="Futhark.IR.Primitive.html#CmpSle"><span class="hs-identifier hs-var">CmpSle</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339910"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339908"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339908"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; CmpOp
</span><a href="Futhark.IR.Primitive.html#FCmpLe"><span class="hs-identifier hs-var">FCmpLe</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339908"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="Futhark.IR.Primitive.html#CmpLle"><span class="hs-identifier hs-var">CmpLle</span></a></span><span>
</span><span id="line-456"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339904"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339904"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%3D%3D."><span class="annot"><span class="annottext">.==. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3D%3D."><span class="hs-operator hs-var hs-var">.==.</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339903"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339903"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimType -&gt; CmpOp
</span><a href="Futhark.IR.Primitive.html#CmpEq"><span class="hs-identifier hs-var">CmpEq</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; CmpOp) -&gt; PrimType -&gt; CmpOp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339904"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; PrimType -&gt; PrimType
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`min`</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339903"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339904"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339903"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-460"></span><span id="local-6989586621684339900"><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339900"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%3E."><span class="annot"><span class="annottext">.&gt;. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3E."><span class="hs-operator hs-var hs-var">.&gt;.</span></a></span></span><span> </span><span id="local-6989586621684339899"><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339899"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339899"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3C."><span class="hs-operator hs-var">.&lt;.</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339900"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-461"></span><span id="local-6989586621684339898"><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339898"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id=".%3E%3D."><span class="annot"><span class="annottext">.&gt;=. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3E%3D."><span class="hs-operator hs-var hs-var">.&gt;=.</span></a></span></span><span> </span><span id="local-6989586621684339897"><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339897"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339897"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#.%3C%3D."><span class="hs-operator hs-var">.&lt;=.</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v
</span><a href="#local-6989586621684339898"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | Lifted bitwise operators.  The right-shift is logical, *not* arithmetic.</span><span>
</span><span id="line-464"></span><span id="local-6989586621684341209"><span id="local-6989586621684341210"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%26."><span class="hs-operator hs-type">(.&amp;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%7C."><span class="hs-operator hs-type">(.|.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%5E."><span class="hs-operator hs-type">(.^.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E%3E."><span class="hs-operator hs-type">(.&gt;&gt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C%3C."><span class="hs-operator hs-type">(.&lt;&lt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341210"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341209"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341210"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341209"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341210"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341209"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-465"></span><span id="local-6989586621684341214"><span id="local-6989586621684341215"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-type">bitPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341215"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341214"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341215"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341214"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341215"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341214"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-466"></span><span id="bitPrimExp"><span class="annot"><span class="annottext">bitPrimExp :: forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var hs-var">bitPrimExp</span></a></span></span><span> </span><span id="local-6989586621684339895"><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="#local-6989586621684339895"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339894"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339894"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span id="local-6989586621684339893"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339893"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp t v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp t v) -&gt; PrimExp v -&gt; TPrimExp t v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimExp v
forall v. PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#constFoldPrimExp"><span class="hs-identifier hs-var">constFoldPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v) -&gt; PrimExp v -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="#local-6989586621684339895"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; IntType -&gt; BinOp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; IntType
forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var">primExpIntType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339894"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339894"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339893"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-470"></span><span id=".%26."><span class="annot"><span class="annottext">.&amp;. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#.%26."><span class="hs-operator hs-var hs-var">(.&amp;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var">bitPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#And"><span class="hs-identifier hs-var">And</span></a></span><span>
</span><span id="line-471"></span><span id=".%7C."><span class="annot"><span class="annottext">.|. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#.%7C."><span class="hs-operator hs-var hs-var">(.|.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var">bitPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Or"><span class="hs-identifier hs-var">Or</span></a></span><span>
</span><span id="line-472"></span><span id=".%5E."><span class="annot"><span class="annottext">.^. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#.%5E."><span class="hs-operator hs-var hs-var">(.^.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var">bitPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Xor"><span class="hs-identifier hs-var">Xor</span></a></span><span>
</span><span id="line-473"></span><span id=".%3E%3E."><span class="annot"><span class="annottext">.&gt;&gt;. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#.%3E%3E."><span class="hs-operator hs-var hs-var">(.&gt;&gt;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var">bitPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#LShr"><span class="hs-identifier hs-var">LShr</span></a></span><span>
</span><span id="line-474"></span><span id=".%3C%3C."><span class="annot"><span class="annottext">.&lt;&lt;. :: forall t v. TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#.%3C%3C."><span class="hs-operator hs-var hs-var">(.&lt;&lt;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
forall t v.
(IntType -&gt; BinOp) -&gt; TPrimExp t v -&gt; TPrimExp t v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#bitPrimExp"><span class="hs-identifier hs-var">bitPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Shl"><span class="hs-identifier hs-var">Shl</span></a></span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3D%3D."><span class="hs-operator hs-type">.==.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C."><span class="hs-operator hs-type">.&lt;.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E."><span class="hs-operator hs-type">.&gt;.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3C%3D."><span class="hs-operator hs-type">.&lt;=.</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%3E%3D."><span class="hs-operator hs-type">.&gt;=.</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%26%26."><span class="hs-operator hs-type">.&amp;&amp;.</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#.%7C%7C."><span class="hs-operator hs-type">.||.</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Untyped smart constructor for sign extension that does a bit of</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- constant folding.</span><span>
</span><span id="line-484"></span><span id="local-6989586621684341198"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-type">sExt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341198"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341198"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-485"></span><span id="sExt"><span class="annot"><span class="annottext">sExt :: forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-var hs-var">sExt</span></a></span></span><span> </span><span id="local-6989586621684339884"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339884"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-type">IntValue</span></a></span><span> </span><span id="local-6989586621684339883"><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339883"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue) -&gt; IntValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; IntType -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#doSExt"><span class="hs-identifier hs-var">doSExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339883"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339884"><span class="hs-identifier hs-var">it</span></a></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-var">sExt</span></a></span><span> </span><span id="local-6989586621684339881"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339881"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span id="local-6989586621684339880"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339880"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; IntType
forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var">primExpIntType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339880"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; IntType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339881"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339880"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#SExt"><span class="hs-identifier hs-var">SExt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; IntType
forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var">primExpIntType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339880"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339881"><span class="hs-identifier hs-var">it</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339880"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Untyped smart constructor for zero extension that does a bit of</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- constant folding.</span><span>
</span><span id="line-492"></span><span id="local-6989586621684339878"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier hs-type">zExt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339878"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339878"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-493"></span><span id="zExt"><span class="annot"><span class="annottext">zExt :: forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier hs-var hs-var">zExt</span></a></span></span><span> </span><span id="local-6989586621684339876"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339876"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-type">IntValue</span></a></span><span> </span><span id="local-6989586621684339875"><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339875"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue) -&gt; IntValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; IntType -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#doZExt"><span class="hs-identifier hs-var">doZExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339875"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339876"><span class="hs-identifier hs-var">it</span></a></span><span>
</span><span id="line-494"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier hs-var">zExt</span></a></span><span> </span><span id="local-6989586621684339873"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339873"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span id="local-6989586621684339872"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339872"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; IntType
forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var">primExpIntType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339872"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; IntType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339873"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339872"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; PrimExp v
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; IntType -&gt; ConvOp
</span><a href="Futhark.IR.Primitive.html#ZExt"><span class="hs-identifier hs-var">ZExt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; IntType
forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var">primExpIntType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339872"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339873"><span class="hs-identifier hs-var">it</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339872"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span id="local-6989586621684341249"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-type">asIntOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341249"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341249"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-499"></span><span id="asIntOp"><span class="annot"><span class="annottext">asIntOp :: forall v.
(IntType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asIntOp"><span class="hs-identifier hs-var hs-var">asIntOp</span></a></span></span><span> </span><span id="local-6989586621684339870"><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="#local-6989586621684339870"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621684339869"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339869"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339868"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339868"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339867"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339867"><span class="hs-identifier hs-var">x_t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339869"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Maybe (PrimExp v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; Maybe (PrimExp v)) -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="#local-6989586621684339870"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339867"><span class="hs-identifier hs-var">x_t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339869"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339868"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PrimExp v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span id="local-6989586621684341247"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-type">asFloatOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341247"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341247"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341247"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-504"></span><span id="asFloatOp"><span class="annot"><span class="annottext">asFloatOp :: forall v.
(FloatType -&gt; BinOp) -&gt; PrimExp v -&gt; PrimExp v -&gt; Maybe (PrimExp v)
</span><a href="Futhark.Analysis.PrimExp.html#asFloatOp"><span class="hs-identifier hs-var hs-var">asFloatOp</span></a></span></span><span> </span><span id="local-6989586621684339866"><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="#local-6989586621684339866"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621684339865"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339865"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339864"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339864"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339863"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339863"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339865"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Maybe (PrimExp v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; Maybe (PrimExp v)) -&gt; PrimExp v -&gt; Maybe (PrimExp v)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="#local-6989586621684339866"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339863"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339865"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339864"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (PrimExp v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span id="local-6989586621684341245"><span id="local-6989586621684341246"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-type">numBad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341246"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341245"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-509"></span><span id="numBad"><span class="annot"><span class="annottext">numBad :: forall a b. Pretty a =&gt; String -&gt; a -&gt; b
</span><a href="Futhark.Analysis.PrimExp.html#numBad"><span class="hs-identifier hs-var hs-var">numBad</span></a></span></span><span> </span><span id="local-6989586621684339854"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339854"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684339853"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339853"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; b) -&gt; String -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid argument to PrimExp method &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339854"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Futhark.Util.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339853"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Evaluate a 'PrimExp' in the given monad.  Invokes 'fail' on type</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- errors.</span><span>
</span><span id="line-514"></span><span id="local-6989586621684341184"><span id="local-6989586621684341185"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-type">evalPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341185"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621684341184"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684341185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341184"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimValue"><span class="hs-identifier hs-type">PrimValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341184"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimValue"><span class="hs-identifier hs-type">PrimValue</span></a></span></span></span><span>
</span><span id="line-515"></span><span id="evalPrimExp"><span class="annot"><span class="annottext">evalPrimExp :: forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var hs-var">evalPrimExp</span></a></span></span><span> </span><span id="local-6989586621684339789"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339789"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span id="local-6989586621684339788"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621684339788"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339789"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621684339788"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684339787"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339787"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339787"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-517"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span id="local-6989586621684339786"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339786"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684339785"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339785"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339784"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339784"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339783"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339783"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>  </span><span id="local-6989586621684339782"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339782"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339786"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339784"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span id="local-6989586621684339781"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339781"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339786"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339783"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><span class="annottext">m PrimValue
-&gt; (PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinOp -&gt; (PrimExp v, PrimExp v) -&gt; m PrimValue
forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var">evalBad</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339785"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339784"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339783"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimValue -&gt; PrimValue -&gt; Maybe PrimValue
</span><a href="Futhark.IR.Primitive.html#doBinOp"><span class="hs-identifier hs-var">doBinOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339785"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339782"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339781"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-521"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span id="local-6989586621684339779"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339779"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span id="local-6989586621684339778"><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339778"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339777"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339777"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339776"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339776"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-522"></span><span>  </span><span id="local-6989586621684339775"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339775"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339779"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339777"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621684339774"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339774"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339779"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339776"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="annot"><span class="annottext">m PrimValue -&gt; (Bool -&gt; m PrimValue) -&gt; Maybe Bool -&gt; m PrimValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmpOp -&gt; (PrimExp v, PrimExp v) -&gt; m PrimValue
forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var">evalBad</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339778"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339777"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339776"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; m PrimValue)
-&gt; (Bool -&gt; PrimValue) -&gt; Bool -&gt; m PrimValue
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#BoolValue"><span class="hs-identifier hs-var">BoolValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; m PrimValue) -&gt; Maybe Bool -&gt; m PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimValue -&gt; PrimValue -&gt; Maybe Bool
</span><a href="Futhark.IR.Primitive.html#doCmpOp"><span class="hs-identifier hs-var">doCmpOp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339778"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339775"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339774"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-525"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span id="local-6989586621684339771"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339771"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span id="local-6989586621684339770"><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339770"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339769"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339769"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621684339768"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339768"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339771"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339769"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><span class="annottext">m PrimValue
-&gt; (PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp v -&gt; m PrimValue
forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var">evalBad</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339770"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339769"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimValue -&gt; Maybe PrimValue
</span><a href="Futhark.IR.Primitive.html#doUnOp"><span class="hs-identifier hs-var">doUnOp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339770"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339768"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span id="local-6989586621684339766"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339766"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span id="local-6989586621684339765"><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339765"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339764"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339764"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621684339763"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339763"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339766"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339764"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><span class="annottext">m PrimValue
-&gt; (PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp v -&gt; m PrimValue
forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var">evalBad</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339765"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339764"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimValue -&gt; Maybe PrimValue
</span><a href="Futhark.IR.Primitive.html#doConvOp"><span class="hs-identifier hs-var">doConvOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339765"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339763"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-531"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span id="local-6989586621684339761"><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339761"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span id="local-6989586621684339760"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339760"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621684339759"><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684339759"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621684339758"><span class="annot"><span class="annottext">[PrimValue]
</span><a href="#local-6989586621684339758"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; m PrimValue) -&gt; [PrimExp v] -&gt; m [PrimValue]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
forall v (m :: * -&gt; *).
(Pretty v, MonadFail m) =&gt;
(v -&gt; m PrimValue) -&gt; PrimExp v -&gt; m PrimValue
</span><a href="Futhark.Analysis.PrimExp.html#evalPrimExp"><span class="hs-identifier hs-var">evalPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; m PrimValue
</span><a href="#local-6989586621684339761"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684339759"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-533"></span><span>  </span><span class="annot"><span class="annottext">m PrimValue
-&gt; (PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [PrimExp v] -&gt; m PrimValue
forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var">evalBad</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339760"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684339759"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; m PrimValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PrimValue -&gt; m PrimValue) -&gt; Maybe PrimValue -&gt; m PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PrimType]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684339756"><span class="annot"><span class="annottext">[PrimValue] -&gt; Maybe PrimValue
</span><a href="#local-6989586621684339756"><span class="hs-identifier hs-var">fun</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Map
     String ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue)
-&gt; Maybe ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339760"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Map String ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue)
</span><a href="Futhark.IR.Primitive.html#primFuns"><span class="hs-identifier hs-var">primFuns</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><span class="annottext">[PrimValue] -&gt; Maybe PrimValue
</span><a href="#local-6989586621684339756"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimValue]
</span><a href="#local-6989586621684339758"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span id="local-6989586621684341174"><span id="local-6989586621684341175"><span id="local-6989586621684341176"><span id="local-6989586621684341177"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-type">evalBad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341177"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341176"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621684341175"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341177"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341176"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684341175"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341174"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-538"></span><span id="evalBad"><span class="annot"><span class="annottext">evalBad :: forall a b (m :: * -&gt; *) c.
(Pretty a, Pretty b, MonadFail m) =&gt;
a -&gt; b -&gt; m c
</span><a href="Futhark.Analysis.PrimExp.html#evalBad"><span class="hs-identifier hs-var hs-var">evalBad</span></a></span></span><span> </span><span id="local-6989586621684339744"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339744"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339743"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621684339743"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-539"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; m c
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m c) -&gt; String -&gt; m c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-540"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;evalPrimExp: Type error when applying &quot;</span></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Futhark.Util.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339744"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to &quot;</span></span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Futhark.Util.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621684339743"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-comment">-- | The type of values returned by a 'PrimExp'.  This function</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- returning does not imply that the 'PrimExp' is type-correct.</span><span>
</span><span id="line-547"></span><span id="local-6989586621684341288"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-type">primExpType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341288"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span></span><span>
</span><span id="line-548"></span><span id="primExpType"><span class="annot"><span class="annottext">primExpType :: forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var hs-var">primExpType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339742"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339742"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339742"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684339741"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339741"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#primValueType"><span class="hs-identifier hs-var">primValueType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339741"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-550"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684339739"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339739"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#binOpType"><span class="hs-identifier hs-var">binOpType</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339739"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span id="local-6989586621684339736"><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339736"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#unOpType"><span class="hs-identifier hs-var">unOpType</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339736"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span id="local-6989586621684339734"><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339734"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PrimType, PrimType) -&gt; PrimType
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((PrimType, PrimType) -&gt; PrimType)
-&gt; (PrimType, PrimType) -&gt; PrimType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; (PrimType, PrimType)
</span><a href="Futhark.IR.Primitive.html#convOpType"><span class="hs-identifier hs-var">convOpType</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339734"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-554"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[PrimExp v]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339732"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339732"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339732"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">-- | Is the expression a constant zero of some sort?</span><span>
</span><span id="line-557"></span><span id="local-6989586621684339731"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-type">zeroIshExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339731"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-558"></span><span id="zeroIshExp"><span class="annot"><span class="annottext">zeroIshExp :: forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var hs-var">zeroIshExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684339730"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339730"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339730"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-559"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zeroIshExp"><span class="hs-identifier hs-var">zeroIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- | Is the expression a constant one of some sort?</span><span>
</span><span id="line-562"></span><span id="local-6989586621684339728"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-type">oneIshExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339728"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-563"></span><span id="oneIshExp"><span class="annot"><span class="annottext">oneIshExp :: forall a. PrimExp a -&gt; Bool
</span><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var hs-var">oneIshExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684339727"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339727"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#oneIsh"><span class="hs-identifier hs-var">oneIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339727"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#oneIshExp"><span class="hs-identifier hs-var">oneIshExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">-- | If the given 'PrimExp' is a constant of the wrong integer type,</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- coerce it to the given integer type.  This is a workaround for an</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- issue in the 'Num' instance.</span><span>
</span><span id="line-569"></span><span id="local-6989586621684339725"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#coerceIntPrimExp"><span class="hs-identifier hs-type">coerceIntPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339725"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339725"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-570"></span><span id="coerceIntPrimExp"><span class="annot"><span class="annottext">coerceIntPrimExp :: forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#coerceIntPrimExp"><span class="hs-identifier hs-var hs-var">coerceIntPrimExp</span></a></span></span><span> </span><span id="local-6989586621684339724"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339724"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-type">IntValue</span></a></span><span> </span><span id="local-6989586621684339723"><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339723"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#IntValue"><span class="hs-identifier hs-var">IntValue</span></a></span><span> </span><span class="annot"><span class="annottext">(IntValue -&gt; PrimValue) -&gt; IntValue -&gt; PrimValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IntValue -&gt; IntType -&gt; IntValue
</span><a href="Futhark.IR.Primitive.html#doSExt"><span class="hs-identifier hs-var">doSExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntValue
</span><a href="#local-6989586621684339723"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339724"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-571"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#coerceIntPrimExp"><span class="hs-identifier hs-var">coerceIntPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339722"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339722"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339722"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span id="local-6989586621684341211"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-type">primExpIntType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341211"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span></span><span>
</span><span id="line-574"></span><span id="primExpIntType"><span class="annot"><span class="annottext">primExpIntType :: forall v. PrimExp v -&gt; IntType
</span><a href="Futhark.Analysis.PrimExp.html#primExpIntType"><span class="hs-identifier hs-var hs-var">primExpIntType</span></a></span></span><span> </span><span id="local-6989586621684339721"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339721"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339721"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-575"></span><span>  </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339720"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339720"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339720"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | Boolean-valued PrimExps.</span><span>
</span><span id="line-579"></span><span id="local-6989586621684341158"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#true"><span class="hs-identifier hs-type">true</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#false"><span class="hs-identifier hs-type">false</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341158"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-580"></span><span id="true"><span class="annot"><span class="annottext">true :: forall v. TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#true"><span class="hs-identifier hs-var hs-var">true</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#BoolValue"><span class="hs-identifier hs-var">BoolValue</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-581"></span><span id="false"><span class="annot"><span class="annottext">false :: forall v. TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#false"><span class="hs-identifier hs-var hs-var">false</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v) -&gt; PrimExp v -&gt; TPrimExp Bool v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp v
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimValue -&gt; PrimExp v) -&gt; PrimValue -&gt; PrimExp v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; PrimValue
</span><a href="Futhark.IR.Primitive.html#BoolValue"><span class="hs-identifier hs-var">BoolValue</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="hs-comment">-- | Boolean negation smart constructor.</span><span>
</span><span id="line-584"></span><span id="local-6989586621684341155"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#bNot"><span class="hs-identifier hs-type">bNot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341155"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621684341155"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-585"></span><span id="bNot"><span class="annot"><span class="annottext">bNot :: forall v. TPrimExp Bool v -&gt; TPrimExp Bool v
</span><a href="Futhark.Analysis.PrimExp.html#bNot"><span class="hs-identifier hs-var hs-var">bNot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Bool v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Bool v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v)
-&gt; TPrimExp Bool v
-&gt; TPrimExp Bool v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp v -&gt; PrimExp v
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="Futhark.IR.Primitive.html#Not"><span class="hs-identifier hs-var">Not</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp Bool v -&gt; PrimExp v) -&gt; TPrimExp Bool v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Bool v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | SMax on 32-bit integers.</span><span>
</span><span id="line-588"></span><span id="local-6989586621684341153"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMax32"><span class="hs-identifier hs-type">sMax32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684341153"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684341153"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684341153"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-589"></span><span id="sMax32"><span class="annot"><span class="annottext">sMax32 :: forall v. TPrimExp Int32 v -&gt; TPrimExp Int32 v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#sMax32"><span class="hs-identifier hs-var hs-var">sMax32</span></a></span></span><span> </span><span id="local-6989586621684339716"><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339716"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339715"><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339715"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v) -&gt; PrimExp v -&gt; TPrimExp Int32 v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SMax"><span class="hs-identifier hs-var">SMax</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int32 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339716"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int32 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339715"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-comment">-- | SMin on 32-bit integers.</span><span>
</span><span id="line-592"></span><span id="local-6989586621684339713"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMin32"><span class="hs-identifier hs-type">sMin32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684339713"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684339713"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684339713"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-593"></span><span id="sMin32"><span class="annot"><span class="annottext">sMin32 :: forall v. TPrimExp Int32 v -&gt; TPrimExp Int32 v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#sMin32"><span class="hs-identifier hs-var hs-var">sMin32</span></a></span></span><span> </span><span id="local-6989586621684339712"><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339712"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339711"><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339711"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v) -&gt; PrimExp v -&gt; TPrimExp Int32 v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SMin"><span class="hs-identifier hs-var">SMin</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int32 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339712"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int32 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int32 v
</span><a href="#local-6989586621684339711"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">-- | SMax on 64-bit integers.</span><span>
</span><span id="line-596"></span><span id="local-6989586621684341150"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMax64"><span class="hs-identifier hs-type">sMax64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684341150"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684341150"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684341150"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-597"></span><span id="sMax64"><span class="annot"><span class="annottext">sMax64 :: forall v. TPrimExp Int64 v -&gt; TPrimExp Int64 v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#sMax64"><span class="hs-identifier hs-var hs-var">sMax64</span></a></span></span><span> </span><span id="local-6989586621684339709"><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339709"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339708"><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339708"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v) -&gt; PrimExp v -&gt; TPrimExp Int64 v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SMax"><span class="hs-identifier hs-var">SMax</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339709"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339708"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- | SMin on 64-bit integers.</span><span>
</span><span id="line-600"></span><span id="local-6989586621684339707"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sMin64"><span class="hs-identifier hs-type">sMin64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684339707"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684339707"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684339707"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-601"></span><span id="sMin64"><span class="annot"><span class="annottext">sMin64 :: forall v. TPrimExp Int64 v -&gt; TPrimExp Int64 v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#sMin64"><span class="hs-identifier hs-var hs-var">sMin64</span></a></span></span><span> </span><span id="local-6989586621684339706"><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339706"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339705"><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339705"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v) -&gt; PrimExp v -&gt; TPrimExp Int64 v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SMin"><span class="hs-identifier hs-var">SMin</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339706"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 v
</span><a href="#local-6989586621684339705"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-comment">-- | Sign-extend to 32 bit integer.</span><span>
</span><span id="line-604"></span><span id="local-6989586621684341146"><span id="local-6989586621684341147"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt32"><span class="hs-identifier hs-type">sExt32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341147"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341147"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341146"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684341146"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-605"></span><span id="sExt32"><span class="annot"><span class="annottext">sExt32 :: forall t v. IntExp t =&gt; TPrimExp t v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#sExt32"><span class="hs-identifier hs-var hs-var">sExt32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall v. PrimExp v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-var">isInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; TPrimExp Int32 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; PrimExp v -&gt; PrimExp v
forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-var">sExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | Sign-extend to 64 bit integer.</span><span>
</span><span id="line-608"></span><span id="local-6989586621684341142"><span id="local-6989586621684341143"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#sExt64"><span class="hs-identifier hs-type">sExt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341143"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341143"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341142"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684341142"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-609"></span><span id="sExt64"><span class="annot"><span class="annottext">sExt64 :: forall t v. IntExp t =&gt; TPrimExp t v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#sExt64"><span class="hs-identifier hs-var hs-var">sExt64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall v. PrimExp v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-var">isInt64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; TPrimExp Int64 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; PrimExp v -&gt; PrimExp v
forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-var">sExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- | Zero-extend to 32 bit integer.</span><span>
</span><span id="line-612"></span><span id="local-6989586621684339697"><span id="local-6989586621684339698"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt32"><span class="hs-identifier hs-type">zExt32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339698"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339698"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339697"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="annot"><a href="#local-6989586621684339697"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-613"></span><span id="zExt32"><span class="annot"><span class="annottext">zExt32 :: forall t v. IntExp t =&gt; TPrimExp t v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#zExt32"><span class="hs-identifier hs-var hs-var">zExt32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int32 v
forall v. PrimExp v -&gt; TPrimExp Int32 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt32"><span class="hs-identifier hs-var">isInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int32 v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; TPrimExp Int32 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; PrimExp v -&gt; PrimExp v
forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier hs-var">zExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int32"><span class="hs-identifier hs-var">Int32</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Zero-extend to 64 bit integer.</span><span>
</span><span id="line-616"></span><span id="local-6989586621684339692"><span id="local-6989586621684339693"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#zExt64"><span class="hs-identifier hs-type">zExt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#IntExp"><span class="hs-identifier hs-type">IntExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339693"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339693"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339692"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="#local-6989586621684339692"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-617"></span><span id="zExt64"><span class="annot"><span class="annottext">zExt64 :: forall t v. IntExp t =&gt; TPrimExp t v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#zExt64"><span class="hs-identifier hs-var hs-var">zExt64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Int64 v
forall v. PrimExp v -&gt; TPrimExp Int64 v
</span><a href="Futhark.Analysis.PrimExp.html#isInt64"><span class="hs-identifier hs-var">isInt64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Int64 v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; TPrimExp Int64 v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IntType -&gt; PrimExp v -&gt; PrimExp v
forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#zExt"><span class="hs-identifier hs-var">zExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="Futhark.IR.Primitive.html#Int64"><span class="hs-identifier hs-var">Int64</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; PrimExp v)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; PrimExp v
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-comment">-- | 64-bit float minimum.</span><span>
</span><span id="line-620"></span><span id="local-6989586621684341135"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fMin64"><span class="hs-identifier hs-type">fMin64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684341135"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684341135"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684341135"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-621"></span><span id="fMin64"><span class="annot"><span class="annottext">fMin64 :: forall v.
TPrimExp Double v -&gt; TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#fMin64"><span class="hs-identifier hs-var hs-var">fMin64</span></a></span></span><span> </span><span id="local-6989586621684339688"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339688"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339687"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339687"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FMin"><span class="hs-identifier hs-var">FMin</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339688"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339687"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">-- | 64-bit float maximum.</span><span>
</span><span id="line-624"></span><span id="local-6989586621684339685"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#fMax64"><span class="hs-identifier hs-type">fMax64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684339685"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684339685"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="#local-6989586621684339685"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-625"></span><span id="fMax64"><span class="annot"><span class="annottext">fMax64 :: forall v.
TPrimExp Double v -&gt; TPrimExp Double v -&gt; TPrimExp Double v
</span><a href="Futhark.Analysis.PrimExp.html#fMax64"><span class="hs-identifier hs-var hs-var">fMax64</span></a></span></span><span> </span><span id="local-6989586621684339684"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339684"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339683"><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339683"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; TPrimExp Double v
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; TPrimExp Double v) -&gt; PrimExp v -&gt; TPrimExp Double v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FMax"><span class="hs-identifier hs-var">FMax</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="Futhark.IR.Primitive.html#Float64"><span class="hs-identifier hs-var">Float64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339684"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Double v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Double v
</span><a href="#local-6989586621684339683"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-comment">-- Prettyprinting instances</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span id="local-6989586621684341253"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684339677"><span id="local-6989586621684339679"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341253"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341253"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-630"></span><span>  </span><span id="local-6989586621684339661"><span class="annot"><span class="annottext">ppr :: PrimExp v -&gt; Doc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span id="local-6989586621684339659"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621684339659"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621684339659"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684339658"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339658"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684339658"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-632"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684339657"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339657"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339656"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339656"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339655"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339655"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339657"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339656"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339655"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span id="local-6989586621684339652"><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339652"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339651"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339651"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339650"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339650"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CmpOp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684339652"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339651"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339650"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span id="local-6989586621684339649"><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339649"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339648"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339648"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvOp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684339649"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339648"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span id="local-6989586621684339647"><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339647"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684339646"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339646"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnOp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684339647"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339646"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span id="local-6989586621684339645"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339645"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621684339644"><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684339644"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684339645"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><span class="hs-identifier hs-var">commasep</span></span><span> </span><span class="annot"><span class="annottext">([Doc] -&gt; Doc) -&gt; [Doc] -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; Doc) -&gt; [PrimExp v] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[PrimExp v]
</span><a href="#local-6989586621684339644"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span id="local-6989586621684341127"><span id="local-6989586621684341128"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684339637"><span id="local-6989586621684339639"><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684341128"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341127"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341128"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>  </span><span id="local-6989586621684339634"><span class="annot"><span class="annottext">ppr :: TPrimExp t v -&gt; Doc
</span><a href="#local-6989586621684339634"><span class="hs-identifier hs-var hs-var hs-var hs-var">ppr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp v -&gt; Doc)
-&gt; (TPrimExp t v -&gt; PrimExp v) -&gt; TPrimExp t v -&gt; Doc
forall {k} (cat :: k -&gt; k -&gt; *) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp t v -&gt; PrimExp v
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span></span></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- | Produce a mapping from the leaves of the 'PrimExp' to their</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- designated types.</span><span>
</span><span id="line-643"></span><span id="local-6989586621684341126"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-type">leafExpTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621684341126"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341126"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684341126"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-644"></span><span id="leafExpTypes"><span class="annot"><span class="annottext">leafExpTypes :: forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var hs-var">leafExpTypes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span id="local-6989586621684339619"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339619"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684339618"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339618"><span class="hs-identifier hs-var">ptp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, PrimType) -&gt; Set (a, PrimType)
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684339619"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339618"><span class="hs-identifier hs-var">ptp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set (a, PrimType)
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span>
</span><span id="line-646"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339615"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339615"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339615"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-647"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339614"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339614"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339614"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-648"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339613"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339613"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621684339612"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339612"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><span class="annottext">Set (a, PrimType) -&gt; Set (a, PrimType) -&gt; Set (a, PrimType)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339613"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339612"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339610"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339610"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621684339609"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339609"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><span class="annottext">Set (a, PrimType) -&gt; Set (a, PrimType) -&gt; Set (a, PrimType)
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339610"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684339609"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684339608"><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684339608"><span class="hs-identifier hs-var">pes</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="annottext">[Set (a, PrimType)] -&gt; Set (a, PrimType)
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><span class="hs-identifier hs-var">S.unions</span></span><span> </span><span class="annot"><span class="annottext">([Set (a, PrimType)] -&gt; Set (a, PrimType))
-&gt; [Set (a, PrimType)] -&gt; Set (a, PrimType)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; Set (a, PrimType))
-&gt; [PrimExp a] -&gt; [Set (a, PrimType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PrimExp a -&gt; Set (a, PrimType)
forall a. Ord a =&gt; PrimExp a -&gt; Set (a, PrimType)
</span><a href="Futhark.Analysis.PrimExp.html#leafExpTypes"><span class="hs-identifier hs-var">leafExpTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684339608"><span class="hs-identifier hs-var">pes</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="hs-comment">-- | Multiplication of untyped 'PrimExps', which must have the same</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-657"></span><span id="local-6989586621684341116"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2A~"><span class="hs-operator hs-type">(~*~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341116"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341116"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684341116"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-658"></span><span id="local-6989586621684339606"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="~%2A~"><span class="annot"><span class="annottext">~*~ :: forall v. PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#~%2A~"><span class="hs-operator hs-var hs-var">~*~</span></a></span></span><span> </span><span id="local-6989586621684339605"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339605"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339604"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339605"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-659"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621684339603"><span class="annot"><span class="annottext">t :: PrimType
</span><a href="#local-6989586621684339603"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339606"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621684339604"><span class="annot"><span class="annottext">op :: BinOp
</span><a href="#local-6989586621684339604"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339603"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339602"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339602"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Mul"><span class="hs-identifier hs-var">Mul</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339602"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span>
</span><span id="line-663"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339601"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339601"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FMul"><span class="hs-identifier hs-var">FMul</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339601"><span class="hs-identifier hs-var">ft</span></a></span><span>
</span><span id="line-664"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">-- | Division of untyped 'PrimExps', which must have the same</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- type.  For integers, this is unsafe signed division.</span><span>
</span><span id="line-669"></span><span id="local-6989586621684339599"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2F~"><span class="hs-operator hs-type">(~/~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339599"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339599"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339599"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-670"></span><span id="local-6989586621684339598"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339598"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="~%2F~"><span class="annot"><span class="annottext">~/~ :: forall v. PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#~%2F~"><span class="hs-operator hs-var hs-var">~/~</span></a></span></span><span> </span><span id="local-6989586621684339597"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339597"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339596"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339598"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339597"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621684339595"><span class="annot"><span class="annottext">t :: PrimType
</span><a href="#local-6989586621684339595"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339598"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span id="local-6989586621684339596"><span class="annot"><span class="annottext">op :: BinOp
</span><a href="#local-6989586621684339596"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339595"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-674"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339594"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339594"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Safety -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-identifier hs-var">SDiv</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339594"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Unsafe"><span class="hs-identifier hs-var">Unsafe</span></a></span><span>
</span><span id="line-675"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339593"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339593"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FDiv"><span class="hs-identifier hs-var">FDiv</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339593"><span class="hs-identifier hs-var">ft</span></a></span><span>
</span><span id="line-676"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span>
</span><span id="line-677"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogAnd"><span class="hs-identifier hs-var">LogAnd</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="hs-comment">-- | Addition of untyped 'PrimExps', which must have the same type.</span><span>
</span><span id="line-680"></span><span id="local-6989586621684339592"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2B~"><span class="hs-operator hs-type">(~+~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339592"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339592"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339592"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-681"></span><span id="local-6989586621684339591"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339591"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="~%2B~"><span class="annot"><span class="annottext">~+~ :: forall v. PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#~%2B~"><span class="hs-operator hs-var hs-var">~+~</span></a></span></span><span> </span><span id="local-6989586621684339590"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339590"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339589"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339591"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339590"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-682"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621684339588"><span class="annot"><span class="annottext">t :: PrimType
</span><a href="#local-6989586621684339588"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339591"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621684339589"><span class="annot"><span class="annottext">op :: BinOp
</span><a href="#local-6989586621684339589"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339588"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339587"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339587"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339587"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span>
</span><span id="line-686"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339586"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339586"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FAdd"><span class="hs-identifier hs-var">FAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339586"><span class="hs-identifier hs-var">ft</span></a></span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="hs-comment">-- | Subtraction of untyped 'PrimExps', which must have the same type.</span><span>
</span><span id="line-691"></span><span id="local-6989586621684339585"><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~-~"><span class="hs-operator hs-type">(~-~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339585"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339585"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684339585"><span class="hs-identifier hs-type">v</span></a></span></span><span>
</span><span id="line-692"></span><span id="local-6989586621684339584"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339584"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="~-~"><span class="annot"><span class="annottext">~-~ :: forall v. PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#~-~"><span class="hs-operator hs-var hs-var">~-~</span></a></span></span><span> </span><span id="local-6989586621684339583"><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339583"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684339582"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339584"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339583"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621684339581"><span class="annot"><span class="annottext">t :: PrimType
</span><a href="#local-6989586621684339581"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp v -&gt; PrimType
forall v. PrimExp v -&gt; PrimType
</span><a href="Futhark.Analysis.PrimExp.html#primExpType"><span class="hs-identifier hs-var">primExpType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp v
</span><a href="#local-6989586621684339584"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span id="local-6989586621684339582"><span class="annot"><span class="annottext">op :: BinOp
</span><a href="#local-6989586621684339582"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684339581"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-696"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span id="local-6989586621684339580"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339580"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Sub"><span class="hs-identifier hs-var">Sub</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684339580"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowUndef"><span class="hs-identifier hs-var">OverflowUndef</span></a></span><span>
</span><span id="line-697"></span><span>      </span><span class="annot"><a href="Futhark.IR.Primitive.html#FloatType"><span class="hs-identifier hs-type">FloatType</span></a></span><span> </span><span id="local-6989586621684339579"><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339579"><span class="hs-identifier hs-var">ft</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FloatType -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#FSub"><span class="hs-identifier hs-var">FSub</span></a></span><span> </span><span class="annot"><span class="annottext">FloatType
</span><a href="#local-6989586621684339579"><span class="hs-identifier hs-var">ft</span></a></span><span>
</span><span id="line-698"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Bool"><span class="hs-identifier hs-var">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><span class="annottext">PrimType
</span><a href="Futhark.IR.Primitive.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Futhark.IR.Primitive.html#LogOr"><span class="hs-identifier hs-var">LogOr</span></a></span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">7</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2A~"><span class="hs-operator hs-type">~*~</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2F~"><span class="hs-operator hs-type">~/~</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">6</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~%2B~"><span class="hs-operator hs-type">~+~</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#~-~"><span class="hs-operator hs-type">~-~</span></a></span><span>
</span><span id="line-704"></span></pre></body></html>