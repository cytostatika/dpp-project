<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Defines simplification functions for 'PrimExp's.</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Analysis.PrimExp.Simplify</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyPrimExp"><span class="hs-identifier">simplifyPrimExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyExtPrimExp"><span class="hs-identifier">simplifyExtPrimExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html"><span class="hs-identifier">Futhark.Analysis.PrimExp</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.html"><span class="hs-identifier">Futhark.IR</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html"><span class="hs-identifier">Futhark.Optimise.Simplify.Engine</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Engine</span></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Simplify a 'PrimExp', including copy propagation.  If a 'LeafExp'</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- refers to a name that is a 'Constant', the node turns into a</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- 'ValueExp'.</span><span>
</span><span id="line-13"></span><span id="local-6989586621684371822"><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyPrimExp"><span class="hs-identifier hs-type">simplifyPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimplifiableRep"><span class="hs-identifier hs-type">SimplifiableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371822"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimpleM"><span class="hs-identifier hs-type">SimpleM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371822"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-17"></span><span id="simplifyPrimExp"><span class="annot"><span class="annottext">simplifyPrimExp :: forall rep.
SimplifiableRep rep =&gt;
PrimExp VName -&gt; SimpleM rep (PrimExp VName)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyPrimExp"><span class="hs-identifier hs-var hs-var">simplifyPrimExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VName -&gt; PrimType -&gt; SimpleM rep (PrimExp VName))
-&gt; PrimExp VName -&gt; SimpleM rep (PrimExp VName)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; PrimType -&gt; SimpleM rep (PrimExp VName)
forall {rep}.
(ASTRep rep, Simplifiable (LetDec rep),
 Simplifiable (FParamInfo rep), Simplifiable (LParamInfo rep),
 Simplifiable (RetType rep), Simplifiable (BranchType rep),
 TraverseOpStms (Wise rep), CanBeWise (Op rep),
 IndexOp (OpWithWisdom (Op rep)), BuilderOps (Wise rep)) =&gt;
VName -&gt; PrimType -&gt; SimpleM rep (PrimExp VName)
</span><a href="#local-6989586621684371703"><span class="hs-identifier hs-var">onLeaf</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>    </span><span id="local-6989586621684371703"><span class="annot"><span class="annottext">onLeaf :: VName -&gt; PrimType -&gt; SimpleM rep (PrimExp VName)
</span><a href="#local-6989586621684371703"><span class="hs-identifier hs-var hs-var">onLeaf</span></a></span></span><span> </span><span id="local-6989586621684371640"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371640"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684371639"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371639"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-20"></span><span>      </span><span id="local-6989586621684371638"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684371638"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; SimpleM rep SubExp
forall e rep.
(Simplifiable e, SimplifiableRep rep) =&gt;
e -&gt; SimpleM rep e
</span><a href="Futhark.Optimise.Simplify.Engine.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; SimpleM rep SubExp) -&gt; SubExp -&gt; SimpleM rep SubExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SubExp
</span><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371640"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-21"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684371638"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-22"></span><span>        </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684371635"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371635"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimExp VName -&gt; SimpleM rep (PrimExp VName)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp VName -&gt; SimpleM rep (PrimExp VName))
-&gt; PrimExp VName -&gt; SimpleM rep (PrimExp VName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; PrimType -&gt; PrimExp VName
forall v. v -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371635"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371639"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-23"></span><span>        </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684371632"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371632"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimExp VName -&gt; SimpleM rep (PrimExp VName)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp VName -&gt; SimpleM rep (PrimExp VName))
-&gt; PrimExp VName -&gt; SimpleM rep (PrimExp VName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp VName
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371632"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- | Like 'simplifyPrimExp', but where leaves may be 'Ext's.</span><span>
</span><span id="line-26"></span><span id="local-6989586621684371774"><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyExtPrimExp"><span class="hs-identifier hs-type">simplifyExtPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimplifiableRep"><span class="hs-identifier hs-type">SimplifiableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371774"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimpleM"><span class="hs-identifier hs-type">SimpleM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371774"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-30"></span><span id="simplifyExtPrimExp"><span class="annot"><span class="annottext">simplifyExtPrimExp :: forall rep.
SimplifiableRep rep =&gt;
PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyExtPrimExp"><span class="hs-identifier hs-var hs-var">simplifyExtPrimExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ext VName -&gt; PrimType -&gt; SimpleM rep (PrimExp (Ext VName)))
-&gt; PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">Ext VName -&gt; PrimType -&gt; SimpleM rep (PrimExp (Ext VName))
forall {rep}.
(ASTRep rep, Simplifiable (LetDec rep),
 Simplifiable (FParamInfo rep), Simplifiable (LParamInfo rep),
 Simplifiable (RetType rep), Simplifiable (BranchType rep),
 TraverseOpStms (Wise rep), CanBeWise (Op rep),
 IndexOp (OpWithWisdom (Op rep)), BuilderOps (Wise rep)) =&gt;
Ext VName -&gt; PrimType -&gt; SimpleM rep (PrimExp (Ext VName))
</span><a href="#local-6989586621684371594"><span class="hs-identifier hs-var">onLeaf</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>    </span><span id="local-6989586621684371594"><span class="annot"><span class="annottext">onLeaf :: Ext VName -&gt; PrimType -&gt; SimpleM rep (PrimExp (Ext VName))
</span><a href="#local-6989586621684371594"><span class="hs-identifier hs-var hs-var">onLeaf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Free"><span class="hs-identifier hs-type">Free</span></a></span><span> </span><span id="local-6989586621684371532"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371532"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684371531"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371531"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-33"></span><span>      </span><span id="local-6989586621684371530"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684371530"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; SimpleM rep SubExp
forall e rep.
(Simplifiable e, SimplifiableRep rep) =&gt;
e -&gt; SimpleM rep e
</span><a href="Futhark.Optimise.Simplify.Engine.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; SimpleM rep SubExp) -&gt; SubExp -&gt; SimpleM rep SubExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SubExp
</span><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371532"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-34"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684371530"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684371529"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371529"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName)))
-&gt; PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ext VName -&gt; PrimType -&gt; PrimExp (Ext VName)
forall v. v -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Ext VName
forall a. a -&gt; Ext a
</span><a href="Futhark.IR.Syntax.Core.html#Free"><span class="hs-identifier hs-var">Free</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684371529"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371531"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684371528"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371528"><span class="hs-identifier hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName)))
-&gt; PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp (Ext VName)
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371528"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="#local-6989586621684371594"><span class="hs-identifier hs-var">onLeaf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621684371526"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684371526"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684371525"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371525"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName)))
-&gt; PrimExp (Ext VName) -&gt; SimpleM rep (PrimExp (Ext VName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ext VName -&gt; PrimType -&gt; PrimExp (Ext VName)
forall v. v -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-var">LeafExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Ext VName
forall a. Int -&gt; Ext a
</span><a href="Futhark.IR.Syntax.Core.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684371526"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371525"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span id="local-6989586621684371789"><span id="local-6989586621684371790"><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-type">simplifyAnyPrimExp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimplifiableRep"><span class="hs-identifier hs-type">SimplifiableRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371790"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684371789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimpleM"><span class="hs-identifier hs-type">SimpleM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371790"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371789"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Futhark.Optimise.Simplify.Engine.html#SimpleM"><span class="hs-identifier hs-type">SimpleM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371790"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684371789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-44"></span><span id="simplifyAnyPrimExp"><span class="annot"><span class="annottext">simplifyAnyPrimExp :: forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var hs-var">simplifyAnyPrimExp</span></a></span></span><span> </span><span id="local-6989586621684371494"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#LeafExp"><span class="hs-identifier hs-type">LeafExp</span></a></span><span> </span><span id="local-6989586621684371493"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684371493"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684371492"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371492"><span class="hs-identifier hs-var">pt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371494"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684371493"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371492"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-type">ValueExp</span></a></span><span> </span><span id="local-6989586621684371491"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371491"><span class="hs-identifier hs-var">pv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="annottext">PrimExp a -&gt; SimpleM rep (PrimExp a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimExp a
forall v. PrimValue -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ValueExp"><span class="hs-identifier hs-var">ValueExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684371491"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span id="local-6989586621684371490"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371490"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-type">BinOpExp</span></a></span><span> </span><span id="local-6989586621684371488"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684371488"><span class="hs-identifier hs-var">bop</span></a></span></span><span> </span><span id="local-6989586621684371487"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371487"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621684371486"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371486"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp a -&gt; PrimExp a -&gt; PrimExp a
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684371488"><span class="hs-identifier hs-var">bop</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a -&gt; PrimExp a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371490"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371487"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleM rep (PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371490"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371486"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span id="local-6989586621684371484"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371484"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-type">CmpOpExp</span></a></span><span> </span><span id="local-6989586621684371482"><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684371482"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621684371481"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371481"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621684371480"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371480"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><span class="annottext">CmpOp -&gt; PrimExp a -&gt; PrimExp a -&gt; PrimExp a
forall v. CmpOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#CmpOpExp"><span class="hs-identifier hs-var">CmpOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">CmpOp
</span><a href="#local-6989586621684371482"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a -&gt; PrimExp a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371484"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371481"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleM rep (PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371484"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371480"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span id="local-6989586621684371479"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371479"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-type">UnOpExp</span></a></span><span> </span><span id="local-6989586621684371477"><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684371477"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621684371476"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371476"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">UnOp -&gt; PrimExp a -&gt; PrimExp a
forall v. UnOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#UnOpExp"><span class="hs-identifier hs-var">UnOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">UnOp
</span><a href="#local-6989586621684371477"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371479"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371476"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span id="local-6989586621684371475"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371475"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-type">ConvOpExp</span></a></span><span> </span><span id="local-6989586621684371473"><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684371473"><span class="hs-identifier hs-var">conv</span></a></span></span><span> </span><span id="local-6989586621684371472"><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371472"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="annottext">ConvOp -&gt; PrimExp a -&gt; PrimExp a
forall v. ConvOp -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#ConvOpExp"><span class="hs-identifier hs-var">ConvOpExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConvOp
</span><a href="#local-6989586621684371473"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; PrimExp a)
-&gt; SimpleM rep (PrimExp a) -&gt; SimpleM rep (PrimExp a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371475"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp a
</span><a href="#local-6989586621684371472"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span id="local-6989586621684371471"><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371471"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-type">FunExp</span></a></span><span> </span><span id="local-6989586621684371469"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684371469"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621684371468"><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684371468"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621684371467"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371467"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [PrimExp a] -&gt; PrimType -&gt; PrimExp a
forall v. String -&gt; [PrimExp v] -&gt; PrimType -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#FunExp"><span class="hs-identifier hs-var">FunExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684371469"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">([PrimExp a] -&gt; PrimType -&gt; PrimExp a)
-&gt; SimpleM rep [PrimExp a] -&gt; SimpleM rep (PrimType -&gt; PrimExp a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp a -&gt; SimpleM rep (PrimExp a))
-&gt; [PrimExp a] -&gt; SimpleM rep [PrimExp a]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
forall rep a.
SimplifiableRep rep =&gt;
(a -&gt; PrimType -&gt; SimpleM rep (PrimExp a))
-&gt; PrimExp a -&gt; SimpleM rep (PrimExp a)
</span><a href="Futhark.Analysis.PrimExp.Simplify.html#simplifyAnyPrimExp"><span class="hs-identifier hs-var">simplifyAnyPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; PrimType -&gt; SimpleM rep (PrimExp a)
</span><a href="#local-6989586621684371471"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PrimExp a]
</span><a href="#local-6989586621684371468"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleM rep (PrimType -&gt; PrimExp a)
-&gt; SimpleM rep PrimType -&gt; SimpleM rep (PrimExp a)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; SimpleM rep PrimType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684371467"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-57"></span></pre></body></html>