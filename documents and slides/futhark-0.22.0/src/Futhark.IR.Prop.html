<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">-- | This module provides various simple ways to query and manipulate</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- fundamental Futhark terms, such as types and values.  The intent is to</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- keep &quot;Futhark.IRrsentation.AST.Syntax&quot; simple, and put whatever</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- embellishments we need here.  This is an internal, desugared</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- representation.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.IR.Prop</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Reshape.html"><span class="hs-identifier">Futhark.IR.Prop.Reshape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Rearrange.html"><span class="hs-identifier">Futhark.IR.Prop.Rearrange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html"><span class="hs-identifier">Futhark.IR.Prop.Types</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Constants.html"><span class="hs-identifier">Futhark.IR.Prop.Constants</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.TypeOf.html"><span class="hs-identifier">Futhark.IR.Prop.TypeOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Patterns.html"><span class="hs-identifier">Futhark.IR.Prop.Patterns</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Futhark.IR.RetType.html"><span class="hs-identifier">Futhark.IR.RetType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Built-in functions</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#isBuiltInFunction"><span class="hs-identifier">isBuiltInFunction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#builtInFunctions"><span class="hs-identifier">builtInFunctions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extra tools</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#asBasicOp"><span class="hs-identifier">asBasicOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier">safeExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#subExpVars"><span class="hs-identifier">subExpVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier">subExpVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#commutativeLambda"><span class="hs-identifier">commutativeLambda</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#entryPointSize"><span class="hs-identifier">entryPointSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#defAux"><span class="hs-identifier">defAux</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#stmCerts"><span class="hs-identifier">stmCerts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#certify"><span class="hs-identifier">certify</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#expExtTypesFromPat"><span class="hs-identifier">expExtTypesFromPat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#attrsForAssert"><span class="hs-identifier">attrsForAssert</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#lamIsBinOp"><span class="hs-identifier">lamIsBinOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTConstraints"><span class="hs-identifier">ASTConstraints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier">IsOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier">ASTRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elemIndex</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Pretty.html"><span class="hs-identifier">Futhark.IR.Pretty</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Constants.html"><span class="hs-identifier">Futhark.IR.Prop.Constants</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html"><span class="hs-identifier">Futhark.IR.Prop.Names</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Patterns.html"><span class="hs-identifier">Futhark.IR.Prop.Patterns</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Rearrange.html"><span class="hs-identifier">Futhark.IR.Prop.Rearrange</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Reshape.html"><span class="hs-identifier">Futhark.IR.Prop.Reshape</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.TypeOf.html"><span class="hs-identifier">Futhark.IR.Prop.TypeOf</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html"><span class="hs-identifier">Futhark.IR.Prop.Types</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.RetType.html"><span class="hs-identifier">Futhark.IR.RetType</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html"><span class="hs-identifier">Futhark.IR.Syntax</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Transform.Rename.html"><span class="hs-identifier">Futhark.Transform.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Transform.Rename.html#Rename"><span class="hs-identifier">Rename</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Transform.Rename.html#Renameable"><span class="hs-identifier">Renameable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Transform.Substitute.html"><span class="hs-identifier">Futhark.Transform.Substitute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Transform.Substitute.html#Substitutable"><span class="hs-identifier">Substitutable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Transform.Substitute.html#Substitute"><span class="hs-identifier">Substitute</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.html"><span class="hs-identifier">Futhark.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Util.html#maybeNth"><span class="hs-identifier">maybeNth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | @isBuiltInFunction k@ is 'True' if @k@ is an element of 'builtInFunctions'.</span><span>
</span><span id="line-66"></span><span class="annot"><a href="Futhark.IR.Prop.html#isBuiltInFunction"><span class="hs-identifier hs-type">isBuiltInFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-67"></span><span id="isBuiltInFunction"><span class="annot"><span class="annottext">isBuiltInFunction :: Name -&gt; Bool
</span><a href="Futhark.IR.Prop.html#isBuiltInFunction"><span class="hs-identifier hs-var hs-var">isBuiltInFunction</span></a></span></span><span> </span><span id="local-6989586621684345389"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684345389"><span class="hs-identifier hs-var">fnm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684345389"><span class="hs-identifier hs-var">fnm</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name (PrimType, [PrimType]) -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-operator hs-var">`M.member`</span></span><span> </span><span class="annot"><span class="annottext">Map Name (PrimType, [PrimType])
</span><a href="Futhark.IR.Prop.html#builtInFunctions"><span class="hs-identifier hs-var">builtInFunctions</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | A map of all built-in functions and their types.</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Futhark.IR.Prop.html#builtInFunctions"><span class="hs-identifier hs-type">builtInFunctions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span id="builtInFunctions"><span class="annot"><span class="annottext">builtInFunctions :: Map Name (PrimType, [PrimType])
</span><a href="Futhark.IR.Prop.html#builtInFunctions"><span class="hs-identifier hs-var hs-var">builtInFunctions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, (PrimType, [PrimType]))] -&gt; Map Name (PrimType, [PrimType])
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, (PrimType, [PrimType]))]
 -&gt; Map Name (PrimType, [PrimType]))
-&gt; [(Name, (PrimType, [PrimType]))]
-&gt; Map Name (PrimType, [PrimType])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((String, ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))
 -&gt; (Name, (PrimType, [PrimType])))
-&gt; [(String,
     ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))]
-&gt; [(Name, (PrimType, [PrimType]))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(String, ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))
-&gt; (Name, (PrimType, [PrimType]))
forall {b} {a} {c}. (String, (b, a, c)) -&gt; (Name, (a, b))
</span><a href="#local-6989586621684345386"><span class="hs-identifier hs-var">namify</span></a></span><span> </span><span class="annot"><span class="annottext">([(String, ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))]
 -&gt; [(Name, (PrimType, [PrimType]))])
-&gt; [(String,
     ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))]
-&gt; [(Name, (PrimType, [PrimType]))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map String ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue)
-&gt; [(String,
     ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map String ([PrimType], PrimType, [PrimValue] -&gt; Maybe PrimValue)
</span><a href="Futhark.IR.Primitive.html#primFuns"><span class="hs-identifier hs-var">primFuns</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621684345386"><span class="annot"><span class="annottext">namify :: (String, (b, a, c)) -&gt; (Name, (a, b))
</span><a href="#local-6989586621684345386"><span class="hs-identifier hs-var hs-var">namify</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345383"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684345383"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684345382"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621684345382"><span class="hs-identifier hs-var">paramts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345381"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684345381"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Language.Futhark.Core.html#nameFromString"><span class="hs-identifier hs-var">nameFromString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621684345383"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684345381"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621684345382"><span class="hs-identifier hs-var">paramts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | If the expression is a t'BasicOp', return it, otherwise 'Nothing'.</span><span>
</span><span id="line-76"></span><span id="local-6989586621684345541"><span class="annot"><a href="Futhark.IR.Prop.html#asBasicOp"><span class="hs-identifier hs-type">asBasicOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345541"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span></span><span>
</span><span id="line-77"></span><span id="asBasicOp"><span class="annot"><span class="annottext">asBasicOp :: forall rep. Exp rep -&gt; Maybe BasicOp
</span><a href="Futhark.IR.Prop.html#asBasicOp"><span class="hs-identifier hs-var hs-var">asBasicOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span id="local-6989586621684345378"><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345378"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BasicOp -&gt; Maybe BasicOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345378"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Futhark.IR.Prop.html#asBasicOp"><span class="hs-identifier hs-var">asBasicOp</span></a></span><span> </span><span class="annot"><span class="annottext">ExpT rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe BasicOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | An expression is safe if it is always well-defined (assuming that</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- any required certificates have been checked) in any context.  For</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- example, array indexing is not safe, as the index may be out of</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- bounds.  On the other hand, adding two numbers cannot fail.</span><span>
</span><span id="line-84"></span><span id="local-6989586621684345535"><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-type">safeExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-type">IsOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345535"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345535"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-85"></span><span id="safeExp"><span class="annot"><span class="annottext">safeExp :: forall rep. IsOp (Op rep) =&gt; Exp rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var hs-var">safeExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span id="local-6989586621684345368"><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345368"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BasicOp -&gt; Bool
</span><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684345368"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621684345367"><span class="annot"><span class="annottext">safeBasicOp :: BasicOp -&gt; Bool
</span><a href="#local-6989586621684345367"><span class="hs-identifier hs-var hs-var">safeBasicOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-identifier hs-type">SDiv</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#SDivUp"><span class="hs-identifier hs-type">SDivUp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#SQuot"><span class="hs-identifier hs-type">SQuot</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#UDiv"><span class="hs-identifier hs-type">UDiv</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#UDivUp"><span class="hs-identifier hs-type">UDivUp</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#SMod"><span class="hs-identifier hs-type">SMod</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#SRem"><span class="hs-identifier hs-type">SRem</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#UMod"><span class="hs-identifier hs-type">UMod</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="Futhark.IR.Primitive.html#Safe"><span class="hs-identifier hs-var">Safe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-identifier hs-type">SDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345355"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345355"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345355"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SDiv"><span class="hs-identifier hs-type">SDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SDivUp"><span class="hs-identifier hs-type">SDivUp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345352"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345352"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345352"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SDivUp"><span class="hs-identifier hs-type">SDivUp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UDiv"><span class="hs-identifier hs-type">UDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345351"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345351"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345351"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UDiv"><span class="hs-identifier hs-type">UDiv</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UDivUp"><span class="hs-identifier hs-type">UDivUp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345350"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345350"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345350"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UDivUp"><span class="hs-identifier hs-type">UDivUp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SMod"><span class="hs-identifier hs-type">SMod</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345349"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345349"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345349"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SMod"><span class="hs-identifier hs-type">SMod</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UMod"><span class="hs-identifier hs-type">UMod</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345348"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345348"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345348"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#UMod"><span class="hs-identifier hs-type">UMod</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SQuot"><span class="hs-identifier hs-type">SQuot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345347"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345347"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345347"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SQuot"><span class="hs-identifier hs-type">SQuot</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SRem"><span class="hs-identifier hs-type">SRem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345346"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345346"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#zeroIsh"><span class="hs-identifier hs-var">zeroIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345346"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#SRem"><span class="hs-identifier hs-type">SRem</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684345344"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345344"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#negativeIsh"><span class="hs-identifier hs-var">negativeIsh</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684345344"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#Pow"><span class="hs-identifier hs-type">Pow</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#ArrayLit"><span class="hs-identifier hs-type">ArrayLit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#UnOp"><span class="hs-identifier hs-type">UnOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#CmpOp"><span class="hs-identifier hs-type">CmpOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#ConvOp"><span class="hs-identifier hs-type">ConvOp</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Scratch"><span class="hs-identifier hs-type">Scratch</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Concat"><span class="hs-identifier hs-type">Concat</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Reshape"><span class="hs-identifier hs-type">Reshape</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Rearrange"><span class="hs-identifier hs-type">Rearrange</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Manifest"><span class="hs-identifier hs-type">Manifest</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Iota"><span class="hs-identifier hs-type">Iota</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Replicate"><span class="hs-identifier hs-type">Replicate</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Copy"><span class="hs-identifier hs-type">Copy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="#local-6989586621684345367"><span class="hs-identifier hs-var">safeBasicOp</span></a></span><span> </span><span class="annot"><span class="annottext">BasicOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#DoLoop"><span class="hs-identifier hs-type">DoLoop</span></a></span><span> </span><span class="annot"><span class="annottext">[(FParam rep, SubExp)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">LoopForm rep
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345328"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345328"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Bool
forall rep. IsOp (Op rep) =&gt; Body rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeBody"><span class="hs-identifier hs-var">safeBody</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345328"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621684345325"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684345325"><span class="hs-identifier hs-var">fname</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(SubExp, Diet)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[RetType rep]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Safety, SrcLoc, [SrcLoc])
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="Futhark.IR.Prop.html#isBuiltInFunction"><span class="hs-identifier hs-var">isBuiltInFunction</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621684345325"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345323"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345323"><span class="hs-identifier hs-var">tbranch</span></a></span></span><span> </span><span id="local-6989586621684345322"><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345322"><span class="hs-identifier hs-var">fbranch</span></a></span></span><span> </span><span class="annot"><span class="annottext">IfDec (BranchType rep)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">(Stm rep -&gt; Bool) -&gt; Seq (Stm rep) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpT rep -&gt; Bool
forall rep. IsOp (Op rep) =&gt; Exp rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpT rep -&gt; Bool) -&gt; (Stm rep -&gt; ExpT rep) -&gt; Stm rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; ExpT rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; Seq (Stm rep)
forall rep. BodyT rep -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#bodyStms"><span class="hs-identifier hs-var hs-var">bodyStms</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345323"><span class="hs-identifier hs-var">tbranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Bool) -&gt; Seq (Stm rep) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExpT rep -&gt; Bool
forall rep. IsOp (Op rep) =&gt; Exp rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpT rep -&gt; Bool) -&gt; (Stm rep -&gt; ExpT rep) -&gt; Stm rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; ExpT rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; Seq (Stm rep)
forall rep. BodyT rep -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#bodyStms"><span class="hs-identifier hs-var hs-var">bodyStms</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345322"><span class="hs-identifier hs-var">fbranch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#WithAcc"><span class="hs-identifier hs-type">WithAcc</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- Although unlikely to matter.</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684345314"><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345314"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Op rep -&gt; Bool
forall op. IsOp op =&gt; op -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeOp"><span class="hs-identifier hs-var">safeOp</span></a></span><span> </span><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684345314"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621684345523"><span class="annot"><a href="Futhark.IR.Prop.html#safeBody"><span class="hs-identifier hs-type">safeBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-type">IsOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345523"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345523"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-138"></span><span id="safeBody"><span class="annot"><span class="annottext">safeBody :: forall rep. IsOp (Op rep) =&gt; Body rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeBody"><span class="hs-identifier hs-var hs-var">safeBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Bool) -&gt; Seq (Stm rep) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp rep -&gt; Bool
forall rep. IsOp (Op rep) =&gt; Exp rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#safeExp"><span class="hs-identifier hs-var">safeExp</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp rep -&gt; Bool) -&gt; (Stm rep -&gt; Exp rep) -&gt; Stm rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Exp rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (Stm rep) -&gt; Bool)
-&gt; (BodyT rep -&gt; Seq (Stm rep)) -&gt; BodyT rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Seq (Stm rep)
forall rep. BodyT rep -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#bodyStms"><span class="hs-identifier hs-var hs-var">bodyStms</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Return the variable names used in 'Var' subexpressions.  May contain</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- duplicates.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Futhark.IR.Prop.html#subExpVars"><span class="hs-identifier hs-type">subExpVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span id="subExpVars"><span class="annot"><span class="annottext">subExpVars :: [SubExp] -&gt; [VName]
</span><a href="Futhark.IR.Prop.html#subExpVars"><span class="hs-identifier hs-var hs-var">subExpVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Maybe VName) -&gt; [SubExp] -&gt; [VName]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; Maybe VName
</span><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier hs-var">subExpVar</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | If the t'SubExp' is a 'Var' return the variable name.</span><span>
</span><span id="line-146"></span><span class="annot"><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier hs-type">subExpVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span>
</span><span id="line-147"></span><span id="subExpVar"><span class="annot"><span class="annottext">subExpVar :: SubExp -&gt; Maybe VName
</span><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier hs-var hs-var">subExpVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345307"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345307"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Maybe VName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345307"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier hs-var">subExpVar</span></a></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe VName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Does the given lambda represent a known commutative function?</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- Based on pattern matching and checking whether the lambda</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- represents a known arithmetic operator; don't expect anything</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- clever here.</span><span>
</span><span id="line-154"></span><span id="local-6989586621684345502"><span class="annot"><a href="Futhark.IR.Prop.html#commutativeLambda"><span class="hs-identifier hs-type">commutativeLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345502"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-155"></span><span id="commutativeLambda"><span class="annot"><span class="annottext">commutativeLambda :: forall rep. Lambda rep -&gt; Bool
</span><a href="Futhark.IR.Prop.html#commutativeLambda"><span class="hs-identifier hs-var hs-var">commutativeLambda</span></a></span></span><span> </span><span id="local-6989586621684345291"><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345291"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684345290"><span class="annot"><span class="annottext">body :: BodyT rep
</span><a href="#local-6989586621684345290"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; BodyT rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345291"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span id="local-6989586621684345288"><span class="annot"><span class="annottext">n2 :: Int
</span><a href="#local-6989586621684345288"><span class="hs-identifier hs-var hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Param (LParamInfo rep)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345291"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621684345284"><span class="annot"><span class="annottext">[Param (LParamInfo rep)]
</span><a href="#local-6989586621684345284"><span class="hs-identifier hs-var">xps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345283"><span class="annot"><span class="annottext">[Param (LParamInfo rep)]
</span><a href="#local-6989586621684345283"><span class="hs-identifier hs-var">yps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [Param (LParamInfo rep)]
-&gt; ([Param (LParamInfo rep)], [Param (LParamInfo rep)])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345288"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345291"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>      </span><span id="local-6989586621684345281"><span class="annot"><span class="annottext">okComponent :: (Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes) -&gt; Bool
</span><a href="#local-6989586621684345281"><span class="hs-identifier hs-var hs-var">okComponent</span></a></span></span><span> </span><span id="local-6989586621684345280"><span class="annot"><span class="annottext">(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)
</span><a href="#local-6989586621684345280"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stm rep) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stm rep) -&gt; Bool) -&gt; Maybe (Stm rep) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Bool) -&gt; Seq (Stm rep) -&gt; Maybe (Stm rep)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)
-&gt; Stm rep -&gt; Bool
forall {dec} {dec} {rep}.
(Param dec, Param dec, SubExpRes) -&gt; Stm rep -&gt; Bool
</span><a href="#local-6989586621684345279"><span class="hs-identifier hs-var">okBinOp</span></a></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)
</span><a href="#local-6989586621684345280"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Seq (Stm rep) -&gt; Maybe (Stm rep))
-&gt; Seq (Stm rep) -&gt; Maybe (Stm rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Seq (Stm rep)
forall rep. BodyT rep -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#bodyStms"><span class="hs-identifier hs-var hs-var">bodyStms</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345290"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span id="local-6989586621684345279"><span class="annot"><span class="annottext">okBinOp :: (Param dec, Param dec, SubExpRes) -&gt; Stm rep -&gt; Bool
</span><a href="#local-6989586621684345279"><span class="hs-identifier hs-var hs-var">okBinOp</span></a></span></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621684345272"><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345272"><span class="hs-identifier hs-var">xp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684345271"><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345271"><span class="hs-identifier hs-var">yp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExpRes"><span class="hs-identifier hs-type">SubExpRes</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345269"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345269"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621684345266"><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684345266"><span class="hs-identifier hs-var">pe</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StmAux (ExpDec rep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span id="local-6989586621684345265"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684345265"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345264"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345264"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345263"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345263"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>          </span><span class="annot"><span class="annottext">PatElemT (LetDec rep) -&gt; VName
forall dec. PatElemT dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#patElemName"><span class="hs-identifier hs-var hs-var">patElemName</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684345266"><span class="hs-identifier hs-var">pe</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345269"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; Bool
</span><a href="Futhark.IR.Primitive.html#commutativeBinOp"><span class="hs-identifier hs-var">commutativeBinOp</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684345265"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345264"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345272"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345263"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345271"><span class="hs-identifier hs-var">yp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                   </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345263"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345272"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345264"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Param dec -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param dec
</span><a href="#local-6989586621684345271"><span class="hs-identifier hs-var">yp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>               </span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><a href="#local-6989586621684345279"><span class="hs-identifier hs-var">okBinOp</span></a></span><span> </span><span class="annot"><span class="annottext">(Param dec, Param dec, SubExpRes)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-170"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345288"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Param (LParamInfo rep)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345291"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345288"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[SubExpRes] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [SubExpRes]
forall rep. BodyT rep -&gt; [SubExpRes]
</span><a href="Futhark.IR.Syntax.html#bodyResult"><span class="hs-identifier hs-var hs-var">bodyResult</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345290"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)
 -&gt; Bool)
-&gt; [(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)]
-&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes) -&gt; Bool
</span><a href="#local-6989586621684345281"><span class="hs-identifier hs-var">okComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Param (LParamInfo rep)]
-&gt; [Param (LParamInfo rep)]
-&gt; [SubExpRes]
-&gt; [(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><span class="hs-identifier hs-var">zip3</span></span><span> </span><span class="annot"><span class="annottext">[Param (LParamInfo rep)]
</span><a href="#local-6989586621684345284"><span class="hs-identifier hs-var">xps</span></a></span><span> </span><span class="annot"><span class="annottext">[Param (LParamInfo rep)]
</span><a href="#local-6989586621684345283"><span class="hs-identifier hs-var">yps</span></a></span><span> </span><span class="annot"><span class="annottext">([SubExpRes]
 -&gt; [(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)])
-&gt; [SubExpRes]
-&gt; [(Param (LParamInfo rep), Param (LParamInfo rep), SubExpRes)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; [SubExpRes]
forall rep. BodyT rep -&gt; [SubExpRes]
</span><a href="Futhark.IR.Syntax.html#bodyResult"><span class="hs-identifier hs-var hs-var">bodyResult</span></a></span><span> </span><span class="annot"><span class="annottext">BodyT rep
</span><a href="#local-6989586621684345290"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | How many value parameters are accepted by this entry point?  This</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- is used to determine which of the function parameters correspond to</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- the parameters of the original function (they must all come at the</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- end).</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Futhark.IR.Prop.html#entryPointSize"><span class="hs-identifier hs-type">entryPointSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#EntryPointType"><span class="hs-identifier hs-type">EntryPointType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-179"></span><span id="entryPointSize"><span class="annot"><span class="annottext">entryPointSize :: EntryPointType -&gt; Int
</span><a href="Futhark.IR.Prop.html#entryPointSize"><span class="hs-identifier hs-var hs-var">entryPointSize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#TypeOpaque"><span class="hs-identifier hs-type">TypeOpaque</span></a></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684345254"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345254"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345254"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Futhark.IR.Prop.html#entryPointSize"><span class="hs-identifier hs-var">entryPointSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#TypeUnsigned"><span class="hs-identifier hs-type">TypeUnsigned</span></a></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Futhark.IR.Prop.html#entryPointSize"><span class="hs-identifier hs-var">entryPointSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#TypeDirect"><span class="hs-identifier hs-type">TypeDirect</span></a></span><span> </span><span class="annot"><span class="annottext">Uniqueness
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | A 'StmAux' with empty 'Certs'.</span><span>
</span><span id="line-184"></span><span id="local-6989586621684345468"><span class="annot"><a href="Futhark.IR.Prop.html#defAux"><span class="hs-identifier hs-type">defAux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345468"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-type">StmAux</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345468"><span class="hs-identifier hs-type">dec</span></a></span></span><span>
</span><span id="line-185"></span><span id="defAux"><span class="annot"><span class="annottext">defAux :: forall dec. dec -&gt; StmAux dec
</span><a href="Futhark.IR.Prop.html#defAux"><span class="hs-identifier hs-var hs-var">defAux</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Certs -&gt; Attrs -&gt; dec -&gt; StmAux dec
forall dec. Certs -&gt; Attrs -&gt; dec -&gt; StmAux dec
</span><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-var">StmAux</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Attrs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | The certificates associated with a statement.</span><span>
</span><span id="line-188"></span><span id="local-6989586621684345463"><span class="annot"><a href="Futhark.IR.Prop.html#stmCerts"><span class="hs-identifier hs-type">stmCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345463"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span></span><span>
</span><span id="line-189"></span><span id="stmCerts"><span class="annot"><span class="annottext">stmCerts :: forall rep. Stm rep -&gt; Certs
</span><a href="Futhark.IR.Prop.html#stmCerts"><span class="hs-identifier hs-var hs-var">stmCerts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StmAux (ExpDec rep) -&gt; Certs
forall dec. StmAux dec -&gt; Certs
</span><a href="Futhark.IR.Syntax.html#stmAuxCerts"><span class="hs-identifier hs-var hs-var">stmAuxCerts</span></a></span><span> </span><span class="annot"><span class="annottext">(StmAux (ExpDec rep) -&gt; Certs)
-&gt; (Stm rep -&gt; StmAux (ExpDec rep)) -&gt; Stm rep -&gt; Certs
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; StmAux (ExpDec rep)
forall rep. Stm rep -&gt; StmAux (ExpDec rep)
</span><a href="Futhark.IR.Syntax.html#stmAux"><span class="hs-identifier hs-var hs-var">stmAux</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Add certificates to a statement.</span><span>
</span><span id="line-192"></span><span id="local-6989586621684345461"><span class="annot"><a href="Futhark.IR.Prop.html#certify"><span class="hs-identifier hs-type">certify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345461"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345461"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-193"></span><span id="certify"><span class="annot"><span class="annottext">certify :: forall rep. Certs -&gt; Stm rep -&gt; Stm rep
</span><a href="Futhark.IR.Prop.html#certify"><span class="hs-identifier hs-var hs-var">certify</span></a></span></span><span> </span><span id="local-6989586621684345242"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345242"><span class="hs-identifier hs-var">cs1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621684345241"><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684345241"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-type">StmAux</span></a></span><span> </span><span id="local-6989586621684345240"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345240"><span class="hs-identifier hs-var">cs2</span></a></span></span><span> </span><span id="local-6989586621684345239"><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684345239"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621684345238"><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684345238"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684345237"><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684345237"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="annottext">Pat rep -&gt; StmAux (ExpDec rep) -&gt; Exp rep -&gt; Stm rep
forall rep. Pat rep -&gt; StmAux (ExpDec rep) -&gt; Exp rep -&gt; Stm rep
</span><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684345241"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs -&gt; Attrs -&gt; ExpDec rep -&gt; StmAux (ExpDec rep)
forall dec. Certs -&gt; Attrs -&gt; dec -&gt; StmAux dec
</span><a href="Futhark.IR.Syntax.html#StmAux"><span class="hs-identifier hs-var">StmAux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345240"><span class="hs-identifier hs-var">cs2</span></a></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; Certs -&gt; Certs
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345242"><span class="hs-identifier hs-var">cs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attrs
</span><a href="#local-6989586621684345239"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="annottext">ExpDec rep
</span><a href="#local-6989586621684345238"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684345237"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | A handy shorthand for properties that we usually want to things</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- we stuff into ASTs.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">type</span><span> </span><span id="ASTConstraints"><span class="annot"><a href="Futhark.IR.Prop.html#ASTConstraints"><span class="hs-identifier hs-var">ASTConstraints</span></a></span></span><span> </span><span id="local-6989586621684345236"><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Transform.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Transform.Substitute.html#Substitute"><span class="hs-identifier hs-type">Substitute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621684345236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | A type class for operations.</span><span>
</span><span id="line-202"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTConstraints"><span class="hs-identifier hs-type">ASTConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345507"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.TypeOf.html#TypedOp"><span class="hs-identifier hs-type">TypedOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345507"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="IsOp"><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-var">IsOp</span></a></span></span><span> </span><span id="local-6989586621684345507"><span class="annot"><a href="#local-6989586621684345507"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">-- | Like 'safeExp', but for arbitrary ops.</span><span>
</span><span id="line-204"></span><span>  </span><span id="safeOp"><span class="annot"><a href="Futhark.IR.Prop.html#safeOp"><span class="hs-identifier hs-type">safeOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345507"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- | Should we try to hoist this out of branches?</span><span>
</span><span id="line-207"></span><span>  </span><span id="cheapOp"><span class="annot"><a href="Futhark.IR.Prop.html#cheapOp"><span class="hs-identifier hs-type">cheapOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621684345507"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-type">IsOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621684345209"><span class="annot"><span class="annottext">safeOp :: () -&gt; Bool
</span><a href="#local-6989586621684345209"><span class="hs-identifier hs-var hs-var hs-var hs-var">safeOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621684345208"><span class="annot"><span class="annottext">cheapOp :: () -&gt; Bool
</span><a href="#local-6989586621684345208"><span class="hs-identifier hs-var hs-var hs-var hs-var">cheapOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Representation-specific attributes; also means the rep supports</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- some basic facilities.</span><span>
</span><span id="line-215"></span><span class="hs-keyword">class</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#RepTypes"><span class="hs-identifier hs-type">RepTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="Futhark.IR.Pretty.html#PrettyRep"><span class="hs-identifier hs-type">PrettyRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="Futhark.Transform.Rename.html#Renameable"><span class="hs-identifier hs-type">Renameable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><a href="Futhark.Transform.Substitute.html#Substitutable"><span class="hs-identifier hs-type">Substitutable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeDec"><span class="hs-identifier hs-type">FreeDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#ExpDec"><span class="hs-identifier hs-type">ExpDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeDec"><span class="hs-identifier hs-type">FreeDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#BodyDec"><span class="hs-identifier hs-type">BodyDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#RetType"><span class="hs-identifier hs-type">RetType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-type">BranchType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Futhark.IR.Prop.html#IsOp"><span class="hs-identifier hs-type">IsOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span id="ASTRep"><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-var">ASTRep</span></a></span></span><span> </span><span id="local-6989586621684345451"><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- | Given a pattern, construct the type of a body that would match</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-comment">-- it.  An implementation for many representations would be</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">-- 'expExtTypesFromPat'.</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621684345195"><span id="expTypesFromPat"><span class="annot"><a href="Futhark.IR.Prop.html#expTypesFromPat"><span class="hs-identifier hs-type">expTypesFromPat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#HasScope"><span class="hs-identifier hs-type">HasScope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345195"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621684345195"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="#local-6989586621684345195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Rep.html#BranchType"><span class="hs-identifier hs-type">BranchType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345451"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Construct the type of an expression that would match the pattern.</span><span>
</span><span id="line-240"></span><span id="local-6989586621684345442"><span class="annot"><a href="Futhark.IR.Prop.html#expExtTypesFromPat"><span class="hs-identifier hs-type">expExtTypesFromPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345442"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatT"><span class="hs-identifier hs-type">PatT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345442"><span class="hs-identifier hs-type">dec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#ExtType"><span class="hs-identifier hs-type">ExtType</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-241"></span><span id="expExtTypesFromPat"><span class="annot"><span class="annottext">expExtTypesFromPat :: forall dec. Typed dec =&gt; PatT dec -&gt; [ExtType]
</span><a href="Futhark.IR.Prop.html#expExtTypesFromPat"><span class="hs-identifier hs-var hs-var">expExtTypesFromPat</span></a></span></span><span> </span><span id="local-6989586621684345190"><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684345190"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">[VName] -&gt; [ExtType] -&gt; [ExtType]
</span><a href="Futhark.IR.Prop.Types.html#existentialiseExtTypes"><span class="hs-identifier hs-var">existentialiseExtTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatT dec -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684345190"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ExtType] -&gt; [ExtType]) -&gt; [ExtType] -&gt; [ExtType]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">[TypeBase Shape NoUniqueness] -&gt; [ExtType]
forall u. [TypeBase Shape u] -&gt; [TypeBase ExtShape u]
</span><a href="Futhark.IR.Prop.Types.html#staticShapes"><span class="hs-identifier hs-var">staticShapes</span></a></span><span> </span><span class="annot"><span class="annottext">([TypeBase Shape NoUniqueness] -&gt; [ExtType])
-&gt; [TypeBase Shape NoUniqueness] -&gt; [ExtType]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PatElemT dec -&gt; TypeBase Shape NoUniqueness)
-&gt; [PatElemT dec] -&gt; [TypeBase Shape NoUniqueness]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PatElemT dec -&gt; TypeBase Shape NoUniqueness
forall dec.
Typed dec =&gt;
PatElemT dec -&gt; TypeBase Shape NoUniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#patElemType"><span class="hs-identifier hs-var">patElemType</span></a></span><span> </span><span class="annot"><span class="annottext">([PatElemT dec] -&gt; [TypeBase Shape NoUniqueness])
-&gt; [PatElemT dec] -&gt; [TypeBase Shape NoUniqueness]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatT dec -&gt; [PatElemT dec]
forall dec. PatT dec -&gt; [PatElemT dec]
</span><a href="Futhark.IR.Syntax.html#patElems"><span class="hs-identifier hs-var hs-var">patElems</span></a></span><span> </span><span class="annot"><span class="annottext">PatT dec
</span><a href="#local-6989586621684345190"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Keep only those attributes that are relevant for 'Assert'</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- expressions.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Futhark.IR.Prop.html#attrsForAssert"><span class="hs-identifier hs-type">attrsForAssert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Attrs"><span class="hs-identifier hs-type">Attrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Attrs"><span class="hs-identifier hs-type">Attrs</span></a></span><span>
</span><span id="line-248"></span><span id="attrsForAssert"><span class="annot"><span class="annottext">attrsForAssert :: Attrs -&gt; Attrs
</span><a href="Futhark.IR.Prop.html#attrsForAssert"><span class="hs-identifier hs-var hs-var">attrsForAssert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Attrs"><span class="hs-identifier hs-type">Attrs</span></a></span><span> </span><span id="local-6989586621684345183"><span class="annot"><span class="annottext">Set Attr
</span><a href="#local-6989586621684345183"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">Set Attr -&gt; Attrs
</span><a href="Futhark.IR.Syntax.Core.html#Attrs"><span class="hs-identifier hs-var">Attrs</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Attr -&gt; Attrs) -&gt; Set Attr -&gt; Attrs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Attr -&gt; Bool) -&gt; Set Attr -&gt; Set Attr
forall a. (a -&gt; Bool) -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">S.filter</span></span><span> </span><span class="annot"><span class="annottext">Attr -&gt; Bool
</span><a href="#local-6989586621684345181"><span class="hs-identifier hs-var">attrForAssert</span></a></span><span> </span><span class="annot"><span class="annottext">Set Attr
</span><a href="#local-6989586621684345183"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621684345181"><span class="annot"><span class="annottext">attrForAssert :: Attr -&gt; Bool
</span><a href="#local-6989586621684345181"><span class="hs-identifier hs-var hs-var">attrForAssert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attr -&gt; Attr -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Attr] -&gt; Attr
</span><a href="Futhark.IR.Syntax.Core.html#AttrComp"><span class="hs-identifier hs-var">AttrComp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;warn&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attr
</span><span class="hs-string">&quot;safety_checks&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Horizontally fission a lambda that models a binary operator.</span><span>
</span><span id="line-254"></span><span id="local-6989586621684345427"><span class="annot"><a href="Futhark.IR.Prop.html#lamIsBinOp"><span class="hs-identifier hs-type">lamIsBinOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345427"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684345427"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Primitive.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#PrimType"><span class="hs-identifier hs-type">PrimType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-255"></span><span id="lamIsBinOp"><span class="annot"><span class="annottext">lamIsBinOp :: forall rep.
ASTRep rep =&gt;
Lambda rep -&gt; Maybe [(BinOp, PrimType, VName, VName)]
</span><a href="Futhark.IR.Prop.html#lamIsBinOp"><span class="hs-identifier hs-var hs-var">lamIsBinOp</span></a></span></span><span> </span><span id="local-6989586621684345130"><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubExpRes -&gt; Maybe (BinOp, PrimType, VName, VName))
-&gt; [SubExpRes] -&gt; Maybe [(BinOp, PrimType, VName, VName)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SubExpRes -&gt; Maybe (BinOp, PrimType, VName, VName)
</span><a href="#local-6989586621684345128"><span class="hs-identifier hs-var">splitStm</span></a></span><span> </span><span class="annot"><span class="annottext">([SubExpRes] -&gt; Maybe [(BinOp, PrimType, VName, VName)])
-&gt; [SubExpRes] -&gt; Maybe [(BinOp, PrimType, VName, VName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; [SubExpRes]
forall rep. BodyT rep -&gt; [SubExpRes]
</span><a href="Futhark.IR.Syntax.html#bodyResult"><span class="hs-identifier hs-var hs-var">bodyResult</span></a></span><span> </span><span class="annot"><span class="annottext">(BodyT rep -&gt; [SubExpRes]) -&gt; BodyT rep -&gt; [SubExpRes]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; BodyT rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>    </span><span id="local-6989586621684345127"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621684345127"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TypeBase Shape NoUniqueness] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([TypeBase Shape NoUniqueness] -&gt; Int)
-&gt; [TypeBase Shape NoUniqueness] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; [TypeBase Shape NoUniqueness]
forall rep. LambdaT rep -&gt; [TypeBase Shape NoUniqueness]
</span><a href="Futhark.IR.Syntax.html#lambdaReturnType"><span class="hs-identifier hs-var hs-var">lambdaReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621684345128"><span class="annot"><span class="annottext">splitStm :: SubExpRes -&gt; Maybe (BinOp, PrimType, VName, VName)
</span><a href="#local-6989586621684345128"><span class="hs-identifier hs-var hs-var">splitStm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExpRes"><span class="hs-identifier hs-type">SubExpRes</span></a></span><span> </span><span id="local-6989586621684345125"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345125"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345124"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345124"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684345125"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; Certs -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Certs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621684345123"><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684345123"><span class="hs-identifier hs-var">pe</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StmAux (ExpDec rep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span id="local-6989586621684345122"><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684345122"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345121"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345121"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684345120"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345120"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><span class="annottext">(Stm rep -&gt; Bool) -&gt; [Stm rep] -&gt; Maybe (Stm rep)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345124"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; [VName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Bool) -&gt; (Stm rep -&gt; [VName]) -&gt; Stm rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; [VName])
-&gt; (Stm rep -&gt; PatT (LetDec rep)) -&gt; Stm rep -&gt; [VName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; PatT (LetDec rep)
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Stm rep] -&gt; Maybe (Stm rep)) -&gt; [Stm rep] -&gt; Maybe (Stm rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><span class="annottext">Stms rep -&gt; [Stm rep]
forall rep. Stms rep -&gt; [Stm rep]
</span><a href="Futhark.IR.Syntax.html#stmsToList"><span class="hs-identifier hs-var">stmsToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Stms rep -&gt; [Stm rep]) -&gt; Stms rep -&gt; [Stm rep]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BodyT rep -&gt; Stms rep
forall rep. BodyT rep -&gt; Stms rep
</span><a href="Futhark.IR.Syntax.html#bodyStms"><span class="hs-identifier hs-var hs-var">bodyStms</span></a></span><span> </span><span class="annot"><span class="annottext">(BodyT rep -&gt; Stms rep) -&gt; BodyT rep -&gt; Stms rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; BodyT rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621684345117"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345117"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VName -&gt; SubExp
</span><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345124"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; [SubExp] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">(SubExpRes -&gt; SubExp) -&gt; [SubExpRes] -&gt; [SubExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SubExpRes -&gt; SubExp
</span><a href="Futhark.IR.Syntax.html#resSubExp"><span class="hs-identifier hs-var hs-var">resSubExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BodyT rep -&gt; [SubExpRes]
forall rep. BodyT rep -&gt; [SubExpRes]
</span><a href="Futhark.IR.Syntax.html#bodyResult"><span class="hs-identifier hs-var hs-var">bodyResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lambda rep -&gt; BodyT rep
forall rep. LambdaT rep -&gt; BodyT rep
</span><a href="Futhark.IR.Syntax.html#lambdaBody"><span class="hs-identifier hs-var hs-var">lambdaBody</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621684345115"><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345115"><span class="hs-identifier hs-var">xp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep))
forall int a. Integral int =&gt; int -&gt; [a] -&gt; Maybe a
</span><a href="Futhark.Util.html#maybeNth"><span class="hs-identifier hs-var">maybeNth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345117"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep)))
-&gt; [Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621684345114"><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345114"><span class="hs-identifier hs-var">yp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep))
forall int a. Integral int =&gt; int -&gt; [a] -&gt; Maybe a
</span><a href="Futhark.Util.html#maybeNth"><span class="hs-identifier hs-var">maybeNth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345127"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684345117"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep)))
-&gt; [Param (LParamInfo rep)] -&gt; Maybe (Param (LParamInfo rep))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lambda rep -&gt; [Param (LParamInfo rep)]
forall rep. LambdaT rep -&gt; [LParam rep]
</span><a href="Futhark.IR.Syntax.html#lambdaParams"><span class="hs-identifier hs-var hs-var">lambdaParams</span></a></span><span> </span><span class="annot"><span class="annottext">Lambda rep
</span><a href="#local-6989586621684345130"><span class="hs-identifier hs-var">lam</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345115"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345121"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345114"><span class="hs-identifier hs-var">yp</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; VName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684345120"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621684345111"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684345111"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TypeBase Shape NoUniqueness -&gt; Maybe (TypeBase Shape NoUniqueness)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TypeBase Shape NoUniqueness
 -&gt; Maybe (TypeBase Shape NoUniqueness))
-&gt; TypeBase Shape NoUniqueness
-&gt; Maybe (TypeBase Shape NoUniqueness)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatElemT (LetDec rep) -&gt; TypeBase Shape NoUniqueness
forall dec.
Typed dec =&gt;
PatElemT dec -&gt; TypeBase Shape NoUniqueness
</span><a href="Futhark.IR.Prop.Patterns.html#patElemType"><span class="hs-identifier hs-var">patElemType</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684345123"><span class="hs-identifier hs-var">pe</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">(BinOp, PrimType, VName, VName)
-&gt; Maybe (BinOp, PrimType, VName, VName)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BinOp
</span><a href="#local-6989586621684345122"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684345111"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345115"><span class="hs-identifier hs-var">xp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param (LParamInfo rep)
</span><a href="#local-6989586621684345114"><span class="hs-identifier hs-var">yp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="#local-6989586621684345128"><span class="hs-identifier hs-var">splitStm</span></a></span><span> </span><span class="annot"><span class="annottext">SubExpRes
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (BinOp, PrimType, VName, VName)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-271"></span></pre></body></html>