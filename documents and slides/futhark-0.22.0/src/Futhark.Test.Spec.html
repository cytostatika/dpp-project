<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- | Definition and parsing of a test specification.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Test.Spec</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromProgram"><span class="hs-identifier">testSpecFromProgram</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromProgramOrDie"><span class="hs-identifier">testSpecFromProgramOrDie</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecsFromPaths"><span class="hs-identifier">testSpecsFromPaths</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecsFromPathsOrDie"><span class="hs-identifier">testSpecsFromPathsOrDie</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromFile"><span class="hs-identifier">testSpecFromFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromFileOrDie"><span class="hs-identifier">testSpecFromFileOrDie</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier">ProgramTest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier">StructureTest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#StructurePipeline"><span class="hs-identifier">StructurePipeline</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#WarningTest"><span class="hs-identifier">WarningTest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#TestAction"><span class="hs-identifier">TestAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier">ExpectedError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-identifier">InputOutputs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier">TestRun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedResult"><span class="hs-identifier">ExpectedResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#Success"><span class="hs-identifier">Success</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier">Values</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier">GenValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.Test.Spec.html#genValueType"><span class="hs-identifier">genValueType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.IO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Void</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.Metrics.Type.html"><span class="hs-identifier">Futhark.Analysis.Metrics.Type</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Futhark.Data.Parser</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Futhark.Data.Parser</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.Script.html"><span class="hs-identifier">Futhark.Script</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.Test.Values.html"><span class="hs-identifier">Futhark.Test.Values</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.html"><span class="hs-identifier">Futhark.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Util.html#directoryContents"><span class="hs-identifier">directoryContents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Util.Pretty.html"><span class="hs-identifier">Futhark.Util.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Util.Pretty.html#prettyOneLine"><span class="hs-identifier">prettyOneLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO.Error</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">many</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">some</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Megaparsec.Char</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex.TDFA</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Description of a test to be carried out on a Futhark program.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- The Futhark program is stored separately.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="ProgramTest"><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-var">ProgramTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProgramTest"><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-var">ProgramTest</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="testDescription"><span class="annot"><span class="annottext">ProgramTest -&gt; Text
</span><a href="Futhark.Test.Spec.html#testDescription"><span class="hs-identifier hs-var hs-var">testDescription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-58"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span id="testTags"><span class="annot"><span class="annottext">ProgramTest -&gt; [Text]
</span><a href="Futhark.Test.Spec.html#testTags"><span class="hs-identifier hs-var hs-var">testTags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-60"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span id="testAction"><span class="annot"><span class="annottext">ProgramTest -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#testAction"><span class="hs-identifier hs-var hs-var">testAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><a href="Futhark.Test.Spec.html#TestAction"><span class="hs-identifier hs-type">TestAction</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320878"><span id="local-6989586621684320880"><span id="local-6989586621684320889"><span class="annot"><span class="annottext">Int -&gt; ProgramTest -&gt; ShowS
[ProgramTest] -&gt; ShowS
ProgramTest -&gt; [Char]
(Int -&gt; ProgramTest -&gt; ShowS)
-&gt; (ProgramTest -&gt; [Char])
-&gt; ([ProgramTest] -&gt; ShowS)
-&gt; Show ProgramTest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProgramTest] -&gt; ShowS
$cshowList :: [ProgramTest] -&gt; ShowS
show :: ProgramTest -&gt; [Char]
$cshow :: ProgramTest -&gt; [Char]
showsPrec :: Int -&gt; ProgramTest -&gt; ShowS
$cshowsPrec :: Int -&gt; ProgramTest -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | How to test a program.</span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="TestAction"><span class="annot"><a href="Futhark.Test.Spec.html#TestAction"><span class="hs-identifier hs-var">TestAction</span></a></span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="CompileTimeFailure"><span class="annot"><a href="Futhark.Test.Spec.html#CompileTimeFailure"><span class="hs-identifier hs-var">CompileTimeFailure</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier hs-type">ExpectedError</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RunCases"><span class="annot"><a href="Futhark.Test.Spec.html#RunCases"><span class="hs-identifier hs-var">RunCases</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-identifier hs-type">InputOutputs</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier hs-type">StructureTest</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#WarningTest"><span class="hs-identifier hs-type">WarningTest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320860"><span id="local-6989586621684320862"><span id="local-6989586621684320873"><span class="annot"><span class="annottext">Int -&gt; TestAction -&gt; ShowS
[TestAction] -&gt; ShowS
TestAction -&gt; [Char]
(Int -&gt; TestAction -&gt; ShowS)
-&gt; (TestAction -&gt; [Char])
-&gt; ([TestAction] -&gt; ShowS)
-&gt; Show TestAction
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TestAction] -&gt; ShowS
$cshowList :: [TestAction] -&gt; ShowS
show :: TestAction -&gt; [Char]
$cshow :: TestAction -&gt; [Char]
showsPrec :: Int -&gt; TestAction -&gt; ShowS
$cshowsPrec :: Int -&gt; TestAction -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Input and output pairs for some entry point(s).</span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="InputOutputs"><span class="annot"><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-identifier hs-var">InputOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InputOutputs"><span class="annot"><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-identifier hs-var">InputOutputs</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="iosEntryPoint"><span class="annot"><span class="annottext">InputOutputs -&gt; Text
</span><a href="Futhark.Test.Spec.html#iosEntryPoint"><span class="hs-identifier hs-var hs-var">iosEntryPoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span id="iosTestRuns"><span class="annot"><span class="annottext">InputOutputs -&gt; [TestRun]
</span><a href="Futhark.Test.Spec.html#iosTestRuns"><span class="hs-identifier hs-var hs-var">iosTestRuns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier hs-type">TestRun</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320847"><span id="local-6989586621684320849"><span id="local-6989586621684320855"><span class="annot"><span class="annottext">Int -&gt; InputOutputs -&gt; ShowS
[InputOutputs] -&gt; ShowS
InputOutputs -&gt; [Char]
(Int -&gt; InputOutputs -&gt; ShowS)
-&gt; (InputOutputs -&gt; [Char])
-&gt; ([InputOutputs] -&gt; ShowS)
-&gt; Show InputOutputs
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [InputOutputs] -&gt; ShowS
$cshowList :: [InputOutputs] -&gt; ShowS
show :: InputOutputs -&gt; [Char]
$cshow :: InputOutputs -&gt; [Char]
showsPrec :: Int -&gt; InputOutputs -&gt; ShowS
$cshowsPrec :: Int -&gt; InputOutputs -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | The error expected for a negative test.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="ExpectedError"><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier hs-var">ExpectedError</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AnyError"><span class="annot"><a href="Futhark.Test.Spec.html#AnyError"><span class="hs-identifier hs-var">AnyError</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ThisError"><span class="annot"><a href="Futhark.Test.Spec.html#ThisError"><span class="hs-identifier hs-var">ThisError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Regex</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684320840"><span id="local-6989586621684320843"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier hs-type">ExpectedError</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621684320837"><span class="annot"><span class="annottext">show :: ExpectedError -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">ExpectedError
</span><a href="Futhark.Test.Spec.html#AnyError"><span class="hs-identifier hs-var">AnyError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;AnyError&quot;</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#ThisError"><span class="hs-identifier hs-type">ThisError</span></a></span><span> </span><span id="local-6989586621684320835"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320835"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ThisError &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320835"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | How a program can be transformed.</span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span> </span><span id="StructurePipeline"><span class="annot"><a href="Futhark.Test.Spec.html#StructurePipeline"><span class="hs-identifier hs-var">StructurePipeline</span></a></span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GpuPipeline"><span class="annot"><a href="Futhark.Test.Spec.html#GpuPipeline"><span class="hs-identifier hs-var">GpuPipeline</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SOACSPipeline"><span class="annot"><a href="Futhark.Test.Spec.html#SOACSPipeline"><span class="hs-identifier hs-var">SOACSPipeline</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SeqMemPipeline"><span class="annot"><a href="Futhark.Test.Spec.html#SeqMemPipeline"><span class="hs-identifier hs-var">SeqMemPipeline</span></a></span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GpuMemPipeline"><span class="annot"><a href="Futhark.Test.Spec.html#GpuMemPipeline"><span class="hs-identifier hs-var">GpuMemPipeline</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoPipeline"><span class="annot"><a href="Futhark.Test.Spec.html#NoPipeline"><span class="hs-identifier hs-var">NoPipeline</span></a></span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320824"><span id="local-6989586621684320826"><span id="local-6989586621684320828"><span class="annot"><span class="annottext">Int -&gt; StructurePipeline -&gt; ShowS
[StructurePipeline] -&gt; ShowS
StructurePipeline -&gt; [Char]
(Int -&gt; StructurePipeline -&gt; ShowS)
-&gt; (StructurePipeline -&gt; [Char])
-&gt; ([StructurePipeline] -&gt; ShowS)
-&gt; Show StructurePipeline
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StructurePipeline] -&gt; ShowS
$cshowList :: [StructurePipeline] -&gt; ShowS
show :: StructurePipeline -&gt; [Char]
$cshow :: StructurePipeline -&gt; [Char]
showsPrec :: Int -&gt; StructurePipeline -&gt; ShowS
$cshowsPrec :: Int -&gt; StructurePipeline -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | A structure test specifies a compilation pipeline, as well as</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- metrics for the program coming out the other end.</span><span>
</span><span id="line-99"></span><span class="hs-keyword">data</span><span> </span><span id="StructureTest"><span class="annot"><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier hs-var">StructureTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StructureTest"><span class="annot"><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier hs-var">StructureTest</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#StructurePipeline"><span class="hs-identifier hs-type">StructurePipeline</span></a></span><span> </span><span class="annot"><a href="Futhark.Analysis.Metrics.Type.html#AstMetrics"><span class="hs-identifier hs-type">AstMetrics</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320813"><span id="local-6989586621684320815"><span id="local-6989586621684320821"><span class="annot"><span class="annottext">Int -&gt; StructureTest -&gt; ShowS
[StructureTest] -&gt; ShowS
StructureTest -&gt; [Char]
(Int -&gt; StructureTest -&gt; ShowS)
-&gt; (StructureTest -&gt; [Char])
-&gt; ([StructureTest] -&gt; ShowS)
-&gt; Show StructureTest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StructureTest] -&gt; ShowS
$cshowList :: [StructureTest] -&gt; ShowS
show :: StructureTest -&gt; [Char]
$cshow :: StructureTest -&gt; [Char]
showsPrec :: Int -&gt; StructureTest -&gt; ShowS
$cshowsPrec :: Int -&gt; StructureTest -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | A warning test requires that a warning matching the regular</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- expression is produced.  The program must also compile succesfully.</span><span>
</span><span id="line-104"></span><span class="hs-keyword">data</span><span> </span><span id="WarningTest"><span class="annot"><a href="Futhark.Test.Spec.html#WarningTest"><span class="hs-identifier hs-var">WarningTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExpectedWarning"><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedWarning"><span class="hs-identifier hs-var">ExpectedWarning</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Regex</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684320807"><span id="local-6989586621684320810"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#WarningTest"><span class="hs-identifier hs-type">WarningTest</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621684320805"><span class="annot"><span class="annottext">show :: WarningTest -&gt; [Char]
</span><a href="#local-6989586621684320805"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedWarning"><span class="hs-identifier hs-type">ExpectedWarning</span></a></span><span> </span><span id="local-6989586621684320804"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320804"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Regex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;ExpectedWarning &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320804"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | A condition for execution, input, and expected result.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">data</span><span> </span><span id="TestRun"><span class="annot"><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier hs-var">TestRun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TestRun"><span class="annot"><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier hs-var">TestRun</span></a></span></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="runTags"><span class="annot"><span class="annottext">TestRun -&gt; [[Char]]
</span><a href="Futhark.Test.Spec.html#runTags"><span class="hs-identifier hs-var hs-var">runTags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span id="runInput"><span class="annot"><span class="annottext">TestRun -&gt; Values
</span><a href="Futhark.Test.Spec.html#runInput"><span class="hs-identifier hs-var hs-var">runInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span id="runExpectedResult"><span class="annot"><span class="annottext">TestRun -&gt; ExpectedResult Success
</span><a href="Futhark.Test.Spec.html#runExpectedResult"><span class="hs-identifier hs-var hs-var">runExpectedResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedResult"><span class="hs-identifier hs-type">ExpectedResult</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span id="runIndex"><span class="annot"><span class="annottext">TestRun -&gt; Int
</span><a href="Futhark.Test.Spec.html#runIndex"><span class="hs-identifier hs-var hs-var">runIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span id="runDescription"><span class="annot"><span class="annottext">TestRun -&gt; [Char]
</span><a href="Futhark.Test.Spec.html#runDescription"><span class="hs-identifier hs-var hs-var">runDescription</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320783"><span id="local-6989586621684320785"><span id="local-6989586621684320795"><span class="annot"><span class="annottext">Int -&gt; TestRun -&gt; ShowS
[TestRun] -&gt; ShowS
TestRun -&gt; [Char]
(Int -&gt; TestRun -&gt; ShowS)
-&gt; (TestRun -&gt; [Char]) -&gt; ([TestRun] -&gt; ShowS) -&gt; Show TestRun
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TestRun] -&gt; ShowS
$cshowList :: [TestRun] -&gt; ShowS
show :: TestRun -&gt; [Char]
$cshow :: TestRun -&gt; [Char]
showsPrec :: Int -&gt; TestRun -&gt; ShowS
$cshowsPrec :: Int -&gt; TestRun -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Several values - either literally, or by reference to a file, or</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- to be generated on demand.  All paths are relative to test program.</span><span>
</span><span id="line-121"></span><span class="hs-keyword">data</span><span> </span><span id="Values"><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-var">Values</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Values"><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-var">Values</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">V.Value</span></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InFile"><span class="annot"><a href="Futhark.Test.Spec.html#InFile"><span class="hs-identifier hs-var">InFile</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GenValues"><span class="annot"><a href="Futhark.Test.Spec.html#GenValues"><span class="hs-identifier hs-var">GenValues</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-type">GenValue</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScriptValues"><span class="annot"><a href="Futhark.Test.Spec.html#ScriptValues"><span class="hs-identifier hs-var">ScriptValues</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Script.html#Exp"><span class="hs-identifier hs-type">Script.Exp</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScriptFile"><span class="annot"><a href="Futhark.Test.Spec.html#ScriptFile"><span class="hs-identifier hs-var">ScriptFile</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320755"><span id="local-6989586621684320757"><span id="local-6989586621684320773"><span class="annot"><span class="annottext">Int -&gt; Values -&gt; ShowS
[Values] -&gt; ShowS
Values -&gt; [Char]
(Int -&gt; Values -&gt; ShowS)
-&gt; (Values -&gt; [Char]) -&gt; ([Values] -&gt; ShowS) -&gt; Show Values
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Values] -&gt; ShowS
$cshowList :: [Values] -&gt; ShowS
show :: Values -&gt; [Char]
$cshow :: Values -&gt; [Char]
showsPrec :: Int -&gt; Values -&gt; ShowS
$cshowsPrec :: Int -&gt; Values -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="GenValue"><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-var">GenValue</span></a></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Generate a value of the given rank and primitive</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">-- type.  Scalars are considered 0-ary arrays.</span><span>
</span><span id="line-132"></span><span>    </span><span id="GenValue"><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-var">GenValue</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.ValueType</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A fixed non-randomised primitive value.</span><span>
</span><span id="line-134"></span><span>    </span><span id="GenPrim"><span class="annot"><a href="Futhark.Test.Spec.html#GenPrim"><span class="hs-identifier hs-var">GenPrim</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Value</span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320741"><span id="local-6989586621684320743"><span id="local-6989586621684320750"><span class="annot"><span class="annottext">Int -&gt; GenValue -&gt; ShowS
[GenValue] -&gt; ShowS
GenValue -&gt; [Char]
(Int -&gt; GenValue -&gt; ShowS)
-&gt; (GenValue -&gt; [Char]) -&gt; ([GenValue] -&gt; ShowS) -&gt; Show GenValue
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GenValue] -&gt; ShowS
$cshowList :: [GenValue] -&gt; ShowS
show :: GenValue -&gt; [Char]
$cshow :: GenValue -&gt; [Char]
showsPrec :: Int -&gt; GenValue -&gt; ShowS
$cshowsPrec :: Int -&gt; GenValue -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | A prettyprinted representation of type of value produced by a</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- 'GenValue'.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Futhark.Test.Spec.html#genValueType"><span class="hs-identifier hs-type">genValueType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-type">GenValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-140"></span><span id="genValueType"><span class="annot"><span class="annottext">genValueType :: GenValue -&gt; [Char]
</span><a href="Futhark.Test.Spec.html#genValueType"><span class="hs-identifier hs-var hs-var">genValueType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-type">GenValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">V.ValueType</span></span><span> </span><span id="local-6989586621684320739"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621684320739"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621684320738"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684320738"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; [Char]) -&gt; [Int] -&gt; [Char]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621684320736"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320736"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320736"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621684320739"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimType -&gt; Text
</span><span class="hs-identifier hs-var">V.primTypeText</span></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684320738"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Futhark.Test.Spec.html#genValueType"><span class="hs-identifier hs-var">genValueType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#GenPrim"><span class="hs-identifier hs-type">GenPrim</span></a></span><span> </span><span id="local-6989586621684320734"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621684320734"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; Text -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Text
</span><span class="hs-identifier hs-var">V.valueText</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621684320734"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | How a test case is expected to terminate.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="ExpectedResult"><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedResult"><span class="hs-identifier hs-var">ExpectedResult</span></a></span></span><span> </span><span id="local-6989586621684321393"><span class="annot"><a href="#local-6989586621684321393"><span class="hs-identifier hs-type">values</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Execution suceeds, with or without</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-comment">-- expected result values.</span><span>
</span><span id="line-149"></span><span>    </span><span id="Succeeds"><span class="annot"><a href="Futhark.Test.Spec.html#Succeeds"><span class="hs-identifier hs-var">Succeeds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621684321393"><span class="hs-identifier hs-type">values</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Execution fails with this error.</span><span>
</span><span id="line-151"></span><span>    </span><span id="RunTimeFailure"><span class="annot"><a href="Futhark.Test.Spec.html#RunTimeFailure"><span class="hs-identifier hs-var">RunTimeFailure</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier hs-type">ExpectedError</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320720"><span id="local-6989586621684320722"><span id="local-6989586621684320729"><span class="annot"><span class="annottext">Int -&gt; ExpectedResult values -&gt; ShowS
[ExpectedResult values] -&gt; ShowS
ExpectedResult values -&gt; [Char]
(Int -&gt; ExpectedResult values -&gt; ShowS)
-&gt; (ExpectedResult values -&gt; [Char])
-&gt; ([ExpectedResult values] -&gt; ShowS)
-&gt; Show (ExpectedResult values)
forall values. Show values =&gt; Int -&gt; ExpectedResult values -&gt; ShowS
forall values. Show values =&gt; [ExpectedResult values] -&gt; ShowS
forall values. Show values =&gt; ExpectedResult values -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ExpectedResult values] -&gt; ShowS
$cshowList :: forall values. Show values =&gt; [ExpectedResult values] -&gt; ShowS
show :: ExpectedResult values -&gt; [Char]
$cshow :: forall values. Show values =&gt; ExpectedResult values -&gt; [Char]
showsPrec :: Int -&gt; ExpectedResult values -&gt; ShowS
$cshowsPrec :: forall values. Show values =&gt; Int -&gt; ExpectedResult values -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | The result expected from a succesful execution.</span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="Success"><span class="annot"><a href="Futhark.Test.Spec.html#Success"><span class="hs-identifier hs-var">Success</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | These values are expected.</span><span>
</span><span id="line-157"></span><span>    </span><span id="SuccessValues"><span class="annot"><a href="Futhark.Test.Spec.html#SuccessValues"><span class="hs-identifier hs-var">SuccessValues</span></a></span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Compute expected values from executing a known-good</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">-- reference implementation.</span><span>
</span><span id="line-160"></span><span>    </span><span id="SuccessGenerateValues"><span class="annot"><a href="Futhark.Test.Spec.html#SuccessGenerateValues"><span class="hs-identifier hs-var">SuccessGenerateValues</span></a></span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684320710"><span id="local-6989586621684320712"><span id="local-6989586621684320716"><span class="annot"><span class="annottext">Int -&gt; Success -&gt; ShowS
[Success] -&gt; ShowS
Success -&gt; [Char]
(Int -&gt; Success -&gt; ShowS)
-&gt; (Success -&gt; [Char]) -&gt; ([Success] -&gt; ShowS) -&gt; Show Success
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Success] -&gt; ShowS
$cshowList :: [Success] -&gt; ShowS
show :: Success -&gt; [Char]
$cshow :: Success -&gt; [Char]
showsPrec :: Int -&gt; Success -&gt; ShowS
$cshowsPrec :: Int -&gt; Success -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Parsec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span id="local-6989586621684321381"><span class="annot"><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-type">lexeme</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684321381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684321381"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-166"></span><span id="lexeme"><span class="annot"><span class="annottext">lexeme :: forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var hs-var">lexeme</span></a></span></span><span> </span><span id="local-6989586621684320707"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320707"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span id="local-6989586621684320706"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684320706"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684320706"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; Parser () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320707"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Like 'lexeme', but does not consume trailing linebreaks.</span><span>
</span><span id="line-169"></span><span id="local-6989586621684321376"><span class="annot"><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-type">lexeme'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684321376"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684321376"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-170"></span><span id="lexeme%27"><span class="annot"><span class="annottext">lexeme' :: forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var hs-var">lexeme'</span></a></span></span><span> </span><span id="local-6989586621684320699"><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684320699"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser a
</span><a href="#local-6989586621684320699"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parser a -&gt; Parser () -&gt; Parser a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">hspace</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- Like 'lexstr', but does not consume trailing linebreaks.</span><span>
</span><span id="line-173"></span><span class="annot"><a href="Futhark.Test.Spec.html#lexstr%27"><span class="hs-identifier hs-type">lexstr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span id="lexstr%27"><span class="annot"><span class="annottext">lexstr' :: Text -&gt; Parser ()
</span><a href="Futhark.Test.Spec.html#lexstr%27"><span class="hs-identifier hs-var hs-var">lexstr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser ())
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; Parser ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text)
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text)
-&gt; (Text -&gt; Parser Text) -&gt; Text -&gt; Parser Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Tokens s -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">string</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span id="local-6989586621684320692"><span class="annot"><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-type">inBraces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684320692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684320692"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-177"></span><span id="inBraces"><span class="annot"><span class="annottext">inBraces :: forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var hs-var">inBraces</span></a></span></span><span> </span><span id="local-6989586621684320679"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320679"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; Parser Text
-&gt; ParsecT Void Text Identity a
-&gt; ParsecT Void Text Identity a
forall (m :: * -&gt; *) open close a.
Applicative m =&gt;
m open -&gt; m close -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">between</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320679"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;{&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320679"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseNatural"><span class="hs-identifier hs-type">parseNatural</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-180"></span><span id="parseNatural"><span class="annot"><span class="annottext">parseNatural :: Parser () -&gt; Parser Int
</span><a href="Futhark.Test.Spec.html#parseNatural"><span class="hs-identifier hs-var hs-var">parseNatural</span></a></span></span><span> </span><span id="local-6989586621684320676"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320676"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Int -&gt; Parser Int
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320676"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Int -&gt; Parser Int) -&gt; Parser Int -&gt; Parser Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; [Int] -&gt; Int
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. Num a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621684320675"><span class="hs-identifier hs-var">addDigit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; ([Char] -&gt; [Int]) -&gt; [Char] -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; [Char] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="#local-6989586621684320674"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Int) -&gt; ParsecT Void Text Identity [Char] -&gt; Parser Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Token s)
</span><span class="hs-identifier hs-var">digitChar</span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621684320675"><span class="annot"><span class="annottext">addDigit :: a -&gt; a -&gt; a
</span><a href="#local-6989586621684320675"><span class="hs-identifier hs-var hs-var">addDigit</span></a></span></span><span> </span><span id="local-6989586621684320666"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320666"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621684320665"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320665"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320666"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall {a}. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall {a}. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320665"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621684320674"><span class="annot"><span class="annottext">num :: Char -&gt; Int
</span><a href="#local-6989586621684320674"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span> </span><span id="local-6989586621684320661"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320661"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320661"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Futhark.Test.Spec.html#restOfLine"><span class="hs-identifier hs-type">restOfLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-187"></span><span id="restOfLine"><span class="annot"><span class="annottext">restOfLine :: Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine"><span class="hs-identifier hs-var hs-var">restOfLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621684320658"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320658"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine_"><span class="hs-identifier hs-var">restOfLine_</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320658"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Tokens s)
</span><span class="hs-identifier hs-var">eol</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Tokens s)
</span><span class="hs-identifier hs-var">eol</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320658"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Futhark.Test.Spec.html#restOfLine_"><span class="hs-identifier hs-type">restOfLine_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-193"></span><span id="restOfLine_"><span class="annot"><span class="annottext">restOfLine_ :: Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine_"><span class="hs-identifier hs-var hs-var">restOfLine_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseDescription"><span class="hs-identifier hs-type">parseDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-196"></span><span id="parseDescription"><span class="annot"><span class="annottext">parseDescription :: Parser () -&gt; Parser Text
</span><a href="Futhark.Test.Spec.html#parseDescription"><span class="hs-identifier hs-var hs-var">parseDescription</span></a></span></span><span> </span><span id="local-6989586621684320649"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320649"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">T.unlines</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text)
-&gt; ParsecT Void Text Identity [Text] -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621684320647"><span class="hs-identifier hs-var">pDescLine</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; ParsecT Void Text Identity [Text]
forall (m :: * -&gt; *) a end. MonadPlus m =&gt; m a -&gt; m end -&gt; m [a]
</span><span class="hs-operator hs-var">`manyTill`</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320645"><span class="hs-identifier hs-var">pDescriptionSeparator</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621684320647"><span class="annot"><span class="annottext">pDescLine :: Parser Text
</span><a href="#local-6989586621684320647"><span class="hs-identifier hs-var hs-var">pDescLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine"><span class="hs-identifier hs-var">restOfLine</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320649"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621684320645"><span class="annot"><span class="annottext">pDescriptionSeparator :: Parser ()
</span><a href="#local-6989586621684320645"><span class="hs-identifier hs-var hs-var">pDescriptionSeparator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;==&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320649"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseTags"><span class="hs-identifier hs-type">parseTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span id="parseTags"><span class="annot"><span class="annottext">parseTags :: Parser () -&gt; ParsecT Void Text Identity [Text]
</span><a href="Futhark.Test.Spec.html#parseTags"><span class="hs-identifier hs-var hs-var">parseTags</span></a></span></span><span> </span><span id="local-6989586621684320632"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320632"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;tags&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var">inBraces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320632"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621684320630"><span class="hs-identifier hs-var">parseTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621684320630"><span class="annot"><span class="annottext">parseTag :: Parser Text
</span><a href="#local-6989586621684320630"><span class="hs-identifier hs-var hs-var">parseTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text)
-&gt; ParsecT Void Text Identity [Char] -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity [Char]
-&gt; ParsecT Void Text Identity [Char]
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320632"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char
 -&gt; ParsecT Void Text Identity [Char])
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="Futhark.Test.Spec.html#tagConstituent"><span class="hs-identifier hs-var">tagConstituent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><a href="Futhark.Test.Spec.html#tagConstituent"><span class="hs-identifier hs-type">tagConstituent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-208"></span><span id="tagConstituent"><span class="annot"><span class="annottext">tagConstituent :: Char -&gt; Bool
</span><a href="Futhark.Test.Spec.html#tagConstituent"><span class="hs-identifier hs-var hs-var">tagConstituent</span></a></span></span><span> </span><span id="local-6989586621684320621"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320621"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlphaNum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320621"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320621"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320621"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseAction"><span class="hs-identifier hs-type">parseAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#TestAction"><span class="hs-identifier hs-type">TestAction</span></a></span><span>
</span><span id="line-211"></span><span id="parseAction"><span class="annot"><span class="annottext">parseAction :: Parser () -&gt; Parser TestAction
</span><a href="Futhark.Test.Spec.html#parseAction"><span class="hs-identifier hs-var hs-var">parseAction</span></a></span></span><span> </span><span id="local-6989586621684320617"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320617"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">[Parser TestAction] -&gt; Parser TestAction
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ExpectedError -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#CompileTimeFailure"><span class="hs-identifier hs-var">CompileTimeFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpectedError -&gt; TestAction)
-&gt; ParsecT Void Text Identity ExpectedError -&gt; Parser TestAction
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser ()
</span><a href="Futhark.Test.Spec.html#lexstr%27"><span class="hs-identifier hs-var">lexstr'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;error:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity ExpectedError
-&gt; ParsecT Void Text Identity ExpectedError
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity ExpectedError
</span><a href="Futhark.Test.Spec.html#parseExpectedError"><span class="hs-identifier hs-var">parseExpectedError</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320617"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">[InputOutputs] -&gt; [StructureTest] -&gt; [WarningTest] -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#RunCases"><span class="hs-identifier hs-var">RunCases</span></a></span><span> </span><span class="annot"><span class="annottext">([InputOutputs] -&gt; [StructureTest] -&gt; [WarningTest] -&gt; TestAction)
-&gt; ParsecT Void Text Identity [InputOutputs]
-&gt; ParsecT
     Void Text Identity ([StructureTest] -&gt; [WarningTest] -&gt; TestAction)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [InputOutputs]
</span><a href="Futhark.Test.Spec.html#parseInputOutputs"><span class="hs-identifier hs-var">parseInputOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320617"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">ParsecT
  Void Text Identity ([StructureTest] -&gt; [WarningTest] -&gt; TestAction)
-&gt; ParsecT Void Text Identity [StructureTest]
-&gt; ParsecT Void Text Identity ([WarningTest] -&gt; TestAction)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity StructureTest
-&gt; ParsecT Void Text Identity [StructureTest]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity StructureTest
</span><a href="Futhark.Test.Spec.html#parseExpectedStructure"><span class="hs-identifier hs-var">parseExpectedStructure</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320617"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ([WarningTest] -&gt; TestAction)
-&gt; ParsecT Void Text Identity [WarningTest] -&gt; Parser TestAction
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity WarningTest
-&gt; ParsecT Void Text Identity [WarningTest]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity WarningTest
</span><a href="Futhark.Test.Spec.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320617"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseInputOutputs"><span class="hs-identifier hs-type">parseInputOutputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-identifier hs-type">InputOutputs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span id="parseInputOutputs"><span class="annot"><span class="annottext">parseInputOutputs :: Parser () -&gt; ParsecT Void Text Identity [InputOutputs]
</span><a href="Futhark.Test.Spec.html#parseInputOutputs"><span class="hs-identifier hs-var hs-var">parseInputOutputs</span></a></span></span><span> </span><span id="local-6989586621684320611"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320611"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621684320610"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621684320610"><span class="hs-identifier hs-var">entrys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [Text]
</span><a href="Futhark.Test.Spec.html#parseEntryPoints"><span class="hs-identifier hs-var">parseEntryPoints</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320611"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621684320608"><span class="annot"><span class="annottext">[TestRun]
</span><a href="#local-6989586621684320608"><span class="hs-identifier hs-var">cases</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser [TestRun]
</span><a href="Futhark.Test.Spec.html#parseRunCases"><span class="hs-identifier hs-var">parseRunCases</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320611"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">[InputOutputs] -&gt; ParsecT Void Text Identity [InputOutputs]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([InputOutputs] -&gt; ParsecT Void Text Identity [InputOutputs])
-&gt; [InputOutputs] -&gt; ParsecT Void Text Identity [InputOutputs]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[TestRun] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TestRun]
</span><a href="#local-6989586621684320608"><span class="hs-identifier hs-var">cases</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; InputOutputs) -&gt; [Text] -&gt; [InputOutputs]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [TestRun] -&gt; InputOutputs
</span><a href="Futhark.Test.Spec.html#InputOutputs"><span class="hs-operator hs-var">`InputOutputs`</span></a></span><span> </span><span class="annot"><span class="annottext">[TestRun]
</span><a href="#local-6989586621684320608"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621684320610"><span class="hs-identifier hs-var">entrys</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseEntryPoints"><span class="hs-identifier hs-type">parseEntryPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span id="parseEntryPoints"><span class="annot"><span class="annottext">parseEntryPoints :: Parser () -&gt; ParsecT Void Text Identity [Text]
</span><a href="Futhark.Test.Spec.html#parseEntryPoints"><span class="hs-identifier hs-var hs-var">parseEntryPoints</span></a></span></span><span> </span><span id="local-6989586621684320605"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320605"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;entry:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621684320604"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Text]
-&gt; Parser () -&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320605"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; ParsecT Void Text Identity [Text]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;main&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621684320602"><span class="annot"><span class="annottext">constituent :: Char -&gt; Bool
</span><a href="#local-6989586621684320602"><span class="hs-identifier hs-var hs-var">constituent</span></a></span></span><span> </span><span id="local-6989586621684320601"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320601"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320601"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320601"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621684320604"><span class="annot"><span class="annottext">entry :: Parser Text
</span><a href="#local-6989586621684320604"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text
forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser Text) -&gt; Parser Text -&gt; Parser Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text)
-&gt; ParsecT Void Text Identity [Char] -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621684320602"><span class="hs-identifier hs-var">constituent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseRunTags"><span class="hs-identifier hs-type">parseRunTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span id="parseRunTags"><span class="annot"><span class="annottext">parseRunTags :: Parser [[Char]]
</span><a href="Futhark.Test.Spec.html#parseRunTags"><span class="hs-identifier hs-var hs-var">parseRunTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Char] -&gt; Parser [[Char]]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [Char] -&gt; Parser [[Char]])
-&gt; (ParsecT Void Text Identity [Char]
    -&gt; ParsecT Void Text Identity [Char])
-&gt; ParsecT Void Text Identity [Char]
-&gt; Parser [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Char]
-&gt; ParsecT Void Text Identity [Char]
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [Char]
 -&gt; ParsecT Void Text Identity [Char])
-&gt; (ParsecT Void Text Identity [Char]
    -&gt; ParsecT Void Text Identity [Char])
-&gt; ParsecT Void Text Identity [Char]
-&gt; ParsecT Void Text Identity [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [Char]
-&gt; ParsecT Void Text Identity [Char]
forall a. Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme%27"><span class="hs-identifier hs-var">lexeme'</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [Char] -&gt; Parser [[Char]])
-&gt; ParsecT Void Text Identity [Char] -&gt; Parser [[Char]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621684320591"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320591"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Char
 -&gt; ParsecT Void Text Identity [Char])
-&gt; ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="Futhark.Test.Spec.html#tagConstituent"><span class="hs-identifier hs-var">tagConstituent</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Parser ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser ()) -&gt; Bool -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320591"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;input&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;structure&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;warning&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320591"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseRunCases"><span class="hs-identifier hs-type">parseRunCases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier hs-type">TestRun</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span id="parseRunCases"><span class="annot"><span class="annottext">parseRunCases :: Parser () -&gt; Parser [TestRun]
</span><a href="Futhark.Test.Spec.html#parseRunCases"><span class="hs-identifier hs-var hs-var">parseRunCases</span></a></span></span><span> </span><span id="local-6989586621684320589"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser [TestRun]
</span><a href="#local-6989586621684320588"><span class="hs-identifier hs-var">parseRunCases'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621684320588"><span class="annot"><span class="annottext">parseRunCases' :: Int -&gt; Parser [TestRun]
</span><a href="#local-6989586621684320588"><span class="hs-identifier hs-var hs-var">parseRunCases'</span></a></span></span><span> </span><span id="local-6989586621684320579"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320579"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TestRun -&gt; [TestRun] -&gt; [TestRun])
-&gt; ParsecT Void Text Identity TestRun
-&gt; ParsecT Void Text Identity ([TestRun] -&gt; [TestRun])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ParsecT Void Text Identity TestRun
</span><a href="#local-6989586621684320578"><span class="hs-identifier hs-var">parseRunCase</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320579"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ([TestRun] -&gt; [TestRun])
-&gt; Parser [TestRun] -&gt; Parser [TestRun]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser [TestRun]
</span><a href="#local-6989586621684320588"><span class="hs-identifier hs-var">parseRunCases'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320579"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall {a}. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">Parser [TestRun] -&gt; Parser [TestRun] -&gt; Parser [TestRun]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TestRun] -&gt; Parser [TestRun]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621684320578"><span class="annot"><span class="annottext">parseRunCase :: Int -&gt; ParsecT Void Text Identity TestRun
</span><a href="#local-6989586621684320578"><span class="hs-identifier hs-var hs-var">parseRunCase</span></a></span></span><span> </span><span id="local-6989586621684320555"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320555"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>      </span><span id="local-6989586621684320554"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320554"><span class="hs-identifier hs-var">tags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [[Char]]
</span><a href="Futhark.Test.Spec.html#parseRunTags"><span class="hs-identifier hs-var">parseRunTags</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser ()) -&gt; Parser Text -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;input&quot;</span></span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621684320553"><span class="annot"><span class="annottext">Values
</span><a href="#local-6989586621684320553"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;random&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320554"><span class="hs-identifier hs-var">tags</span></a></span><span>
</span><span id="line-252"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseRandomValues"><span class="hs-identifier hs-var">parseRandomValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-254"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;script&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320554"><span class="hs-identifier hs-var">tags</span></a></span><span>
</span><span id="line-255"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseScriptValues"><span class="hs-identifier hs-var">parseScriptValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-256"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseValues"><span class="hs-identifier hs-var">parseValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621684320548"><span class="annot"><span class="annottext">ExpectedResult Success
</span><a href="#local-6989586621684320548"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser (ExpectedResult Success)
</span><a href="Futhark.Test.Spec.html#parseExpectedResult"><span class="hs-identifier hs-var">parseExpectedResult</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320589"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><span class="annottext">TestRun -&gt; ParsecT Void Text Identity TestRun
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(TestRun -&gt; ParsecT Void Text Identity TestRun)
-&gt; TestRun -&gt; ParsecT Void Text Identity TestRun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
-&gt; Values -&gt; ExpectedResult Success -&gt; Int -&gt; [Char] -&gt; TestRun
</span><a href="Futhark.Test.Spec.html#TestRun"><span class="hs-identifier hs-var">TestRun</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320554"><span class="hs-identifier hs-var">tags</span></a></span><span> </span><span class="annot"><span class="annottext">Values
</span><a href="#local-6989586621684320553"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">ExpectedResult Success
</span><a href="#local-6989586621684320548"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320555"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TestRun) -&gt; [Char] -&gt; TestRun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Values -&gt; [Char]
forall {a}. Show a =&gt; a -&gt; Values -&gt; [Char]
</span><a href="#local-6989586621684320546"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684320555"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Values
</span><a href="#local-6989586621684320553"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- If the file is gzipped, we strip the 'gz' extension from</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- the dataset name.  This makes it more convenient to rename</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- from 'foo.in' to 'foo.in.gz', as the reported dataset name</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- does not change (which would make comparisons to historical</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- data harder).</span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621684320546"><span class="annot"><span class="annottext">desc :: a -&gt; Values -&gt; [Char]
</span><a href="#local-6989586621684320546"><span class="hs-identifier hs-var hs-var">desc</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#InFile"><span class="hs-identifier hs-type">InFile</span></a></span><span> </span><span id="local-6989586621684320534"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320534"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeExtension</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320534"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.gz&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">dropExtension</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320534"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320534"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="#local-6989586621684320546"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span id="local-6989586621684320531"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320531"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span> </span><span id="local-6989586621684320530"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621684320530"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-comment">-- Turn linebreaks into space.</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621684320531"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; (\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]]
</span><span class="hs-identifier hs-var">lines</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320527"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\&quot;)&quot;</span></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621684320527"><span class="annot"><span class="annottext">vs' :: [Char]
</span><a href="#local-6989586621684320527"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [Char]) -&gt; [Value] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; (Value -&gt; Text) -&gt; Value -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Text
</span><span class="hs-identifier hs-var">V.valueText</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621684320530"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>          </span><span id="local-6989586621684320521"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320521"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320521"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320521"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;...&quot;</span></span><span>
</span><span id="line-275"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320521"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621684320546"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#GenValues"><span class="hs-identifier hs-type">GenValues</span></a></span><span> </span><span id="local-6989586621684320517"><span class="annot"><span class="annottext">[GenValue]
</span><a href="#local-6989586621684320517"><span class="hs-identifier hs-var">gens</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GenValue -&gt; [Char]) -&gt; [GenValue] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GenValue -&gt; [Char]
</span><a href="Futhark.Test.Spec.html#genValueType"><span class="hs-identifier hs-var">genValueType</span></a></span><span> </span><span class="annot"><span class="annottext">[GenValue]
</span><a href="#local-6989586621684320517"><span class="hs-identifier hs-var">gens</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621684320546"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#ScriptValues"><span class="hs-identifier hs-type">ScriptValues</span></a></span><span> </span><span id="local-6989586621684320516"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684320516"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="annottext">Exp -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Futhark.Util.Pretty.html#prettyOneLine"><span class="hs-identifier hs-var">prettyOneLine</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621684320516"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="#local-6989586621684320546"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#ScriptFile"><span class="hs-identifier hs-type">ScriptFile</span></a></span><span> </span><span id="local-6989586621684320515"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320515"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320515"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseExpectedResult"><span class="hs-identifier hs-type">parseExpectedResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedResult"><span class="hs-identifier hs-type">ExpectedResult</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span id="parseExpectedResult"><span class="annot"><span class="annottext">parseExpectedResult :: Parser () -&gt; Parser (ExpectedResult Success)
</span><a href="Futhark.Test.Spec.html#parseExpectedResult"><span class="hs-identifier hs-var hs-var">parseExpectedResult</span></a></span></span><span> </span><span id="local-6989586621684320514"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">[Parser (ExpectedResult Success)]
-&gt; Parser (ExpectedResult Success)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;auto&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;output&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ExpectedResult Success -&gt; Parser (ExpectedResult Success)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Success -&gt; ExpectedResult Success
forall values. Maybe values -&gt; ExpectedResult values
</span><a href="Futhark.Test.Spec.html#Succeeds"><span class="hs-identifier hs-var">Succeeds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Success -&gt; Maybe Success
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Success
</span><a href="Futhark.Test.Spec.html#SuccessGenerateValues"><span class="hs-identifier hs-var">SuccessGenerateValues</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">Maybe Success -&gt; ExpectedResult Success
forall values. Maybe values -&gt; ExpectedResult values
</span><a href="Futhark.Test.Spec.html#Succeeds"><span class="hs-identifier hs-var">Succeeds</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Success -&gt; ExpectedResult Success)
-&gt; (Values -&gt; Maybe Success) -&gt; Values -&gt; ExpectedResult Success
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Success -&gt; Maybe Success
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Success -&gt; Maybe Success)
-&gt; (Values -&gt; Success) -&gt; Values -&gt; Maybe Success
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Values -&gt; Success
</span><a href="Futhark.Test.Spec.html#SuccessValues"><span class="hs-identifier hs-var">SuccessValues</span></a></span><span> </span><span class="annot"><span class="annottext">(Values -&gt; ExpectedResult Success)
-&gt; Parser Values -&gt; Parser (ExpectedResult Success)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;output&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Values -&gt; Parser Values
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseValues"><span class="hs-identifier hs-var">parseValues</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">ExpectedError -&gt; ExpectedResult Success
forall values. ExpectedError -&gt; ExpectedResult values
</span><a href="Futhark.Test.Spec.html#RunTimeFailure"><span class="hs-identifier hs-var">RunTimeFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(ExpectedError -&gt; ExpectedResult Success)
-&gt; ParsecT Void Text Identity ExpectedError
-&gt; Parser (ExpectedResult Success)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;error:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity ExpectedError
-&gt; ParsecT Void Text Identity ExpectedError
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity ExpectedError
</span><a href="Futhark.Test.Spec.html#parseExpectedError"><span class="hs-identifier hs-var">parseExpectedError</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320514"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">ExpectedResult Success -&gt; Parser (ExpectedResult Success)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Success -&gt; ExpectedResult Success
forall values. Maybe values -&gt; ExpectedResult values
</span><a href="Futhark.Test.Spec.html#Succeeds"><span class="hs-identifier hs-var">Succeeds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Success
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseExpectedError"><span class="hs-identifier hs-type">parseExpectedError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ExpectedError"><span class="hs-identifier hs-type">ExpectedError</span></a></span><span>
</span><span id="line-293"></span><span id="parseExpectedError"><span class="annot"><span class="annottext">parseExpectedError :: Parser () -&gt; ParsecT Void Text Identity ExpectedError
</span><a href="Futhark.Test.Spec.html#parseExpectedError"><span class="hs-identifier hs-var hs-var">parseExpectedError</span></a></span></span><span> </span><span id="local-6989586621684320512"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320512"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity ExpectedError
-&gt; ParsecT Void Text Identity ExpectedError
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320512"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity ExpectedError
 -&gt; ParsecT Void Text Identity ExpectedError)
-&gt; ParsecT Void Text Identity ExpectedError
-&gt; ParsecT Void Text Identity ExpectedError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621684320511"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320511"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine_"><span class="hs-identifier hs-var">restOfLine_</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320512"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320511"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ExpectedError -&gt; ParsecT Void Text Identity ExpectedError
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ExpectedError
</span><a href="Futhark.Test.Spec.html#AnyError"><span class="hs-identifier hs-var">AnyError</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- blankCompOpt creates a regular expression that treats</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">-- newlines like ordinary characters, which is what we want.</span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Regex -&gt; ExpectedError
</span><a href="Futhark.Test.Spec.html#ThisError"><span class="hs-identifier hs-var">ThisError</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320511"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Regex -&gt; ExpectedError)
-&gt; ParsecT Void Text Identity Regex
-&gt; ParsecT Void Text Identity ExpectedError
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CompOption
-&gt; ExecOption -&gt; [Char] -&gt; ParsecT Void Text Identity Regex
forall regex compOpt execOpt source (m :: * -&gt; *).
(RegexMaker regex compOpt execOpt source, MonadFail m) =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
</span><span class="hs-identifier hs-var">makeRegexOptsM</span></span><span> </span><span class="annot"><span class="annottext">CompOption
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
compOpt
</span><span class="hs-identifier hs-var">blankCompOpt</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
execOpt
</span><span class="hs-identifier hs-var">defaultExecOpt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320511"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseScriptValues"><span class="hs-identifier hs-type">parseScriptValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span>
</span><span id="line-302"></span><span id="parseScriptValues"><span class="annot"><span class="annottext">parseScriptValues :: Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseScriptValues"><span class="hs-identifier hs-var hs-var">parseScriptValues</span></a></span></span><span> </span><span id="local-6989586621684320506"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320506"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="annottext">[Parser Values] -&gt; Parser Values
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Values
</span><a href="Futhark.Test.Spec.html#ScriptValues"><span class="hs-identifier hs-var">ScriptValues</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Values) -&gt; ParsecT Void Text Identity Exp -&gt; Parser Values
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity Exp -&gt; ParsecT Void Text Identity Exp
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var">inBraces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320506"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity Exp
</span><a href="Futhark.Script.html#parseExp"><span class="hs-identifier hs-var">Script.parseExp</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320506"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Values
</span><a href="Futhark.Test.Spec.html#ScriptFile"><span class="hs-identifier hs-var">ScriptFile</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Values) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; Values
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Values) -&gt; Parser Text -&gt; Parser Values
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320506"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320506"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
ParsecT Void Text Identity (Tokens Text)
</span><a href="#local-6989586621684320504"><span class="hs-identifier hs-var">nextWord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621684320504"><span class="annot"><span class="annottext">nextWord :: ParsecT Void Text Identity (Tokens Text)
</span><a href="#local-6989586621684320504"><span class="hs-identifier hs-var hs-var">nextWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">((Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text))
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseRandomValues"><span class="hs-identifier hs-type">parseRandomValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span>
</span><span id="line-311"></span><span id="parseRandomValues"><span class="annot"><span class="annottext">parseRandomValues :: Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseRandomValues"><span class="hs-identifier hs-var hs-var">parseRandomValues</span></a></span></span><span> </span><span id="local-6989586621684320502"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320502"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[GenValue] -&gt; Values
</span><a href="Futhark.Test.Spec.html#GenValues"><span class="hs-identifier hs-var">GenValues</span></a></span><span> </span><span class="annot"><span class="annottext">([GenValue] -&gt; Values)
-&gt; ParsecT Void Text Identity [GenValue] -&gt; Parser Values
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity [GenValue]
-&gt; ParsecT Void Text Identity [GenValue]
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var">inBraces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320502"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity GenValue
-&gt; ParsecT Void Text Identity [GenValue]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity GenValue
</span><a href="Futhark.Test.Spec.html#parseGenValue"><span class="hs-identifier hs-var">parseGenValue</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320502"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseGenValue"><span class="hs-identifier hs-type">parseGenValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-type">GenValue</span></a></span><span>
</span><span id="line-314"></span><span id="parseGenValue"><span class="annot"><span class="annottext">parseGenValue :: Parser () -&gt; ParsecT Void Text Identity GenValue
</span><a href="Futhark.Test.Spec.html#parseGenValue"><span class="hs-identifier hs-var hs-var">parseGenValue</span></a></span></span><span> </span><span id="local-6989586621684320500"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320500"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity GenValue]
-&gt; ParsecT Void Text Identity GenValue
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ValueType -&gt; GenValue
</span><a href="Futhark.Test.Spec.html#GenValue"><span class="hs-identifier hs-var">GenValue</span></a></span><span> </span><span class="annot"><span class="annottext">(ValueType -&gt; GenValue)
-&gt; ParsecT Void Text Identity ValueType
-&gt; ParsecT Void Text Identity GenValue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity ValueType
-&gt; ParsecT Void Text Identity ValueType
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320500"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ValueType
</span><span class="hs-identifier hs-var">parseType</span></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">Value -&gt; GenValue
</span><a href="Futhark.Test.Spec.html#GenPrim"><span class="hs-identifier hs-var">GenPrim</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; GenValue)
-&gt; ParsecT Void Text Identity Value
-&gt; ParsecT Void Text Identity GenValue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity Value
-&gt; ParsecT Void Text Identity Value
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320500"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity Value
</span><span class="hs-identifier hs-var">V.parsePrimValue</span></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseValues"><span class="hs-identifier hs-type">parseValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-type">Values</span></a></span><span>
</span><span id="line-321"></span><span id="parseValues"><span class="annot"><span class="annottext">parseValues :: Parser () -&gt; Parser Values
</span><a href="Futhark.Test.Spec.html#parseValues"><span class="hs-identifier hs-var hs-var">parseValues</span></a></span></span><span> </span><span id="local-6989586621684320497"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320497"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">[Parser Values] -&gt; Parser Values
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Values
</span><a href="Futhark.Test.Spec.html#Values"><span class="hs-identifier hs-var">Values</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Values)
-&gt; ParsecT Void Text Identity [Value] -&gt; Parser Values
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity [Value]
-&gt; ParsecT Void Text Identity [Value]
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var">inBraces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320497"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Value
-&gt; ParsecT Void Text Identity [Value]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity Value
 -&gt; ParsecT Void Text Identity [Value])
-&gt; ParsecT Void Text Identity Value
-&gt; ParsecT Void Text Identity [Value]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity Value
</span><span class="hs-identifier hs-var">parseValue</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320497"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Values
</span><a href="Futhark.Test.Spec.html#InFile"><span class="hs-identifier hs-var">InFile</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Values) -&gt; (Text -&gt; [Char]) -&gt; Text -&gt; Values
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Values) -&gt; Parser Text -&gt; Parser Values
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320497"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;@&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320497"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
ParsecT Void Text Identity (Tokens Text)
</span><a href="#local-6989586621684320495"><span class="hs-identifier hs-var">nextWord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>    </span><span id="local-6989586621684320495"><span class="annot"><span class="annottext">nextWord :: ParsecT Void Text Identity (Tokens Text)
</span><a href="#local-6989586621684320495"><span class="hs-identifier hs-var hs-var">nextWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
Maybe [Char] -&gt; (Token s -&gt; Bool) -&gt; m (Tokens s)
</span><span class="hs-identifier hs-var">takeWhileP</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">((Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text))
-&gt; (Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Tokens Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseWarning"><span class="hs-identifier hs-type">parseWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#WarningTest"><span class="hs-identifier hs-type">WarningTest</span></a></span><span>
</span><span id="line-330"></span><span id="parseWarning"><span class="annot"><span class="annottext">parseWarning :: Parser () -&gt; ParsecT Void Text Identity WarningTest
</span><a href="Futhark.Test.Spec.html#parseWarning"><span class="hs-identifier hs-var hs-var">parseWarning</span></a></span></span><span> </span><span id="local-6989586621684320493"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320493"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320493"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;warning:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity WarningTest
-&gt; ParsecT Void Text Identity WarningTest
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity WarningTest
</span><a href="#local-6989586621684320492"><span class="hs-identifier hs-var">parseExpectedWarning</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621684320492"><span class="annot"><span class="annottext">parseExpectedWarning :: ParsecT Void Text Identity WarningTest
</span><a href="#local-6989586621684320492"><span class="hs-identifier hs-var hs-var">parseExpectedWarning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity WarningTest
-&gt; ParsecT Void Text Identity WarningTest
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320493"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity WarningTest
 -&gt; ParsecT Void Text Identity WarningTest)
-&gt; ParsecT Void Text Identity WarningTest
-&gt; ParsecT Void Text Identity WarningTest
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621684320483"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320483"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine_"><span class="hs-identifier hs-var">restOfLine_</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Regex -&gt; WarningTest
</span><a href="Futhark.Test.Spec.html#ExpectedWarning"><span class="hs-identifier hs-var">ExpectedWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320483"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Regex -&gt; WarningTest)
-&gt; ParsecT Void Text Identity Regex
-&gt; ParsecT Void Text Identity WarningTest
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CompOption
-&gt; ExecOption -&gt; [Char] -&gt; ParsecT Void Text Identity Regex
forall regex compOpt execOpt source (m :: * -&gt; *).
(RegexMaker regex compOpt execOpt source, MonadFail m) =&gt;
compOpt -&gt; execOpt -&gt; source -&gt; m regex
</span><span class="hs-identifier hs-var">makeRegexOptsM</span></span><span> </span><span class="annot"><span class="annottext">CompOption
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
compOpt
</span><span class="hs-identifier hs-var">blankCompOpt</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
forall regex compOpt execOpt.
RegexOptions regex compOpt execOpt =&gt;
execOpt
</span><span class="hs-identifier hs-var">defaultExecOpt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621684320483"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseExpectedStructure"><span class="hs-identifier hs-type">parseExpectedStructure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier hs-type">StructureTest</span></a></span><span>
</span><span id="line-337"></span><span id="parseExpectedStructure"><span class="annot"><span class="annottext">parseExpectedStructure :: Parser () -&gt; ParsecT Void Text Identity StructureTest
</span><a href="Futhark.Test.Spec.html#parseExpectedStructure"><span class="hs-identifier hs-var hs-var">parseExpectedStructure</span></a></span></span><span> </span><span id="local-6989586621684320482"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320482"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320482"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;structure&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity StructureTest
-&gt; ParsecT Void Text Identity StructureTest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StructurePipeline -&gt; AstMetrics -&gt; StructureTest
</span><a href="Futhark.Test.Spec.html#StructureTest"><span class="hs-identifier hs-var">StructureTest</span></a></span><span> </span><span class="annot"><span class="annottext">(StructurePipeline -&gt; AstMetrics -&gt; StructureTest)
-&gt; ParsecT Void Text Identity StructurePipeline
-&gt; ParsecT Void Text Identity (AstMetrics -&gt; StructureTest)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity StructurePipeline
</span><a href="Futhark.Test.Spec.html#optimisePipeline"><span class="hs-identifier hs-var">optimisePipeline</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320482"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (AstMetrics -&gt; StructureTest)
-&gt; ParsecT Void Text Identity AstMetrics
-&gt; ParsecT Void Text Identity StructureTest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity AstMetrics
</span><a href="Futhark.Test.Spec.html#parseMetrics"><span class="hs-identifier hs-var">parseMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320482"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Futhark.Test.Spec.html#optimisePipeline"><span class="hs-identifier hs-type">optimisePipeline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#StructurePipeline"><span class="hs-identifier hs-type">StructurePipeline</span></a></span><span>
</span><span id="line-341"></span><span id="optimisePipeline"><span class="annot"><span class="annottext">optimisePipeline :: Parser () -&gt; ParsecT Void Text Identity StructurePipeline
</span><a href="Futhark.Test.Spec.html#optimisePipeline"><span class="hs-identifier hs-var hs-var">optimisePipeline</span></a></span></span><span> </span><span id="local-6989586621684320479"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320479"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">[ParsecT Void Text Identity StructurePipeline]
-&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable f, Alternative m) =&gt;
f (m a) -&gt; m a
</span><span class="hs-identifier hs-var">choice</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320479"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;gpu-mem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; StructurePipeline
-&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StructurePipeline
</span><a href="Futhark.Test.Spec.html#GpuMemPipeline"><span class="hs-identifier hs-var">GpuMemPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320479"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;gpu&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; StructurePipeline
-&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StructurePipeline
</span><a href="Futhark.Test.Spec.html#GpuPipeline"><span class="hs-identifier hs-var">GpuPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320479"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;seq-mem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; StructurePipeline
-&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StructurePipeline
</span><a href="Futhark.Test.Spec.html#SeqMemPipeline"><span class="hs-identifier hs-var">SeqMemPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320479"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;internalised&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; StructurePipeline
-&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StructurePipeline
</span><a href="Futhark.Test.Spec.html#NoPipeline"><span class="hs-identifier hs-var">NoPipeline</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">StructurePipeline -&gt; ParsecT Void Text Identity StructurePipeline
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StructurePipeline
</span><a href="Futhark.Test.Spec.html#SOACSPipeline"><span class="hs-identifier hs-var">SOACSPipeline</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Futhark.Test.Spec.html#parseMetrics"><span class="hs-identifier hs-type">parseMetrics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Analysis.Metrics.Type.html#AstMetrics"><span class="hs-identifier hs-type">AstMetrics</span></a></span><span>
</span><span id="line-351"></span><span id="parseMetrics"><span class="annot"><span class="annottext">parseMetrics :: Parser () -&gt; ParsecT Void Text Identity AstMetrics
</span><a href="Futhark.Test.Spec.html#parseMetrics"><span class="hs-identifier hs-var hs-var">parseMetrics</span></a></span></span><span> </span><span id="local-6989586621684320478"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320478"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity AstMetrics
-&gt; ParsecT Void Text Identity AstMetrics
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#inBraces"><span class="hs-identifier hs-var">inBraces</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320478"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity AstMetrics
 -&gt; ParsecT Void Text Identity AstMetrics)
-&gt; (ParsecT Void Text Identity (Text, Int)
    -&gt; ParsecT Void Text Identity AstMetrics)
-&gt; ParsecT Void Text Identity (Text, Int)
-&gt; ParsecT Void Text Identity AstMetrics
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([(Text, Int)] -&gt; AstMetrics)
-&gt; ParsecT Void Text Identity [(Text, Int)]
-&gt; ParsecT Void Text Identity AstMetrics
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Text Int -&gt; AstMetrics
</span><a href="Futhark.Analysis.Metrics.Type.html#AstMetrics"><span class="hs-identifier hs-var">AstMetrics</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Text Int -&gt; AstMetrics)
-&gt; ([(Text, Int)] -&gt; Map Text Int) -&gt; [(Text, Int)] -&gt; AstMetrics
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Text, Int)] -&gt; Map Text Int
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [(Text, Int)]
 -&gt; ParsecT Void Text Identity AstMetrics)
-&gt; (ParsecT Void Text Identity (Text, Int)
    -&gt; ParsecT Void Text Identity [(Text, Int)])
-&gt; ParsecT Void Text Identity (Text, Int)
-&gt; ParsecT Void Text Identity AstMetrics
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Text, Int)
-&gt; ParsecT Void Text Identity [(Text, Int)]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Text, Int)
 -&gt; ParsecT Void Text Identity AstMetrics)
-&gt; ParsecT Void Text Identity (Text, Int)
-&gt; ParsecT Void Text Identity AstMetrics
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int -&gt; (Text, Int))
-&gt; Parser Text -&gt; ParsecT Void Text Identity (Int -&gt; (Text, Int))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text)
-&gt; ParsecT Void Text Identity [Char] -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity [Char]
-&gt; ParsecT Void Text Identity [Char]
forall a. Parser () -&gt; Parser a -&gt; Parser a
</span><a href="Futhark.Test.Spec.html#lexeme"><span class="hs-identifier hs-var">lexeme</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320478"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity Char
-&gt; ParsecT Void Text Identity [Char]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">some</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Token Text -&gt; Bool) -&gt; ParsecT Void Text Identity (Token Text)
forall e s (m :: * -&gt; *).
MonadParsec e s m =&gt;
(Token s -&gt; Bool) -&gt; m (Token s)
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
Token Text -&gt; Bool
</span><a href="#local-6989586621684320475"><span class="hs-identifier hs-var">constituent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Int -&gt; (Text, Int))
-&gt; Parser Int -&gt; ParsecT Void Text Identity (Text, Int)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Int
</span><a href="Futhark.Test.Spec.html#parseNatural"><span class="hs-identifier hs-var">parseNatural</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320478"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621684320475"><span class="annot"><span class="annottext">constituent :: Char -&gt; Bool
</span><a href="#local-6989586621684320475"><span class="hs-identifier hs-var hs-var">constituent</span></a></span></span><span> </span><span id="local-6989586621684320473"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320473"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320473"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621684320473"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpec"><span class="hs-identifier hs-type">testSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span>
</span><span id="line-358"></span><span id="testSpec"><span class="annot"><span class="annottext">testSpec :: Parser () -&gt; Parser ProgramTest
</span><a href="Futhark.Test.Spec.html#testSpec"><span class="hs-identifier hs-var hs-var">testSpec</span></a></span></span><span> </span><span id="local-6989586621684320470"><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320470"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; TestAction -&gt; ProgramTest
</span><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-var">ProgramTest</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Text] -&gt; TestAction -&gt; ProgramTest)
-&gt; Parser Text
-&gt; ParsecT Void Text Identity ([Text] -&gt; TestAction -&gt; ProgramTest)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text
</span><a href="Futhark.Test.Spec.html#parseDescription"><span class="hs-identifier hs-var">parseDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320470"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity ([Text] -&gt; TestAction -&gt; ProgramTest)
-&gt; ParsecT Void Text Identity [Text]
-&gt; ParsecT Void Text Identity (TestAction -&gt; ProgramTest)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [Text]
</span><a href="Futhark.Test.Spec.html#parseTags"><span class="hs-identifier hs-var">parseTags</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320470"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (TestAction -&gt; ProgramTest)
-&gt; Parser TestAction -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser TestAction
</span><a href="Futhark.Test.Spec.html#parseAction"><span class="hs-identifier hs-var">parseAction</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320470"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span id="local-6989586621684321288"><span class="annot"><a href="Futhark.Test.Spec.html#couldNotRead"><span class="hs-identifier hs-type">couldNotRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621684321288"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-362"></span><span id="couldNotRead"><span class="annot"><span class="annottext">couldNotRead :: forall a. IOError -&gt; IO (Either [Char] a)
</span><a href="Futhark.Test.Spec.html#couldNotRead"><span class="hs-identifier hs-var hs-var">couldNotRead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either [Char] a -&gt; IO (Either [Char] a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] a -&gt; IO (Either [Char] a))
-&gt; (IOError -&gt; Either [Char] a) -&gt; IOError -&gt; IO (Either [Char] a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Either [Char] a)
-&gt; (IOError -&gt; [Char]) -&gt; IOError -&gt; Either [Char] a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Futhark.Test.Spec.html#pProgramTest"><span class="hs-identifier hs-type">pProgramTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span>
</span><span id="line-365"></span><span id="pProgramTest"><span class="annot"><span class="annottext">pProgramTest :: Parser ProgramTest
</span><a href="Futhark.Test.Spec.html#pProgramTest"><span class="hs-identifier hs-var hs-var">pProgramTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [()] -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [()] -&gt; Parser ())
-&gt; ParsecT Void Text Identity [()] -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [()]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320464"><span class="hs-identifier hs-var">pNonTestLine</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621684320463"><span class="annot"><span class="annottext">Maybe ProgramTest
</span><a href="#local-6989586621684320463"><span class="hs-identifier hs-var">maybe_spec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">Parser ProgramTest
-&gt; ParsecT Void Text Identity (Maybe ProgramTest)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ProgramTest -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ProgramTest
</span><a href="Futhark.Test.Spec.html#testSpec"><span class="hs-identifier hs-var">testSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe ProgramTest)
-&gt; Parser () -&gt; ParsecT Void Text Identity (Maybe ProgramTest)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320460"><span class="hs-identifier hs-var">pEndOfTestBlock</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe ProgramTest)
-&gt; ParsecT Void Text Identity [()]
-&gt; ParsecT Void Text Identity (Maybe ProgramTest)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [()]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320464"><span class="hs-identifier hs-var">pNonTestLine</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ProgramTest
</span><a href="#local-6989586621684320463"><span class="hs-identifier hs-var">maybe_spec</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684320459"><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320459"><span class="hs-identifier hs-var">spec</span></a></span></span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#RunCases"><span class="hs-identifier hs-type">RunCases</span></a></span><span> </span><span id="local-6989586621684320458"><span class="annot"><span class="annottext">[InputOutputs]
</span><a href="#local-6989586621684320458"><span class="hs-identifier hs-var">old_cases</span></a></span></span><span> </span><span id="local-6989586621684320457"><span class="annot"><span class="annottext">[StructureTest]
</span><a href="#local-6989586621684320457"><span class="hs-identifier hs-var">structures</span></a></span></span><span> </span><span id="local-6989586621684320456"><span class="annot"><span class="annottext">[WarningTest]
</span><a href="#local-6989586621684320456"><span class="hs-identifier hs-var">warnings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#testAction"><span class="hs-identifier hs-var hs-var">testAction</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320459"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>        </span><span id="local-6989586621684320455"><span class="annot"><span class="annottext">[[InputOutputs]]
</span><a href="#local-6989586621684320455"><span class="hs-identifier hs-var">cases</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [InputOutputs]
-&gt; ParsecT Void Text Identity [[InputOutputs]]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity [InputOutputs]
 -&gt; ParsecT Void Text Identity [[InputOutputs]])
-&gt; ParsecT Void Text Identity [InputOutputs]
-&gt; ParsecT Void Text Identity [[InputOutputs]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [InputOutputs]
</span><a href="#local-6989586621684320454"><span class="hs-identifier hs-var">pInputOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [InputOutputs]
-&gt; ParsecT Void Text Identity [()]
-&gt; ParsecT Void Text Identity [InputOutputs]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [()]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320464"><span class="hs-identifier hs-var">pNonTestLine</span></a></span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><span class="annottext">ProgramTest -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320459"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">testAction :: TestAction
</span><a href="Futhark.Test.Spec.html#testAction"><span class="hs-identifier hs-var">testAction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InputOutputs] -&gt; [StructureTest] -&gt; [WarningTest] -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#RunCases"><span class="hs-identifier hs-var">RunCases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InputOutputs]
</span><a href="#local-6989586621684320458"><span class="hs-identifier hs-var">old_cases</span></a></span><span> </span><span class="annot"><span class="annottext">[InputOutputs] -&gt; [InputOutputs] -&gt; [InputOutputs]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[InputOutputs]] -&gt; [InputOutputs]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[InputOutputs]]
</span><a href="#local-6989586621684320455"><span class="hs-identifier hs-var">cases</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StructureTest]
</span><a href="#local-6989586621684320457"><span class="hs-identifier hs-var">structures</span></a></span><span> </span><span class="annot"><span class="annottext">[WarningTest]
</span><a href="#local-6989586621684320456"><span class="hs-identifier hs-var">warnings</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [()]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320464"><span class="hs-identifier hs-var">pNonTestLine</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [()] -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;-- ==&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser ProgramTest -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320459"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-376"></span><span>          </span><span class="annot"><span class="annottext">Parser ProgramTest -&gt; [Char] -&gt; Parser ProgramTest
forall e s (m :: * -&gt; *) a.
MonadParsec e s m =&gt;
m a -&gt; [Char] -&gt; m a
</span><span class="hs-operator hs-var">&lt;?&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;no more test blocks, since first test block specifies type error.&quot;</span></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><span class="annottext">Maybe ProgramTest
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ProgramTest -&gt; Parser ProgramTest
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320450"><span class="hs-identifier hs-var">noTest</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>    </span><span id="local-6989586621684320461"><span class="annot"><span class="annottext">sep :: Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Maybe ()) -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ParsecT Void Text Identity (Maybe ()) -&gt; Parser ())
-&gt; ParsecT Void Text Identity (Maybe ()) -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">hspace</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
-&gt; ParsecT Void Text Identity (Maybe ())
-&gt; ParsecT Void Text Identity (Maybe ())
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity (Maybe ())
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><span class="hs-identifier hs-var">optional</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(Parser () -&gt; Parser ()) -&gt; Parser () -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Tokens s)
</span><span class="hs-identifier hs-var">eol</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
-&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621684320450"><span class="annot"><span class="annottext">noTest :: ProgramTest
</span><a href="#local-6989586621684320450"><span class="hs-identifier hs-var hs-var">noTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; TestAction -&gt; ProgramTest
</span><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-var">ProgramTest</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[Text]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[InputOutputs] -&gt; [StructureTest] -&gt; [WarningTest] -&gt; TestAction
</span><a href="Futhark.Test.Spec.html#RunCases"><span class="hs-identifier hs-var">RunCases</span></a></span><span> </span><span class="annot"><span class="annottext">[InputOutputs]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[StructureTest]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[WarningTest]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621684320460"><span class="annot"><span class="annottext">pEndOfTestBlock :: Parser ()
</span><a href="#local-6989586621684320460"><span class="hs-identifier hs-var hs-var">pEndOfTestBlock</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text) -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity (Tokens Text)
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m (Tokens s)
</span><span class="hs-identifier hs-var">eol</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *). MonadParsec e s m =&gt; m ()
</span><span class="hs-identifier hs-var">eof</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;--&quot;</span></span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621684320464"><span class="annot"><span class="annottext">pNonTestLine :: Parser ()
</span><a href="#local-6989586621684320464"><span class="hs-identifier hs-var hs-var">pNonTestLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text -&gt; Parser ()) -&gt; Parser Text -&gt; Parser ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser ()
forall e s (m :: * -&gt; *) a. MonadParsec e s m =&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">notFollowedBy</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;-- ==&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="Futhark.Test.Spec.html#restOfLine"><span class="hs-identifier hs-var">restOfLine</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621684320454"><span class="annot"><span class="annottext">pInputOutputs :: ParsecT Void Text Identity [InputOutputs]
</span><a href="#local-6989586621684320454"><span class="hs-identifier hs-var hs-var">pInputOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser () -&gt; Parser ()
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; Parser Text
</span><a href="Futhark.Test.Spec.html#parseDescription"><span class="hs-identifier hs-var">parseDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text
-&gt; ParsecT Void Text Identity [InputOutputs]
-&gt; ParsecT Void Text Identity [InputOutputs]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser () -&gt; ParsecT Void Text Identity [InputOutputs]
</span><a href="Futhark.Test.Spec.html#parseInputOutputs"><span class="hs-identifier hs-var">parseInputOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320461"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT Void Text Identity [InputOutputs]
-&gt; Parser () -&gt; ParsecT Void Text Identity [InputOutputs]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser ()
</span><a href="#local-6989586621684320460"><span class="hs-identifier hs-var">pEndOfTestBlock</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- | Read the test specification from the given Futhark program.</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromProgram"><span class="hs-identifier hs-type">testSpecFromProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span id="testSpecFromProgram"><span class="annot"><span class="annottext">testSpecFromProgram :: [Char] -&gt; IO (Either [Char] ProgramTest)
</span><a href="Futhark.Test.Spec.html#testSpecFromProgram"><span class="hs-identifier hs-var hs-var">testSpecFromProgram</span></a></span></span><span> </span><span id="local-6989586621684320395"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320395"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(ParseErrorBundle Text Void -&gt; Either [Char] ProgramTest)
-&gt; (ProgramTest -&gt; Either [Char] ProgramTest)
-&gt; Either (ParseErrorBundle Text Void) ProgramTest
-&gt; Either [Char] ProgramTest
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] ProgramTest
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Either [Char] ProgramTest)
-&gt; (ParseErrorBundle Text Void -&gt; [Char])
-&gt; ParseErrorBundle Text Void
-&gt; Either [Char] ProgramTest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle Text Void -&gt; [Char]
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; [Char]
</span><span class="hs-identifier hs-var">errorBundlePretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; Either [Char] ProgramTest
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either (ParseErrorBundle Text Void) ProgramTest
 -&gt; Either [Char] ProgramTest)
-&gt; (Text -&gt; Either (ParseErrorBundle Text Void) ProgramTest)
-&gt; Text
-&gt; Either [Char] ProgramTest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser ProgramTest
-&gt; [Char]
-&gt; Text
-&gt; Either (ParseErrorBundle Text Void) ProgramTest
forall e s a.
Parsec e s a -&gt; [Char] -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">parse</span></span><span> </span><span class="annot"><span class="annottext">Parser ProgramTest
</span><a href="Futhark.Test.Spec.html#pProgramTest"><span class="hs-identifier hs-var">pProgramTest</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320395"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><span class="annottext">(Text -&gt; Either [Char] ProgramTest)
-&gt; IO Text -&gt; IO (Either [Char] ProgramTest)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO Text
</span><span class="hs-identifier hs-var">T.readFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320395"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="annot"><span class="annottext">IO (Either [Char] ProgramTest)
-&gt; (IOError -&gt; IO (Either [Char] ProgramTest))
-&gt; IO (Either [Char] ProgramTest)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO (Either [Char] ProgramTest)
forall a. IOError -&gt; IO (Either [Char] a)
</span><a href="Futhark.Test.Spec.html#couldNotRead"><span class="hs-identifier hs-var">couldNotRead</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-comment">-- | Like 'testSpecFromProgram', but exits the process on error.</span><span>
</span><span id="line-401"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromProgramOrDie"><span class="hs-identifier hs-type">testSpecFromProgramOrDie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span>
</span><span id="line-402"></span><span id="testSpecFromProgramOrDie"><span class="annot"><span class="annottext">testSpecFromProgramOrDie :: [Char] -&gt; IO ProgramTest
</span><a href="Futhark.Test.Spec.html#testSpecFromProgramOrDie"><span class="hs-identifier hs-var hs-var">testSpecFromProgramOrDie</span></a></span></span><span> </span><span id="local-6989586621684320390"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320390"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621684320389"><span class="annot"><span class="annottext">Either [Char] ProgramTest
</span><a href="#local-6989586621684320389"><span class="hs-identifier hs-var">spec_or_err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either [Char] ProgramTest)
</span><a href="Futhark.Test.Spec.html#testSpecFromProgram"><span class="hs-identifier hs-var">testSpecFromProgram</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320390"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] ProgramTest
</span><a href="#local-6989586621684320389"><span class="hs-identifier hs-var">spec_or_err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684320388"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320388"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320388"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><span class="annottext">IO ProgramTest
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684320385"><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320385"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; IO ProgramTest
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320385"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><a href="Futhark.Test.Spec.html#testPrograms"><span class="hs-identifier hs-type">testPrograms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span id="testPrograms"><span class="annot"><span class="annottext">testPrograms :: [Char] -&gt; IO [[Char]]
</span><a href="Futhark.Test.Spec.html#testPrograms"><span class="hs-identifier hs-var hs-var">testPrograms</span></a></span></span><span> </span><span id="local-6989586621684320383"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320383"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; [[Char]] -&gt; [[Char]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
</span><a href="#local-6989586621684320382"><span class="hs-identifier hs-var">isFut</span></a></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [[Char]]) -&gt; IO [[Char]] -&gt; IO [[Char]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [[Char]]
</span><a href="Futhark.Util.html#directoryContents"><span class="hs-identifier hs-var">directoryContents</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320383"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621684320382"><span class="annot"><span class="annottext">isFut :: [Char] -&gt; Bool
</span><a href="#local-6989586621684320382"><span class="hs-identifier hs-var hs-var">isFut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.fut&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; ShowS -&gt; [Char] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeExtension</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | Read test specifications from the given path, which can be a file</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- or directory containing @.fut@ files and further directories.</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecsFromPath"><span class="hs-identifier hs-type">testSpecsFromPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span id="testSpecsFromPath"><span class="annot"><span class="annottext">testSpecsFromPath :: [Char] -&gt; IO (Either [Char] [([Char], ProgramTest)])
</span><a href="Futhark.Test.Spec.html#testSpecsFromPath"><span class="hs-identifier hs-var hs-var">testSpecsFromPath</span></a></span></span><span> </span><span id="local-6989586621684320376"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320376"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621684320375"><span class="annot"><span class="annottext">Either [Char] [[Char]]
</span><a href="#local-6989586621684320375"><span class="hs-identifier hs-var">programs_or_err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]] -&gt; Either [Char] [[Char]]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; Either [Char] [[Char]])
-&gt; IO [[Char]] -&gt; IO (Either [Char] [[Char]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [[Char]]
</span><a href="Futhark.Test.Spec.html#testPrograms"><span class="hs-identifier hs-var">testPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320376"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either [Char] [[Char]])
-&gt; (IOError -&gt; IO (Either [Char] [[Char]]))
-&gt; IO (Either [Char] [[Char]])
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO (Either [Char] [[Char]])
forall a. IOError -&gt; IO (Either [Char] a)
</span><a href="Futhark.Test.Spec.html#couldNotRead"><span class="hs-identifier hs-var">couldNotRead</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] [[Char]]
</span><a href="#local-6989586621684320375"><span class="hs-identifier hs-var">programs_or_err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684320374"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320374"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either [Char] [([Char], ProgramTest)]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] [([Char], ProgramTest)]
 -&gt; IO (Either [Char] [([Char], ProgramTest)]))
-&gt; Either [Char] [([Char], ProgramTest)]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] [([Char], ProgramTest)]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320374"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684320373"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320373"><span class="hs-identifier hs-var">programs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621684320372"><span class="annot"><span class="annottext">[Either [Char] ProgramTest]
</span><a href="#local-6989586621684320372"><span class="hs-identifier hs-var">specs_or_errs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO (Either [Char] ProgramTest))
-&gt; [[Char]] -&gt; IO [Either [Char] ProgramTest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either [Char] ProgramTest)
</span><a href="Futhark.Test.Spec.html#testSpecFromProgram"><span class="hs-identifier hs-var">testSpecFromProgram</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320373"><span class="hs-identifier hs-var">programs</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">Either [Char] [([Char], ProgramTest)]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] [([Char], ProgramTest)]
 -&gt; IO (Either [Char] [([Char], ProgramTest)]))
-&gt; Either [Char] [([Char], ProgramTest)]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [ProgramTest] -&gt; [([Char], ProgramTest)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320373"><span class="hs-identifier hs-var">programs</span></a></span><span> </span><span class="annot"><span class="annottext">([ProgramTest] -&gt; [([Char], ProgramTest)])
-&gt; Either [Char] [ProgramTest]
-&gt; Either [Char] [([Char], ProgramTest)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Either [Char] ProgramTest] -&gt; Either [Char] [ProgramTest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[Either [Char] ProgramTest]
</span><a href="#local-6989586621684320372"><span class="hs-identifier hs-var">specs_or_errs</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- | Read test specifications from the given paths, which can be a</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- files or directories containing @.fut@ files and further</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- directories.</span><span>
</span><span id="line-429"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecsFromPaths"><span class="hs-identifier hs-type">testSpecsFromPaths</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span id="testSpecsFromPaths"><span class="annot"><span class="annottext">testSpecsFromPaths :: [[Char]] -&gt; IO (Either [Char] [([Char], ProgramTest)])
</span><a href="Futhark.Test.Spec.html#testSpecsFromPaths"><span class="hs-identifier hs-var hs-var">testSpecsFromPaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Either [Char] [([Char], ProgramTest)]]
 -&gt; Either [Char] [([Char], ProgramTest)])
-&gt; IO [Either [Char] [([Char], ProgramTest)]]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([[([Char], ProgramTest)]] -&gt; [([Char], ProgramTest)])
-&gt; Either [Char] [[([Char], ProgramTest)]]
-&gt; Either [Char] [([Char], ProgramTest)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[[([Char], ProgramTest)]] -&gt; [([Char], ProgramTest)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">(Either [Char] [[([Char], ProgramTest)]]
 -&gt; Either [Char] [([Char], ProgramTest)])
-&gt; ([Either [Char] [([Char], ProgramTest)]]
    -&gt; Either [Char] [[([Char], ProgramTest)]])
-&gt; [Either [Char] [([Char], ProgramTest)]]
-&gt; Either [Char] [([Char], ProgramTest)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Either [Char] [([Char], ProgramTest)]]
-&gt; Either [Char] [[([Char], ProgramTest)]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO [Either [Char] [([Char], ProgramTest)]]
 -&gt; IO (Either [Char] [([Char], ProgramTest)]))
-&gt; ([[Char]] -&gt; IO [Either [Char] [([Char], ProgramTest)]])
-&gt; [[Char]]
-&gt; IO (Either [Char] [([Char], ProgramTest)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO (Either [Char] [([Char], ProgramTest)]))
-&gt; [[Char]] -&gt; IO [Either [Char] [([Char], ProgramTest)]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either [Char] [([Char], ProgramTest)])
</span><a href="Futhark.Test.Spec.html#testSpecsFromPath"><span class="hs-identifier hs-var">testSpecsFromPath</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- | Like 'testSpecsFromPaths', but kills the process on errors.</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecsFromPathsOrDie"><span class="hs-identifier hs-type">testSpecsFromPathsOrDie</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span id="testSpecsFromPathsOrDie"><span class="annot"><span class="annottext">testSpecsFromPathsOrDie :: [[Char]] -&gt; IO [([Char], ProgramTest)]
</span><a href="Futhark.Test.Spec.html#testSpecsFromPathsOrDie"><span class="hs-identifier hs-var hs-var">testSpecsFromPathsOrDie</span></a></span></span><span> </span><span id="local-6989586621684320369"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320369"><span class="hs-identifier hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>  </span><span id="local-6989586621684320368"><span class="annot"><span class="annottext">Either [Char] [([Char], ProgramTest)]
</span><a href="#local-6989586621684320368"><span class="hs-identifier hs-var">specs_or_err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; IO (Either [Char] [([Char], ProgramTest)])
</span><a href="Futhark.Test.Spec.html#testSpecsFromPaths"><span class="hs-identifier hs-var">testSpecsFromPaths</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621684320369"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] [([Char], ProgramTest)]
</span><a href="#local-6989586621684320368"><span class="hs-identifier hs-var">specs_or_err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-441"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684320367"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320367"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320367"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-443"></span><span>      </span><span class="annot"><span class="annottext">IO [([Char], ProgramTest)]
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684320366"><span class="annot"><span class="annottext">[([Char], ProgramTest)]
</span><a href="#local-6989586621684320366"><span class="hs-identifier hs-var">specs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[([Char], ProgramTest)] -&gt; IO [([Char], ProgramTest)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[([Char], ProgramTest)]
</span><a href="#local-6989586621684320366"><span class="hs-identifier hs-var">specs</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | Read a test specification from a file.  Expects only a single</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- block, and no comment prefixes.</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromFile"><span class="hs-identifier hs-type">testSpecFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span id="testSpecFromFile"><span class="annot"><span class="annottext">testSpecFromFile :: [Char] -&gt; IO (Either [Char] ProgramTest)
</span><a href="Futhark.Test.Spec.html#testSpecFromFile"><span class="hs-identifier hs-var hs-var">testSpecFromFile</span></a></span></span><span> </span><span id="local-6989586621684320365"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320365"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(ParseErrorBundle Text Void -&gt; Either [Char] ProgramTest)
-&gt; (ProgramTest -&gt; Either [Char] ProgramTest)
-&gt; Either (ParseErrorBundle Text Void) ProgramTest
-&gt; Either [Char] ProgramTest
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Either [Char] ProgramTest
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Either [Char] ProgramTest)
-&gt; (ParseErrorBundle Text Void -&gt; [Char])
-&gt; ParseErrorBundle Text Void
-&gt; Either [Char] ProgramTest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParseErrorBundle Text Void -&gt; [Char]
forall s e.
(VisualStream s, TraversableStream s, ShowErrorComponent e) =&gt;
ParseErrorBundle s e -&gt; [Char]
</span><span class="hs-identifier hs-var">errorBundlePretty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; Either [Char] ProgramTest
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either (ParseErrorBundle Text Void) ProgramTest
 -&gt; Either [Char] ProgramTest)
-&gt; (Text -&gt; Either (ParseErrorBundle Text Void) ProgramTest)
-&gt; Text
-&gt; Either [Char] ProgramTest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parser ProgramTest
-&gt; [Char]
-&gt; Text
-&gt; Either (ParseErrorBundle Text Void) ProgramTest
forall e s a.
Parsec e s a -&gt; [Char] -&gt; s -&gt; Either (ParseErrorBundle s e) a
</span><span class="hs-identifier hs-var">parse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser () -&gt; Parser ProgramTest
</span><a href="Futhark.Test.Spec.html#testSpec"><span class="hs-identifier hs-var">testSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ()
forall e s (m :: * -&gt; *).
(MonadParsec e s m, Token s ~ Char) =&gt;
m ()
</span><span class="hs-identifier hs-var">space</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320365"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><span class="annottext">(Text -&gt; Either [Char] ProgramTest)
-&gt; IO Text -&gt; IO (Either [Char] ProgramTest)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO Text
</span><span class="hs-identifier hs-var">T.readFile</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320365"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">IO (Either [Char] ProgramTest)
-&gt; (IOError -&gt; IO (Either [Char] ProgramTest))
-&gt; IO (Either [Char] ProgramTest)
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`catch`</span></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO (Either [Char] ProgramTest)
forall a. IOError -&gt; IO (Either [Char] a)
</span><a href="Futhark.Test.Spec.html#couldNotRead"><span class="hs-identifier hs-var">couldNotRead</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- | Like 'testSpecFromFile', but kills the process on errors.</span><span>
</span><span id="line-456"></span><span class="annot"><a href="Futhark.Test.Spec.html#testSpecFromFileOrDie"><span class="hs-identifier hs-type">testSpecFromFileOrDie</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Futhark.Test.Spec.html#ProgramTest"><span class="hs-identifier hs-type">ProgramTest</span></a></span><span>
</span><span id="line-457"></span><span id="testSpecFromFileOrDie"><span class="annot"><span class="annottext">testSpecFromFileOrDie :: [Char] -&gt; IO ProgramTest
</span><a href="Futhark.Test.Spec.html#testSpecFromFileOrDie"><span class="hs-identifier hs-var hs-var">testSpecFromFileOrDie</span></a></span></span><span> </span><span id="local-6989586621684320363"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320363"><span class="hs-identifier hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>  </span><span id="local-6989586621684320362"><span class="annot"><span class="annottext">Either [Char] ProgramTest
</span><a href="#local-6989586621684320362"><span class="hs-identifier hs-var">spec_or_err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Either [Char] ProgramTest)
</span><a href="Futhark.Test.Spec.html#testSpecFromFile"><span class="hs-identifier hs-var">testSpecFromFile</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320363"><span class="hs-identifier hs-var">dirs</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either [Char] ProgramTest
</span><a href="#local-6989586621684320362"><span class="hs-identifier hs-var">spec_or_err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621684320361"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320361"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621684320361"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><span class="annottext">IO ProgramTest
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621684320360"><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320360"><span class="hs-identifier hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgramTest -&gt; IO ProgramTest
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ProgramTest
</span><a href="#local-6989586621684320360"><span class="hs-identifier hs-var">spec</span></a></span><span>
</span><span id="line-464"></span></pre></body></html>