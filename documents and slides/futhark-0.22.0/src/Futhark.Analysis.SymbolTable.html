<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Futhark.Analysis.SymbolTable</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier">SymbolTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier">bindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier">loopDepth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier">availableAtClosestLoop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#simplifyMemory"><span class="hs-identifier">simplifyMemory</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#fromScope"><span class="hs-identifier">fromScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#toScope"><span class="hs-identifier">toScope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Entries</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier">Entry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#deepen"><span class="hs-identifier">deepen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAccInput"><span class="hs-identifier">entryAccInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryDepth"><span class="hs-identifier">entryDepth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryLetBoundDec"><span class="hs-identifier">entryLetBoundDec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryIsSize"><span class="hs-identifier">entryIsSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryStm"><span class="hs-identifier">entryStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryFParam"><span class="hs-identifier">entryFParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryLParam"><span class="hs-identifier">entryLParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Lookup</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#elem"><span class="hs-identifier">elem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupStm"><span class="hs-identifier">lookupStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupExp"><span class="hs-identifier">lookupExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupBasicOp"><span class="hs-identifier">lookupBasicOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupType"><span class="hs-identifier">lookupType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupSubExp"><span class="hs-identifier">lookupSubExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupAliases"><span class="hs-identifier">lookupAliases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupLoopVar"><span class="hs-identifier">lookupLoopVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupLoopParam"><span class="hs-identifier">lookupLoopParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#available"><span class="hs-identifier">available</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#consume"><span class="hs-identifier">consume</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#index"><span class="hs-identifier">index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier">index'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier">Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexedAddCerts"><span class="hs-identifier">indexedAddCerts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Insertion</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertStm"><span class="hs-identifier">insertStm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertStms"><span class="hs-identifier">insertStms</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertFParams"><span class="hs-identifier">insertFParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLParam"><span class="hs-identifier">insertLParam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLoopVar"><span class="hs-identifier">insertLoopVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLoopMerge"><span class="hs-identifier">insertLoopMerge</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Misc</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#hideCertified"><span class="hs-identifier">hideCertified</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#noteAccTokens"><span class="hs-identifier">noteAccTokens</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elemIndex</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.Analysis.PrimExp.Convert.html"><span class="hs-identifier">Futhark.Analysis.PrimExp.Convert</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Futhark.IR.html"><span class="hs-identifier">Futhark.IR</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#FParam"><span class="hs-identifier">FParam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#lookupType"><span class="hs-identifier">lookupType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.IR.html"><span class="hs-identifier">Futhark.IR</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AST</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html"><span class="hs-identifier">Futhark.IR.Prop.Aliases</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aliases</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="SymbolTable"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span> </span><span id="local-6989586621684363388"><span class="annot"><a href="#local-6989586621684363388"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SymbolTable"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="loopDepth"><span class="annot"><span class="annottext">forall rep. SymbolTable rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var hs-var">loopDepth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span id="bindings"><span class="annot"><span class="annottext">forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363388"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-comment">-- | Which names are available just before the most enclosing</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- loop?</span><span>
</span><span id="line-72"></span><span>    </span><span id="availableAtClosestLoop"><span class="annot"><span class="annottext">forall rep. SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier hs-var hs-var">availableAtClosestLoop</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- | We are in a situation where we should</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- simplify/hoist/un-existentialise memory as much as possible -</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- typically, inside a kernel.</span><span>
</span><span id="line-76"></span><span>    </span><span id="simplifyMemory"><span class="annot"><span class="annottext">forall rep. SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#simplifyMemory"><span class="hs-identifier hs-var hs-var">simplifyMemory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621684363376"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684363017"><span id="local-6989586621684363019"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363376"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621684363007"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363007"><span class="hs-identifier hs-var">table1</span></a></span></span><span> </span><span id="local-6989586621684363006"><span class="annot"><span class="annottext">&lt;&gt; :: SymbolTable rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621684363005"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363005"><span class="hs-identifier hs-var">table2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">SymbolTable :: forall rep.
Int -&gt; Map VName (Entry rep) -&gt; Names -&gt; Bool -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">loopDepth :: Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var">loopDepth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Int
forall rep. SymbolTable rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var hs-var">loopDepth</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363007"><span class="hs-identifier hs-var">table1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Int
forall rep. SymbolTable rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var hs-var">loopDepth</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363005"><span class="hs-identifier hs-var">table2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363007"><span class="hs-identifier hs-var">table1</span></a></span><span> </span><span class="annot"><span class="annottext">Map VName (Entry rep)
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363005"><span class="hs-identifier hs-var">table2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">availableAtClosestLoop :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier hs-var">availableAtClosestLoop</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>          </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Names
forall rep. SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier hs-var hs-var">availableAtClosestLoop</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363007"><span class="hs-identifier hs-var">table1</span></a></span><span>
</span><span id="line-86"></span><span>            </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Names
forall rep. SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier hs-var hs-var">availableAtClosestLoop</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363005"><span class="hs-identifier hs-var">table2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">simplifyMemory :: Bool
</span><a href="Futhark.Analysis.SymbolTable.html#simplifyMemory"><span class="hs-identifier hs-var">simplifyMemory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Bool
forall rep. SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#simplifyMemory"><span class="hs-identifier hs-var hs-var">simplifyMemory</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363007"><span class="hs-identifier hs-var">table1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Bool
forall rep. SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#simplifyMemory"><span class="hs-identifier hs-var hs-var">simplifyMemory</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684363005"><span class="hs-identifier hs-var">table2</span></a></span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-special">}</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621684363371"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684362996"><span id="local-6989586621684362998"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363371"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621684362994"><span class="annot"><span class="annottext">mempty :: SymbolTable rep
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
forall rep. SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621684362993"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684362993"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-94"></span><span id="empty"><span class="annot"><span class="annottext">empty :: forall rep. SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Map VName (Entry rep) -&gt; Names -&gt; Bool -&gt; SymbolTable rep
forall rep.
Int -&gt; Map VName (Entry rep) -&gt; Names -&gt; Bool -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Map VName (Entry rep)
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621684363367"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#fromScope"><span class="hs-identifier hs-type">fromScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363367"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363367"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363367"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-97"></span><span id="fromScope"><span class="annot"><span class="annottext">fromScope :: forall rep. ASTRep rep =&gt; Scope rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#fromScope"><span class="hs-identifier hs-var hs-var">fromScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; VName -&gt; NameInfo rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; Map VName (NameInfo rep) -&gt; SymbolTable rep
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">M.foldlWithKey'</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; VName -&gt; NameInfo rep -&gt; SymbolTable rep
forall {rep}.
ASTRep rep =&gt;
SymbolTable rep -&gt; VName -&gt; NameInfo rep -&gt; SymbolTable rep
</span><a href="#local-6989586621684362986"><span class="hs-identifier hs-var">insertFreeVar'</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
forall rep. SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621684362986"><span class="annot"><span class="annottext">insertFreeVar' :: SymbolTable rep -&gt; VName -&gt; NameInfo rep -&gt; SymbolTable rep
</span><a href="#local-6989586621684362986"><span class="hs-identifier hs-var hs-var">insertFreeVar'</span></a></span></span><span> </span><span id="local-6989586621684362983"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362983"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621684362982"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362982"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621684362981"><span class="annot"><span class="annottext">NameInfo rep
</span><a href="#local-6989586621684362981"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; NameInfo rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; NameInfo rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertFreeVar"><span class="hs-identifier hs-var">insertFreeVar</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362982"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">NameInfo rep
</span><a href="#local-6989586621684362981"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362983"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621684363358"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#toScope"><span class="hs-identifier hs-type">toScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363358"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363358"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-102"></span><span id="toScope"><span class="annot"><span class="annottext">toScope :: forall rep. SymbolTable rep -&gt; Scope rep
</span><a href="Futhark.Analysis.SymbolTable.html#toScope"><span class="hs-identifier hs-var hs-var">toScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; NameInfo rep)
-&gt; Map VName (Entry rep) -&gt; Map VName (NameInfo rep)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; NameInfo rep
forall rep. Entry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryInfo"><span class="hs-identifier hs-var">entryInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (NameInfo rep))
-&gt; (SymbolTable rep -&gt; Map VName (Entry rep))
-&gt; SymbolTable rep
-&gt; Map VName (NameInfo rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span id="local-6989586621684363349"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#deepen"><span class="hs-identifier hs-type">deepen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363349"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363349"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-105"></span><span id="deepen"><span class="annot"><span class="annottext">deepen :: forall rep. SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#deepen"><span class="hs-identifier hs-var hs-var">deepen</span></a></span></span><span> </span><span id="local-6989586621684362973"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362973"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362973"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">loopDepth :: Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var">loopDepth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Int
forall rep. SymbolTable rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var hs-var">loopDepth</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362973"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">availableAtClosestLoop :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#availableAtClosestLoop"><span class="hs-identifier hs-var">availableAtClosestLoop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VName] -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#namesFromList"><span class="hs-identifier hs-var">namesFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Names) -&gt; [VName] -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map VName (Entry rep) -&gt; [VName]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; [VName])
-&gt; Map VName (Entry rep) -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362973"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | The result of indexing a delayed array.</span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="Indexed"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-var">Indexed</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | A PrimExp based on the indexes (that is, without</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- accessing any actual array).</span><span>
</span><span id="line-115"></span><span>    </span><span id="Indexed"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-var">Indexed</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#PrimExp"><span class="hs-identifier hs-type">PrimExp</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | The indexing corresponds to another (perhaps more</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- advantageous) array.</span><span>
</span><span id="line-118"></span><span>    </span><span id="IndexedArray"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexedArray"><span class="hs-identifier hs-var">IndexedArray</span></a></span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexedAddCerts"><span class="hs-identifier hs-type">indexedAddCerts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span>
</span><span id="line-121"></span><span id="indexedAddCerts"><span class="annot"><span class="annottext">indexedAddCerts :: Certs -&gt; Indexed -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#indexedAddCerts"><span class="hs-identifier hs-var hs-var">indexedAddCerts</span></a></span></span><span> </span><span id="local-6989586621684362967"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362967"><span class="hs-identifier hs-var">cs1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span> </span><span id="local-6989586621684362966"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362966"><span class="hs-identifier hs-var">cs2</span></a></span></span><span> </span><span id="local-6989586621684362965"><span class="annot"><span class="annottext">PrimExp VName
</span><a href="#local-6989586621684362965"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Certs -&gt; PrimExp VName -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-var">Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362967"><span class="hs-identifier hs-var">cs1</span></a></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; Certs -&gt; Certs
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362966"><span class="hs-identifier hs-var">cs2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimExp VName
</span><a href="#local-6989586621684362965"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexedAddCerts"><span class="hs-identifier hs-var">indexedAddCerts</span></a></span><span> </span><span id="local-6989586621684362964"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362964"><span class="hs-identifier hs-var">cs1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexedArray"><span class="hs-identifier hs-type">IndexedArray</span></a></span><span> </span><span id="local-6989586621684362963"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362963"><span class="hs-identifier hs-var">cs2</span></a></span></span><span> </span><span id="local-6989586621684362962"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362962"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684362961"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362961"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Certs -&gt; VName -&gt; [TPrimExp Int64 VName] -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#IndexedArray"><span class="hs-identifier hs-var">IndexedArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362964"><span class="hs-identifier hs-var">cs1</span></a></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; Certs -&gt; Certs
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362963"><span class="hs-identifier hs-var">cs2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362962"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362961"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#FreeIn"><span class="hs-identifier hs-type">FreeIn</span></a></span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621684362941"><span class="annot"><span class="annottext">freeIn' :: Indexed -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var hs-var hs-var hs-var">freeIn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span> </span><span id="local-6989586621684362939"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362939"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621684362938"><span class="annot"><span class="annottext">PrimExp VName
</span><a href="#local-6989586621684362938"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Certs -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362939"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrimExp VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">PrimExp VName
</span><a href="#local-6989586621684362938"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexedArray"><span class="hs-identifier hs-type">IndexedArray</span></a></span><span> </span><span id="local-6989586621684362937"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362937"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621684362936"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362936"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621684362935"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362935"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Certs -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362937"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362936"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">FV -&gt; FV -&gt; FV
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName] -&gt; FV
forall a. FreeIn a =&gt; a -&gt; FV
</span><a href="Futhark.IR.Prop.Names.html#freeIn%27"><span class="hs-identifier hs-var">freeIn'</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362935"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Indexing a delayed array if possible.</span><span>
</span><span id="line-129"></span><span class="hs-keyword">type</span><span> </span><span id="IndexArray"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexArray"><span class="hs-identifier hs-var">IndexArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">data</span><span> </span><span id="Entry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span></span><span> </span><span id="local-6989586621684363331"><span class="annot"><a href="#local-6989586621684363331"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Entry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-var">Entry</span></a></span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | True if consumed.</span><span>
</span><span id="line-133"></span><span>    </span><span id="entryConsumed"><span class="annot"><span class="annottext">forall rep. Entry rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryConsumed"><span class="hs-identifier hs-var hs-var">entryConsumed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>    </span><span id="entryDepth"><span class="annot"><span class="annottext">forall rep. Entry rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#entryDepth"><span class="hs-identifier hs-var hs-var">entryDepth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- | True if this name has been used as an array size,</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- implying that it is non-negative.</span><span>
</span><span id="line-137"></span><span>    </span><span id="entryIsSize"><span class="annot"><span class="annottext">forall rep. Entry rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryIsSize"><span class="hs-identifier hs-var hs-var">entryIsSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- | For names that are tokens of an accumulator, this is the</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- corresponding combining function and neutral element.</span><span>
</span><span id="line-140"></span><span>    </span><span id="entryAccInput"><span class="annot"><span class="annottext">forall rep. Entry rep -&gt; Maybe (WithAccInput rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryAccInput"><span class="hs-identifier hs-var hs-var">entryAccInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#WithAccInput"><span class="hs-identifier hs-type">WithAccInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363331"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>    </span><span id="entryType"><span class="annot"><span class="annottext">forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#EntryType"><span class="hs-identifier hs-type">EntryType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363331"><span class="hs-identifier hs-type">rep</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">data</span><span> </span><span id="EntryType"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#EntryType"><span class="hs-identifier hs-var">EntryType</span></a></span></span><span> </span><span id="local-6989586621684363122"><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LoopVar"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVar"><span class="hs-identifier hs-var">LoopVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVarEntry"><span class="hs-identifier hs-type">LoopVarEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LetBound"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-var">LetBound</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-type">LetBoundEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FParam"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-var">FParam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParamEntry"><span class="hs-identifier hs-type">FParamEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LParam"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-var">LParam</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParamEntry"><span class="hs-identifier hs-type">LParamEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FreeVar"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-var">FreeVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVarEntry"><span class="hs-identifier hs-type">FreeVarEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363122"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">data</span><span> </span><span id="LoopVarEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVarEntry"><span class="hs-identifier hs-var">LoopVarEntry</span></a></span></span><span> </span><span id="local-6989586621684363323"><span class="annot"><a href="#local-6989586621684363323"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LoopVarEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVarEntry"><span class="hs-identifier hs-var">LoopVarEntry</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="loopVarType"><span class="annot"><span class="annottext">forall rep. LoopVarEntry rep -&gt; IntType
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarType"><span class="hs-identifier hs-var hs-var">loopVarType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>    </span><span id="loopVarBound"><span class="annot"><span class="annottext">forall rep. LoopVarEntry rep -&gt; SubExp
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarBound"><span class="hs-identifier hs-var hs-var">loopVarBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">data</span><span> </span><span id="LetBoundEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-var">LetBoundEntry</span></a></span></span><span> </span><span id="local-6989586621684363317"><span class="annot"><a href="#local-6989586621684363317"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LetBoundEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-var">LetBoundEntry</span></a></span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="letBoundDec"><span class="annot"><span class="annottext">forall rep. LetBoundEntry rep -&gt; LetDec rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundDec"><span class="hs-identifier hs-var hs-var">letBoundDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363317"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span id="letBoundAliases"><span class="annot"><span class="annottext">forall rep. LetBoundEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundAliases"><span class="hs-identifier hs-var hs-var">letBoundAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>    </span><span id="letBoundStm"><span class="annot"><span class="annottext">forall rep. LetBoundEntry rep -&gt; Stm rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundStm"><span class="hs-identifier hs-var hs-var">letBoundStm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363317"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- | Index a delayed array, if possible.</span><span>
</span><span id="line-161"></span><span>    </span><span id="letBoundIndex"><span class="annot"><span class="annottext">forall rep. LetBoundEntry rep -&gt; Int -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundIndex"><span class="hs-identifier hs-var hs-var">letBoundIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexArray"><span class="hs-identifier hs-type">IndexArray</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">data</span><span> </span><span id="FParamEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParamEntry"><span class="hs-identifier hs-var">FParamEntry</span></a></span></span><span> </span><span id="local-6989586621684363308"><span class="annot"><a href="#local-6989586621684363308"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FParamEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParamEntry"><span class="hs-identifier hs-var">FParamEntry</span></a></span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fparamDec"><span class="annot"><span class="annottext">forall rep. FParamEntry rep -&gt; FParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#fparamDec"><span class="hs-identifier hs-var hs-var">fparamDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363308"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>    </span><span id="fparamAliases"><span class="annot"><span class="annottext">forall rep. FParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var hs-var">fparamAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">-- | If a loop parameter, the initial value and the eventual</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- result.  The result need not be in scope in the symbol table.</span><span>
</span><span id="line-169"></span><span>    </span><span id="fparamMerge"><span class="annot"><span class="annottext">forall rep. FParamEntry rep -&gt; Maybe (SubExp, SubExp)
</span><a href="Futhark.Analysis.SymbolTable.html#fparamMerge"><span class="hs-identifier hs-var hs-var">fparamMerge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">data</span><span> </span><span id="LParamEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParamEntry"><span class="hs-identifier hs-var">LParamEntry</span></a></span></span><span> </span><span id="local-6989586621684363302"><span class="annot"><a href="#local-6989586621684363302"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LParamEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParamEntry"><span class="hs-identifier hs-var">LParamEntry</span></a></span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="lparamDec"><span class="annot"><span class="annottext">forall rep. LParamEntry rep -&gt; LParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#lparamDec"><span class="hs-identifier hs-var hs-var">lparamDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363302"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>    </span><span id="lparamAliases"><span class="annot"><span class="annottext">forall rep. LParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#lparamAliases"><span class="hs-identifier hs-var hs-var">lparamAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span id="lparamIndex"><span class="annot"><span class="annottext">forall rep. LParamEntry rep -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#lparamIndex"><span class="hs-identifier hs-var hs-var">lparamIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexArray"><span class="hs-identifier hs-type">IndexArray</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="FreeVarEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVarEntry"><span class="hs-identifier hs-var">FreeVarEntry</span></a></span></span><span> </span><span id="local-6989586621684363296"><span class="annot"><a href="#local-6989586621684363296"><span class="hs-identifier hs-type">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreeVarEntry"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVarEntry"><span class="hs-identifier hs-var">FreeVarEntry</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="freeVarDec"><span class="annot"><span class="annottext">forall rep. FreeVarEntry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarDec"><span class="hs-identifier hs-var hs-var">freeVarDec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#NameInfo"><span class="hs-identifier hs-type">NameInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363296"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span id="freeVarAliases"><span class="annot"><span class="annottext">forall rep. FreeVarEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var hs-var">freeVarAliases</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- | Index a delayed array, if possible.</span><span>
</span><span id="line-182"></span><span>    </span><span id="freeVarIndex"><span class="annot"><span class="annottext">forall rep. FreeVarEntry rep -&gt; VName -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarIndex"><span class="hs-identifier hs-var hs-var">freeVarIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexArray"><span class="hs-identifier hs-type">IndexArray</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span id="local-6989586621684363287"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363287"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Types.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363287"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621684362898"><span class="annot"><span class="annottext">typeOf :: Entry rep -&gt; Type
</span><a href="Futhark.IR.Prop.Types.html#typeOf"><span class="hs-identifier hs-var hs-var hs-var hs-var">typeOf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameInfo rep -&gt; Type
forall t. Typed t =&gt; t -&gt; Type
</span><a href="Futhark.IR.Prop.Types.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">(NameInfo rep -&gt; Type)
-&gt; (Entry rep -&gt; NameInfo rep) -&gt; Entry rep -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; NameInfo rep
forall rep. Entry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryInfo"><span class="hs-identifier hs-var">entryInfo</span></a></span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621684363353"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryInfo"><span class="hs-identifier hs-type">entryInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363353"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#NameInfo"><span class="hs-identifier hs-type">NameInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363353"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-189"></span><span id="entryInfo"><span class="annot"><span class="annottext">entryInfo :: forall rep. Entry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryInfo"><span class="hs-identifier hs-var hs-var">entryInfo</span></a></span></span><span> </span><span id="local-6989586621684362896"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362896"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362896"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-type">LetBound</span></a></span><span> </span><span id="local-6989586621684362895"><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362895"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LetDec rep -&gt; NameInfo rep
forall rep. LetDec rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#LetName"><span class="hs-identifier hs-var">LetName</span></a></span><span> </span><span class="annot"><span class="annottext">(LetDec rep -&gt; NameInfo rep) -&gt; LetDec rep -&gt; NameInfo rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; LetDec rep
forall rep. LetBoundEntry rep -&gt; LetDec rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundDec"><span class="hs-identifier hs-var hs-var">letBoundDec</span></a></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362895"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVar"><span class="hs-identifier hs-type">LoopVar</span></a></span><span> </span><span id="local-6989586621684362893"><span class="annot"><span class="annottext">LoopVarEntry rep
</span><a href="#local-6989586621684362893"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; NameInfo rep
forall rep. IntType -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#IndexName"><span class="hs-identifier hs-var">IndexName</span></a></span><span> </span><span class="annot"><span class="annottext">(IntType -&gt; NameInfo rep) -&gt; IntType -&gt; NameInfo rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LoopVarEntry rep -&gt; IntType
forall rep. LoopVarEntry rep -&gt; IntType
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarType"><span class="hs-identifier hs-var hs-var">loopVarType</span></a></span><span> </span><span class="annot"><span class="annottext">LoopVarEntry rep
</span><a href="#local-6989586621684362893"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-type">FParam</span></a></span><span> </span><span id="local-6989586621684362891"><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362891"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FParamInfo rep -&gt; NameInfo rep
forall rep. FParamInfo rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#FParamName"><span class="hs-identifier hs-var">FParamName</span></a></span><span> </span><span class="annot"><span class="annottext">(FParamInfo rep -&gt; NameInfo rep) -&gt; FParamInfo rep -&gt; NameInfo rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; FParamInfo rep
forall rep. FParamEntry rep -&gt; FParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#fparamDec"><span class="hs-identifier hs-var hs-var">fparamDec</span></a></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362891"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span id="local-6989586621684362889"><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362889"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LParamInfo rep -&gt; NameInfo rep
forall rep. LParamInfo rep -&gt; NameInfo rep
</span><a href="Futhark.IR.Prop.Scope.html#LParamName"><span class="hs-identifier hs-var">LParamName</span></a></span><span> </span><span class="annot"><span class="annottext">(LParamInfo rep -&gt; NameInfo rep) -&gt; LParamInfo rep -&gt; NameInfo rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; LParamInfo rep
forall rep. LParamEntry rep -&gt; LParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#lparamDec"><span class="hs-identifier hs-var hs-var">lparamDec</span></a></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362889"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-type">FreeVar</span></a></span><span> </span><span id="local-6989586621684362887"><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362887"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; NameInfo rep
forall rep. FreeVarEntry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarDec"><span class="hs-identifier hs-var hs-var">freeVarDec</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362887"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621684363281"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#isLetBound"><span class="hs-identifier hs-type">isLetBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363281"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-type">LetBoundEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363281"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span id="isLetBound"><span class="annot"><span class="annottext">isLetBound :: forall rep. Entry rep -&gt; Maybe (LetBoundEntry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#isLetBound"><span class="hs-identifier hs-var hs-var">isLetBound</span></a></span></span><span> </span><span id="local-6989586621684362885"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362885"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362885"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-type">LetBound</span></a></span><span> </span><span id="local-6989586621684362884"><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362884"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Maybe (LetBoundEntry rep)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362884"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="annottext">EntryType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (LetBoundEntry rep)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621684363278"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryStm"><span class="hs-identifier hs-type">entryStm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363278"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363278"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-202"></span><span id="entryStm"><span class="annot"><span class="annottext">entryStm :: forall rep. Entry rep -&gt; Maybe (Stm rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryStm"><span class="hs-identifier hs-var hs-var">entryStm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LetBoundEntry rep -&gt; Stm rep)
-&gt; Maybe (LetBoundEntry rep) -&gt; Maybe (Stm rep)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Stm rep
forall rep. LetBoundEntry rep -&gt; Stm rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundStm"><span class="hs-identifier hs-var hs-var">letBoundStm</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (LetBoundEntry rep) -&gt; Maybe (Stm rep))
-&gt; (Entry rep -&gt; Maybe (LetBoundEntry rep))
-&gt; Entry rep
-&gt; Maybe (Stm rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Maybe (LetBoundEntry rep)
forall rep. Entry rep -&gt; Maybe (LetBoundEntry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#isLetBound"><span class="hs-identifier hs-var">isLetBound</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621684363273"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryFParam"><span class="hs-identifier hs-type">entryFParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363273"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#FParamInfo"><span class="hs-identifier hs-type">FParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363273"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-205"></span><span id="entryFParam"><span class="annot"><span class="annottext">entryFParam :: forall rep. Entry rep -&gt; Maybe (FParamInfo rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryFParam"><span class="hs-identifier hs-var hs-var">entryFParam</span></a></span></span><span> </span><span id="local-6989586621684362881"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362881"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362881"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-type">FParam</span></a></span><span> </span><span id="local-6989586621684362880"><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362880"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FParamInfo rep -&gt; Maybe (FParamInfo rep)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FParamInfo rep -&gt; Maybe (FParamInfo rep))
-&gt; FParamInfo rep -&gt; Maybe (FParamInfo rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; FParamInfo rep
forall rep. FParamEntry rep -&gt; FParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#fparamDec"><span class="hs-identifier hs-var hs-var">fparamDec</span></a></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362880"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">EntryType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FParamInfo rep)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span id="local-6989586621684363271"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryLParam"><span class="hs-identifier hs-type">entryLParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363271"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LParamInfo"><span class="hs-identifier hs-type">LParamInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363271"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-210"></span><span id="entryLParam"><span class="annot"><span class="annottext">entryLParam :: forall rep. Entry rep -&gt; Maybe (LParamInfo rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryLParam"><span class="hs-identifier hs-var hs-var">entryLParam</span></a></span></span><span> </span><span id="local-6989586621684362879"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362879"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362879"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span id="local-6989586621684362878"><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362878"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LParamInfo rep -&gt; Maybe (LParamInfo rep)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LParamInfo rep -&gt; Maybe (LParamInfo rep))
-&gt; LParamInfo rep -&gt; Maybe (LParamInfo rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; LParamInfo rep
forall rep. LParamEntry rep -&gt; LParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#lparamDec"><span class="hs-identifier hs-var hs-var">lparamDec</span></a></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362878"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">EntryType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (LParamInfo rep)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621684363269"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryLetBoundDec"><span class="hs-identifier hs-type">entryLetBoundDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363269"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#LetDec"><span class="hs-identifier hs-type">LetDec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363269"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-215"></span><span id="entryLetBoundDec"><span class="annot"><span class="annottext">entryLetBoundDec :: forall rep. Entry rep -&gt; Maybe (LetDec rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryLetBoundDec"><span class="hs-identifier hs-var hs-var">entryLetBoundDec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LetBoundEntry rep -&gt; LetDec rep)
-&gt; Maybe (LetBoundEntry rep) -&gt; Maybe (LetDec rep)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; LetDec rep
forall rep. LetBoundEntry rep -&gt; LetDec rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundDec"><span class="hs-identifier hs-var hs-var">letBoundDec</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (LetBoundEntry rep) -&gt; Maybe (LetDec rep))
-&gt; (Entry rep -&gt; Maybe (LetBoundEntry rep))
-&gt; Entry rep
-&gt; Maybe (LetDec rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Maybe (LetBoundEntry rep)
forall rep. Entry rep -&gt; Maybe (LetBoundEntry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#isLetBound"><span class="hs-identifier hs-var">isLetBound</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621684363267"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-type">entryAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#EntryType"><span class="hs-identifier hs-type">EntryType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363267"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-218"></span><span id="entryAliases"><span class="annot"><span class="annottext">entryAliases :: forall rep. EntryType rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var hs-var">entryAliases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-type">LetBound</span></a></span><span> </span><span id="local-6989586621684362874"><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362874"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Names
forall rep. LetBoundEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundAliases"><span class="hs-identifier hs-var hs-var">letBoundAliases</span></a></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-type">FParam</span></a></span><span> </span><span id="local-6989586621684362873"><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362873"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; Names
forall rep. FParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var hs-var">fparamAliases</span></a></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362873"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span id="local-6989586621684362872"><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362872"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; Names
forall rep. LParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#lparamAliases"><span class="hs-identifier hs-var hs-var">lparamAliases</span></a></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362872"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-type">FreeVar</span></a></span><span> </span><span id="local-6989586621684362871"><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362871"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; Names
forall rep. FreeVarEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var hs-var">freeVarAliases</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362871"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-222"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVar"><span class="hs-identifier hs-type">LoopVar</span></a></span><span> </span><span class="annot"><span class="annottext">LoopVarEntry rep
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-comment">-- Integers have no aliases.</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | You almost always want 'available' instead of this one.</span><span>
</span><span id="line-225"></span><span id="local-6989586621684363265"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#elem"><span class="hs-identifier hs-type">elem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363265"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-226"></span><span id="elem"><span class="annot"><span class="annottext">elem :: forall rep. VName -&gt; SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#elem"><span class="hs-identifier hs-var hs-var">elem</span></a></span></span><span> </span><span id="local-6989586621684362870"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362870"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Entry rep) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Entry rep) -&gt; Bool)
-&gt; (SymbolTable rep -&gt; Maybe (Entry rep))
-&gt; SymbolTable rep
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362870"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621684363262"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363262"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363262"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-229"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621684362867"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362867"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362867"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Maybe (Entry rep))
-&gt; (SymbolTable rep -&gt; Map VName (Entry rep))
-&gt; SymbolTable rep
-&gt; Maybe (Entry rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621684363258"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupStm"><span class="hs-identifier hs-type">lookupStm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363258"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363258"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-232"></span><span id="lookupStm"><span class="annot"><span class="annottext">lookupStm :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Stm rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupStm"><span class="hs-identifier hs-var hs-var">lookupStm</span></a></span></span><span> </span><span id="local-6989586621684362863"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362863"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362862"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362862"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Maybe (Stm rep)
forall rep. Entry rep -&gt; Maybe (Stm rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryStm"><span class="hs-identifier hs-var">entryStm</span></a></span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Maybe (Stm rep))
-&gt; Maybe (Entry rep) -&gt; Maybe (Stm rep)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362863"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362862"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621684363253"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupExp"><span class="hs-identifier hs-type">lookupExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363253"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363253"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-235"></span><span id="lookupExp"><span class="annot"><span class="annottext">lookupExp :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Exp rep, Certs)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupExp"><span class="hs-identifier hs-var hs-var">lookupExp</span></a></span></span><span> </span><span id="local-6989586621684362857"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362857"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362856"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362856"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stm rep -&gt; Exp rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Exp rep)
-&gt; (Stm rep -&gt; Certs) -&gt; Stm rep -&gt; (Exp rep, Certs)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Certs
forall rep. Stm rep -&gt; Certs
</span><a href="Futhark.IR.Prop.html#stmCerts"><span class="hs-identifier hs-var">stmCerts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; (Exp rep, Certs))
-&gt; Maybe (Stm rep) -&gt; Maybe (Exp rep, Certs)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Stm rep)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Stm rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupStm"><span class="hs-identifier hs-var">lookupStm</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362857"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362856"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span id="local-6989586621684363240"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupBasicOp"><span class="hs-identifier hs-type">lookupBasicOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363240"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-238"></span><span id="lookupBasicOp"><span class="annot"><span class="annottext">lookupBasicOp :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (BasicOp, Certs)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupBasicOp"><span class="hs-identifier hs-var hs-var">lookupBasicOp</span></a></span></span><span> </span><span id="local-6989586621684362852"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362852"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362851"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362851"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Exp rep, Certs)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Exp rep, Certs)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupExp"><span class="hs-identifier hs-var">lookupExp</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362852"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362851"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span id="local-6989586621684362849"><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684362849"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684362848"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362848"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(BasicOp, Certs) -&gt; Maybe (BasicOp, Certs)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BasicOp
</span><a href="#local-6989586621684362849"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362848"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Exp rep, Certs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (BasicOp, Certs)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621684363237"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupType"><span class="hs-identifier hs-type">lookupType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363237"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363237"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-243"></span><span id="lookupType"><span class="annot"><span class="annottext">lookupType :: forall rep. ASTRep rep =&gt; VName -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupType"><span class="hs-identifier hs-var hs-var">lookupType</span></a></span></span><span> </span><span id="local-6989586621684362844"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362844"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362843"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362843"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Type
forall t. Typed t =&gt; t -&gt; Type
</span><a href="Futhark.IR.Prop.Types.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Type) -&gt; Maybe (Entry rep) -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362844"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362843"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621684363235"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupSubExpType"><span class="hs-identifier hs-type">lookupSubExpType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363235"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363235"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-246"></span><span id="lookupSubExpType"><span class="annot"><span class="annottext">lookupSubExpType :: forall rep. ASTRep rep =&gt; SubExp -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupSubExpType"><span class="hs-identifier hs-var hs-var">lookupSubExpType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684362838"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362838"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe Type
forall rep. ASTRep rep =&gt; VName -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362838"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupSubExpType"><span class="hs-identifier hs-var">lookupSubExpType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621684362836"><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684362836"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; SymbolTable rep -&gt; Maybe Type
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Type -&gt; SymbolTable rep -&gt; Maybe Type)
-&gt; Maybe Type -&gt; SymbolTable rep -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Maybe Type) -&gt; Type -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; Type
forall shape u. PrimType -&gt; TypeBase shape u
</span><a href="Futhark.IR.Syntax.Core.html#Prim"><span class="hs-identifier hs-var">Prim</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimType -&gt; Type) -&gt; PrimType -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimValue -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#primValueType"><span class="hs-identifier hs-var">primValueType</span></a></span><span> </span><span class="annot"><span class="annottext">PrimValue
</span><a href="#local-6989586621684362836"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span id="local-6989586621684363226"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupSubExp"><span class="hs-identifier hs-type">lookupSubExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363226"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Certs"><span class="hs-identifier hs-type">Certs</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span id="lookupSubExp"><span class="annot"><span class="annottext">lookupSubExp :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (SubExp, Certs)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupSubExp"><span class="hs-identifier hs-var hs-var">lookupSubExp</span></a></span></span><span> </span><span id="local-6989586621684362831"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362831"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362830"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362830"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621684362829"><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684362829"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684362828"><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362828"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Exp rep, Certs)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Exp rep, Certs)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupExp"><span class="hs-identifier hs-var">lookupExp</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362831"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362830"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp rep
</span><a href="#local-6989586621684362829"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span id="local-6989586621684362826"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362826"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(SubExp, Certs) -&gt; Maybe (SubExp, Certs)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362826"><span class="hs-identifier hs-var">se</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Certs
</span><a href="#local-6989586621684362828"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">Exp rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (SubExp, Certs)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621684363224"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupAliases"><span class="hs-identifier hs-type">lookupAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363224"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-257"></span><span id="lookupAliases"><span class="annot"><span class="annottext">lookupAliases :: forall rep. VName -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#lookupAliases"><span class="hs-identifier hs-var hs-var">lookupAliases</span></a></span></span><span> </span><span id="local-6989586621684362823"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362823"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362822"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362822"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">Names -&gt; (Entry rep -&gt; Names) -&gt; Maybe (Entry rep) -&gt; Names
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EntryType rep -&gt; Names
forall rep. EntryType rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(EntryType rep -&gt; Names)
-&gt; (Entry rep -&gt; EntryType rep) -&gt; Entry rep -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Entry rep) -&gt; Names) -&gt; Maybe (Entry rep) -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362823"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362822"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- | If the given variable name is the name of a 'ForLoop' parameter,</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- then return the bound of that loop.</span><span>
</span><span id="line-262"></span><span id="local-6989586621684363220"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupLoopVar"><span class="hs-identifier hs-type">lookupLoopVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363220"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span></span><span>
</span><span id="line-263"></span><span id="lookupLoopVar"><span class="annot"><span class="annottext">lookupLoopVar :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe SubExp
</span><a href="Futhark.Analysis.SymbolTable.html#lookupLoopVar"><span class="hs-identifier hs-var hs-var">lookupLoopVar</span></a></span></span><span> </span><span id="local-6989586621684362814"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362814"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362813"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362813"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LoopVar"><span class="hs-identifier hs-type">LoopVar</span></a></span><span> </span><span id="local-6989586621684362812"><span class="annot"><span class="annottext">LoopVarEntry rep
</span><a href="#local-6989586621684362812"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; EntryType rep)
-&gt; Maybe (Entry rep) -&gt; Maybe (EntryType rep)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362814"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362813"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">SubExp -&gt; Maybe SubExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Maybe SubExp) -&gt; SubExp -&gt; Maybe SubExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LoopVarEntry rep -&gt; SubExp
forall rep. LoopVarEntry rep -&gt; SubExp
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarBound"><span class="hs-identifier hs-var hs-var">loopVarBound</span></a></span><span> </span><span class="annot"><span class="annottext">LoopVarEntry rep
</span><a href="#local-6989586621684362812"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621684363216"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#lookupLoopParam"><span class="hs-identifier hs-type">lookupLoopParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363216"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-268"></span><span id="lookupLoopParam"><span class="annot"><span class="annottext">lookupLoopParam :: forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (SubExp, SubExp)
</span><a href="Futhark.Analysis.SymbolTable.html#lookupLoopParam"><span class="hs-identifier hs-var hs-var">lookupLoopParam</span></a></span></span><span> </span><span id="local-6989586621684362807"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362807"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362806"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362806"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-type">FParam</span></a></span><span> </span><span id="local-6989586621684362805"><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362805"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; EntryType rep)
-&gt; Maybe (Entry rep) -&gt; Maybe (EntryType rep)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362807"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362806"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; Maybe (SubExp, SubExp)
forall rep. FParamEntry rep -&gt; Maybe (SubExp, SubExp)
</span><a href="Futhark.Analysis.SymbolTable.html#fparamMerge"><span class="hs-identifier hs-var hs-var">fparamMerge</span></a></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362805"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | In symbol table and not consumed.</span><span>
</span><span id="line-273"></span><span id="local-6989586621684362804"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#available"><span class="hs-identifier hs-type">available</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684362804"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-274"></span><span id="available"><span class="annot"><span class="annottext">available :: forall rep. VName -&gt; SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#available"><span class="hs-identifier hs-var hs-var">available</span></a></span></span><span> </span><span id="local-6989586621684362802"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362802"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Entry rep -&gt; Bool) -&gt; Maybe (Entry rep) -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Entry rep -&gt; Bool) -&gt; Entry rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Bool
forall rep. Entry rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryConsumed"><span class="hs-identifier hs-var hs-var">entryConsumed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Entry rep) -&gt; Bool)
-&gt; (SymbolTable rep -&gt; Maybe (Entry rep))
-&gt; SymbolTable rep
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362802"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Maybe (Entry rep))
-&gt; (SymbolTable rep -&gt; Map VName (Entry rep))
-&gt; SymbolTable rep
-&gt; Maybe (Entry rep)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621684363213"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#index"><span class="hs-identifier hs-type">index</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363213"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363213"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span></span><span>
</span><span id="line-282"></span><span id="index"><span class="annot"><span class="annottext">index :: forall rep.
ASTRep rep =&gt;
VName -&gt; [SubExp] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span id="local-6989586621684362791"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362791"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362790"><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362790"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621684362789"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362789"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621684362788"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362788"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Maybe (TPrimExp Int64 VName))
-&gt; [SubExp] -&gt; Maybe [TPrimExp Int64 VName]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; Maybe (TPrimExp Int64 VName)
</span><a href="#local-6989586621684362786"><span class="hs-identifier hs-var">asPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362790"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
forall rep.
VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362791"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362788"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362789"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621684362786"><span class="annot"><span class="annottext">asPrimExp :: SubExp -&gt; Maybe (TPrimExp Int64 VName)
</span><a href="#local-6989586621684362786"><span class="hs-identifier hs-var hs-var">asPrimExp</span></a></span></span><span> </span><span id="local-6989586621684362785"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362785"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621684362784"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684362784"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; SymbolTable rep -&gt; Maybe Type
forall rep. ASTRep rep =&gt; SubExp -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupSubExpType"><span class="hs-identifier hs-var">lookupSubExpType</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362785"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362789"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">TPrimExp Int64 VName -&gt; Maybe (TPrimExp Int64 VName)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TPrimExp Int64 VName -&gt; Maybe (TPrimExp Int64 VName))
-&gt; TPrimExp Int64 VName -&gt; Maybe (TPrimExp Int64 VName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimExp VName -&gt; TPrimExp Int64 VName
forall t v. PrimExp v -&gt; TPrimExp t v
</span><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-var">TPrimExp</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimExp VName -&gt; TPrimExp Int64 VName)
-&gt; PrimExp VName -&gt; TPrimExp Int64 VName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; SubExp -&gt; PrimExp VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#primExpFromSubExp"><span class="hs-identifier hs-var">primExpFromSubExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684362784"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362785"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span id="local-6989586621684363207"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-type">index'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363207"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span></span><span>
</span><span id="line-295"></span><span id="index%27"><span class="annot"><span class="annottext">index' :: forall rep.
VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-var hs-var">index'</span></a></span></span><span> </span><span id="local-6989586621684362778"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362778"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362777"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362777"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span id="local-6989586621684362776"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362776"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621684362775"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362775"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
forall rep. VName -&gt; SymbolTable rep -&gt; Maybe (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362778"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362776"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362775"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-type">LetBound</span></a></span><span> </span><span id="local-6989586621684362774"><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362774"><span class="hs-identifier hs-var">entry'</span></a></span></span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684362773"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362773"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-300"></span><span>          </span><span class="annot"><span class="annottext">VName -&gt; [VName] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362778"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Maybe Int)
-&gt; (Stm rep -&gt; [VName]) -&gt; Stm rep -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; [VName])
-&gt; (Stm rep -&gt; PatT (LetDec rep)) -&gt; Stm rep -&gt; [VName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; PatT (LetDec rep)
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span> </span><span class="annot"><span class="annottext">(Stm rep -&gt; Maybe Int) -&gt; Stm rep -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-301"></span><span>            </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Stm rep
forall rep. LetBoundEntry rep -&gt; Stm rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundStm"><span class="hs-identifier hs-var hs-var">letBoundStm</span></a></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362774"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Int -&gt; IndexArray
forall rep. LetBoundEntry rep -&gt; Int -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundIndex"><span class="hs-identifier hs-var hs-var">letBoundIndex</span></a></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362774"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362773"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362777"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-type">FreeVar</span></a></span><span> </span><span id="local-6989586621684362770"><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362770"><span class="hs-identifier hs-var">entry'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; VName -&gt; IndexArray
forall rep. FreeVarEntry rep -&gt; VName -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarIndex"><span class="hs-identifier hs-var hs-var">freeVarIndex</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362770"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362778"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362777"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span id="local-6989586621684362769"><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362769"><span class="hs-identifier hs-var">entry'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; IndexArray
forall rep. LParamEntry rep -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#lparamIndex"><span class="hs-identifier hs-var hs-var">lparamIndex</span></a></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362769"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362777"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">EntryType rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-keyword">class</span><span> </span><span id="IndexOp"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-var">IndexOp</span></a></span></span><span> </span><span id="local-6989586621684363198"><span class="annot"><a href="#local-6989586621684363198"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621684363199"><span id="indexOp"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexOp"><span class="hs-identifier hs-type">indexOp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363199"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363199"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363199"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="#local-6989586621684363198"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.PrimExp.html#TPrimExp"><span class="hs-identifier hs-type">TPrimExp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-type">Indexed</span></a></span></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621684362766"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexOp"><span class="hs-identifier hs-var hs-var">indexOp</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">op
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621684362762"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621684363196"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-type">indexExp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363196"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363196"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363196"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Exp"><span class="hs-identifier hs-type">Exp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363196"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexArray"><span class="hs-identifier hs-type">IndexArray</span></a></span></span><span>
</span><span id="line-326"></span><span id="indexExp"><span class="annot"><span class="annottext">indexExp :: forall rep.
(IndexOp (Op rep), ASTRep rep) =&gt;
SymbolTable rep -&gt; Exp rep -&gt; Int -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var hs-var">indexExp</span></a></span></span><span> </span><span id="local-6989586621684362731"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362731"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span id="local-6989586621684362729"><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684362729"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684362728"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362728"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621684362727"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362727"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Int -&gt; Op rep -&gt; IndexArray
forall op rep.
(IndexOp op, ASTRep rep, IndexOp (Op rep)) =&gt;
SymbolTable rep -&gt; Int -&gt; op -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#indexOp"><span class="hs-identifier hs-var">indexOp</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362731"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362728"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Op rep
</span><a href="#local-6989586621684362729"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362727"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Iota"><span class="hs-identifier hs-type">Iota</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362725"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362725"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621684362724"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362724"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621684362723"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621684362722"><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362722"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">Indexed -&gt; Maybe Indexed
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Indexed -&gt; Maybe Indexed) -&gt; Indexed -&gt; Maybe Indexed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">Certs -&gt; PrimExp VName -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-var">Indexed</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp VName -&gt; Indexed) -&gt; PrimExp VName -&gt; Indexed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">IntType -&gt; PrimExp VName -&gt; PrimExp VName
forall v. IntType -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#sExt"><span class="hs-identifier hs-var">sExt</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 VName -&gt; PrimExp VName
forall t v. TPrimExp t v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#untyped"><span class="hs-identifier hs-var hs-var">untyped</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362722"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>          </span><span class="annot"><span class="annottext">PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
</span><a href="#local-6989586621684362719"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; SubExp -&gt; PrimExp VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#primExpFromSubExp"><span class="hs-identifier hs-var">primExpFromSubExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362724"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
</span><a href="#local-6989586621684362717"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; SubExp -&gt; PrimExp VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#primExpFromSubExp"><span class="hs-identifier hs-var">primExpFromSubExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; PrimType
</span><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362725"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621684362719"><span class="annot"><span class="annottext">mul :: PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
</span><a href="#local-6989586621684362719"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Mul"><span class="hs-identifier hs-var">Mul</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowWrap"><span class="hs-identifier hs-var">OverflowWrap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621684362717"><span class="annot"><span class="annottext">add :: PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
</span><a href="#local-6989586621684362717"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp -&gt; PrimExp VName -&gt; PrimExp VName -&gt; PrimExp VName
forall v. BinOp -&gt; PrimExp v -&gt; PrimExp v -&gt; PrimExp v
</span><a href="Futhark.Analysis.PrimExp.html#BinOpExp"><span class="hs-identifier hs-var">BinOpExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntType -&gt; Overflow -&gt; BinOp
</span><a href="Futhark.IR.Primitive.html#Add"><span class="hs-identifier hs-var">Add</span></a></span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362723"><span class="hs-identifier hs-var">to_it</span></a></span><span> </span><span class="annot"><span class="annottext">Overflow
</span><a href="Futhark.IR.Primitive.html#OverflowWrap"><span class="hs-identifier hs-var">OverflowWrap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span id="local-6989586621684362712"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362712"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Replicate"><span class="hs-identifier hs-type">Replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span id="local-6989586621684362709"><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362709"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684362708"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362708"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362707"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362707"><span class="hs-identifier hs-var">is</span></a></span></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[SubExp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362709"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362707"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span id="local-6989586621684362705"><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684362705"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; SymbolTable rep -&gt; Maybe Type
forall rep. ASTRep rep =&gt; SubExp -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupSubExpType"><span class="hs-identifier hs-var">lookupSubExpType</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362708"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362712"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">Indexed -&gt; Maybe Indexed
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Indexed -&gt; Maybe Indexed) -&gt; Indexed -&gt; Maybe Indexed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; PrimExp VName -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#Indexed"><span class="hs-identifier hs-var">Indexed</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(PrimExp VName -&gt; Indexed) -&gt; PrimExp VName -&gt; Indexed
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PrimType -&gt; SubExp -&gt; PrimExp VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#primExpFromSubExp"><span class="hs-identifier hs-var">primExpFromSubExp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimType
</span><a href="#local-6989586621684362705"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362708"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span id="local-6989586621684362704"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362704"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Replicate"><span class="hs-identifier hs-type">Replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621684362703"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362703"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621684362702"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362702"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362703"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Bool
forall rep. VName -&gt; SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#available"><span class="hs-operator hs-var">`available`</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362704"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
forall rep.
VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362703"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362702"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362704"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span id="local-6989586621684362701"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362701"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Reshape"><span class="hs-identifier hs-type">Reshape</span></a></span><span> </span><span id="local-6989586621684362699"><span class="annot"><span class="annottext">ShapeChange SubExp
</span><a href="#local-6989586621684362699"><span class="hs-identifier hs-var">newshape</span></a></span></span><span> </span><span id="local-6989586621684362698"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362698"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362697"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362697"><span class="hs-identifier hs-var">is</span></a></span></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684362696"><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362696"><span class="hs-identifier hs-var">oldshape</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; [SubExp]
forall u. TypeBase (ShapeBase SubExp) u -&gt; [SubExp]
</span><a href="Futhark.IR.Prop.Types.html#arrayDims"><span class="hs-identifier hs-var">arrayDims</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [SubExp]) -&gt; Maybe Type -&gt; Maybe [SubExp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Maybe Type
forall rep. ASTRep rep =&gt; VName -&gt; SymbolTable rep -&gt; Maybe Type
</span><a href="Futhark.Analysis.SymbolTable.html#lookupType"><span class="hs-identifier hs-var">lookupType</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362698"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362701"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684362694"><span class="annot"><span class="annottext">is' :: [TPrimExp Int64 VName]
</span><a href="#local-6989586621684362694"><span class="hs-identifier hs-var hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>          </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
-&gt; [TPrimExp Int64 VName]
-&gt; [TPrimExp Int64 VName]
-&gt; [TPrimExp Int64 VName]
forall num. IntegralExp num =&gt; [num] -&gt; [num] -&gt; [num] -&gt; [num]
</span><a href="Futhark.IR.Prop.Reshape.html#reshapeIndex"><span class="hs-identifier hs-var">reshapeIndex</span></a></span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SubExp -&gt; TPrimExp Int64 VName)
-&gt; [SubExp] -&gt; [TPrimExp Int64 VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; TPrimExp Int64 VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#pe64"><span class="hs-identifier hs-var">pe64</span></a></span><span> </span><span class="annot"><span class="annottext">[SubExp]
</span><a href="#local-6989586621684362696"><span class="hs-identifier hs-var">oldshape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SubExp -&gt; TPrimExp Int64 VName)
-&gt; [SubExp] -&gt; [TPrimExp Int64 VName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; TPrimExp Int64 VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#pe64"><span class="hs-identifier hs-var">pe64</span></a></span><span> </span><span class="annot"><span class="annottext">([SubExp] -&gt; [TPrimExp Int64 VName])
-&gt; [SubExp] -&gt; [TPrimExp Int64 VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShapeChange SubExp -&gt; [SubExp]
forall d. ShapeChange d -&gt; [d]
</span><a href="Futhark.IR.Prop.Reshape.html#newDims"><span class="hs-identifier hs-var">newDims</span></a></span><span> </span><span class="annot"><span class="annottext">ShapeChange SubExp
</span><a href="#local-6989586621684362699"><span class="hs-identifier hs-var">newshape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362697"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-352"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
forall rep.
VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362698"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362694"><span class="hs-identifier hs-var">is'</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362701"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span id="local-6989586621684362690"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362690"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#BasicOp"><span class="hs-identifier hs-type">BasicOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span id="local-6989586621684362688"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362688"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621684362687"><span class="annot"><span class="annottext">Slice SubExp
</span><a href="#local-6989586621684362687"><span class="hs-identifier hs-var">slice</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362686"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362686"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe ()) -&gt; Bool -&gt; Maybe ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362688"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Bool
forall rep. VName -&gt; SymbolTable rep -&gt; Bool
</span><a href="Futhark.Analysis.SymbolTable.html#available"><span class="hs-operator hs-var">`available`</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362690"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><span class="annottext">VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
forall rep.
VName -&gt; [TPrimExp Int64 VName] -&gt; SymbolTable rep -&gt; Maybe Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#index%27"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362688"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DimIndex SubExp]
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
</span><a href="#local-6989586621684362685"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slice SubExp -&gt; [DimIndex SubExp]
forall d. Slice d -&gt; [DimIndex d]
</span><a href="Futhark.IR.Syntax.Core.html#unSlice"><span class="hs-identifier hs-var hs-var">unSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Slice SubExp
</span><a href="#local-6989586621684362687"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362686"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362690"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621684362685"><span class="annot"><span class="annottext">adjust :: [DimIndex SubExp]
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
</span><a href="#local-6989586621684362685"><span class="hs-identifier hs-var hs-var">adjust</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#DimFix"><span class="hs-identifier hs-type">DimFix</span></a></span><span> </span><span id="local-6989586621684362676"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362676"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621684362675"><span class="annot"><span class="annottext">[DimIndex SubExp]
</span><a href="#local-6989586621684362675"><span class="hs-identifier hs-var">js'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684362674"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362674"><span class="hs-identifier hs-var">is'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><span class="annottext">SubExp -&gt; TPrimExp Int64 VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#pe64"><span class="hs-identifier hs-var">pe64</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362676"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DimIndex SubExp]
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
</span><a href="#local-6989586621684362685"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">[DimIndex SubExp]
</span><a href="#local-6989586621684362675"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362674"><span class="hs-identifier hs-var">is'</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="#local-6989586621684362685"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#DimSlice"><span class="hs-identifier hs-type">DimSlice</span></a></span><span> </span><span id="local-6989586621684362672"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362672"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362671"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362671"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621684362670"><span class="annot"><span class="annottext">[DimIndex SubExp]
</span><a href="#local-6989586621684362670"><span class="hs-identifier hs-var">js'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621684362669"><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362669"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621684362668"><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362668"><span class="hs-identifier hs-var">is'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684362667"><span class="annot"><span class="annottext">i_t_s :: TPrimExp Int64 VName
</span><a href="#local-6989586621684362667"><span class="hs-identifier hs-var hs-var">i_t_s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362669"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
-&gt; TPrimExp Int64 VName -&gt; TPrimExp Int64 VName
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; TPrimExp Int64 VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#pe64"><span class="hs-identifier hs-var">pe64</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362671"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-361"></span><span>          </span><span id="local-6989586621684362665"><span class="annot"><span class="annottext">j_p_i_t_s :: TPrimExp Int64 VName
</span><a href="#local-6989586621684362665"><span class="hs-identifier hs-var hs-var">j_p_i_t_s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; TPrimExp Int64 VName
</span><a href="Futhark.Analysis.PrimExp.Convert.html#pe64"><span class="hs-identifier hs-var">pe64</span></a></span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362672"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
-&gt; TPrimExp Int64 VName -&gt; TPrimExp Int64 VName
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362667"><span class="hs-identifier hs-var">i_t_s</span></a></span><span>
</span><span id="line-362"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
</span><a href="#local-6989586621684362665"><span class="hs-identifier hs-var">j_p_i_t_s</span></a></span><span> </span><span class="annot"><span class="annottext">TPrimExp Int64 VName
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DimIndex SubExp]
-&gt; [TPrimExp Int64 VName] -&gt; [TPrimExp Int64 VName]
</span><a href="#local-6989586621684362685"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">[DimIndex SubExp]
</span><a href="#local-6989586621684362670"><span class="hs-identifier hs-var">js'</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><a href="#local-6989586621684362668"><span class="hs-identifier hs-var">is'</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="#local-6989586621684362685"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">[DimIndex SubExp]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExpT rep
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span id="local-6989586621684363166"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#defBndEntry"><span class="hs-identifier hs-type">defBndEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#PatElem"><span class="hs-identifier hs-type">PatElem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-type">LetBoundEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363166"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-373"></span><span id="defBndEntry"><span class="annot"><span class="annottext">defBndEntry :: forall rep.
(ASTRep rep, IndexOp (Op rep)) =&gt;
SymbolTable rep
-&gt; PatElem rep -&gt; Names -&gt; Stm rep -&gt; LetBoundEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#defBndEntry"><span class="hs-identifier hs-var hs-var">defBndEntry</span></a></span></span><span> </span><span id="local-6989586621684362654"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362654"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span id="local-6989586621684362653"><span class="annot"><span class="annottext">PatElem rep
</span><a href="#local-6989586621684362653"><span class="hs-identifier hs-var">patElem</span></a></span></span><span> </span><span id="local-6989586621684362652"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362652"><span class="hs-identifier hs-var">als</span></a></span></span><span> </span><span id="local-6989586621684362651"><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362651"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="annottext">LetBoundEntry :: forall rep.
LetDec rep
-&gt; Names -&gt; Stm rep -&gt; (Int -&gt; IndexArray) -&gt; LetBoundEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-type">LetBoundEntry</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">letBoundDec :: LetDec rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundDec"><span class="hs-identifier hs-var">letBoundDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatElem rep -&gt; LetDec rep
forall dec. PatElemT dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#patElemDec"><span class="hs-identifier hs-var hs-var">patElemDec</span></a></span><span> </span><span class="annot"><span class="annottext">PatElem rep
</span><a href="#local-6989586621684362653"><span class="hs-identifier hs-var">patElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><span class="annottext">letBoundAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundAliases"><span class="hs-identifier hs-var">letBoundAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362652"><span class="hs-identifier hs-var">als</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">letBoundStm :: Stm rep
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundStm"><span class="hs-identifier hs-var">letBoundStm</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362651"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">letBoundIndex :: Int -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundIndex"><span class="hs-identifier hs-var">letBoundIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621684362649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362649"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">(Indexed -&gt; Indexed) -&gt; Maybe Indexed -&gt; Maybe Indexed
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Certs -&gt; Indexed -&gt; Indexed
</span><a href="Futhark.Analysis.SymbolTable.html#indexedAddCerts"><span class="hs-identifier hs-var">indexedAddCerts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StmAux (ExpDec rep) -&gt; Certs
forall dec. StmAux dec -&gt; Certs
</span><a href="Futhark.IR.Syntax.html#stmAuxCerts"><span class="hs-identifier hs-var hs-var">stmAuxCerts</span></a></span><span> </span><span class="annot"><span class="annottext">(StmAux (ExpDec rep) -&gt; Certs) -&gt; StmAux (ExpDec rep) -&gt; Certs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; StmAux (ExpDec rep)
forall rep. Stm rep -&gt; StmAux (ExpDec rep)
</span><a href="Futhark.IR.Syntax.html#stmAux"><span class="hs-identifier hs-var hs-var">stmAux</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362651"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>          </span><span class="annot"><span class="annottext">(Maybe Indexed -&gt; Maybe Indexed) -&gt; IndexArray -&gt; IndexArray
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Exp rep -&gt; Int -&gt; IndexArray
forall rep.
(IndexOp (Op rep), ASTRep rep) =&gt;
SymbolTable rep -&gt; Exp rep -&gt; Int -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#indexExp"><span class="hs-identifier hs-var">indexExp</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362654"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stm rep -&gt; Exp rep
forall rep. Stm rep -&gt; Exp rep
</span><a href="Futhark.IR.Syntax.html#stmExp"><span class="hs-identifier hs-var hs-var">stmExp</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362651"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621684362649"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621684363158"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#bindingEntries"><span class="hs-identifier hs-type">bindingEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliases.Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBoundEntry"><span class="hs-identifier hs-type">LetBoundEntry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363158"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-388"></span><span id="bindingEntries"><span class="annot"><span class="annottext">bindingEntries :: forall rep.
(ASTRep rep, Aliased rep, IndexOp (Op rep)) =&gt;
Stm rep -&gt; SymbolTable rep -&gt; [LetBoundEntry rep]
</span><a href="Futhark.Analysis.SymbolTable.html#bindingEntries"><span class="hs-identifier hs-var hs-var">bindingEntries</span></a></span></span><span> </span><span id="local-6989586621684362629"><span class="annot"><span class="annottext">stm :: Stm rep
</span><a href="#local-6989586621684362629"><span class="hs-identifier hs-var">stm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621684362627"><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684362627"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">StmAux (ExpDec rep)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp rep
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621684362626"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362626"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621684362625"><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684362625"><span class="hs-identifier hs-var">pat_elem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat rep -&gt; [PatElemT (LetDec rep)]
forall dec. PatT dec -&gt; [PatElemT dec]
</span><a href="Futhark.IR.Syntax.html#patElems"><span class="hs-identifier hs-var hs-var">patElems</span></a></span><span> </span><span class="annot"><span class="annottext">Pat rep
</span><a href="#local-6989586621684362627"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; [LetBoundEntry rep]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(LetBoundEntry rep -&gt; [LetBoundEntry rep])
-&gt; LetBoundEntry rep -&gt; [LetBoundEntry rep]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
-&gt; PatElemT (LetDec rep) -&gt; Names -&gt; Stm rep -&gt; LetBoundEntry rep
forall rep.
(ASTRep rep, IndexOp (Op rep)) =&gt;
SymbolTable rep
-&gt; PatElem rep -&gt; Names -&gt; Stm rep -&gt; LetBoundEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#defBndEntry"><span class="hs-identifier hs-var">defBndEntry</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362626"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684362625"><span class="hs-identifier hs-var">pat_elem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT (LetDec rep) -&gt; Names
forall a. AliasesOf a =&gt; a -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var">Aliases.aliasesOf</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT (LetDec rep)
</span><a href="#local-6989586621684362625"><span class="hs-identifier hs-var">pat_elem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362629"><span class="hs-identifier hs-var">stm</span></a></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span id="local-6989586621684363149"><span id="local-6989586621684363150"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#adjustSeveral"><span class="hs-identifier hs-type">adjustSeveral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621684363150"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621684363149"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621684363149"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621684363150"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621684363150"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363149"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621684363150"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363149"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-393"></span><span id="adjustSeveral"><span class="annot"><span class="annottext">adjustSeveral :: forall k v. Ord k =&gt; (v -&gt; v) -&gt; [k] -&gt; Map k v -&gt; Map k v
</span><a href="Futhark.Analysis.SymbolTable.html#adjustSeveral"><span class="hs-identifier hs-var hs-var">adjustSeveral</span></a></span></span><span> </span><span id="local-6989586621684362618"><span class="annot"><span class="annottext">v -&gt; v
</span><a href="#local-6989586621684362618"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map k v -&gt; [k] -&gt; Map k v) -&gt; [k] -&gt; Map k v -&gt; Map k v
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Map k v -&gt; [k] -&gt; Map k v) -&gt; [k] -&gt; Map k v -&gt; Map k v)
-&gt; (Map k v -&gt; [k] -&gt; Map k v) -&gt; [k] -&gt; Map k v -&gt; Map k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Map k v -&gt; k -&gt; Map k v) -&gt; Map k v -&gt; [k] -&gt; Map k v
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">((Map k v -&gt; k -&gt; Map k v) -&gt; Map k v -&gt; [k] -&gt; Map k v)
-&gt; (Map k v -&gt; k -&gt; Map k v) -&gt; Map k v -&gt; [k] -&gt; Map k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; k -&gt; Map k v
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; k -&gt; Map k v)
-&gt; (k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; k -&gt; Map k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v) -&gt; k -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.adjust</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; v
</span><a href="#local-6989586621684362618"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span id="local-6989586621684363139"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-type">insertEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363139"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#EntryType"><span class="hs-identifier hs-type">EntryType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363139"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363139"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363139"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-401"></span><span id="insertEntry"><span class="annot"><span class="annottext">insertEntry :: forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var hs-var">insertEntry</span></a></span></span><span> </span><span id="local-6989586621684362610"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362610"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362609"><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362609"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621684362608"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362608"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621684362607"><span class="annot"><span class="annottext">entry' :: Entry rep
</span><a href="#local-6989586621684362607"><span class="hs-identifier hs-var hs-var">entry'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="annottext">Entry :: forall rep.
Bool
-&gt; Int
-&gt; Bool
-&gt; Maybe (WithAccInput rep)
-&gt; EntryType rep
-&gt; Entry rep
</span><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">entryConsumed :: Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryConsumed"><span class="hs-identifier hs-var">entryConsumed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="annottext">entryDepth :: Int
</span><a href="Futhark.Analysis.SymbolTable.html#entryDepth"><span class="hs-identifier hs-var">entryDepth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Int
forall rep. SymbolTable rep -&gt; Int
</span><a href="Futhark.Analysis.SymbolTable.html#loopDepth"><span class="hs-identifier hs-var hs-var">loopDepth</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362608"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="annottext">entryIsSize :: Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryIsSize"><span class="hs-identifier hs-var">entryIsSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><span class="annottext">entryAccInput :: Maybe (WithAccInput rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryAccInput"><span class="hs-identifier hs-var">entryAccInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (WithAccInput rep)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><span class="annottext">entryType :: EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var">entryType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362609"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-409"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-410"></span><span>      </span><span id="local-6989586621684362606"><span class="annot"><span class="annottext">dims :: [VName]
</span><a href="#local-6989586621684362606"><span class="hs-identifier hs-var hs-var">dims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubExp -&gt; Maybe VName) -&gt; [SubExp] -&gt; [VName]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SubExp -&gt; Maybe VName
</span><a href="Futhark.IR.Prop.html#subExpVar"><span class="hs-identifier hs-var">subExpVar</span></a></span><span> </span><span class="annot"><span class="annottext">([SubExp] -&gt; [VName]) -&gt; [SubExp] -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [SubExp]
forall u. TypeBase (ShapeBase SubExp) u -&gt; [SubExp]
</span><a href="Futhark.IR.Prop.Types.html#arrayDims"><span class="hs-identifier hs-var">arrayDims</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; [SubExp]) -&gt; Type -&gt; [SubExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Type
forall t. Typed t =&gt; t -&gt; Type
</span><a href="Futhark.IR.Prop.Types.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362607"><span class="hs-identifier hs-var">entry'</span></a></span><span>
</span><span id="line-411"></span><span>      </span><span id="local-6989586621684362603"><span class="annot"><span class="annottext">isSize :: Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362603"><span class="hs-identifier hs-var hs-var">isSize</span></a></span></span><span> </span><span id="local-6989586621684362602"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362602"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362602"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">entryIsSize :: Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryIsSize"><span class="hs-identifier hs-var">entryIsSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-412"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362608"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-414"></span><span>            </span><span class="annot"><span class="annottext">(Entry rep -&gt; Entry rep)
-&gt; [VName] -&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall k v. Ord k =&gt; (v -&gt; v) -&gt; [k] -&gt; Map k v -&gt; Map k v
</span><a href="Futhark.Analysis.SymbolTable.html#adjustSeveral"><span class="hs-identifier hs-var">adjustSeveral</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Entry rep
forall {rep}. Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362603"><span class="hs-identifier hs-var">isSize</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684362606"><span class="hs-identifier hs-var">dims</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-415"></span><span>              </span><span class="annot"><span class="annottext">VName
-&gt; Entry rep -&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362610"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362607"><span class="hs-identifier hs-var">entry'</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362608"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span id="local-6989586621684363132"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertEntries"><span class="hs-identifier hs-type">insertEntries</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363132"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#EntryType"><span class="hs-identifier hs-type">EntryType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363132"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363132"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363132"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-423"></span><span id="insertEntries"><span class="annot"><span class="annottext">insertEntries :: forall rep.
ASTRep rep =&gt;
[(VName, EntryType rep)] -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntries"><span class="hs-identifier hs-var hs-var">insertEntries</span></a></span></span><span> </span><span id="local-6989586621684362596"><span class="annot"><span class="annottext">[(VName, EntryType rep)]
</span><a href="#local-6989586621684362596"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span id="local-6989586621684362595"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362595"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; (VName, EntryType rep) -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [(VName, EntryType rep)] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; (VName, EntryType rep) -&gt; SymbolTable rep
forall {rep}.
ASTRep rep =&gt;
SymbolTable rep -&gt; (VName, EntryType rep) -&gt; SymbolTable rep
</span><a href="#local-6989586621684362594"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362595"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">[(VName, EntryType rep)]
</span><a href="#local-6989586621684362596"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621684362594"><span class="annot"><span class="annottext">add :: SymbolTable rep -&gt; (VName, EntryType rep) -&gt; SymbolTable rep
</span><a href="#local-6989586621684362594"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621684362591"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362591"><span class="hs-identifier hs-var">vtable'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684362590"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362590"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684362589"><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362589"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362590"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362589"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362591"><span class="hs-identifier hs-var">vtable'</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span id="local-6989586621684363129"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertStm"><span class="hs-identifier hs-type">insertStm</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliases.Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stm"><span class="hs-identifier hs-type">Stm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363129"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-433"></span><span id="insertStm"><span class="annot"><span class="annottext">insertStm :: forall rep.
(ASTRep rep, IndexOp (Op rep), Aliased rep) =&gt;
Stm rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertStm"><span class="hs-identifier hs-var hs-var">insertStm</span></a></span></span><span> </span><span id="local-6989586621684362572"><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362572"><span class="hs-identifier hs-var">stm</span></a></span></span><span> </span><span id="local-6989586621684362571"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362571"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-434"></span><span>  </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; [VName] -&gt; SymbolTable rep)
-&gt; [VName] -&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; VName -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [VName] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">((SymbolTable rep -&gt; VName -&gt; SymbolTable rep)
 -&gt; SymbolTable rep -&gt; [VName] -&gt; SymbolTable rep)
-&gt; (SymbolTable rep -&gt; VName -&gt; SymbolTable rep)
-&gt; SymbolTable rep
-&gt; [VName]
-&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; VName -&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep. VName -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#consume"><span class="hs-identifier hs-var">consume</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362569"><span class="hs-identifier hs-var">stm_consumed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; [PatElemT (LetDec rep)] -&gt; SymbolTable rep)
-&gt; [PatElemT (LetDec rep)] -&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; PatElemT (LetDec rep) -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [PatElemT (LetDec rep)] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; PatElemT (LetDec rep) -&gt; SymbolTable rep
forall {dec} {rep}.
AliasesOf dec =&gt;
SymbolTable rep -&gt; PatElemT dec -&gt; SymbolTable rep
</span><a href="#local-6989586621684362568"><span class="hs-identifier hs-var">addRevAliases</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; [PatElemT (LetDec rep)]
forall dec. PatT dec -&gt; [PatElemT dec]
</span><a href="Futhark.IR.Syntax.html#patElems"><span class="hs-identifier hs-var hs-var">patElems</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; [PatElemT (LetDec rep)])
-&gt; PatT (LetDec rep) -&gt; [PatElemT (LetDec rep)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; PatT (LetDec rep)
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362572"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><span class="annottext">[(VName, EntryType rep)] -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
[(VName, EntryType rep)] -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntries"><span class="hs-identifier hs-var">insertEntries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VName] -&gt; [EntryType rep] -&gt; [(VName, EntryType rep)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684362567"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">([EntryType rep] -&gt; [(VName, EntryType rep)])
-&gt; [EntryType rep] -&gt; [(VName, EntryType rep)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(LetBoundEntry rep -&gt; EntryType rep)
-&gt; [LetBoundEntry rep] -&gt; [EntryType rep]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; EntryType rep
forall rep. LetBoundEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-var">LetBound</span></a></span><span> </span><span class="annot"><span class="annottext">([LetBoundEntry rep] -&gt; [EntryType rep])
-&gt; [LetBoundEntry rep] -&gt; [EntryType rep]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; SymbolTable rep -&gt; [LetBoundEntry rep]
forall rep.
(ASTRep rep, Aliased rep, IndexOp (Op rep)) =&gt;
Stm rep -&gt; SymbolTable rep -&gt; [LetBoundEntry rep]
</span><a href="Futhark.Analysis.SymbolTable.html#bindingEntries"><span class="hs-identifier hs-var">bindingEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362572"><span class="hs-identifier hs-var">stm</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362571"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362571"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621684362567"><span class="annot"><span class="annottext">names :: [VName]
</span><a href="#local-6989586621684362567"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatT (LetDec rep) -&gt; [VName]
forall dec. PatT dec -&gt; [VName]
</span><a href="Futhark.IR.Prop.Patterns.html#patNames"><span class="hs-identifier hs-var">patNames</span></a></span><span> </span><span class="annot"><span class="annottext">(PatT (LetDec rep) -&gt; [VName]) -&gt; PatT (LetDec rep) -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; PatT (LetDec rep)
forall rep. Stm rep -&gt; Pat rep
</span><a href="Futhark.IR.Syntax.html#stmPat"><span class="hs-identifier hs-var hs-var">stmPat</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362572"><span class="hs-identifier hs-var">stm</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span id="local-6989586621684362569"><span class="annot"><span class="annottext">stm_consumed :: Names
</span><a href="#local-6989586621684362569"><span class="hs-identifier hs-var hs-var">stm_consumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; SymbolTable rep -&gt; Names
forall rep. Names -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#expandAliases"><span class="hs-identifier hs-var">expandAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stm rep -&gt; Names
forall rep. Aliased rep =&gt; Stm rep -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#consumedInStm"><span class="hs-identifier hs-var">Aliases.consumedInStm</span></a></span><span> </span><span class="annot"><span class="annottext">Stm rep
</span><a href="#local-6989586621684362572"><span class="hs-identifier hs-var">stm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362571"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span id="local-6989586621684362568"><span class="annot"><span class="annottext">addRevAliases :: SymbolTable rep -&gt; PatElemT dec -&gt; SymbolTable rep
</span><a href="#local-6989586621684362568"><span class="hs-identifier hs-var hs-var">addRevAliases</span></a></span></span><span> </span><span id="local-6989586621684362556"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362556"><span class="hs-identifier hs-var">vtable'</span></a></span></span><span> </span><span id="local-6989586621684362555"><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>      </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362556"><span class="hs-identifier hs-var">vtable'</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Entry rep)
-&gt; [VName] -&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall k v. Ord k =&gt; (v -&gt; v) -&gt; [k] -&gt; Map k v -&gt; Map k v
</span><a href="Futhark.Analysis.SymbolTable.html#adjustSeveral"><span class="hs-identifier hs-var">adjustSeveral</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362554"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">[VName]
</span><a href="#local-6989586621684362553"><span class="hs-identifier hs-var">inedges</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362556"><span class="hs-identifier hs-var">vtable'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-442"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>        </span><span id="local-6989586621684362553"><span class="annot"><span class="annottext">inedges :: [VName]
</span><a href="#local-6989586621684362553"><span class="hs-identifier hs-var hs-var">inedges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; [VName]) -&gt; Names -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; SymbolTable rep -&gt; Names
forall rep. Names -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#expandAliases"><span class="hs-identifier hs-var">expandAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT dec -&gt; Names
forall a. AliasesOf a =&gt; a -&gt; Names
</span><a href="Futhark.IR.Prop.Aliases.html#aliasesOf"><span class="hs-identifier hs-var">Aliases.aliasesOf</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362556"><span class="hs-identifier hs-var">vtable'</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span id="local-6989586621684362554"><span class="annot"><span class="annottext">update :: Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362554"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621684362552"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362552"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362552"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">entryType :: EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var">entryType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntryType rep -&gt; EntryType rep
</span><a href="#local-6989586621684362551"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">(EntryType rep -&gt; EntryType rep) -&gt; EntryType rep -&gt; EntryType rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362552"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-445"></span><span>        </span><span id="local-6989586621684362551"><span class="annot"><span class="annottext">update' :: EntryType rep -&gt; EntryType rep
</span><a href="#local-6989586621684362551"><span class="hs-identifier hs-var hs-var">update'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-type">LetBound</span></a></span><span> </span><span id="local-6989586621684362550"><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362550"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>          </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; EntryType rep
forall rep. LetBoundEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#LetBound"><span class="hs-identifier hs-var">LetBound</span></a></span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362550"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-448"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">letBoundAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundAliases"><span class="hs-identifier hs-var">letBoundAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT dec -&gt; VName
forall dec. PatElemT dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#patElemName"><span class="hs-identifier hs-var hs-var">patElemName</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep -&gt; Names
forall rep. LetBoundEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#letBoundAliases"><span class="hs-identifier hs-var hs-var">letBoundAliases</span></a></span><span> </span><span class="annot"><span class="annottext">LetBoundEntry rep
</span><a href="#local-6989586621684362550"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-449"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><a href="#local-6989586621684362551"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-type">FParam</span></a></span><span> </span><span id="local-6989586621684362547"><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362547"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>          </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; EntryType rep
forall rep. FParamEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-var">FParam</span></a></span><span>
</span><span id="line-452"></span><span>            </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362547"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-453"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fparamAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var">fparamAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT dec -&gt; VName
forall dec. PatElemT dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#patElemName"><span class="hs-identifier hs-var hs-var">patElemName</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; Names
forall rep. FParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var hs-var">fparamAliases</span></a></span><span> </span><span class="annot"><span class="annottext">FParamEntry rep
</span><a href="#local-6989586621684362547"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-454"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><a href="#local-6989586621684362551"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span id="local-6989586621684362546"><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362546"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-456"></span><span>          </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; EntryType rep
forall rep. LParamEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-var">LParam</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362546"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-458"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lparamAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#lparamAliases"><span class="hs-identifier hs-var">lparamAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT dec -&gt; VName
forall dec. PatElemT dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#patElemName"><span class="hs-identifier hs-var hs-var">patElemName</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; Names
forall rep. LParamEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#lparamAliases"><span class="hs-identifier hs-var hs-var">lparamAliases</span></a></span><span> </span><span class="annot"><span class="annottext">LParamEntry rep
</span><a href="#local-6989586621684362546"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-459"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-460"></span><span>        </span><span class="annot"><a href="#local-6989586621684362551"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-type">FreeVar</span></a></span><span> </span><span id="local-6989586621684362545"><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362545"><span class="hs-identifier hs-var">entry</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>          </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; EntryType rep
forall rep. FreeVarEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-var">FreeVar</span></a></span><span>
</span><span id="line-462"></span><span>            </span><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362545"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-463"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">freeVarAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var">freeVarAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatElemT dec -&gt; VName
forall dec. PatElemT dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#patElemName"><span class="hs-identifier hs-var hs-var">patElemName</span></a></span><span> </span><span class="annot"><span class="annottext">PatElemT dec
</span><a href="#local-6989586621684362555"><span class="hs-identifier hs-var">pe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; Names
forall rep. FreeVarEntry rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var hs-var">freeVarAliases</span></a></span><span> </span><span class="annot"><span class="annottext">FreeVarEntry rep
</span><a href="#local-6989586621684362545"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-464"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-465"></span><span>        </span><span class="annot"><a href="#local-6989586621684362551"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span id="local-6989586621684362544"><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362544"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362544"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span id="local-6989586621684363119"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertStms"><span class="hs-identifier hs-type">insertStms</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#IndexOp"><span class="hs-identifier hs-type">IndexOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Rep.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Aliases.html#Aliased"><span class="hs-identifier hs-type">Aliases.Aliased</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#Stms"><span class="hs-identifier hs-type">Stms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363119"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-472"></span><span id="insertStms"><span class="annot"><span class="annottext">insertStms :: forall rep.
(ASTRep rep, IndexOp (Op rep), Aliased rep) =&gt;
Stms rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertStms"><span class="hs-identifier hs-var hs-var">insertStms</span></a></span></span><span> </span><span id="local-6989586621684362534"><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684362534"><span class="hs-identifier hs-var">stms</span></a></span></span><span> </span><span id="local-6989586621684362533"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362533"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; Stm rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [Stm rep] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Stm rep -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; Stm rep -&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
(ASTRep rep, IndexOp (Op rep), Aliased rep) =&gt;
Stm rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertStm"><span class="hs-identifier hs-var">insertStm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362533"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">([Stm rep] -&gt; SymbolTable rep) -&gt; [Stm rep] -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stms rep -&gt; [Stm rep]
forall rep. Stms rep -&gt; [Stm rep]
</span><a href="Futhark.IR.Syntax.html#stmsToList"><span class="hs-identifier hs-var">stmsToList</span></a></span><span> </span><span class="annot"><span class="annottext">Stms rep
</span><a href="#local-6989586621684362534"><span class="hs-identifier hs-var">stms</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span id="local-6989586621684363121"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#expandAliases"><span class="hs-identifier hs-type">expandAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363121"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span></span><span>
</span><span id="line-475"></span><span id="expandAliases"><span class="annot"><span class="annottext">expandAliases :: forall rep. Names -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#expandAliases"><span class="hs-identifier hs-var hs-var">expandAliases</span></a></span></span><span> </span><span id="local-6989586621684362529"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362529"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621684362528"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362528"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362529"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Names -&gt; Names -&gt; Names
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362527"><span class="hs-identifier hs-var">aliasesOfAliases</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621684362527"><span class="annot"><span class="annottext">aliasesOfAliases :: Names
</span><a href="#local-6989586621684362527"><span class="hs-identifier hs-var hs-var">aliasesOfAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><span class="annottext">[Names] -&gt; Names
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Names] -&gt; Names) -&gt; (Names -&gt; [Names]) -&gt; Names -&gt; Names
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Names) -&gt; [VName] -&gt; [Names]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; SymbolTable rep -&gt; Names
forall rep. VName -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#lookupAliases"><span class="hs-operator hs-var">`lookupAliases`</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362528"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; [Names]) -&gt; (Names -&gt; [VName]) -&gt; Names -&gt; [Names]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; Names) -&gt; Names -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362529"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span id="local-6989586621684363114"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertFParam"><span class="hs-identifier hs-type">insertFParam</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363114"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-482"></span><span>  </span><span class="annot"><a href="Futhark.IR.Syntax.html#FParam"><span class="hs-identifier hs-type">AST.FParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363114"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363114"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363114"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-485"></span><span id="insertFParam"><span class="annot"><span class="annottext">insertFParam :: forall rep.
ASTRep rep =&gt;
FParam rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertFParam"><span class="hs-identifier hs-var hs-var">insertFParam</span></a></span></span><span> </span><span id="local-6989586621684362521"><span class="annot"><span class="annottext">FParam rep
</span><a href="#local-6989586621684362521"><span class="hs-identifier hs-var">fparam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362520"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362519"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621684362520"><span class="annot"><span class="annottext">name :: VName
</span><a href="#local-6989586621684362520"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">AST.paramName</span></a></span><span> </span><span class="annot"><span class="annottext">FParam rep
</span><a href="#local-6989586621684362521"><span class="hs-identifier hs-var">fparam</span></a></span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621684362519"><span class="annot"><span class="annottext">entry :: EntryType rep
</span><a href="#local-6989586621684362519"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; EntryType rep
forall rep. FParamEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-var">FParam</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><span class="annottext">FParamEntry :: forall rep.
FParamInfo rep
-&gt; Names -&gt; Maybe (SubExp, SubExp) -&gt; FParamEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#FParamEntry"><span class="hs-identifier hs-type">FParamEntry</span></a></span><span>
</span><span id="line-491"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fparamDec :: FParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#fparamDec"><span class="hs-identifier hs-var">fparamDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; FParamInfo rep
forall dec. Param dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#paramDec"><span class="hs-identifier hs-var hs-var">AST.paramDec</span></a></span><span> </span><span class="annot"><span class="annottext">FParam rep
</span><a href="#local-6989586621684362521"><span class="hs-identifier hs-var">fparam</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-492"></span><span>            </span><span class="annot"><span class="annottext">fparamAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var">fparamAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span>
</span><span id="line-493"></span><span>            </span><span class="annot"><span class="annottext">fparamMerge :: Maybe (SubExp, SubExp)
</span><a href="Futhark.Analysis.SymbolTable.html#fparamMerge"><span class="hs-identifier hs-var">fparamMerge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SubExp, SubExp)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-494"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621684363109"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertFParams"><span class="hs-identifier hs-type">insertFParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363109"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Futhark.IR.Syntax.html#FParam"><span class="hs-identifier hs-type">AST.FParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363109"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-499"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363109"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363109"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-501"></span><span id="insertFParams"><span class="annot"><span class="annottext">insertFParams :: forall rep.
ASTRep rep =&gt;
[FParam rep] -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertFParams"><span class="hs-identifier hs-var hs-var">insertFParams</span></a></span></span><span> </span><span id="local-6989586621684362512"><span class="annot"><span class="annottext">[FParam rep]
</span><a href="#local-6989586621684362512"><span class="hs-identifier hs-var">fparams</span></a></span></span><span> </span><span id="local-6989586621684362511"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362511"><span class="hs-identifier hs-var">symtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; FParam rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [FParam rep] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FParam rep -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; FParam rep -&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">FParam rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
FParam rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertFParam"><span class="hs-identifier hs-var">insertFParam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362511"><span class="hs-identifier hs-var">symtable</span></a></span><span> </span><span class="annot"><span class="annottext">[FParam rep]
</span><a href="#local-6989586621684362512"><span class="hs-identifier hs-var">fparams</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span id="local-6989586621684363107"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLParam"><span class="hs-identifier hs-type">insertLParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363107"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#LParam"><span class="hs-identifier hs-type">LParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363107"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363107"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363107"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-504"></span><span id="insertLParam"><span class="annot"><span class="annottext">insertLParam :: forall rep.
ASTRep rep =&gt;
LParam rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertLParam"><span class="hs-identifier hs-var hs-var">insertLParam</span></a></span></span><span> </span><span id="local-6989586621684362506"><span class="annot"><span class="annottext">LParam rep
</span><a href="#local-6989586621684362506"><span class="hs-identifier hs-var">param</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362505"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362504"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621684362504"><span class="annot"><span class="annottext">bind :: EntryType rep
</span><a href="#local-6989586621684362504"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>      </span><span class="annot"><span class="annottext">LParamEntry rep -&gt; EntryType rep
forall rep. LParamEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#LParam"><span class="hs-identifier hs-var">LParam</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">LParamEntry :: forall rep.
LParamInfo rep -&gt; Names -&gt; IndexArray -&gt; LParamEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#LParamEntry"><span class="hs-identifier hs-type">LParamEntry</span></a></span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">lparamDec :: LParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#lparamDec"><span class="hs-identifier hs-var">lparamDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LParam rep -&gt; LParamInfo rep
forall dec. Param dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#paramDec"><span class="hs-identifier hs-var hs-var">AST.paramDec</span></a></span><span> </span><span class="annot"><span class="annottext">LParam rep
</span><a href="#local-6989586621684362506"><span class="hs-identifier hs-var">param</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-510"></span><span>            </span><span class="annot"><span class="annottext">lparamAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#lparamAliases"><span class="hs-identifier hs-var">lparamAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span>
</span><span id="line-511"></span><span>            </span><span class="annot"><span class="annottext">lparamIndex :: IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#lparamIndex"><span class="hs-identifier hs-var">lparamIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed -&gt; IndexArray
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-512"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621684362505"><span class="annot"><span class="annottext">name :: VName
</span><a href="#local-6989586621684362505"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LParam rep -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">AST.paramName</span></a></span><span> </span><span class="annot"><span class="annottext">LParam rep
</span><a href="#local-6989586621684362506"><span class="hs-identifier hs-var">param</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | Insert entries corresponding to the parameters of a loop (not</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- distinguishing contect and value part).  Apart from the parameter</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- itself, we also insert the initial value and the subexpression</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- providing the final value.  Note that the latter is likely not in</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- scope in the symbol at this point.  This is OK, and can still be</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- used to help some loop optimisations detect invariant loop</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- parameters.</span><span>
</span><span id="line-522"></span><span id="local-6989586621684363104"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLoopMerge"><span class="hs-identifier hs-type">insertLoopMerge</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363104"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Futhark.IR.Syntax.html#FParam"><span class="hs-identifier hs-type">AST.FParam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363104"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExpRes"><span class="hs-identifier hs-type">SubExpRes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363104"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363104"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-527"></span><span id="insertLoopMerge"><span class="annot"><span class="annottext">insertLoopMerge :: forall rep.
ASTRep rep =&gt;
[(FParam rep, SubExp, SubExpRes)]
-&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertLoopMerge"><span class="hs-identifier hs-var hs-var">insertLoopMerge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep
 -&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
 -&gt; SymbolTable rep)
-&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
-&gt; SymbolTable rep
-&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((SymbolTable rep
  -&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
  -&gt; SymbolTable rep)
 -&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
 -&gt; SymbolTable rep
 -&gt; SymbolTable rep)
-&gt; (SymbolTable rep
    -&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
    -&gt; SymbolTable rep)
-&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
-&gt; SymbolTable rep
-&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep
 -&gt; (Param (FParamInfo rep), SubExp, SubExpRes) -&gt; SymbolTable rep)
-&gt; SymbolTable rep
-&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
-&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">((SymbolTable rep
  -&gt; (Param (FParamInfo rep), SubExp, SubExpRes) -&gt; SymbolTable rep)
 -&gt; SymbolTable rep
 -&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
 -&gt; SymbolTable rep)
-&gt; (SymbolTable rep
    -&gt; (Param (FParamInfo rep), SubExp, SubExpRes) -&gt; SymbolTable rep)
-&gt; SymbolTable rep
-&gt; [(Param (FParamInfo rep), SubExp, SubExpRes)]
-&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Param (FParamInfo rep), SubExp, SubExpRes)
 -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; SymbolTable rep
-&gt; (Param (FParamInfo rep), SubExp, SubExpRes)
-&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Param (FParamInfo rep), SubExp, SubExpRes)
-&gt; SymbolTable rep -&gt; SymbolTable rep
forall {rep}.
ASTRep rep =&gt;
(Param (FParamInfo rep), SubExp, SubExpRes)
-&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="#local-6989586621684362499"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621684362499"><span class="annot"><span class="annottext">bind :: (Param (FParamInfo rep), SubExp, SubExpRes)
-&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="#local-6989586621684362499"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684362495"><span class="annot"><span class="annottext">Param (FParamInfo rep)
</span><a href="#local-6989586621684362495"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684362494"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362494"><span class="hs-identifier hs-var">initial</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#SubExpRes"><span class="hs-identifier hs-type">SubExpRes</span></a></span><span> </span><span class="annot"><span class="annottext">Certs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621684362492"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362492"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Param (FParamInfo rep) -&gt; VName
forall dec. Param dec -&gt; VName
</span><a href="Futhark.IR.Syntax.Core.html#paramName"><span class="hs-identifier hs-var hs-var">paramName</span></a></span><span> </span><span class="annot"><span class="annottext">Param (FParamInfo rep)
</span><a href="#local-6989586621684362495"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">FParamEntry rep -&gt; EntryType rep
forall rep. FParamEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FParam"><span class="hs-identifier hs-var">FParam</span></a></span><span>
</span><span id="line-532"></span><span>          </span><span class="annot"><span class="annottext">FParamEntry :: forall rep.
FParamInfo rep
-&gt; Names -&gt; Maybe (SubExp, SubExp) -&gt; FParamEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#FParamEntry"><span class="hs-identifier hs-type">FParamEntry</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fparamDec :: FParamInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#fparamDec"><span class="hs-identifier hs-var">fparamDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Param (FParamInfo rep) -&gt; FParamInfo rep
forall dec. Param dec -&gt; dec
</span><a href="Futhark.IR.Syntax.Core.html#paramDec"><span class="hs-identifier hs-var hs-var">AST.paramDec</span></a></span><span> </span><span class="annot"><span class="annottext">Param (FParamInfo rep)
</span><a href="#local-6989586621684362495"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-534"></span><span>              </span><span class="annot"><span class="annottext">fparamAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#fparamAliases"><span class="hs-identifier hs-var">fparamAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span>
</span><span id="line-535"></span><span>              </span><span class="annot"><span class="annottext">fparamMerge :: Maybe (SubExp, SubExp)
</span><a href="Futhark.Analysis.SymbolTable.html#fparamMerge"><span class="hs-identifier hs-var">fparamMerge</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubExp, SubExp) -&gt; Maybe (SubExp, SubExp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362494"><span class="hs-identifier hs-var">initial</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362492"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span id="local-6989586621684363100"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertLoopVar"><span class="hs-identifier hs-type">insertLoopVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363100"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Primitive.html#IntType"><span class="hs-identifier hs-type">IntType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.Core.html#SubExp"><span class="hs-identifier hs-type">SubExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363100"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363100"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-539"></span><span id="insertLoopVar"><span class="annot"><span class="annottext">insertLoopVar :: forall rep.
ASTRep rep =&gt;
VName -&gt; IntType -&gt; SubExp -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertLoopVar"><span class="hs-identifier hs-var hs-var">insertLoopVar</span></a></span></span><span> </span><span id="local-6989586621684362489"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362489"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362488"><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362488"><span class="hs-identifier hs-var">it</span></a></span></span><span> </span><span id="local-6989586621684362487"><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362487"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362489"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362486"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621684362486"><span class="annot"><span class="annottext">bind :: EntryType rep
</span><a href="#local-6989586621684362486"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><span class="annottext">LoopVarEntry rep -&gt; EntryType rep
forall rep. LoopVarEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#LoopVar"><span class="hs-identifier hs-var">LoopVar</span></a></span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="annottext">LoopVarEntry :: forall rep. IntType -&gt; SubExp -&gt; LoopVarEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#LoopVarEntry"><span class="hs-identifier hs-type">LoopVarEntry</span></a></span><span>
</span><span id="line-544"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">loopVarType :: IntType
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarType"><span class="hs-identifier hs-var">loopVarType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntType
</span><a href="#local-6989586621684362488"><span class="hs-identifier hs-var">it</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-545"></span><span>            </span><span class="annot"><span class="annottext">loopVarBound :: SubExp
</span><a href="Futhark.Analysis.SymbolTable.html#loopVarBound"><span class="hs-identifier hs-var">loopVarBound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SubExp
</span><a href="#local-6989586621684362487"><span class="hs-identifier hs-var">bound</span></a></span><span>
</span><span id="line-546"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span id="local-6989586621684363359"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#insertFreeVar"><span class="hs-identifier hs-type">insertFreeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.html#ASTRep"><span class="hs-identifier hs-type">ASTRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363359"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Scope.html#NameInfo"><span class="hs-identifier hs-type">NameInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363359"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363359"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363359"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-549"></span><span id="insertFreeVar"><span class="annot"><span class="annottext">insertFreeVar :: forall rep.
ASTRep rep =&gt;
VName -&gt; NameInfo rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertFreeVar"><span class="hs-identifier hs-var hs-var">insertFreeVar</span></a></span></span><span> </span><span id="local-6989586621684362482"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362482"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621684362481"><span class="annot"><span class="annottext">NameInfo rep
</span><a href="#local-6989586621684362481"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
ASTRep rep =&gt;
VName -&gt; EntryType rep -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#insertEntry"><span class="hs-identifier hs-var">insertEntry</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362482"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EntryType rep
</span><a href="#local-6989586621684362480"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621684362480"><span class="annot"><span class="annottext">entry :: EntryType rep
</span><a href="#local-6989586621684362480"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-552"></span><span>      </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; EntryType rep
forall rep. FreeVarEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-var">FreeVar</span></a></span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><span class="annottext">FreeVarEntry :: forall rep.
NameInfo rep -&gt; Names -&gt; (VName -&gt; IndexArray) -&gt; FreeVarEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#FreeVarEntry"><span class="hs-identifier hs-type">FreeVarEntry</span></a></span><span>
</span><span id="line-554"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">freeVarDec :: NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarDec"><span class="hs-identifier hs-var">freeVarDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameInfo rep
</span><a href="#local-6989586621684362481"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-555"></span><span>            </span><span class="annot"><span class="annottext">freeVarIndex :: VName -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarIndex"><span class="hs-identifier hs-var">freeVarIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-556"></span><span>            </span><span class="annot"><span class="annottext">freeVarAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var">freeVarAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Names
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-557"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span id="local-6989586621684363127"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#consume"><span class="hs-identifier hs-type">consume</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363127"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363127"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-560"></span><span id="consume"><span class="annot"><span class="annottext">consume :: forall rep. VName -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#consume"><span class="hs-identifier hs-var hs-var">consume</span></a></span></span><span> </span><span id="local-6989586621684362478"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362478"><span class="hs-identifier hs-var">consumee</span></a></span></span><span> </span><span id="local-6989586621684362477"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362477"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; VName -&gt; SymbolTable rep)
-&gt; SymbolTable rep -&gt; [VName] -&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; VName -&gt; SymbolTable rep
forall {rep}. SymbolTable rep -&gt; VName -&gt; SymbolTable rep
</span><a href="#local-6989586621684362476"><span class="hs-identifier hs-var">consume'</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362477"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; SymbolTable rep) -&gt; [VName] -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><span class="annottext">Names -&gt; [VName]
</span><a href="Futhark.IR.Prop.Names.html#namesToList"><span class="hs-identifier hs-var">namesToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Names -&gt; [VName]) -&gt; Names -&gt; [VName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-563"></span><span>      </span><span class="annot"><span class="annottext">Names -&gt; SymbolTable rep -&gt; Names
forall rep. Names -&gt; SymbolTable rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#expandAliases"><span class="hs-identifier hs-var">expandAliases</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Names
</span><a href="Futhark.IR.Prop.Names.html#oneName"><span class="hs-identifier hs-var">oneName</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362478"><span class="hs-identifier hs-var">consumee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362477"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-565"></span><span>    </span><span id="local-6989586621684362476"><span class="annot"><span class="annottext">consume' :: SymbolTable rep -&gt; VName -&gt; SymbolTable rep
</span><a href="#local-6989586621684362476"><span class="hs-identifier hs-var hs-var">consume'</span></a></span></span><span> </span><span id="local-6989586621684362474"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362474"><span class="hs-identifier hs-var">vtable'</span></a></span></span><span> </span><span id="local-6989586621684362473"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362473"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-566"></span><span>      </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362474"><span class="hs-identifier hs-var">vtable'</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Entry rep)
-&gt; VName -&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.adjust</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Entry rep
forall {rep}. Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362472"><span class="hs-identifier hs-var">consume''</span></a></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362473"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362474"><span class="hs-identifier hs-var">vtable'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621684362472"><span class="annot"><span class="annottext">consume'' :: Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362472"><span class="hs-identifier hs-var hs-var">consume''</span></a></span></span><span> </span><span id="local-6989586621684362471"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362471"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362471"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">entryConsumed :: Bool
</span><a href="Futhark.Analysis.SymbolTable.html#entryConsumed"><span class="hs-identifier hs-var">entryConsumed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="hs-comment">-- | Hide definitions of those entries that satisfy some predicate.</span><span>
</span><span id="line-570"></span><span id="local-6989586621684363094"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#hideIf"><span class="hs-identifier hs-type">hideIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#Entry"><span class="hs-identifier hs-type">Entry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363094"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363094"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363094"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-571"></span><span id="hideIf"><span class="annot"><span class="annottext">hideIf :: forall rep.
(Entry rep -&gt; Bool) -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#hideIf"><span class="hs-identifier hs-var hs-var">hideIf</span></a></span></span><span> </span><span id="local-6989586621684362469"><span class="annot"><span class="annottext">Entry rep -&gt; Bool
</span><a href="#local-6989586621684362469"><span class="hs-identifier hs-var">hide</span></a></span></span><span> </span><span id="local-6989586621684362468"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362468"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362468"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Entry rep)
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362467"><span class="hs-identifier hs-var">maybeHide</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362468"><span class="hs-identifier hs-var">vtable</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621684362467"><span class="annot"><span class="annottext">maybeHide :: Entry rep -&gt; Entry rep
</span><a href="#local-6989586621684362467"><span class="hs-identifier hs-var hs-var">maybeHide</span></a></span></span><span> </span><span id="local-6989586621684362466"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span></span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Bool
</span><a href="#local-6989586621684362469"><span class="hs-identifier hs-var">hide</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-575"></span><span>        </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-576"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">entryType :: EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var">entryType</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-577"></span><span>              </span><span class="annot"><span class="annottext">FreeVarEntry rep -&gt; EntryType rep
forall rep. FreeVarEntry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#FreeVar"><span class="hs-identifier hs-var">FreeVar</span></a></span><span>
</span><span id="line-578"></span><span>                </span><span class="annot"><span class="annottext">FreeVarEntry :: forall rep.
NameInfo rep -&gt; Names -&gt; (VName -&gt; IndexArray) -&gt; FreeVarEntry rep
</span><a href="Futhark.Analysis.SymbolTable.html#FreeVarEntry"><span class="hs-identifier hs-type">FreeVarEntry</span></a></span><span>
</span><span id="line-579"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">freeVarDec :: NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarDec"><span class="hs-identifier hs-var">freeVarDec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; NameInfo rep
forall rep. Entry rep -&gt; NameInfo rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryInfo"><span class="hs-identifier hs-var">entryInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-580"></span><span>                    </span><span class="annot"><span class="annottext">freeVarIndex :: VName -&gt; IndexArray
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarIndex"><span class="hs-identifier hs-var">freeVarIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">VName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TPrimExp Int64 VName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Indexed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-581"></span><span>                    </span><span class="annot"><span class="annottext">freeVarAliases :: Names
</span><a href="Futhark.Analysis.SymbolTable.html#freeVarAliases"><span class="hs-identifier hs-var">freeVarAliases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EntryType rep -&gt; Names
forall rep. EntryType rep -&gt; Names
</span><a href="Futhark.Analysis.SymbolTable.html#entryAliases"><span class="hs-identifier hs-var">entryAliases</span></a></span><span> </span><span class="annot"><span class="annottext">(EntryType rep -&gt; Names) -&gt; EntryType rep -&gt; Names
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; EntryType rep
forall rep. Entry rep -&gt; EntryType rep
</span><a href="Futhark.Analysis.SymbolTable.html#entryType"><span class="hs-identifier hs-var hs-var">entryType</span></a></span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-582"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-583"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362466"><span class="hs-identifier hs-var">entry</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-comment">-- | Hide these definitions, if they are protected by certificates in</span><span>
</span><span id="line-587"></span><span class="hs-comment">-- the set of names.</span><span>
</span><span id="line-588"></span><span id="local-6989586621684363092"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#hideCertified"><span class="hs-identifier hs-type">hideCertified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Futhark.IR.Prop.Names.html#Names"><span class="hs-identifier hs-type">Names</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363092"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363092"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-589"></span><span id="hideCertified"><span class="annot"><span class="annottext">hideCertified :: forall rep. Names -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#hideCertified"><span class="hs-identifier hs-var hs-var">hideCertified</span></a></span></span><span> </span><span id="local-6989586621684362464"><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362464"><span class="hs-identifier hs-var">to_hide</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Entry rep -&gt; Bool) -&gt; SymbolTable rep -&gt; SymbolTable rep
forall rep.
(Entry rep -&gt; Bool) -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#hideIf"><span class="hs-identifier hs-var">hideIf</span></a></span><span> </span><span class="annot"><span class="annottext">((Entry rep -&gt; Bool) -&gt; SymbolTable rep -&gt; SymbolTable rep)
-&gt; (Entry rep -&gt; Bool) -&gt; SymbolTable rep -&gt; SymbolTable rep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Stm rep -&gt; Bool) -&gt; Maybe (Stm rep) -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Bool
</span><a href="#local-6989586621684362463"><span class="hs-identifier hs-var">hide</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stm rep) -&gt; Bool)
-&gt; (Entry rep -&gt; Maybe (Stm rep)) -&gt; Entry rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Entry rep -&gt; Maybe (Stm rep)
forall rep. Entry rep -&gt; Maybe (Stm rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryStm"><span class="hs-identifier hs-var">entryStm</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-591"></span><span>    </span><span id="local-6989586621684362463"><span class="annot"><span class="annottext">hide :: Stm rep -&gt; Bool
</span><a href="#local-6989586621684362463"><span class="hs-identifier hs-var hs-var">hide</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VName -&gt; Bool) -&gt; [VName] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VName -&gt; Names -&gt; Bool
</span><a href="Futhark.IR.Prop.Names.html#nameIn"><span class="hs-operator hs-var">`nameIn`</span></a></span><span> </span><span class="annot"><span class="annottext">Names
</span><a href="#local-6989586621684362464"><span class="hs-identifier hs-var">to_hide</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VName] -&gt; Bool) -&gt; (Stm rep -&gt; [VName]) -&gt; Stm rep -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Certs -&gt; [VName]
</span><a href="Futhark.IR.Syntax.Core.html#unCerts"><span class="hs-identifier hs-var hs-var">unCerts</span></a></span><span> </span><span class="annot"><span class="annottext">(Certs -&gt; [VName]) -&gt; (Stm rep -&gt; Certs) -&gt; Stm rep -&gt; [VName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stm rep -&gt; Certs
forall rep. Stm rep -&gt; Certs
</span><a href="Futhark.IR.Prop.html#stmCerts"><span class="hs-identifier hs-var">stmCerts</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="hs-comment">-- | Note that these names are tokens for the corresponding</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- accumulators.  The names must already be present in the symbol</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- table.</span><span>
</span><span id="line-596"></span><span id="local-6989586621684363088"><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#noteAccTokens"><span class="hs-identifier hs-type">noteAccTokens</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Futhark.Core.html#VName"><span class="hs-identifier hs-type">VName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Futhark.IR.Syntax.html#WithAccInput"><span class="hs-identifier hs-type">WithAccInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363088"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-598"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363088"><span class="hs-identifier hs-type">rep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><a href="Futhark.Analysis.SymbolTable.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621684363088"><span class="hs-identifier hs-type">rep</span></a></span></span><span>
</span><span id="line-600"></span><span id="noteAccTokens"><span class="annot"><span class="annottext">noteAccTokens :: forall rep.
[(VName, WithAccInput rep)] -&gt; SymbolTable rep -&gt; SymbolTable rep
</span><a href="Futhark.Analysis.SymbolTable.html#noteAccTokens"><span class="hs-identifier hs-var hs-var">noteAccTokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; [(VName, WithAccInput rep)] -&gt; SymbolTable rep)
-&gt; [(VName, WithAccInput rep)]
-&gt; SymbolTable rep
-&gt; SymbolTable rep
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolTable rep -&gt; (VName, WithAccInput rep) -&gt; SymbolTable rep)
-&gt; SymbolTable rep
-&gt; [(VName, WithAccInput rep)]
-&gt; SymbolTable rep
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; (VName, WithAccInput rep) -&gt; SymbolTable rep
forall {rep}.
SymbolTable rep -&gt; (VName, WithAccInput rep) -&gt; SymbolTable rep
</span><a href="#local-6989586621684362458"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621684362458"><span class="annot"><span class="annottext">f :: SymbolTable rep -&gt; (VName, WithAccInput rep) -&gt; SymbolTable rep
</span><a href="#local-6989586621684362458"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621684362455"><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362455"><span class="hs-identifier hs-var">vtable</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621684362454"><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362454"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621684362453"><span class="annot"><span class="annottext">WithAccInput rep
</span><a href="#local-6989586621684362453"><span class="hs-identifier hs-var">accum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VName -&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362454"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Maybe (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Maybe (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362455"><span class="hs-identifier hs-var">vtable</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Entry rep)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362455"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621684362452"><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362452"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-606"></span><span>          </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362455"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-607"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bindings :: Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>                </span><span class="annot"><span class="annottext">VName
-&gt; Entry rep -&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">VName
</span><a href="#local-6989586621684362454"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Entry rep
</span><a href="#local-6989586621684362452"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">entryAccInput :: Maybe (WithAccInput rep)
</span><a href="Futhark.Analysis.SymbolTable.html#entryAccInput"><span class="hs-identifier hs-var">entryAccInput</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WithAccInput rep -&gt; Maybe (WithAccInput rep)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">WithAccInput rep
</span><a href="#local-6989586621684362453"><span class="hs-identifier hs-var">accum</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map VName (Entry rep) -&gt; Map VName (Entry rep))
-&gt; Map VName (Entry rep) -&gt; Map VName (Entry rep)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep -&gt; Map VName (Entry rep)
forall rep. SymbolTable rep -&gt; Map VName (Entry rep)
</span><a href="Futhark.Analysis.SymbolTable.html#bindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable rep
</span><a href="#local-6989586621684362455"><span class="hs-identifier hs-var">vtable</span></a></span><span>
</span><span id="line-609"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-610"></span></pre></body></html>